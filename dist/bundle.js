!function t(e,i,r){function n(o,a){if(!i[o]){if(!e[o]){var h="function"==typeof require&&require;if(!a&&h)return h(o,!0);if(s)return s(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var u=i[o]={exports:{}};e[o][0].call(u.exports,(function(t){return n(e[o][1][t]||t)}),u,u.exports,t,e,i,r)}return i[o].exports}for(var s="function"==typeof require&&require,o=0;o<r.length;o++)n(r[o]);return n}({1:[function(t,e,i){
/*!
 * @pixi/accessibility - v5.2.2
 * Compiled Tue, 21 Apr 2020 03:53:51 UTC
 *
 * @pixi/accessibility is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=t("@pixi/utils"),n={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:!1,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0};t("@pixi/display").DisplayObject.mixin(n);var s=function(t){this._hookDiv=null,(r.isMobile.tablet||r.isMobile.phone)&&this.createTouchHook();var e=document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.zIndex=2,this.div=e,this.pool=[],this.renderId=0,this.debug=!1,this.renderer=t,this.children=[],this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this.isActive=!1,this.isMobileAccessibility=!1,this.androidUpdateCount=0,this.androidUpdateFrequency=500,window.addEventListener("keydown",this._onKeyDown,!1)};s.prototype.createTouchHook=function(){var t=this,e=document.createElement("button");e.style.width="1px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.left="-1000px",e.style.zIndex=2,e.style.backgroundColor="#FF0000",e.title="select to enable accessability for this content",e.addEventListener("focus",(function(){t.isMobileAccessibility=!0,t.activate(),t.destroyTouchHook()})),document.body.appendChild(e),this._hookDiv=e},s.prototype.destroyTouchHook=function(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)},s.prototype.activate=function(){this.isActive||(this.isActive=!0,window.document.addEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode&&this.renderer.view.parentNode.appendChild(this.div))},s.prototype.deactivate=function(){this.isActive&&!this.isMobileAccessibility&&(this.isActive=!1,window.document.removeEventListener("mousemove",this._onMouseMove,!0),window.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode&&this.div.parentNode.removeChild(this.div))},s.prototype.updateAccessibleObjects=function(t){if(t.visible&&t.accessibleChildren){t.accessible&&t.interactive&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);for(var e=t.children,i=0;i<e.length;i++)this.updateAccessibleObjects(e[i])}},s.prototype.update=function(){var t=performance.now();if(!(r.isMobile.android.device&&t<this.androidUpdateCount)&&(this.androidUpdateCount=t+this.androidUpdateFrequency,this.renderer.renderingToScreen)){this.updateAccessibleObjects(this.renderer._lastObjectRendered);var e=this.renderer.view.getBoundingClientRect(),i=this.renderer.resolution,n=e.width/this.renderer.width*i,s=e.height/this.renderer.height*i,o=this.div;o.style.left=e.left+"px",o.style.top=e.top+"px",o.style.width=this.renderer.width+"px",o.style.height=this.renderer.height+"px";for(var a=0;a<this.children.length;a++){var h=this.children[a];if(h.renderId!==this.renderId)h._accessibleActive=!1,r.removeItems(this.children,a,1),this.div.removeChild(h._accessibleDiv),this.pool.push(h._accessibleDiv),h._accessibleDiv=null,a--;else{o=h._accessibleDiv;var l=h.hitArea,u=h.worldTransform;h.hitArea?(o.style.left=(u.tx+l.x*u.a)*n+"px",o.style.top=(u.ty+l.y*u.d)*s+"px",o.style.width=l.width*u.a*n+"px",o.style.height=l.height*u.d*s+"px"):(l=h.getBounds(),this.capHitArea(l),o.style.left=l.x*n+"px",o.style.top=l.y*s+"px",o.style.width=l.width*n+"px",o.style.height=l.height*s+"px",o.title!==h.accessibleTitle&&null!==h.accessibleTitle&&(o.title=h.accessibleTitle),o.getAttribute("aria-label")!==h.accessibleHint&&null!==h.accessibleHint&&o.setAttribute("aria-label",h.accessibleHint)),h.accessibleTitle===o.title&&h.tabIndex===o.tabIndex||(o.title=h.accessibleTitle,o.tabIndex=h.tabIndex,this.debug&&this.updateDebugHTML(o))}}this.renderId++}},s.prototype.updateDebugHTML=function(t){t.innerHTML="type: "+t.type+"</br> title : "+t.title+"</br> tabIndex: "+t.tabIndex},s.prototype.capHitArea=function(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0),t.x+t.width>this.renderer.width&&(t.width=this.renderer.width-t.x),t.y+t.height>this.renderer.height&&(t.height=this.renderer.height-t.y)},s.prototype.addChild=function(t){var e=this.pool.pop();e||((e=document.createElement("button")).style.width="100px",e.style.height="100px",e.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=2,e.style.borderStyle="none",navigator.userAgent.toLowerCase().indexOf("chrome")>-1?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.style.pointerEvents=t.accessiblePointerEvents,e.type=t.accessibleType,t.accessibleTitle&&null!==t.accessibleTitle?e.title=t.accessibleTitle:t.accessibleHint&&null!==t.accessibleHint||(e.title="displayObject "+t.tabIndex),t.accessibleHint&&null!==t.accessibleHint&&e.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(e),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex},s.prototype._onClick=function(t){var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"click",e.eventData),e.dispatchEvent(t.target.displayObject,"pointertap",e.eventData),e.dispatchEvent(t.target.displayObject,"tap",e.eventData)},s.prototype._onFocus=function(t){t.target.getAttribute("aria-live","off")||t.target.setAttribute("aria-live","assertive");var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"mouseover",e.eventData)},s.prototype._onFocusOut=function(t){t.target.getAttribute("aria-live","off")||t.target.setAttribute("aria-live","polite");var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"mouseout",e.eventData)},s.prototype._onKeyDown=function(t){9===t.keyCode&&this.activate()},s.prototype._onMouseMove=function(t){0===t.movementX&&0===t.movementY||this.deactivate()},s.prototype.destroy=function(){this.destroyTouchHook(),this.div=null;for(var t=0;t<this.children.length;t++)this.children[t].div=null;window.document.removeEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},i.AccessibilityManager=s,i.accessibleTarget=n},{"@pixi/display":5,"@pixi/utils":34}],2:[function(t,e,i){
/*!
 * @pixi/app - v5.2.2
 * Compiled Tue, 21 Apr 2020 03:53:51 UTC
 *
 * @pixi/app is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=t("@pixi/display"),n=t("@pixi/core"),s=function t(e){var i=this;e=Object.assign({forceCanvas:!1},e),this.renderer=n.autoDetectRenderer(e),this.stage=new r.Container,t._plugins.forEach((function(t){t.init.call(i,e)}))},o={view:{configurable:!0},screen:{configurable:!0}};s.registerPlugin=function(t){s._plugins.push(t)},s.prototype.render=function(){this.renderer.render(this.stage)},o.view.get=function(){return this.renderer.view},o.screen.get=function(){return this.renderer.screen},s.prototype.destroy=function(t,e){var i=this,r=s._plugins.slice(0);r.reverse(),r.forEach((function(t){t.destroy.call(i)})),this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null,this._options=null},Object.defineProperties(s.prototype,o),s._plugins=[];var a=function(){};a.init=function(t){var e=this;Object.defineProperty(this,"resizeTo",{set:function(t){window.removeEventListener("resize",this.resize),this._resizeTo=t,t&&(window.addEventListener("resize",this.resize),this.resize())},get:function(){return this._resizeTo}}),this.resize=function(){e._resizeTo&&(e._resizeTo===window?e.renderer.resize(window.innerWidth,window.innerHeight):e.renderer.resize(e._resizeTo.clientWidth,e._resizeTo.clientHeight))},this._resizeTo=null,this.resizeTo=t.resizeTo||null},a.destroy=function(){this.resizeTo=null,this.resize=null},s.registerPlugin(a),i.Application=s},{"@pixi/core":4,"@pixi/display":5}],3:[function(t,e,i){
/*!
 * @pixi/constants - v5.2.2
 * Compiled Tue, 21 Apr 2020 03:53:51 UTC
 *
 * @pixi/constants is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
"use strict";var r,n,s,o,a,h,l,u,c,d,p,f,g,m;Object.defineProperty(i,"__esModule",{value:!0}),(r=i.ENV||(i.ENV={}))[r.WEBGL_LEGACY=0]="WEBGL_LEGACY",r[r.WEBGL=1]="WEBGL",r[r.WEBGL2=2]="WEBGL2",(n=i.RENDERER_TYPE||(i.RENDERER_TYPE={}))[n.UNKNOWN=0]="UNKNOWN",n[n.WEBGL=1]="WEBGL",n[n.CANVAS=2]="CANVAS",(s=i.BLEND_MODES||(i.BLEND_MODES={}))[s.NORMAL=0]="NORMAL",s[s.ADD=1]="ADD",s[s.MULTIPLY=2]="MULTIPLY",s[s.SCREEN=3]="SCREEN",s[s.OVERLAY=4]="OVERLAY",s[s.DARKEN=5]="DARKEN",s[s.LIGHTEN=6]="LIGHTEN",s[s.COLOR_DODGE=7]="COLOR_DODGE",s[s.COLOR_BURN=8]="COLOR_BURN",s[s.HARD_LIGHT=9]="HARD_LIGHT",s[s.SOFT_LIGHT=10]="SOFT_LIGHT",s[s.DIFFERENCE=11]="DIFFERENCE",s[s.EXCLUSION=12]="EXCLUSION",s[s.HUE=13]="HUE",s[s.SATURATION=14]="SATURATION",s[s.COLOR=15]="COLOR",s[s.LUMINOSITY=16]="LUMINOSITY",s[s.NORMAL_NPM=17]="NORMAL_NPM",s[s.ADD_NPM=18]="ADD_NPM",s[s.SCREEN_NPM=19]="SCREEN_NPM",s[s.NONE=20]="NONE",s[s.SRC_OVER=0]="SRC_OVER",s[s.SRC_IN=21]="SRC_IN",s[s.SRC_OUT=22]="SRC_OUT",s[s.SRC_ATOP=23]="SRC_ATOP",s[s.DST_OVER=24]="DST_OVER",s[s.DST_IN=25]="DST_IN",s[s.DST_OUT=26]="DST_OUT",s[s.DST_ATOP=27]="DST_ATOP",s[s.ERASE=26]="ERASE",s[s.SUBTRACT=28]="SUBTRACT",s[s.XOR=29]="XOR",(o=i.DRAW_MODES||(i.DRAW_MODES={}))[o.POINTS=0]="POINTS",o[o.LINES=1]="LINES",o[o.LINE_LOOP=2]="LINE_LOOP",o[o.LINE_STRIP=3]="LINE_STRIP",o[o.TRIANGLES=4]="TRIANGLES",o[o.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",o[o.TRIANGLE_FAN=6]="TRIANGLE_FAN",(a=i.FORMATS||(i.FORMATS={}))[a.RGBA=6408]="RGBA",a[a.RGB=6407]="RGB",a[a.ALPHA=6406]="ALPHA",a[a.LUMINANCE=6409]="LUMINANCE",a[a.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",a[a.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",a[a.DEPTH_STENCIL=34041]="DEPTH_STENCIL",(h=i.TARGETS||(i.TARGETS={}))[h.TEXTURE_2D=3553]="TEXTURE_2D",h[h.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",h[h.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",h[h.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",h[h.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",h[h.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",h[h.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",h[h.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",h[h.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",(l=i.TYPES||(i.TYPES={}))[l.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",l[l.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",l[l.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",l[l.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",l[l.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",l[l.FLOAT=5126]="FLOAT",l[l.HALF_FLOAT=36193]="HALF_FLOAT",(u=i.SCALE_MODES||(i.SCALE_MODES={}))[u.NEAREST=0]="NEAREST",u[u.LINEAR=1]="LINEAR",(c=i.WRAP_MODES||(i.WRAP_MODES={}))[c.CLAMP=33071]="CLAMP",c[c.REPEAT=10497]="REPEAT",c[c.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",(d=i.MIPMAP_MODES||(i.MIPMAP_MODES={}))[d.OFF=0]="OFF",d[d.POW2=1]="POW2",d[d.ON=2]="ON",(p=i.ALPHA_MODES||(i.ALPHA_MODES={}))[p.NPM=0]="NPM",p[p.UNPACK=1]="UNPACK",p[p.PMA=2]="PMA",p[p.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",p[p.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",p[p.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",(f=i.GC_MODES||(i.GC_MODES={}))[f.AUTO=0]="AUTO",f[f.MANUAL=1]="MANUAL",(g=i.PRECISION||(i.PRECISION={})).LOW="lowp",g.MEDIUM="mediump",g.HIGH="highp",(m=i.MASK_TYPES||(i.MASK_TYPES={}))[m.NONE=0]="NONE",m[m.SCISSOR=1]="SCISSOR",m[m.STENCIL=2]="STENCIL",m[m.SPRITE=3]="SPRITE"},{}],4:[function(t,e,i){
/*!
 * @pixi/core - v5.2.2
 * Compiled Tue, 21 Apr 2020 03:53:51 UTC
 *
 * @pixi/core is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=t("@pixi/runner"),n=t("@pixi/utils"),s=t("@pixi/constants"),o=t("@pixi/settings"),a=t("@pixi/ticker"),h=t("@pixi/math"),l=t("@pixi/display"),u=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new r.Runner("setRealSize",2),this.onUpdate=new r.Runner("update"),this.onError=new r.Runner("onError",1)},c={valid:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};u.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.run(this._width,this._height)},u.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},u.prototype.resize=function(t,e){t===this._width&&e===this._height||(this._width=t,this._height=e,this.onResize.run(t,e))},c.valid.get=function(){return!!this._width&&!!this._height},u.prototype.update=function(){this.destroyed||this.onUpdate.run()},u.prototype.load=function(){return Promise.resolve()},c.width.get=function(){return this._width},c.height.get=function(){return this._height},u.prototype.upload=function(t,e,i){return!1},u.prototype.style=function(t,e,i){return!1},u.prototype.dispose=function(){},u.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},Object.defineProperties(u.prototype,c);var d=function(t){function e(e){var i=e.naturalWidth||e.videoWidth||e.width,r=e.naturalHeight||e.videoHeight||e.height;t.call(this,i,r),this.source=e,this.noSubImage=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.crossOrigin=function(t,e,i){void 0===i&&0!==e.indexOf("data:")?t.crossOrigin=n.determineCrossOrigin(e):!1!==i&&(t.crossOrigin="string"==typeof i?i:"anonymous")},e.prototype.upload=function(t,e,i,r){var n=t.gl,o=e.realWidth,a=e.realHeight;return r=r||this.source,n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===s.ALPHA_MODES.UNPACK),this.noSubImage||e.target!==n.TEXTURE_2D||i.width!==o||i.height!==a?(i.width=o,i.height=a,n.texImage2D(e.target,0,e.format,e.format,e.type,r)):n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,e.type,r),!0},e.prototype.update=function(){if(!this.destroyed){var e=this.source.naturalWidth||this.source.videoWidth||this.source.width,i=this.source.naturalHeight||this.source.videoHeight||this.source.height;this.resize(e,i),t.prototype.update.call(this)}},e.prototype.dispose=function(){this.source=null},e}(u),p=function(t){function e(e,i){if(i=i||{},!(e instanceof HTMLImageElement)){var r=new Image;t.crossOrigin(r,e,i.crossorigin),r.src=e,e=r}t.call(this,e),!e.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(void 0!==i.createBitmap?i.createBitmap:o.settings.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,this.alphaMode="number"==typeof i.alphaMode?i.alphaMode:null,void 0!==i.premultiplyAlpha&&(this.premultiplyAlpha=i.premultiplyAlpha),this.bitmap=null,this._load=null,!1!==i.autoLoad&&this.load()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(t){var e=this;return this._load||(void 0!==t&&(this.createBitmap=t),this._load=new Promise((function(t,i){e.url=e.source.src;var r=e.source,n=function(){e.destroyed||(r.onload=null,r.onerror=null,e.resize(r.width,r.height),e._load=null,e.createBitmap?t(e.process()):t(e))};r.complete&&r.src?n():(r.onload=n,r.onerror=function(t){i(t),e.onError.emit(t)})}))),this._load},e.prototype.process=function(){var t=this;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(this.source,0,0,this.source.width,this.source.height,{premultiplyAlpha:this.premultiplyAlpha===s.ALPHA_MODES.UNPACK?"premultiply":"none"}).then((function(e){return t.destroyed?Promise.reject():(t.bitmap=e,t.update(),t._process=null,Promise.resolve(t))})),this._process):Promise.resolve(this)},e.prototype.upload=function(e,i,r){if("number"==typeof this.alphaMode&&(i.alphaMode=this.alphaMode),!this.createBitmap)return t.prototype.upload.call(this,e,i,r);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(t.prototype.upload.call(this,e,i,r,this.bitmap),!this.preserveBitmap){var n=!0;for(var s in i._glTextures){var o=i._glTextures[s];if(o!==r&&o.dirtyId!==i.dirtyId){n=!1;break}}n&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},e.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,t.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},e}(d),f=[];function g(t,e){if(!t)return null;var i="";if("string"==typeof t){var r=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);r&&(i=r[1].toLowerCase())}for(var n=f.length-1;n>=0;--n){var s=f[n];if(s.test&&s.test(t,i))return new s(t,e)}return new p(t,e)}var m=function(t){function e(e,i){var r=i||{},n=r.width,s=r.height;if(!n||!s)throw new Error("BufferResource width or height invalid");t.call(this,n,s),this.data=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.upload=function(t,e,i){var r=t.gl;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===s.ALPHA_MODES.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(e.target,0,i.internalFormat,e.width,e.height,0,e.format,i.type,this.data)),!0},e.prototype.dispose=function(){this.data=null},e.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},e}(u),y={scaleMode:s.SCALE_MODES.NEAREST,format:s.FORMATS.RGBA,alphaMode:s.ALPHA_MODES.NPM},_=function(t){function e(e,i){void 0===e&&(e=null),void 0===i&&(i=null),t.call(this);var r=(i=i||{}).alphaMode,a=i.mipmap,h=i.anisotropicLevel,l=i.scaleMode,c=i.width,d=i.height,p=i.wrapMode,f=i.format,m=i.type,y=i.target,_=i.resolution,v=i.resourceOptions;!e||e instanceof u||((e=g(e,v)).internal=!0),this.width=c||0,this.height=d||0,this.resolution=_||o.settings.RESOLUTION,this.mipmap=void 0!==a?a:o.settings.MIPMAP_TEXTURES,this.anisotropicLevel=void 0!==h?h:o.settings.ANISOTROPIC_LEVEL,this.wrapMode=p||o.settings.WRAP_MODE,this.scaleMode=void 0!==l?l:o.settings.SCALE_MODE,this.format=f||s.FORMATS.RGBA,this.type=m||s.TYPES.UNSIGNED_BYTE,this.target=y||s.TARGETS.TEXTURE_2D,this.alphaMode=void 0!==r?r:s.ALPHA_MODES.UNPACK,void 0!==i.premultiplyAlpha&&(this.premultiplyAlpha=i.premultiplyAlpha),this.uid=n.uid(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=c>0&&d>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.setResource(e)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={realWidth:{configurable:!0},realHeight:{configurable:!0}};return i.realWidth.get=function(){return Math.ceil(this.width*this.resolution-1e-4)},i.realHeight.get=function(){return Math.ceil(this.height*this.resolution-1e-4)},e.prototype.setStyle=function(t,e){var i;return void 0!==t&&t!==this.scaleMode&&(this.scaleMode=t,i=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,i=!0),i&&this.dirtyStyleId++,this},e.prototype.setSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t,this.height=e,this._refreshPOT(),this.update(),this},e.prototype.setRealSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t/this.resolution,this.height=e/this.resolution,this._refreshPOT(),this.update(),this},e.prototype._refreshPOT=function(){this.isPowerOfTwo=n.isPow2(this.realWidth)&&n.isPow2(this.realHeight)},e.prototype.setResolution=function(t){var e=this.resolution;return e===t||(this.resolution=t,this.valid&&(this.width=this.width*e/t,this.height=this.height*e/t,this.emit("update",this)),this._refreshPOT()),this},e.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},e.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},e.prototype.onError=function(t){this.emit("error",this,t)},e.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete n.BaseTextureCache[this.cacheId],delete n.TextureCache[this.cacheId],this.cacheId=null),this.dispose(),e.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},e.prototype.dispose=function(){this.emit("dispose",this)},e.from=function(t,i,r){void 0===r&&(r=o.settings.STRICT_TEXTURE_CACHE);var s="string"==typeof t,a=null;s?a=t:(t._pixiId||(t._pixiId="pixiid_"+n.uid()),a=t._pixiId);var h=n.BaseTextureCache[a];if(s&&r&&!h)throw new Error('The cacheId "'+a+'" does not exist in BaseTextureCache.');return h||((h=new e(t,i)).cacheId=a,e.addToCache(h,a)),h},e.fromBuffer=function(t,i,r,n){t=t||new Float32Array(i*r*4);var o=new m(t,{width:i,height:r}),a=t instanceof Float32Array?s.TYPES.FLOAT:s.TYPES.UNSIGNED_BYTE;return new e(o,Object.assign(y,n||{width:i,height:r,type:a}))},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),n.BaseTextureCache[e]&&console.warn("BaseTexture added to the cache with an id ["+e+"] that already had an entry"),n.BaseTextureCache[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=n.BaseTextureCache[t];if(e){var i=e.textureCacheIds.indexOf(t);return i>-1&&e.textureCacheIds.splice(i,1),delete n.BaseTextureCache[t],e}}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)delete n.BaseTextureCache[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},Object.defineProperties(e.prototype,i),e}(n.EventEmitter);_._globalBatch=0;var v=function(t){function e(e,i){var r;i=i||{};var n=e;Array.isArray(e)&&(r=e,n=e.length),t.call(this,i.width,i.height),this.items=[],this.itemDirtyIds=[];for(var s=0;s<n;s++){var o=new _;this.items.push(o),this.itemDirtyIds.push(-1)}if(this.length=n,this._load=null,r)for(var a=0;a<n;a++)this.addResourceAt(g(r[a],i),a)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},e.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=s.TARGETS.TEXTURE_2D_ARRAY;for(var i=0;i<this.length;i++)this.items[i].on("update",e.update,e)},e.prototype.unbind=function(e){t.prototype.unbind.call(this,e);for(var i=0;i<this.length;i++)this.items[i].off("update",e.update,e)},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.items.map((function(t){return t.resource})),i=e.map((function(t){return t.load()}));return this._load=Promise.all(i).then((function(){var i=e[0],r=i.width,n=i.height;return t.resize(r,n),Promise.resolve(t)})),this._load},e.prototype.upload=function(t,e,i){var r=this.length,n=this.itemDirtyIds,s=this.items,o=t.gl;i.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,e.format,this._width,this._height,r,0,e.format,e.type,null);for(var a=0;a<r;a++){var h=s[a];n[a]<h.dirtyId&&(n[a]=h.dirtyId,h.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,a,h.resource.width,h.resource.height,1,e.format,e.type,h.resource.source))}return!0},e}(u),x=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.test=function(t){var e=window.OffscreenCanvas;return!!(e&&t instanceof e)||t instanceof HTMLCanvasElement},e}(d),b=function(t){function e(i,r){if(r=r||{},t.call(this,i,r),this.length!==e.SIDES)throw new Error("Invalid length. Got "+this.length+", expected 6");for(var n=0;n<e.SIDES;n++)this.items[n].target=s.TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X+n;!1!==r.autoLoad&&this.load()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=s.TARGETS.TEXTURE_CUBE_MAP},e.prototype.upload=function(t,i,r){for(var n=this.itemDirtyIds,s=0;s<e.SIDES;s++){var o=this.items[s];n[s]<o.dirtyId&&(n[s]=o.dirtyId,o.valid&&o.resource.upload(t,o,r))}return!0},e}(v);b.SIDES=6;var w=function(t){function e(e,i){i=i||{},t.call(this,document.createElement("canvas")),this._width=0,this._height=0,this.svg=e,this.scale=i.scale||1,this._overrideWidth=i.width,this._overrideHeight=i.height,this._resolve=null,this._crossorigin=i.crossorigin,this._load=null,!1!==i.autoLoad&&this.load()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(){var t=this;return this._load||(this._load=new Promise((function(e){if(t._resolve=function(){t.resize(t.source.width,t.source.height),e(t)},/^\<svg/.test(t.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");t.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(t.svg)))}t._loadSvg()}))),this._load},e.prototype._loadSvg=function(){var e=this,i=new Image;t.crossOrigin(i,this.svg,this._crossorigin),i.src=this.svg,i.onerror=function(t){e._resolve&&(i.onerror=null,e.onError.run(t))},i.onload=function(){if(e._resolve){var t=i.width,r=i.height;if(!t||!r)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var s=t*e.scale,o=r*e.scale;(e._overrideWidth||e._overrideHeight)&&(s=e._overrideWidth||e._overrideHeight/r*t,o=e._overrideHeight||e._overrideWidth/t*r),s=Math.round(s),o=Math.round(o);var a=e.source;a.width=s,a.height=o,a._pixiId="canvas_"+n.uid(),a.getContext("2d").drawImage(i,0,0,t,r,0,0,s,o),e._resolve(),e._resolve=null}}},e.getSize=function(t){var i=e.SVG_SIZE.exec(t),r={};return i&&(r[i[1]]=Math.round(parseFloat(i[3])),r[i[5]]=Math.round(parseFloat(i[7]))),r},e.prototype.dispose=function(){t.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},e.test=function(t,e){return"svg"===e||"string"==typeof t&&0===t.indexOf("data:image/svg+xml;base64")||"string"==typeof t&&0===t.indexOf("<svg")},e}(d);w.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var T=function(t){function e(e,i){if(i=i||{},!(e instanceof HTMLVideoElement)){var r=document.createElement("video");r.setAttribute("preload","auto"),r.setAttribute("webkit-playsinline",""),r.setAttribute("playsinline",""),"string"==typeof e&&(e=[e]),t.crossOrigin(r,e[0].src||e[0],i.crossorigin);for(var n=0;n<e.length;++n){var s=document.createElement("source"),o=e[n],a=o.src,h=o.mime,l=(a=a||e[n]).split("?").shift().toLowerCase(),u=l.substr(l.lastIndexOf(".")+1);h=h||"video/"+u,s.src=a,s.type=h,r.appendChild(s)}e=r}t.call(this,e),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=i.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==i.autoPlay,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),!1!==i.autoLoad&&this.load()}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={autoUpdate:{configurable:!0},updateFPS:{configurable:!0}};return e.prototype.update=function(e){if(void 0===e&&(e=0),!this.destroyed){var i=a.Ticker.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-i),(!this._updateFPS||this._msToNextUpdate<=0)&&(t.prototype.update.call(this,e),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart.bind(this)),e.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise((function(i){t.valid?i(t):(t._resolve=i,e.load())})),this._load},e.prototype._onError=function(){this.source.removeEventListener("error",this._onError,!0),this.onError.run(event)},e.prototype._isSourcePlaying=function(){var t=this.source;return t.currentTime>0&&!1===t.paused&&!1===t.ended&&t.readyState>2},e.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},e.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(a.Ticker.shared.add(this.update,this),this._isConnectedToTicker=!0)},e.prototype._onPlayStop=function(){this._isConnectedToTicker&&(a.Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1)},e.prototype._onCanPlay=function(){var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},e.prototype.dispose=function(){this._isConnectedToTicker&&a.Ticker.shared.remove(this.update,this),this.source&&(this.source.removeEventListener("error",this._onError,!0),this.source.pause(),this.source.src="",this.source.load()),t.prototype.dispose.call(this)},i.autoUpdate.get=function(){return this._autoUpdate},i.autoUpdate.set=function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(a.Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(a.Ticker.shared.add(this.update,this),this._isConnectedToTicker=!0))},i.updateFPS.get=function(){return this._updateFPS},i.updateFPS.set=function(t){t!==this._updateFPS&&(this._updateFPS=t)},e.test=function(t,i){return t instanceof HTMLVideoElement||e.TYPES.indexOf(i)>-1},Object.defineProperties(e.prototype,i),e}(d);T.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];var E=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.test=function(t){return!!window.createImageBitmap&&t instanceof ImageBitmap},e}(d);f.push(p,E,x,T,w,m,b,v);var S={INSTALLED:f,autoDetectResource:g,ArrayResource:v,BufferResource:m,CanvasResource:x,CubeResource:b,ImageResource:p,ImageBitmapResource:E,SVGResource:w,VideoResource:T,Resource:u,BaseImageResource:d},P=function(t){this.renderer=t};P.prototype.destroy=function(){this.renderer=null};var O=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.upload=function(t,e,i){var r=t.gl;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===s.ALPHA_MODES.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(e.target,0,1===t.context.webGLVersion?r.DEPTH_COMPONENT:r.DEPTH_COMPONENT16,e.width,e.height,0,e.format,e.type,this.data)),!0},e}(m),C=function(t,e){this.width=Math.ceil(t||100),this.height=Math.ceil(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new r.Runner("disposeFramebuffer",2)},I={colorTexture:{configurable:!0}};I.colorTexture.get=function(){return this.colorTextures[0]},C.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),this.colorTextures[t]=e||new _(null,{scaleMode:s.SCALE_MODES.NEAREST,resolution:1,mipmap:!1,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},C.prototype.addDepthTexture=function(t){return this.depthTexture=t||new _(new O(null,{width:this.width,height:this.height}),{scaleMode:s.SCALE_MODES.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:!1,format:s.FORMATS.DEPTH_COMPONENT,type:s.TYPES.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},C.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},C.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},C.prototype.resize=function(t,e){if(t=Math.ceil(t),e=Math.ceil(e),t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var i=0;i<this.colorTextures.length;i++){var r=this.colorTextures[i],n=r.resolution;r.setSize(t/n,e/n)}if(this.depthTexture){var s=this.depthTexture.resolution;this.depthTexture.setSize(t/s,e/s)}}},C.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Object.defineProperties(C.prototype,I);var M=function(t){function e(e){if("number"==typeof e){var i=arguments[0],r=arguments[1],n=arguments[2],s=arguments[3];e={width:i,height:r,scaleMode:n,resolution:s}}t.call(this,null,e);var o=e||{},a=o.width,h=o.height;this.mipmap=!1,this.width=Math.ceil(a)||100,this.height=Math.ceil(h)||100,this.valid=!0,this._canvasRenderTarget=null,this.clearColor=[0,0,0,0],this.framebuffer=new C(this.width*this.resolution,this.height*this.resolution).addColorTexture(0,this),this.maskStack=[],this.filterStack=[{}]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.resize=function(t,e){t=Math.ceil(t),e=Math.ceil(e),this.framebuffer.resize(t*this.resolution,e*this.resolution)},e.prototype.dispose=function(){this.framebuffer.dispose(),t.prototype.dispose.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this,!0),this.framebuffer=null},e}(_),A=function(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)};A.prototype.set=function(t,e,i){var r=e.width,n=e.height;if(i){var s=t.width/2/r,o=t.height/2/n,a=t.x/r+s,l=t.y/n+o;i=h.groupD8.add(i,h.groupD8.NW),this.x0=a+s*h.groupD8.uX(i),this.y0=l+o*h.groupD8.uY(i),i=h.groupD8.add(i,2),this.x1=a+s*h.groupD8.uX(i),this.y1=l+o*h.groupD8.uY(i),i=h.groupD8.add(i,2),this.x2=a+s*h.groupD8.uX(i),this.y2=l+o*h.groupD8.uY(i),i=h.groupD8.add(i,2),this.x3=a+s*h.groupD8.uX(i),this.y3=l+o*h.groupD8.uY(i)}else this.x0=t.x/r,this.y0=t.y/n,this.x1=(t.x+t.width)/r,this.y1=t.y/n,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/n,this.x3=t.x/r,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3};var R=new A,D=function(t){function e(i,r,n,s,o,a){if(t.call(this),this.noFrame=!1,r||(this.noFrame=!0,r=new h.Rectangle(0,0,1,1)),i instanceof e&&(i=i.baseTexture),this.baseTexture=i,this._frame=r,this.trim=s,this.valid=!1,this.requiresUpdate=!1,this._uvs=R,this.uvMatrix=null,this.orig=n||r,this._rotate=Number(o||0),!0===o)this._rotate=2;else if(this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=a?new h.Point(a.x,a.y):new h.Point(0,0),this._updateID=0,this.textureCacheIds=[],i.valid?this.noFrame?i.valid&&this.onBaseTextureUpdated(i):this.frame=r:i.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&i.on("update",this.onBaseTextureUpdated,this)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={resolution:{configurable:!0},frame:{configurable:!0},rotate:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return e.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},e.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},e.prototype.destroy=function(t){if(this.baseTexture){if(t){var i=this.baseTexture.resource;i&&n.TextureCache[i.url]&&e.removeFromCache(i.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,e.removeFromCache(this),this.textureCacheIds=null},e.prototype.clone=function(){return new e(this.baseTexture,this.frame.clone(),this.orig.clone(),this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor)},e.prototype.updateUvs=function(){this._uvs===R&&(this._uvs=new A),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},e.from=function(t,i,r){void 0===i&&(i={}),void 0===r&&(r=o.settings.STRICT_TEXTURE_CACHE);var s="string"==typeof t,a=null;s?a=t:(t._pixiId||(t._pixiId="pixiid_"+n.uid()),a=t._pixiId);var h=n.TextureCache[a];if(s&&r&&!h)throw new Error('The cacheId "'+a+'" does not exist in TextureCache.');return h||(i.resolution||(i.resolution=n.getResolutionOfUrl(t)),(h=new e(new _(t,i))).baseTexture.cacheId=a,_.addToCache(h.baseTexture,a),e.addToCache(h,a)),h},e.fromBuffer=function(t,i,r,n){return new e(_.fromBuffer(t,i,r,n))},e.fromLoader=function(t,i,r){var s=new p(t);s.url=i;var a=new e(new _(s,{scaleMode:o.settings.SCALE_MODE,resolution:n.getResolutionOfUrl(i)}));return r||(r=i),_.addToCache(a.baseTexture,r),e.addToCache(a,r),r!==i&&(_.addToCache(a.baseTexture,i),e.addToCache(a,i)),a},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),n.TextureCache[e]&&console.warn("Texture added to the cache with an id ["+e+"] that already had an entry"),n.TextureCache[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=n.TextureCache[t];if(e){var i=e.textureCacheIds.indexOf(t);return i>-1&&e.textureCacheIds.splice(i,1),delete n.TextureCache[t],e}}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)n.TextureCache[t.textureCacheIds[r]]===t&&delete n.TextureCache[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},i.resolution.get=function(){return this.baseTexture.resolution},i.frame.get=function(){return this._frame},i.frame.set=function(t){this._frame=t,this.noFrame=!1;var e=t.x,i=t.y,r=t.width,n=t.height,s=e+r>this.baseTexture.width,o=i+n>this.baseTexture.height;if(s||o){var a=s&&o?"and":"or",h="X: "+e+" + "+r+" = "+(e+r)+" > "+this.baseTexture.width,l="Y: "+i+" + "+n+" = "+(i+n)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+h+" "+a+" "+l)}this.valid=r&&n&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},i.rotate.get=function(){return this._rotate},i.rotate.set=function(t){this._rotate=t,this.valid&&this.updateUvs()},i.width.get=function(){return this.orig.width},i.height.get=function(){return this.orig.height},Object.defineProperties(e.prototype,i),e}(n.EventEmitter);function N(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}D.EMPTY=new D(new _),N(D.EMPTY),N(D.EMPTY.baseTexture),D.WHITE=function(){var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new D(new _(new x(t)))}(),N(D.WHITE),N(D.WHITE.baseTexture);var L=function(t){function e(e,i){var r=null;if(!(e instanceof M)){var n=arguments[1],s=arguments[2],o=arguments[3],a=arguments[4];console.warn("Please use RenderTexture.create("+n+", "+s+") instead of the ctor directly."),r=arguments[0],i=null,e=new M({width:n,height:s,scaleMode:o,resolution:a})}t.call(this,e,i),this.legacyRenderer=r,this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.resize=function(t,e,i){void 0===i&&(i=!0),t=Math.ceil(t),e=Math.ceil(e),this.valid=t>0&&e>0,this._frame.width=this.orig.width=t,this._frame.height=this.orig.height=e,i&&this.baseTexture.resize(t,e),this.updateUvs()},e.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},e.create=function(t){return"number"==typeof t&&(t={width:t,height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}),new e(new M(t))},e}(D),k=function(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0};k.prototype.createTexture=function(t,e){var i=new M(Object.assign({width:t,height:e,resolution:1},this.textureOptions));return new L(i)},k.prototype.getOptimalTexture=function(t,e,i){void 0===i&&(i=1);var r=k.SCREEN_KEY;t*=i,e*=i,this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight||(r=(65535&(t=n.nextPow2(t)))<<16|65535&(e=n.nextPow2(e))),this.texturePool[r]||(this.texturePool[r]=[]);var s=this.texturePool[r].pop();return s||(s=this.createTexture(t,e)),s.filterPoolKey=r,s.setResolution(i),s},k.prototype.getFilterTexture=function(t,e){var i=this.getOptimalTexture(t.width,t.height,e||t.resolution);return i.filterFrame=t.filterFrame,i},k.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},k.prototype.returnFilterTexture=function(t){this.returnTexture(t)},k.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){var i=this.texturePool[e];if(i)for(var r=0;r<i.length;r++)i[r].destroy(!0)}this.texturePool={}},k.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){var e=k.SCREEN_KEY,i=this.texturePool[e];if(this.enableFullScreen=t.width>0&&t.height>0,i)for(var r=0;r<i.length;r++)i[r].destroy(!0);this.texturePool[e]=[],this._pixelsWidth=t.width,this._pixelsHeight=t.height}},k.SCREEN_KEY="screen";var F=function(t,e,i,r,n,s,o){void 0===i&&(i=!1),void 0===r&&(r=5126),this.buffer=t,this.size=e,this.normalized=i,this.type=r,this.stride=n,this.start=s,this.instance=o};F.prototype.destroy=function(){this.buffer=null},F.from=function(t,e,i,r,n){return new F(t,e,i,r,n)};var B=0,U=function(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=e,this.id=B++,this.disposeRunner=new r.Runner("disposeBuffer",2)};function j(t){if(4===t.BYTES_PER_ELEMENT)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array";return null}U.prototype.update=function(t){this.data=t||this.data,this._updateID++},U.prototype.dispose=function(){this.disposeRunner.run(this,!1)},U.prototype.destroy=function(){this.dispose(),this.data=null},U.from=function(t){return t instanceof Array&&(t=new Float32Array(t)),new U(t)};var H={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};var X={5126:4,5123:2,5121:1},z=0,G={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array},W=function(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=z++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new r.Runner("disposeGeometry",2),this.refCount=0};W.prototype.addAttribute=function(t,e,i,r,n,s,o,a){if(void 0===r&&(r=!1),void 0===a&&(a=!1),!e)throw new Error("You must pass a buffer when creating an attribute");e.data||(e instanceof Array&&(e=new Float32Array(e)),e=new U(e));var h=t.split("|");if(h.length>1){for(var l=0;l<h.length;l++)this.addAttribute(h[l],e,i,r,n);return this}var u=this.buffers.indexOf(e);return-1===u&&(this.buffers.push(e),u=this.buffers.length-1),this.attributes[t]=new F(u,i,r,n,s,o,a),this.instanced=this.instanced||a,this},W.prototype.getAttribute=function(t){return this.attributes[t]},W.prototype.getBuffer=function(t){return this.buffers[this.getAttribute(t).buffer]},W.prototype.addIndex=function(t){return t.data||(t instanceof Array&&(t=new Uint16Array(t)),t=new U(t)),t.index=!0,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},W.prototype.getIndex=function(){return this.indexBuffer},W.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],i=[],r=new U;for(t in this.attributes){var n=this.attributes[t],s=this.buffers[n.buffer];e.push(s.data),i.push(n.size*X[n.type]/4),n.buffer=0}for(r.data=function(t,e){for(var i=0,r=0,n={},s=0;s<t.length;s++)r+=e[s],i+=t[s].length;for(var o=new ArrayBuffer(4*i),a=null,h=0,l=0;l<t.length;l++){var u=e[l],c=t[l],d=j(c);n[d]||(n[d]=new H[d](o)),a=n[d];for(var p=0;p<c.length;p++){a[(p/u|0)*r+h+p%u]=c[p]}h+=u}return new Float32Array(o)}(e,i),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[r],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},W.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},W.prototype.dispose=function(){this.disposeRunner.run(this,!1)},W.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},W.prototype.clone=function(){for(var t=new W,e=0;e<this.buffers.length;e++)t.buffers[e]=new U(this.buffers[e].data.slice());for(var i in this.attributes){var r=this.attributes[i];t.attributes[i]=new F(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.index=!0),t},W.merge=function(t){for(var e,i=new W,r=[],n=[],s=[],o=0;o<t.length;o++){e=t[o];for(var a=0;a<e.buffers.length;a++)n[a]=n[a]||0,n[a]+=e.buffers[a].data.length,s[a]=0}for(var h=0;h<e.buffers.length;h++)r[h]=new(G[j(e.buffers[h].data)])(n[h]),i.buffers[h]=new U(r[h]);for(var l=0;l<t.length;l++){e=t[l];for(var u=0;u<e.buffers.length;u++)r[u].set(e.buffers[u].data,s[u]),s[u]+=e.buffers[u].data.length}if(i.attributes=e.attributes,e.indexBuffer){i.indexBuffer=i.buffers[e.buffers.indexOf(e.indexBuffer)],i.indexBuffer.index=!0;for(var c=0,d=0,p=0,f=0,g=0;g<e.buffers.length;g++)if(e.buffers[g]!==e.indexBuffer){f=g;break}for(var m in e.attributes){var y=e.attributes[m];(0|y.buffer)===f&&(d+=y.size*X[y.type]/4)}for(var _=0;_<t.length;_++){for(var v=t[_].indexBuffer.data,x=0;x<v.length;x++)i.indexBuffer.data[x+p]+=c;c+=e.buffers[f].data.length/d,p+=v.length}}return i};var V=function(t){function e(){t.call(this),this.addAttribute("aVertexPosition",[0,0,1,0,1,1,0,1]).addIndex([0,1,3,2])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(W),Y=function(t){function e(){t.call(this),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new U(this.vertices),this.uvBuffer=new U(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.map=function(t,e){var i=0,r=0;return this.uvs[0]=i,this.uvs[1]=r,this.uvs[2]=i+e.width/t.width,this.uvs[3]=r,this.uvs[4]=i+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=i,this.uvs[7]=r+e.height/t.height,i=e.x,r=e.y,this.vertices[0]=i,this.vertices[1]=r,this.vertices[2]=i+e.width,this.vertices[3]=r,this.vertices[4]=i+e.width,this.vertices[5]=r+e.height,this.vertices[6]=i,this.vertices[7]=r+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(W),q=0,K=function(t,e){this.uniforms=t,this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=q++,this.static=!!e};K.prototype.update=function(){this.dirtyId++},K.prototype.add=function(t,e,i){this.uniforms[t]=new K(e,i)},K.from=function(t,e){return new K(t,e)};var $=function(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.sourceFrame=new h.Rectangle,this.destinationFrame=new h.Rectangle,this.filters=[]};$.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null};var Z=function(t){function e(e){t.call(this,e),this.defaultFilterStack=[{}],this.texturePool=new k,this.texturePool.setScreenSize(e.view),this.statePool=[],this.quad=new V,this.quadUv=new Y,this.tempRect=new h.Rectangle,this.activeState={},this.globalUniforms=new K({outputFrame:this.tempRect,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.push=function(t,e){for(var i=this.renderer,r=this.defaultFilterStack,n=this.statePool.pop()||new $,s=e[0].resolution,o=e[0].padding,a=e[0].autoFit,h=e[0].legacy,l=1;l<e.length;l++){var u=e[l];s=Math.min(s,u.resolution),o=this.useMaxPadding?Math.max(o,u.padding):o+u.padding,a=a||u.autoFit,h=h||u.legacy}1===r.length&&(this.defaultFilterStack[0].renderTexture=i.renderTexture.current),r.push(n),n.resolution=s,n.legacy=h,n.target=t,n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(o),a&&n.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),n.sourceFrame.ceil(s),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,s),n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height,n.renderTexture.filterFrame=n.sourceFrame,i.renderTexture.bind(n.renderTexture,n.sourceFrame),i.renderTexture.clear()},e.prototype.pop=function(){var t=this.defaultFilterStack,e=t.pop(),i=e.filters;this.activeState=e;var r=this.globalUniforms.uniforms;r.outputFrame=e.sourceFrame,r.resolution=e.resolution;var n=r.inputSize,s=r.inputPixel,o=r.inputClamp;if(n[0]=e.destinationFrame.width,n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],s[0]=n[0]*e.resolution,s[1]=n[1]*e.resolution,s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=e.sourceFrame.width*n[2]-.5*s[2],o[3]=e.sourceFrame.height*n[3]-.5*s[3],e.legacy){var a=r.filterArea;a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=e.sourceFrame.x,a[3]=e.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();var h=t[t.length-1];if(1===i.length)i[0].apply(this,e.renderTexture,h.renderTexture,!1,e),this.returnFilterTexture(e.renderTexture);else{var l=e.renderTexture,u=this.getOptimalFilterTexture(l.width,l.height,e.resolution);u.filterFrame=l.filterFrame;var c=0;for(c=0;c<i.length-1;++c){i[c].apply(this,l,u,!0,e);var d=l;l=u,u=d}i[c].apply(this,l,h.renderTexture,!1,e),this.returnFilterTexture(l),this.returnFilterTexture(u)}e.clear(),this.statePool.push(e)},e.prototype.applyFilter=function(t,e,i,r){var n=this.renderer;n.renderTexture.bind(i,i?i.filterFrame:null),r&&n.renderTexture.clear(),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.state.set(t.state),n.shader.bind(t),t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(s.DRAW_MODES.TRIANGLES)):(n.geometry.bind(this.quad),n.geometry.draw(s.DRAW_MODES.TRIANGLE_STRIP))},e.prototype.calculateSpriteMatrix=function(t,e){var i=this.activeState,r=i.sourceFrame,n=i.destinationFrame,s=e._texture.orig,o=t.set(n.width,0,0,n.height,r.x,r.y),a=e.worldTransform.copyTo(h.Matrix.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(e.anchor.x,e.anchor.y),o},e.prototype.destroy=function(){this.texturePool.clear(!1)},e.prototype.getOptimalFilterTexture=function(t,e,i){return void 0===i&&(i=1),this.texturePool.getOptimalTexture(t,e,i)},e.prototype.getFilterTexture=function(t,e){if("number"==typeof t){var i=t;t=e,e=i}t=t||this.activeState.renderTexture;var r=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution);return r.filterFrame=t.filterFrame,r},e.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},e.prototype.emptyPool=function(){this.texturePool.clear(!0)},e.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},e}(P),J=function(t){this.renderer=t};J.prototype.flush=function(){},J.prototype.destroy=function(){this.renderer=null},J.prototype.start=function(){},J.prototype.stop=function(){this.flush()},J.prototype.render=function(t){};var Q=function(t){function e(e){t.call(this,e),this.emptyRenderer=new J(e),this.currentRenderer=this.emptyRenderer}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},e.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.copyBoundTextures=function(t,e){for(var i=this.renderer.texture.boundTextures,r=e-1;r>=0;--r)t[r]=i[r]||null,t[r]&&(t[r]._batchLocation=r)},e.prototype.boundArray=function(t,e,i,r){for(var n=t.elements,s=t.ids,o=t.count,a=0,h=0;h<o;h++){var l=n[h],u=l._batchLocation;if(u>=0&&u<r&&e[u]===l)s[h]=u;else for(;a<r;){var c=e[a];if(!c||c._batchEnabled!==i||c._batchLocation!==a){s[h]=a,l._batchLocation=a,e[a]=l;break}a++}}},e}(P);o.settings.PREFER_ENV=n.isMobile.any?s.ENV.WEBGL:s.ENV.WEBGL2,o.settings.STRICT_TEXTURE_CACHE=!1;var tt=0,et=function(t){function e(e){t.call(this,e),this.webGLVersion=1,this.extensions={},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),e.view.addEventListener("webglcontextlost",this.handleContextLost,!1),e.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={isLost:{configurable:!0}};return i.isLost.get=function(){return!this.gl||this.gl.isContextLost()},e.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=tt++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").restoreContext()},e.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=tt++,this.renderer.runners.contextChange.run(t)},e.prototype.initFromOptions=function(t){var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},e.prototype.createContext=function(t,e){var i;if(o.settings.PREFER_ENV>=s.ENV.WEBGL2&&(i=t.getContext("webgl2",e)),i)this.webGLVersion=2;else if(this.webGLVersion=1,!(i=t.getContext("webgl",e)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),i},e.prototype.getExtensions=function(){var t=this.gl;1===this.webGLVersion?Object.assign(this.extensions,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,{anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),colorBufferFloat:t.getExtension("EXT_color_buffer_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear")})},e.prototype.handleContextLost=function(t){t.preventDefault()},e.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.run(this.gl)},e.prototype.destroy=function(){var t=this.renderer.view;t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},e.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},e.prototype.validateContext=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")},Object.defineProperties(e.prototype,i),e}(P),it=function(t){function e(e){t.call(this,e),this.managedFramebuffers=[],this.unknownFramebuffer=new C(10,10)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={size:{configurable:!0}};return e.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new h.Rectangle,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){var e=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;o.settings.PREFER_ENV===s.ENV.WEBGL_LEGACY&&(e=null,i=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),i||(this.writeDepthTexture=!1)}},e.prototype.bind=function(t,e){var i=this.gl;if(t){var r=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,i.bindFramebuffer(i.FRAMEBUFFER,r.framebuffer)),r.dirtyId!==t.dirtyId&&(r.dirtyId=t.dirtyId,r.dirtyFormat!==t.dirtyFormat?(r.dirtyFormat=t.dirtyFormat,this.updateFramebuffer(t)):r.dirtySize!==t.dirtySize&&(r.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var n=0;n<t.colorTextures.length;n++)t.colorTextures[n].texturePart?this.renderer.texture.unbind(t.colorTextures[n].texture):this.renderer.texture.unbind(t.colorTextures[n]);t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,t.width,t.height)}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},e.prototype.setViewport=function(t,e,i,r){var n=this.viewport;n.width===i&&n.height===r&&n.x===t&&n.y===e||(n.x=t,n.y=e,n.width=i,n.height=r,this.gl.viewport(t,e,i,r))},i.size.get=function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},e.prototype.clear=function(t,e,i,r){var n=this.gl;n.clearColor(t,e,i,r),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)},e.prototype.initFramebuffer=function(t){var e={framebuffer:this.gl.createFramebuffer(),stencil:null,dirtyId:0,dirtyFormat:0,dirtySize:0};return t.glFramebuffers[this.CONTEXT_UID]=e,this.managedFramebuffers.push(t),t.disposeRunner.add(this),e},e.prototype.resizeFramebuffer=function(t){var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID];i.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));for(var r=t.colorTextures,n=0;n<r.length;n++)this.renderer.texture.bind(r[n],0);t.depthTexture&&this.renderer.texture.bind(t.depthTexture,0)},e.prototype.updateFramebuffer=function(t){var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID],r=t.colorTextures.length;e.drawBuffers||(r=Math.min(r,1));for(var n=[],s=0;s<r;s++){var o=t.colorTextures[s];o.texturePart?(this.renderer.texture.bind(o.texture,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_CUBE_MAP_NEGATIVE_X+o.side,o.texture._glTextures[this.CONTEXT_UID].texture,0)):(this.renderer.texture.bind(o,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_2D,o._glTextures[this.CONTEXT_UID].texture,0)),n.push(e.COLOR_ATTACHMENT0+s)}if((n.length>1&&e.drawBuffers(n),t.depthTexture)&&this.writeDepthTexture){var a=t.depthTexture;this.renderer.texture.bind(a,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a._glTextures[this.CONTEXT_UID].texture,0)}i.stencil||!t.stencil&&!t.depth||(i.stencil=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height),t.depthTexture||e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,i.stencil))},e.prototype.disposeFramebuffer=function(t,e){var i=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(i){delete t.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(t);n>=0&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(r.deleteFramebuffer(i.framebuffer),i.stencil&&r.deleteRenderbuffer(i.stencil))}},e.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var i=0;i<e.length;i++)this.disposeFramebuffer(e[i],t)},e.prototype.forceStencil=function(){var t=this.current;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.enableStencil();var i=t.width,r=t.height,n=this.gl,s=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,s),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,i,r),e.stencil=s,n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,s)}}},e.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new h.Rectangle},Object.defineProperties(e.prototype,i),e}(P),rt=function(t){this.buffer=t,this.updateID=-1,this.byteLength=-1,this.refCount=0},nt={5126:4,5123:2,5121:1},st=function(t){function e(e){t.call(this,e),this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.boundBuffers={},this.managedGeometries={},this.managedBuffers={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!t.createVertexArray){var i=this.renderer.context.extensions.vertexArrayObject;o.settings.PREFER_ENV===s.ENV.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=function(){return i.createVertexArrayOES()},t.bindVertexArray=function(t){return i.bindVertexArrayOES(t)},t.deleteVertexArray=function(t){return i.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){},t.bindVertexArray=function(){},t.deleteVertexArray=function(){})}if(!t.vertexAttribDivisor){var r=t.getExtension("ANGLE_instanced_arrays");r?(t.vertexAttribDivisor=function(t,e){return r.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,i,n,s){return r.drawElementsInstancedANGLE(t,e,i,n,s)},t.drawArraysInstanced=function(t,e,i,n){return r.drawArraysInstancedANGLE(t,e,i,n)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},e.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var i=this.gl,r=t.glVertexArrayObjects[this.CONTEXT_UID];r||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={});var n=r[e.program.id]||this.initGeometryVao(t,e.program);this._activeGeometry=t,this._activeVao!==n&&(this._activeVao=n,this.hasVao?i.bindVertexArray(n):this.activateVao(t,e.program)),this.updateBuffers()},e.prototype.reset=function(){this.unbind()},e.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.gl,i=0;i<t.buffers.length;i++){var r=t.buffers[i],n=r._glBuffers[this.CONTEXT_UID];if(r._updateID!==n.updateID){n.updateID=r._updateID;var s=r.index?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;if(e.bindBuffer(s,n.buffer),this._boundBuffer=n,n.byteLength>=r.data.byteLength)e.bufferSubData(s,0,r.data);else{var o=r.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;n.byteLength=r.data.byteLength,e.bufferData(s,r.data,o)}}}},e.prototype.checkCompatibility=function(t,e){var i=t.attributes,r=e.attributeData;for(var n in r)if(!i[n])throw new Error('shader and geometry incompatible, geometry missing the "'+n+'" attribute')},e.prototype.getSignature=function(t,e){var i=t.attributes,r=e.attributeData,n=["g",t.id];for(var s in i)r[s]&&n.push(s);return n.join("-")},e.prototype.initGeometryVao=function(t,e){this.checkCompatibility(t,e);var i=this.gl,r=this.CONTEXT_UID,n=this.getSignature(t,e),s=t.glVertexArrayObjects[this.CONTEXT_UID],o=s[n];if(o)return s[e.id]=o,o;var a=t.buffers,h=t.attributes,l={},u={};for(var c in a)l[c]=0,u[c]=0;for(var d in h)!h[d].size&&e.attributeData[d]?h[d].size=e.attributeData[d].size:h[d].size||console.warn("PIXI Geometry attribute '"+d+"' size cannot be determined (likely the bound shader does not have the attribute)"),l[h[d].buffer]+=h[d].size*nt[h[d].type];for(var p in h){var f=h[p],g=f.size;void 0===f.stride&&(l[f.buffer]===g*nt[f.type]?f.stride=0:f.stride=l[f.buffer]),void 0===f.start&&(f.start=u[f.buffer],u[f.buffer]+=g*nt[f.type])}o=i.createVertexArray(),i.bindVertexArray(o);for(var m=0;m<a.length;m++){var y=a[m];y._glBuffers[r]||(y._glBuffers[r]=new rt(i.createBuffer()),this.managedBuffers[y.id]=y,y.disposeRunner.add(this)),y._glBuffers[r].refCount++}return this.activateVao(t,e),this._activeVao=o,s[e.id]=o,s[n]=o,o},e.prototype.disposeBuffer=function(t,e){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var i=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),i&&(e||r.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}},e.prototype.disposeGeometry=function(t,e){if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var i=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,n=t.buffers;if(t.disposeRunner.remove(this),i){for(var s=0;s<n.length;s++){var o=n[s]._glBuffers[this.CONTEXT_UID];o.refCount--,0!==o.refCount||e||this.disposeBuffer(n[s],e)}if(!e)for(var a in i)if("g"===a[0]){var h=i[a];this._activeVao===h&&this.unbind(),r.deleteVertexArray(h)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},e.prototype.disposeAll=function(t){for(var e=Object.keys(this.managedGeometries),i=0;i<e.length;i++)this.disposeGeometry(this.managedGeometries[e[i]],t);e=Object.keys(this.managedBuffers);for(var r=0;r<e.length;r++)this.disposeBuffer(this.managedBuffers[e[r]],t)},e.prototype.activateVao=function(t,e){var i=this.gl,r=this.CONTEXT_UID,n=t.buffers,s=t.attributes;t.indexBuffer&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t.indexBuffer._glBuffers[r].buffer);var o=null;for(var a in s){var h=s[a],l=n[h.buffer]._glBuffers[r];if(e.attributeData[a]){o!==l&&(i.bindBuffer(i.ARRAY_BUFFER,l.buffer),o=l);var u=e.attributeData[a].location;if(i.enableVertexAttribArray(u),i.vertexAttribPointer(u,h.size,h.type||i.FLOAT,h.normalized,h.stride,h.start),h.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");i.vertexAttribDivisor(u,1)}}}},e.prototype.draw=function(t,e,i,r){var n=this.gl,s=this._activeGeometry;if(s.indexBuffer){var o=s.indexBuffer.data.BYTES_PER_ELEMENT,a=2===o?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?s.instanced?n.drawElementsInstanced(t,e||s.indexBuffer.data.length,a,(i||0)*o,r||1):n.drawElements(t,e||s.indexBuffer.data.length,a,(i||0)*o):console.warn("unsupported index buffer type: uint32")}else s.instanced?n.drawArraysInstanced(t,i,e||s.getSize(),r||1):n.drawArrays(t,i,e||s.getSize());return this},e.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},e}(P),ot=function(t){this.type=s.MASK_TYPES.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._target=null};function at(t,e,i,r){var n=ht(t,t.VERTEX_SHADER,e),s=ht(t,t.FRAGMENT_SHADER,i),o=t.createProgram();if(t.attachShader(o,n),t.attachShader(o,s),r)for(var a in r)t.bindAttribLocation(o,r[a],a);return t.linkProgram(o),t.getProgramParameter(o,t.LINK_STATUS)||(t.getShaderParameter(n,t.COMPILE_STATUS)||(console.warn(e),console.error(t.getShaderInfoLog(n))),t.getShaderParameter(s,t.COMPILE_STATUS)||(console.warn(i),console.error(t.getShaderInfoLog(s))),console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(o,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(o)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(o)),t.deleteProgram(o),o=null),t.deleteShader(n),t.deleteShader(s),o}function ht(t,e,i){var r=t.createShader(e);return t.shaderSource(r,i),t.compileShader(r),r}function lt(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return ut(2*e);case"bvec3":return ut(3*e);case"bvec4":return ut(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function ut(t){for(var e=new Array(t),i=0;i<e.length;i++)e[i]=!1;return e}ot.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=s.MASK_TYPES.NONE,this.autoDetect=!0),this._target=null},ot.prototype.copyCountersOrReset=function(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)};var ct,dt={},pt=dt;function ft(){if(pt===dt||pt&&pt.isContextLost()){var t,e=document.createElement("canvas");o.settings.PREFER_ENV>=s.ENV.WEBGL2&&(t=e.getContext("webgl2",{})),t||((t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}))?t.getExtension("WEBGL_draw_buffers"):t=null),pt=t}return pt}function gt(t,e,i){if("precision"!==t.substring(0,9)){var r=e;return e===s.PRECISION.HIGH&&i!==s.PRECISION.HIGH&&(r=s.PRECISION.MEDIUM),"precision "+r+" float;\n"+t}return i!==s.PRECISION.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t}var mt={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function yt(t){return mt[t]}var _t=null,vt={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray"};function xt(t,e){if(!_t){var i=Object.keys(vt);_t={};for(var r=0;r<i.length;++r){var n=i[r];_t[t[n]]=vt[n]}}return _t[e]}var bt={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},wt={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var Tt,Et=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function St(t,e){if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var i=e.createShader(e.FRAGMENT_SHADER);;){var r=Et.replace(/%forloop%/gi,Pt(t));if(e.shaderSource(i,r),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS))break;t=t/2|0}return t}function Pt(t){for(var e="",i=0;i<t;++i)i>0&&(e+="\nelse "),i<t-1&&(e+="if(test == "+i+".0){}");return e}var Ot=0,Ct={},It=function t(e,i,r){void 0===r&&(r="pixi-shader"),this.id=Ot++,this.vertexSrc=e||t.defaultVertexSrc,this.fragmentSrc=i||t.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(r=r.replace(/\s+/g,"-"),Ct[r]?(Ct[r]++,r+="-"+Ct[r]):Ct[r]=1,this.vertexSrc="#define SHADER_NAME "+r+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+r+"\n"+this.fragmentSrc,this.vertexSrc=gt(this.vertexSrc,o.settings.PRECISION_VERTEX,s.PRECISION.HIGH),this.fragmentSrc=gt(this.fragmentSrc,o.settings.PRECISION_FRAGMENT,function(){if(!ct){ct=s.PRECISION.MEDIUM;var t=ft();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);ct=e.precision?s.PRECISION.HIGH:s.PRECISION.MEDIUM}}return ct}())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},this.syncUniforms=null},Mt={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};It.prototype.extractData=function(t,e){var i=ft();if(i){var r=at(i,t,e);this.attributeData=this.getAttributeData(r,i),this.uniformData=this.getUniformData(r,i),i.deleteProgram(r)}else this.uniformData={},this.attributeData={}},It.prototype.getAttributeData=function(t,e){for(var i={},r=[],n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),s=0;s<n;s++){var o=e.getActiveAttrib(t,s),a=xt(e,o.type),h={type:a,name:o.name,size:yt(a),location:0};i[o.name]=h,r.push(h)}r.sort((function(t,e){return t.name>e.name?1:-1}));for(var l=0;l<r.length;l++)r[l].location=l;return i},It.prototype.getUniformData=function(t,e){for(var i={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n=0;n<r;n++){var s=e.getActiveUniform(t,n),o=s.name.replace(/\[.*?\]/,""),a=s.name.match(/\[.*?\]/,""),h=xt(e,s.type);i[o]={type:h,size:s.size,isArray:a,value:lt(h,s.size)}}return i},Mt.defaultVertexSrc.get=function(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"},Mt.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},It.from=function(t,e,i){var r=t+e,s=n.ProgramCache[r];return s||(n.ProgramCache[r]=s=new It(t,e,i)),s},Object.defineProperties(It,Mt);var At=function(t,e){for(var i in this.program=t,this.uniformGroup=e?e instanceof K?e:new K(e):new K({}),t.uniformData)this.uniformGroup.uniforms[i]instanceof Array&&(this.uniformGroup.uniforms[i]=new Float32Array(this.uniformGroup.uniforms[i]))},Rt={uniforms:{configurable:!0}};At.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var i in e.uniforms){var r=e.uniforms[i];if(r.group&&this.checkUniformExists(t,r))return!0}return!1},At.prototype.destroy=function(){this.uniformGroup=null},Rt.uniforms.get=function(){return this.uniformGroup.uniforms},At.from=function(t,e,i){var r=It.from(t,e);return new At(r,i)},Object.defineProperties(At.prototype,Rt);var Dt=function(){this.data=0,this.blendMode=s.BLEND_MODES.NORMAL,this.polygonOffset=0,this.blend=!0},Nt={blend:{configurable:!0},offsets:{configurable:!0},culling:{configurable:!0},depthTest:{configurable:!0},clockwiseFrontFace:{configurable:!0},blendMode:{configurable:!0},polygonOffset:{configurable:!0}};Nt.blend.get=function(){return!!(1&this.data)},Nt.blend.set=function(t){!!(1&this.data)!==t&&(this.data^=1)},Nt.offsets.get=function(){return!!(2&this.data)},Nt.offsets.set=function(t){!!(2&this.data)!==t&&(this.data^=2)},Nt.culling.get=function(){return!!(4&this.data)},Nt.culling.set=function(t){!!(4&this.data)!==t&&(this.data^=4)},Nt.depthTest.get=function(){return!!(8&this.data)},Nt.depthTest.set=function(t){!!(8&this.data)!==t&&(this.data^=8)},Nt.clockwiseFrontFace.get=function(){return!!(16&this.data)},Nt.clockwiseFrontFace.set=function(t){!!(16&this.data)!==t&&(this.data^=16)},Nt.blendMode.get=function(){return this._blendMode},Nt.blendMode.set=function(t){this.blend=t!==s.BLEND_MODES.NONE,this._blendMode=t},Nt.polygonOffset.get=function(){return this._polygonOffset},Nt.polygonOffset.set=function(t){this.offsets=!!t,this._polygonOffset=t},Dt.for2d=function(){var t=new Dt;return t.depthTest=!1,t.blend=!0,t},Object.defineProperties(Dt.prototype,Nt);var Lt=function(t){function e(i,r,n){var s=It.from(i||e.defaultVertexSrc,r||e.defaultFragmentSrc);t.call(this,s,n),this.padding=0,this.resolution=o.settings.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0,this.legacy=!!this.program.attributeData.aTextureCoord,this.state=new Dt}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={blendMode:{configurable:!0}},r={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};return e.prototype.apply=function(t,e,i,r,n){t.applyFilter(this,e,i,r,n)},i.blendMode.get=function(){return this.state.blendMode},i.blendMode.set=function(t){this.state.blendMode=t},r.defaultVertexSrc.get=function(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"},r.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},Object.defineProperties(e.prototype,i),Object.defineProperties(e,r),e}(At);Lt.SOURCE_KEY_MAP={};var kt=new h.Matrix,Ft=function(t,e){this._texture=t,this.mapCoord=new h.Matrix,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._updateID=-1,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1},Bt={texture:{configurable:!0}};Bt.texture.get=function(){return this._texture},Bt.texture.set=function(t){this._texture=t,this._updateID=-1},Ft.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var i=this.mapCoord,r=0;r<t.length;r+=2){var n=t[r],s=t[r+1];e[r]=n*i.a+s*i.c+i.tx,e[r+1]=n*i.b+s*i.d+i.ty}return e},Ft.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._updateID===e._updateID)return!1;this._updateID=e._updateID;var i=e._uvs;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);var r=e.orig,n=e.trim;n&&(kt.set(r.width/n.width,0,0,r.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(kt));var s=e.baseTexture,o=this.uClampFrame,a=this.clampMargin/s.resolution,h=this.clampOffset;return o[0]=(e._frame.x+a+h)/s.width,o[1]=(e._frame.y+a+h)/s.height,o[2]=(e._frame.x+e._frame.width-a+h)/s.width,o[3]=(e._frame.y+e._frame.height-a+h)/s.height,this.uClampOffset[0]=h/s.realWidth,this.uClampOffset[1]=h/s.realHeight,this.isSimple=e._frame.width===s.width&&e._frame.height===s.height&&0===e.rotate,!0},Object.defineProperties(Ft.prototype,Bt);var Ut=function(t){function e(e){var i=new h.Matrix;t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n"),e.renderable=!1,this.maskSprite=e,this.maskMatrix=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t,e,i,r){var n=this.maskSprite,s=this.maskSprite.texture;s.valid&&(s.transform||(s.transform=new Ft(s,0)),s.transform.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(s.transform.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=s.transform.uClampFrame,t.applyFilter(this,e,i,r))},e}(Lt),jt=function(t){function e(e){t.call(this,e),this.scissorRenderTarget=null,this.enableScissor=!1,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},e.prototype.push=function(t,e){if(!e.isMaskData){var i=this.maskDataPool.pop()||new ot;i.pooled=!0,i.maskObject=e,e=i}switch(e.autoDetect&&this.detect(e),e.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),e._target=t,e.type){case s.MASK_TYPES.SCISSOR:this.maskStack.push(e),this.renderer.scissor.push(e);break;case s.MASK_TYPES.STENCIL:this.maskStack.push(e),this.renderer.stencil.push(e);break;case s.MASK_TYPES.SPRITE:e.copyCountersOrReset(null),this.pushSpriteMask(e),this.maskStack.push(e)}},e.prototype.pop=function(t){var e=this.maskStack.pop();if(e&&e._target===t){switch(e.type){case s.MASK_TYPES.SCISSOR:this.renderer.scissor.pop();break;case s.MASK_TYPES.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case s.MASK_TYPES.SPRITE:this.popSpriteMask()}e.reset(),e.pooled&&this.maskDataPool.push(e)}},e.prototype.detect=function(t){var e=t.maskObject;if(e.isSprite)t.type=s.MASK_TYPES.SPRITE;else if(t.type=s.MASK_TYPES.STENCIL,this.enableScissor&&e.isFastRect&&e.isFastRect()){var i=e.worldTransform,r=Math.atan2(i.b,i.a),n=Math.atan2(i.d,i.c);r=Math.round(r*(180/Math.PI)*100),n=((n=Math.round(n*(180/Math.PI)*100)-r)%18e3+18e3)%18e3,0===(r=(r%9e3+9e3)%9e3)&&9e3===n&&(t.type=s.MASK_TYPES.SCISSOR)}},e.prototype.pushSpriteMask=function(t){var e=t.maskObject,i=t._target,r=this.alphaMaskPool[this.alphaMaskIndex];r||(r=this.alphaMaskPool[this.alphaMaskIndex]=[new Ut(e)]),r[0].resolution=this.renderer.resolution,r[0].maskSprite=e;var n=i.filterArea;i.filterArea=e.getBounds(!0),this.renderer.filter.push(i,r),i.filterArea=n,this.alphaMaskIndex++},e.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},e}(P),Ht=function(t){function e(e){t.call(this,e),this.maskStack=[],this.glConst=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getStackLength=function(){return this.maskStack.length},e.prototype.setMaskStack=function(t){var e=this.renderer.gl,i=this.getStackLength();this.maskStack=t;var r=this.getStackLength();r!==i&&(0===r?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))},e.prototype._useCurrent=function(){},e.prototype.destroy=function(){t.prototype.destroy.call(this,this),this.maskStack=null},e}(P),Xt=function(t){function e(e){t.call(this,e),this.glConst=WebGLRenderingContext.SCISSOR_TEST}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},e.prototype.push=function(t){var e=t.maskObject;e.renderable=!0;var i=t._scissorRect,r=e.getBounds(!0),n=this.renderer.gl;e.renderable=!1,i?r.fit(i):n.enable(n.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=r,this._useCurrent()},e.prototype.pop=function(){var t=this.renderer.gl;this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)},e.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,e=this.renderer.renderTexture.current,i=this.renderer.projection,r=i.transform,n=i.sourceFrame,s=i.destinationFrame,o=e?e.resolution:this.renderer.resolution,a=(t.x-n.x)*o+s.x,h=(t.y-n.y)*o+s.y,l=t.width*o,u=t.height*o;r&&(a+=r.tx*o,h+=r.ty*o),e||(h=this.renderer.height-u-h),this.renderer.gl.scissor(a,h,l,u)},e}(Ht),zt=function(t){function e(e){t.call(this,e),this.glConst=WebGLRenderingContext.STENCIL_TEST}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},e.prototype.push=function(t){var e=t.maskObject,i=this.renderer.gl,r=t._stencilCounter;0===r&&(this.renderer.framebuffer.forceStencil(),i.enable(i.STENCIL_TEST)),t._stencilCounter++,i.colorMask(!1,!1,!1,!1),i.stencilFunc(i.EQUAL,r,this._getBitwiseMask()),i.stencilOp(i.KEEP,i.KEEP,i.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent()},e.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?(e.disable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(0)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},e.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},e.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},e}(Ht),Gt=function(t){function e(e){t.call(this,e),this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new h.Matrix,this.transform=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.update=function(t,e,i,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,i,r),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},e.prototype.calculateProjection=function(t,e,i,r){var n=this.projectionMatrix;r?(n.a=1/t.width*2*i,n.d=-1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=1-e.y*n.d):(n.a=1/t.width*2*i,n.d=1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=-1-e.y*n.d)},e.prototype.setTransform=function(){},e}(P),Wt=new h.Rectangle,Vt=function(t){function e(e){t.call(this,e),this.clearColor=e._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new h.Rectangle,this.destinationFrame=new h.Rectangle}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.bind=function(t,e,i){void 0===t&&(t=null),this.current=t;var r,n=this.renderer;if(t){var s=t.baseTexture;r=s.resolution,i||(Wt.width=s.realWidth,Wt.height=s.realHeight,i=Wt),e||(e=i),this.renderer.framebuffer.bind(s.framebuffer,i),this.renderer.projection.update(i,e,r,!1),this.renderer.mask.setMaskStack(s.maskStack)}else r=this.renderer.resolution,i||(Wt.width=n.width,Wt.height=n.height,i=Wt),e||(e=i),n.framebuffer.bind(null,i),this.renderer.projection.update(i,e,r,!0),this.renderer.mask.setMaskStack(this.defaultMaskStack);this.sourceFrame.copyFrom(e),this.destinationFrame.x=i.x/r,this.destinationFrame.y=i.y/r,this.destinationFrame.width=i.width/r,this.destinationFrame.height=i.height/r,e===i&&this.sourceFrame.copyFrom(this.destinationFrame)},e.prototype.clear=function(t){t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor,this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3])},e.prototype.resize=function(){this.bind(null)},e.prototype.reset=function(){this.bind(null)},e}(P),Yt=function(t,e){this.program=t,this.uniformData=e,this.uniformGroups={}};Yt.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null};var qt=0,Kt={textureCount:0},$t=function(t){function e(e){t.call(this,e),this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this.id=qt++}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.systemCheck=function(){if(!function(){if("boolean"==typeof Tt)return Tt;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;");Tt=!0===t({a:"b"},"a","b")}catch(t){Tt=!1}return Tt}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},e.prototype.contextChange=function(t){this.gl=t,this.reset()},e.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var i=t.program,r=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(r.program)),e||(Kt.textureCount=0,this.syncUniformGroup(t.uniformGroup,Kt)),r},e.prototype.setUniforms=function(t){var e=this.shader.program,i=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(i.uniformData,t,this.renderer)},e.prototype.syncUniformGroup=function(t,e){var i=this.getglProgram();t.static&&t.dirtyId===i.uniformGroups[t.id]||(i.uniformGroups[t.id]=t.dirtyId,this.syncUniforms(t,i,e))},e.prototype.syncUniforms=function(t,e,i){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,i)},e.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData);return this.cache[e]||(this.cache[e]=function(t,e){var i="var v = null;\n    var cv = null\n    var t = 0;\n    var gl = renderer.gl\n    ";for(var r in t.uniforms){var n=e[r];if(n)if("float"===n.type&&1===n.size)i+="\n            if(uv."+r+" !== ud."+r+".value)\n            {\n                ud."+r+".value = uv."+r+"\n                gl.uniform1f(ud."+r+".location, uv."+r+")\n            }\n";else if("sampler2D"!==n.type&&"samplerCube"!==n.type&&"sampler2DArray"!==n.type||1!==n.size||n.isArray)if("mat3"===n.type&&1===n.size)void 0!==t.uniforms[r].a?i+="\n                gl.uniformMatrix3fv(ud."+r+".location, false, uv."+r+".toArray(true));\n                \n":i+="\n                gl.uniformMatrix3fv(ud."+r+".location, false, uv."+r+");\n                \n";else if("vec2"===n.type&&1===n.size)void 0!==t.uniforms[r].x?i+="\n                cv = ud."+r+".value;\n                v = uv."+r+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud."+r+".location, v.x, v.y);\n                }\n":i+="\n                cv = ud."+r+".value;\n                v = uv."+r+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud."+r+".location, v[0], v[1]);\n                }\n                \n";else if("vec4"===n.type&&1===n.size)void 0!==t.uniforms[r].width?i+="\n                cv = ud."+r+".value;\n                v = uv."+r+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud."+r+".location, v.x, v.y, v.width, v.height)\n                }\n":i+="\n                cv = ud."+r+".value;\n                v = uv."+r+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud."+r+".location, v[0], v[1], v[2], v[3])\n                }\n                \n";else{i+="\n            cv = ud."+r+".value;\n            v = uv."+r+";\n            "+(1===n.size?bt:wt)[n.type].replace("location","ud."+r+".location")+";\n"}else i+="\n\n            t = syncData.textureCount++;\n\n            renderer.texture.bind(uv."+r+", t);\n            \n            if(ud."+r+".value !== t)\n            {\n                ud."+r+".value = t;\n                gl.uniform1i(ud."+r+".location, t);\n; // eslint-disable-line max-len\n            }\n";else t.uniforms[r].group&&(i+="\n                    renderer.shader.syncUniformGroup(uv."+r+", syncData);\n                ")}return new Function("ud","uv","renderer","syncData",i)}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]},e.prototype.getSignature=function(t,e){var i=t.uniforms,r=[];for(var n in i)r.push(n),e[n]&&r.push(e[n].type);return r.join("-")},e.prototype.getglProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},e.prototype.generateShader=function(t){var e=this.gl,i=t.program,r={};for(var n in i.attributeData)r[n]=i.attributeData[n].location;var s=at(e,i.vertexSrc,i.fragmentSrc,r),o={};for(var a in i.uniformData){var h=i.uniformData[a];o[a]={location:e.getUniformLocation(s,a),value:lt(h.type,h.size)}}var l=new Yt(s,o);return i.glPrograms[this.renderer.CONTEXT_UID]=l,l},e.prototype.reset=function(){this.program=null,this.shader=null},e.prototype.destroy=function(){this.destroyed=!0},e}(P);var Zt=function(t){function e(e){t.call(this,e),this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=s.BLEND_MODES.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.checks=[],this.defaultState=new Dt,this.defaultState.blend=!0,this.defaultState.depth=!0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(t){this.gl=t,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[s.BLEND_MODES.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[s.BLEND_MODES.ADD]=[t.ONE,t.ONE],e[s.BLEND_MODES.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[s.BLEND_MODES.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[s.BLEND_MODES.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[s.BLEND_MODES.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[s.BLEND_MODES.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[s.BLEND_MODES.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[s.BLEND_MODES.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[s.BLEND_MODES.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[s.BLEND_MODES.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[s.BLEND_MODES.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[s.BLEND_MODES.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[s.BLEND_MODES.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[s.BLEND_MODES.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[s.BLEND_MODES.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[s.BLEND_MODES.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[s.BLEND_MODES.NONE]=[0,0],e[s.BLEND_MODES.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[s.BLEND_MODES.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[s.BLEND_MODES.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[s.BLEND_MODES.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[s.BLEND_MODES.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[s.BLEND_MODES.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[s.BLEND_MODES.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[s.BLEND_MODES.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[s.BLEND_MODES.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[s.BLEND_MODES.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[s.BLEND_MODES.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[s.BLEND_MODES.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()},e.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,i=0;e;)1&e&&this.map[i].call(this,!!(t.data&1<<i)),e>>=1,i++;this.stateId=t.data}for(var r=0;r<this.checks.length;r++)this.checks[r](this,t)},e.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(var i=0;i<this.checks.length;i++)this.checks[i](this,t);this.stateId=t.data},e.prototype.setBlend=function(t){this.updateCheck(e.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},e.prototype.setOffset=function(t){this.updateCheck(e.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},e.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},e.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},e.prototype.setFrontFace=function(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])},e.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],i=this.gl;2===e.length?i.blendFunc(e[0],e[1]):i.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(this._blendEq=!0,i.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}},e.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},e.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(0),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},e.prototype.updateCheck=function(t,e){var i=this.checks.indexOf(t);e&&-1===i?this.checks.push(t):e||-1===i||this.checks.splice(i,1)},e.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},e.checkPolygonOffset=function(t,e){t.setPolygonOffset(e.polygonOffset,0)},e}(P),Jt=function(t){function e(e){t.call(this,e),this.count=0,this.checkCount=0,this.maxIdle=o.settings.GC_MAX_IDLE,this.checkCountMax=o.settings.GC_MAX_CHECK_COUNT,this.mode=o.settings.GC_MODE}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==s.GC_MODES.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},e.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,i=!1,r=0;r<e.length;r++){var n=e[r];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(t.destroyTexture(n,!0),e[r]=null,i=!0)}if(i){for(var s=0,o=0;o<e.length;o++)null!==e[o]&&(e[s++]=e[o]);e.length=s}},e.prototype.unload=function(t){var e=this.renderer.textureSystem;t._texture&&t._texture._glRenderTargets&&e.destroyTexture(t._texture);for(var i=t.children.length-1;i>=0;i--)this.unload(t.children[i])},e}(P),Qt=function(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121},te=function(t){function e(e){t.call(this,e),this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new _}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion;var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var i=0;i<e;i++)this.boundTextures[i]=null;this.emptyTextures={};var r=new Qt(t.createTexture());t.bindTexture(t.TEXTURE_2D,r.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=r,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new Qt(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(var n=0;n<6;n++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(var s=0;s<this.boundTextures.length;s++)this.bind(null,s)},e.prototype.bind=function(t,e){void 0===e&&(e=0);var i=this.gl;if(t){if((t=t.baseTexture||t).valid){t.touched=this.renderer.textureGC.count;var r=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(t.target,r.texture)),r.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),this.updateTexture(t)),this.boundTextures[e]=t}}else this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[e]=null},e.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},e.prototype.unbind=function(t){var e=this.gl,i=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var r=0;r<i.length;r++)i[r]===this.unknownTexture&&this.bind(null,r)}for(var n=0;n<i.length;n++)i[n]===t&&(this.currentLocation!==n&&(e.activeTexture(e.TEXTURE0+n),this.currentLocation=n),e.bindTexture(e.TEXTURE_2D,this.emptyTextures[t.target].texture),i[n]=null)},e.prototype.initTexture=function(t){var e=new Qt(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e},e.prototype.initTextureType=function(t,e){if(e.internalFormat=t.format,e.type=t.type,2===this.webGLVersion){var i=this.renderer.gl;t.type===i.FLOAT&&t.format===i.RGBA&&(e.internalFormat=i.RGBA32F),t.type===s.TYPES.HALF_FLOAT&&(e.type=i.HALF_FLOAT),e.type===i.HALF_FLOAT&&t.format===i.RGBA&&(e.internalFormat=i.RGBA16F)}},e.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var i=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(i,t,e));else{var r=t.realWidth,n=t.realHeight,s=i.gl;(e.width!==r||e.height!==n||e.dirtyId<0)&&(e.width=r,e.height=n,s.texImage2D(t.target,0,e.internalFormat,r,n,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}},e.prototype.destroyTexture=function(t,e){var i=this.gl;if((t=t.baseTexture||t)._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){var r=this.managedTextures.indexOf(t);-1!==r&&n.removeItems(this.managedTextures,r,1)}},e.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(t.mipmap!==s.MIPMAP_MODES.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=t.mipmap>=1:e.mipmap=0,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=s.WRAP_MODES.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)},e.prototype.setStyle=function(t,e){var i=this.gl;if(e.mipmap&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,e.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode===s.SCALE_MODES.LINEAR?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);var r=this.renderer.context.extensions.anisotropicFiltering;if(r&&t.anisotropicLevel>0&&t.scaleMode===s.SCALE_MODES.LINEAR){var n=Math.min(t.anisotropicLevel,i.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(t.target,r.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode===s.SCALE_MODES.LINEAR?i.LINEAR:i.NEAREST);i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode===s.SCALE_MODES.LINEAR?i.LINEAR:i.NEAREST)},e}(P),ee={FilterSystem:Z,BatchSystem:Q,ContextSystem:et,FramebufferSystem:it,GeometrySystem:st,MaskSystem:jt,ScissorSystem:Xt,StencilSystem:zt,ProjectionSystem:Gt,RenderTextureSystem:Vt,ShaderSystem:$t,StateSystem:Zt,TextureGCSystem:Jt,TextureSystem:te},ie=new h.Matrix,re=function(t){function e(e,i){t.call(this),(i=Object.assign({},o.settings.RENDER_OPTIONS,i)).roundPixels&&(o.settings.ROUND_PIXELS=i.roundPixels,n.deprecation("5.0.0","Renderer roundPixels option is deprecated, please use PIXI.settings.ROUND_PIXELS",2)),this.options=i,this.type=s.RENDERER_TYPE.UNKNOWN,this.screen=new h.Rectangle(0,0,i.width,i.height),this.view=i.view||document.createElement("canvas"),this.resolution=i.resolution||o.settings.RESOLUTION,this.transparent=i.transparent,this.autoDensity=i.autoDensity||i.autoResize||!1,this.preserveDrawingBuffer=i.preserveDrawingBuffer,this.clearBeforeRender=i.clearBeforeRender,this._backgroundColor=0,this._backgroundColorRgba=[0,0,0,0],this._backgroundColorString="#000000",this.backgroundColor=i.backgroundColor||this._backgroundColor,this._tempDisplayObjectParent=new l.Container,this._lastObjectRendered=this._tempDisplayObjectParent,this.plugins={}}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={width:{configurable:!0},height:{configurable:!0},backgroundColor:{configurable:!0}};return e.prototype.initPlugins=function(t){for(var e in t)this.plugins[e]=new t[e](this)},i.width.get=function(){return this.view.width},i.height.get=function(){return this.view.height},e.prototype.resize=function(t,e){this.screen.width=t,this.screen.height=e,this.view.width=t*this.resolution,this.view.height=e*this.resolution,this.autoDensity&&(this.view.style.width=t+"px",this.view.style.height=e+"px")},e.prototype.generateTexture=function(t,e,i,r){0===(r=r||t.getLocalBounds()).width&&(r.width=1),0===r.height&&(r.height=1);var n=L.create({width:0|r.width,height:0|r.height,scaleMode:e,resolution:i});return ie.tx=-r.x,ie.ty=-r.y,this.render(t,n,!1,ie,!!t.parent),n},e.prototype.destroy=function(t){for(var e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null;t&&this.view.parentNode&&this.view.parentNode.removeChild(this.view),this.plugins=null,this.type=s.RENDERER_TYPE.UNKNOWN,this.view=null,this.screen=null,this.resolution=0,this.transparent=!1,this.autoDensity=!1,this.blendModes=null,this.options=null,this.preserveDrawingBuffer=!1,this.clearBeforeRender=!1,this._backgroundColor=0,this._backgroundColorRgba=null,this._backgroundColorString=null,this._tempDisplayObjectParent=null,this._lastObjectRendered=null},i.backgroundColor.get=function(){return this._backgroundColor},i.backgroundColor.set=function(t){this._backgroundColor=t,this._backgroundColorString=n.hex2string(t),n.hex2rgb(t,this._backgroundColorRgba)},Object.defineProperties(e.prototype,i),e}(n.EventEmitter),ne=function(t){function e(i){void 0===i&&(i={}),t.call(this,"WebGL",i),i=this.options,this.type=s.RENDERER_TYPE.WEBGL,this.gl=null,this.CONTEXT_UID=0,this.runners={destroy:new r.Runner("destroy"),contextChange:new r.Runner("contextChange",1),reset:new r.Runner("reset"),update:new r.Runner("update"),postrender:new r.Runner("postrender"),prerender:new r.Runner("prerender"),resize:new r.Runner("resize",2)},this.globalUniforms=new K({projectionMatrix:new h.Matrix},!0),this.addSystem(jt,"mask").addSystem(et,"context").addSystem(Zt,"state").addSystem($t,"shader").addSystem(te,"texture").addSystem(st,"geometry").addSystem(it,"framebuffer").addSystem(Xt,"scissor").addSystem(zt,"stencil").addSystem(Gt,"projection").addSystem(Jt,"textureGC").addSystem(Z,"filter").addSystem(Vt,"renderTexture").addSystem(Q,"batch"),this.initPlugins(e.__plugins),i.context?this.context.initFromContext(i.context):this.context.initFromOptions({alpha:this.transparent,antialias:i.antialias,premultipliedAlpha:this.transparent&&"notMultiplied"!==this.transparent,stencil:!0,preserveDrawingBuffer:i.preserveDrawingBuffer,powerPreference:this.options.powerPreference}),this.renderingToScreen=!0,n.sayHello(2===this.context.webGLVersion?"WebGL 2":"WebGL 1"),this.resize(this.options.width,this.options.height)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.create=function(t){if(n.isWebGLSupported())return new e(t);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},e.prototype.addSystem=function(t,e){e||(e=t.name);var i=new t(this);if(this[e])throw new Error('Whoops! The name "'+e+'" is already in use');for(var r in this[e]=i,this.runners)this.runners[r].add(i);return this},e.prototype.render=function(t,e,i,r,n){if(this.renderingToScreen=!e,this.runners.prerender.run(),this.emit("prerender"),this.projection.transform=r,!this.context.isLost){if(e||(this._lastObjectRendered=t),!n){var s=t.parent;t.parent=this._tempDisplayObjectParent,t.updateTransform(),t.parent=s}this.renderTexture.bind(e),this.batch.currentRenderer.start(),(void 0!==i?i:this.clearBeforeRender)&&this.renderTexture.clear(),t.render(this),this.batch.currentRenderer.flush(),e&&e.baseTexture.update(),this.runners.postrender.run(),this.projection.transform=null,this.emit("postrender")}},e.prototype.resize=function(e,i){t.prototype.resize.call(this,e,i),this.runners.resize.run(e,i)},e.prototype.reset=function(){return this.runners.reset.run(),this},e.prototype.clear=function(){this.framebuffer.bind(),this.framebuffer.clear()},e.prototype.destroy=function(e){for(var i in this.runners.destroy.run(),this.runners)this.runners[i].destroy();t.prototype.destroy.call(this,e),this.gl=null},e.registerPlugin=function(t,i){e.__plugins=e.__plugins||{},e.__plugins[t]=i},e}(re);var se=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.from=function(t,i){return new e(new b(t,i))},e}(_),oe=function(){this.texArray=null,this.blend=0,this.type=s.DRAW_MODES.TRIANGLES,this.start=0,this.size=0,this.data=null},ae=function(){this.elements=[],this.ids=[],this.count=0};ae.prototype.clear=function(){for(var t=0;t<this.count;t++)this.elements[t]=null;this.count=0};var he=function(t){this.rawBinaryData=new ArrayBuffer(t),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)},le={int8View:{configurable:!0},uint8View:{configurable:!0},int16View:{configurable:!0},uint16View:{configurable:!0},int32View:{configurable:!0}};le.int8View.get=function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},le.uint8View.get=function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},le.int16View.get=function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},le.uint16View.get=function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},le.int32View.get=function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},he.prototype.view=function(t){return this[t+"View"]},he.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},he.sizeOf=function(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},Object.defineProperties(he.prototype,le);var ue=function(t){function e(e){t.call(this,e),this.shaderGenerator=null,this.geometryClass=null,this.vertexSize=null,this.state=Dt.for2d(),this.size=4*o.settings.SPRITE_BATCH_SIZE,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.MAX_TEXTURES=1,this.renderer.on("prerender",this.onPrerender,this),e.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(){var t=this.renderer.gl;o.settings.PREFER_ENV===s.ENV.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),o.settings.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=St(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},e.prototype.initFlushBuffers=function(){for(var t=e._drawCallPool,i=e._textureArrayPool,r=this.size/4,n=Math.floor(r/this.MAX_TEXTURES)+1;t.length<r;)t.push(new oe);for(;i.length<n;)i.push(new ae);for(var s=0;s<this.MAX_TEXTURES;s++)this._tempBoundTextures[s]=null},e.prototype.onPrerender=function(){this._flushId=0},e.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},e.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,i=this.MAX_TEXTURES,r=e._textureArrayPool,n=this.renderer.batch,s=this._tempBoundTextures,o=this.renderer.textureGC.count,a=++_._globalBatch,h=0,l=r[0],u=0;n.copyBoundTextures(s,i);for(var c=0;c<this._bufferSize;++c){var d=t[c];t[c]=null,d._batchEnabled!==a&&(l.count>=i&&(n.boundArray(l,s,a,i),this.buildDrawCalls(l,u,c),u=c,l=r[++h],++a),d._batchEnabled=a,d.touched=o,l.elements[l.count++]=d)}l.count>0&&(n.boundArray(l,s,a,i),this.buildDrawCalls(l,u,this._bufferSize),++h,++a);for(var p=0;p<s.length;p++)s[p]=null;_._globalBatch=a},e.prototype.buildDrawCalls=function(t,i,r){var s=this._bufferedElements,o=this._attributeBuffer,a=this._indexBuffer,h=this.vertexSize,l=e._drawCallPool,u=this._dcIndex,c=this._aIndex,d=this._iIndex,p=l[u];p.start=this._iIndex,p.texArray=t;for(var f=i;f<r;++f){var g=s[f],m=g._texture.baseTexture,y=n.premultiplyBlendMode[m.alphaMode?1:0][g.blendMode];s[f]=null,i<f&&p.blend!==y&&(p.size=d-p.start,i=f,(p=l[++u]).texArray=t,p.start=d),this.packInterleavedGeometry(g,o,a,c,d),c+=g.vertexData.length/2*h,d+=g.indices.length,p.blend=y}i<r&&(p.size=d-p.start,++u),this._dcIndex=u,this._aIndex=c,this._iIndex=d},e.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,i=0;i<t.count;i++)e.bind(t.elements[i],t.ids[i]),t.elements[i]=null;t.count=0},e.prototype.updateGeometry=function(){var t=this._packedGeometries,e=this._attributeBuffer,i=this._indexBuffer;o.settings.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},e.prototype.drawBatches=function(){for(var t=this._dcIndex,i=this.renderer,r=i.gl,n=i.state,s=e._drawCallPool,o=null,a=0;a<t;a++){var h=s[a],l=h.texArray,u=h.type,c=h.size,d=h.start,p=h.blend;o!==l&&(o=l,this.bindAndClearTexArray(l)),this.state.blendMode=p,n.set(this.state),r.drawElements(u,c,r.UNSIGNED_SHORT,2*d)}},e.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},e.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),o.settings.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},e.prototype.stop=function(){this.flush()},e.prototype.destroy=function(){for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),t.prototype.destroy.call(this)},e.prototype.getAttributeBuffer=function(t){var e=n.nextPow2(Math.ceil(t/8)),i=n.log2(e),r=8*e;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);var s=this._aBuffers[r];return s||(this._aBuffers[r]=s=new he(r*this.vertexSize*4)),s},e.prototype.getIndexBuffer=function(t){var e=n.nextPow2(Math.ceil(t/12)),i=n.log2(e),r=12*e;this._iBuffers.length<=i&&(this._iBuffers.length=i+1);var s=this._iBuffers[i];return s||(this._iBuffers[i]=s=new Uint16Array(r)),s},e.prototype.packInterleavedGeometry=function(t,e,i,r,s){for(var o=e.uint32View,a=e.float32View,h=r/this.vertexSize,l=t.uvs,u=t.indices,c=t.vertexData,d=t._texture.baseTexture._batchLocation,p=Math.min(t.worldAlpha,1),f=p<1&&t._texture.baseTexture.alphaMode?n.premultiplyTint(t._tintRGB,p):t._tintRGB+(255*p<<24),g=0;g<c.length;g+=2)a[r++]=c[g],a[r++]=c[g+1],a[r++]=l[g],a[r++]=l[g+1],o[r++]=f,a[r++]=d;for(var m=0;m<u.length;m++)i[s++]=h+u[m]},e}(J);ue._drawCallPool=[],ue._textureArrayPool=[];var ce=function(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')};ce.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),i=0;i<t;i++)e[i]=i;this.defaultGroupCache[t]=K.from({uSamplers:e},!0);var r=this.fragTemplate;r=(r=r.replace(/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new It(this.vertexSrc,r)}var n={tint:new Float32Array([1,1,1,1]),translationMatrix:new h.Matrix,default:this.defaultGroupCache[t]};return new At(this.programCache[t],n)},ce.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var i=0;i<t;i++)i>0&&(e+="\nelse "),i<t-1&&(e+="if(vTextureId < "+i+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+i+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"};var de=function(t){function e(e){void 0===e&&(e=!1),t.call(this),this._buffer=new U(null,e,!1),this._indexBuffer=new U(null,e,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,s.TYPES.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,s.TYPES.FLOAT).addAttribute("aColor",this._buffer,4,!0,s.TYPES.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,s.TYPES.FLOAT).addIndex(this._indexBuffer)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(W),pe="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n",fe="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",ge=function(){},me={defaultVertexSrc:{configurable:!0},defaultFragmentTemplate:{configurable:!0}};ge.create=function(t){var e=Object.assign({vertex:pe,fragment:fe,geometryClass:de,vertexSize:6},t),i=e.vertex,r=e.fragment,n=e.vertexSize,s=e.geometryClass;return function(t){function e(e){t.call(this,e),this.shaderGenerator=new ce(i,r),this.geometryClass=s,this.vertexSize=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(ue)},me.defaultVertexSrc.get=function(){return pe},me.defaultFragmentTemplate.get=function(){return fe},Object.defineProperties(ge,me);var ye=ge.create();i.AbstractBatchRenderer=ue,i.AbstractRenderer=re,i.Attribute=F,i.BaseRenderTexture=M,i.BaseTexture=_,i.BatchDrawCall=oe,i.BatchGeometry=de,i.BatchPluginFactory=ge,i.BatchRenderer=ye,i.BatchShaderGenerator=ce,i.BatchTextureArray=ae,i.Buffer=U,i.CubeTexture=se,i.Filter=Lt,i.Framebuffer=C,i.GLProgram=Yt,i.GLTexture=Qt,i.Geometry=W,i.MaskData=ot,i.ObjectRenderer=J,i.Program=It,i.Quad=V,i.QuadUv=Y,i.RenderTexture=L,i.RenderTexturePool=k,i.Renderer=ne,i.Shader=At,i.SpriteMaskFilter=Ut,i.State=Dt,i.System=P,i.Texture=D,i.TextureMatrix=Ft,i.TextureUvs=A,i.UniformGroup=K,i.ViewableBuffer=he,i.autoDetectRenderer=function(t){return ne.create(t)},i.checkMaxIfStatementsInShader=St,i.defaultFilterVertex="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n",i.defaultVertex="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}",i.resources=S,i.systems=ee},{"@pixi/constants":3,"@pixi/display":5,"@pixi/math":16,"@pixi/runner":25,"@pixi/settings":26,"@pixi/ticker":33,"@pixi/utils":34}],5:[function(t,e,i){
/*!
 * @pixi/display - v5.2.2
 * Compiled Tue, 21 Apr 2020 03:53:51 UTC
 *
 * @pixi/display is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=t("@pixi/settings"),n=t("@pixi/math"),s=t("@pixi/utils");r.settings.SORTABLE_CHILDREN=!1;var o=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null};o.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},o.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},o.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?n.Rectangle.EMPTY:((t=t||new n.Rectangle(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},o.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},o.prototype.addQuad=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY,s=t[0],o=t[1];e=s<e?s:e,i=o<i?o:i,r=s>r?s:r,n=o>n?o:n,e=(s=t[2])<e?s:e,i=(o=t[3])<i?o:i,r=s>r?s:r,n=o>n?o:n,e=(s=t[4])<e?s:e,i=(o=t[5])<i?o:i,r=s>r?s:r,n=o>n?o:n,e=(s=t[6])<e?s:e,i=(o=t[7])<i?o:i,r=s>r?s:r,n=o>n?o:n,this.minX=e,this.minY=i,this.maxX=r,this.maxY=n},o.prototype.addFrame=function(t,e,i,r,n){this.addFrameMatrix(t.worldTransform,e,i,r,n)},o.prototype.addFrameMatrix=function(t,e,i,r,n){var s=t.a,o=t.b,a=t.c,h=t.d,l=t.tx,u=t.ty,c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,g=s*e+a*i+l,m=o*e+h*i+u;c=g<c?g:c,d=m<d?m:d,p=g>p?g:p,f=m>f?m:f,c=(g=s*r+a*i+l)<c?g:c,d=(m=o*r+h*i+u)<d?m:d,p=g>p?g:p,f=m>f?m:f,c=(g=s*e+a*n+l)<c?g:c,d=(m=o*e+h*n+u)<d?m:d,p=g>p?g:p,f=m>f?m:f,c=(g=s*r+a*n+l)<c?g:c,d=(m=o*r+h*n+u)<d?m:d,p=g>p?g:p,f=m>f?m:f,this.minX=c,this.minY=d,this.maxX=p,this.maxY=f},o.prototype.addVertexData=function(t,e,i){for(var r=this.minX,n=this.minY,s=this.maxX,o=this.maxY,a=e;a<i;a+=2){var h=t[a],l=t[a+1];r=h<r?h:r,n=l<n?l:n,s=h>s?h:s,o=l>o?l:o}this.minX=r,this.minY=n,this.maxX=s,this.maxY=o},o.prototype.addVertices=function(t,e,i,r){this.addVerticesMatrix(t.worldTransform,e,i,r)},o.prototype.addVerticesMatrix=function(t,e,i,r,n,s){var o=t.a,a=t.b,h=t.c,l=t.d,u=t.tx,c=t.ty;n=n||0,s=s||0;for(var d=this.minX,p=this.minY,f=this.maxX,g=this.maxY,m=i;m<r;m+=2){var y=e[m],_=e[m+1],v=o*y+h*_+u,x=l*_+a*y+c;d=Math.min(d,v-n),f=Math.max(f,v+n),p=Math.min(p,x-s),g=Math.max(g,x+s)}this.minX=d,this.minY=p,this.maxX=f,this.maxY=g},o.prototype.addBounds=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<i?t.minY:i,this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>n?t.maxY:n},o.prototype.addBoundsMask=function(t,e){var i=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(i<=n&&r<=s){var o=this.minX,a=this.minY,h=this.maxX,l=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=n>h?n:h,this.maxY=s>l?s:l}},o.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},o.prototype.addBoundsArea=function(t,e){var i=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=n&&r<=s){var o=this.minX,a=this.minY,h=this.maxX,l=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=n>h?n:h,this.maxY=s>l?s:l}},o.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},o.prototype.addFramePad=function(t,e,i,r,n,s){t-=n,e-=s,i+=n,r+=s,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r};var a=function(t){function e(){t.call(this),this.tempDisplayObjectParent=null,this.transform=new n.Transform,this.alpha=1,this.visible=!0,this.renderable=!0,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new o,this._boundsID=0,this._lastBoundsID=-1,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={_tempDisplayObjectParent:{configurable:!0},x:{configurable:!0},y:{configurable:!0},worldTransform:{configurable:!0},localTransform:{configurable:!0},position:{configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},zIndex:{configurable:!0},worldVisible:{configurable:!0},mask:{configurable:!0}};return e.mixin=function(t){for(var i=Object.keys(t),r=0;r<i.length;++r){var n=i[r];Object.defineProperty(e.prototype,n,Object.getOwnPropertyDescriptor(t,n))}},i._tempDisplayObjectParent.get=function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new e),this.tempDisplayObjectParent},e.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},e.prototype.calculateBounds=function(){},e.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},e.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._boundsID!==this._lastBoundsID&&(this.calculateBounds(),this._lastBoundsID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new n.Rectangle),e=this._boundsRect),this._bounds.getRectangle(e)},e.prototype.getLocalBounds=function(t){var e=this.transform,i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new n.Rectangle),t=this._localBoundsRect);var r=this.getBounds(!1,t);return this.parent=i,this.transform=e,r},e.prototype.toGlobal=function(t,e,i){return void 0===i&&(i=!1),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},e.prototype.toLocal=function(t,e,i,r){return e&&(t=e.toGlobal(t,i,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)},e.prototype.render=function(t){},e.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},e.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=1),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=r||1,this.rotation=n,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},e.prototype.destroy=function(){this.parent&&this.parent.removeChild(this),this.removeAllListeners(),this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},i.x.get=function(){return this.position.x},i.x.set=function(t){this.transform.position.x=t},i.y.get=function(){return this.position.y},i.y.set=function(t){this.transform.position.y=t},i.worldTransform.get=function(){return this.transform.worldTransform},i.localTransform.get=function(){return this.transform.localTransform},i.position.get=function(){return this.transform.position},i.position.set=function(t){this.transform.position.copyFrom(t)},i.scale.get=function(){return this.transform.scale},i.scale.set=function(t){this.transform.scale.copyFrom(t)},i.pivot.get=function(){return this.transform.pivot},i.pivot.set=function(t){this.transform.pivot.copyFrom(t)},i.skew.get=function(){return this.transform.skew},i.skew.set=function(t){this.transform.skew.copyFrom(t)},i.rotation.get=function(){return this.transform.rotation},i.rotation.set=function(t){this.transform.rotation=t},i.angle.get=function(){return this.transform.rotation*n.RAD_TO_DEG},i.angle.set=function(t){this.transform.rotation=t*n.DEG_TO_RAD},i.zIndex.get=function(){return this._zIndex},i.zIndex.set=function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},i.worldVisible.get=function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},i.mask.get=function(){return this._mask},i.mask.set=function(t){if(this._mask){var e=this._mask.maskObject||this._mask;e.renderable=!0,e.isMask=!1}if(this._mask=t,this._mask){var i=this._mask.maskObject||this._mask;i.renderable=!1,i.isMask=!0}},Object.defineProperties(e.prototype,i),e}(s.EventEmitter);function h(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}a.prototype.displayObjectUpdateTransform=a.prototype.updateTransform;var l=function(t){function e(){t.call(this),this.children=[],this.sortableChildren=r.settings.SORTABLE_CHILDREN,this.sortDirty=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={width:{configurable:!0},height:{configurable:!0}};return e.prototype.onChildrenChange=function(){},e.prototype.addChild=function(t){var e=arguments,i=arguments.length;if(i>1)for(var r=0;r<i;r++)this.addChild(e[r]);else t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this);return t},e.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t},e.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),r=this.getChildIndex(e);this.children[i]=e,this.children[r]=t,this.onChildrenChange(i<r?i:r)}},e.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},e.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The index "+e+" supplied is out of bounds "+this.children.length);var i=this.getChildIndex(t);s.removeItems(this.children,i,1),this.children.splice(e,0,t),this.onChildrenChange(e)},e.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},e.prototype.removeChild=function(t){var e=arguments,i=arguments.length;if(i>1)for(var r=0;r<i;r++)this.removeChild(e[r]);else{var n=this.children.indexOf(t);if(-1===n)return null;t.parent=null,t.transform._parentID=-1,s.removeItems(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this),this.emit("childRemoved",t,this,n)}return t},e.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,s.removeItems(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},e.prototype.removeChildren=function(t,e){void 0===t&&(t=0);var i,r=t,n="number"==typeof e?e:this.children.length,s=n-r;if(s>0&&s<=n){i=this.children.splice(r,s);for(var o=0;o<i.length;++o)i[o].parent=null,i[o].transform&&(i[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<i.length;++a)i[a].emit("removed",this),this.emit("childRemoved",i[a],this,a);return i}if(0===s&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},e.prototype.sortChildren=function(){for(var t=!1,e=0,i=this.children.length;e<i;++e){var r=this.children[e];r._lastSortedIndex=e,t||0===r.zIndex||(t=!0)}t&&this.children.length>1&&this.children.sort(h),this.sortDirty=!1},e.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var i=this.children[t];i.visible&&i.updateTransform()}},e.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){var i=e._mask.maskObject||e._mask;i.calculateBounds(),this._bounds.addBoundsMask(e._bounds,i._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._lastBoundsID=this._boundsID},e.prototype._calculateBounds=function(){},e.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,i=this.children.length;e<i;++e)this.children[e].render(t)}},e.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var r=0;r<e.length;r++)e[r].enabled&&this._enabledFilters.push(e[r]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}i&&t.mask.push(this,this._mask),this._render(t);for(var n=0,s=this.children.length;n<s;n++)this.children[n].render(t);t.batch.flush(),i&&t.mask.pop(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},e.prototype._render=function(t){},e.prototype.destroy=function(e){t.prototype.destroy.call(this),this.sortDirty=!1;var i="boolean"==typeof e?e:e&&e.children,r=this.removeChildren(0,this.children.length);if(i)for(var n=0;n<r.length;++n)r[n].destroy(e)},i.width.get=function(){return this.scale.x*this.getLocalBounds().width},i.width.set=function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},i.height.get=function(){return this.scale.y*this.getLocalBounds().height},i.height.set=function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},Object.defineProperties(e.prototype,i),e}(a);l.prototype.containerUpdateTransform=l.prototype.updateTransform,i.Bounds=o,i.Container=l,i.DisplayObject=a},{"@pixi/math":16,"@pixi/settings":26,"@pixi/utils":34}],6:[function(t,e,i){
/*!
 * @pixi/extract - v5.2.2
 * Compiled Tue, 21 Apr 2020 03:53:51 UTC
 *
 * @pixi/extract is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=t("@pixi/core"),n=t("@pixi/utils"),s=new(t("@pixi/math").Rectangle),o=function(t){this.renderer=t,t.extract=this};o.prototype.image=function(t,e,i){var r=new Image;return r.src=this.base64(t,e,i),r},o.prototype.base64=function(t,e,i){return this.canvas(t).toDataURL(e,i)},o.prototype.canvas=function(t){var e,i,a,h=this.renderer,l=!1,u=!1;t&&(t instanceof r.RenderTexture?a=t:(a=this.renderer.generateTexture(t),u=!0)),a?(e=a.baseTexture.resolution,i=a.frame,l=!1,h.renderTexture.bind(a)):(e=this.renderer.resolution,l=!0,(i=s).width=this.renderer.width,i.height=this.renderer.height,h.renderTexture.bind(null));var c=Math.floor(i.width*e+1e-4),d=Math.floor(i.height*e+1e-4),p=new n.CanvasRenderTarget(c,d,1),f=new Uint8Array(4*c*d),g=h.gl;g.readPixels(i.x*e,i.y*e,c,d,g.RGBA,g.UNSIGNED_BYTE,f);var m=p.context.getImageData(0,0,c,d);if(o.arrayPostDivide(f,m.data),p.context.putImageData(m,0,0),l){var y=new n.CanvasRenderTarget(p.width,p.height,1);y.context.scale(1,-1),y.context.drawImage(p.canvas,0,-d),p.destroy(),p=y}return u&&a.destroy(!0),p.canvas},o.prototype.pixels=function(t){var e,i,n,a=this.renderer,h=!1;t&&(t instanceof r.RenderTexture?n=t:(n=this.renderer.generateTexture(t),h=!0)),n?(e=n.baseTexture.resolution,i=n.frame,a.renderTexture.bind(n)):(e=a.resolution,(i=s).width=a.width,i.height=a.height,a.renderTexture.bind(null));var l=i.width*e,u=i.height*e,c=new Uint8Array(4*l*u),d=a.gl;return d.readPixels(i.x*e,i.y*e,l,u,d.RGBA,d.UNSIGNED_BYTE,c),h&&n.destroy(!0),o.arrayPostDivide(c,c),c},o.prototype.destroy=function(){this.renderer.extract=null,this.renderer=null},o.arrayPostDivide=function(t,e){for(var i=0;i<t.length;i+=4){var r=e[i+3]=t[i+3];0!==r?(e[i]=Math.round(Math.min(255*t[i]/r,255)),e[i+1]=Math.round(Math.min(255*t[i+1]/r,255)),e[i+2]=Math.round(Math.min(255*t[i+2]/r,255))):(e[i]=t[i],e[i+1]=t[i+1],e[i+2]=t[i+2])}},i.Extract=o},{"@pixi/core":4,"@pixi/math":16,"@pixi/utils":34}],7:[function(t,e,i){
/*!
 * @pixi/filter-alpha - v5.2.2
 * Compiled Tue, 21 Apr 2020 03:53:51 UTC
 *
 * @pixi/filter-alpha is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=t("@pixi/core"),n=function(t){function e(e){void 0===e&&(e=1),t.call(this,r.defaultVertex,"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n",{uAlpha:1}),this.alpha=e}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={alpha:{configurable:!0}};return i.alpha.get=function(){return this.uniforms.uAlpha},i.alpha.set=function(t){this.uniforms.uAlpha=t},Object.defineProperties(e.prototype,i),e}(r.Filter);i.AlphaFilter=n},{"@pixi/core":4}],8:[function(t,e,i){
/*!
 * @pixi/filter-blur - v5.2.2
 * Compiled Tue, 21 Apr 2020 03:53:51 UTC
 *
 * @pixi/filter-blur is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=t("@pixi/core"),n=t("@pixi/settings");var s={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},o=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n");var a=function(t){function e(e,i,r,a,h){var l=function(t,e){var i,r=Math.ceil(t/2),n="\n    attribute vec2 aVertexPosition;\n\n    uniform mat3 projectionMatrix;\n\n    uniform float strength;\n\n    varying vec2 vBlurTexCoords[%size%];\n\n    uniform vec4 inputSize;\n    uniform vec4 outputFrame;\n\n    vec4 filterVertexPosition( void )\n    {\n        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n    }\n\n    vec2 filterTextureCoord( void )\n    {\n        return aVertexPosition * (outputFrame.zw * inputSize.zw);\n    }\n\n    void main(void)\n    {\n        gl_Position = filterVertexPosition();\n\n        vec2 textureCoord = filterTextureCoord();\n        %blur%\n    }",s="";i=e?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(var o=0;o<t;o++){var a=i.replace("%index%",o);s+=a=a.replace("%sampleIndex%",o-(r-1)+".0"),s+="\n"}return n=(n=n.replace("%blur%",s)).replace("%size%",t)}(h=h||5,e),u=function(t){for(var e,i=s[t],r=i.length,n=o,a="",h=0;h<t;h++){var l="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",h);e=h,h>=r&&(e=t-h-1),a+=l=l.replace("%value%",i[e]),a+="\n"}return n=(n=n.replace("%blur%",a)).replace("%size%",t)}(h);t.call(this,l,u),this.horizontal=e,this.resolution=a||n.settings.RESOLUTION,this._quality=0,this.quality=r||4,this.blur=i||8}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={blur:{configurable:!0},quality:{configurable:!0}};return e.prototype.apply=function(t,e,i,r){if(i?this.horizontal?this.uniforms.strength=1/i.width*(i.width/e.width):this.uniforms.strength=1/i.height*(i.height/e.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/e.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/e.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)t.applyFilter(this,e,i,r);else{var n=t.getFilterTexture(),s=t.renderer,o=e,a=n;this.state.blend=!1,t.applyFilter(this,o,a,!0);for(var h=1;h<this.passes-1;h++){s.renderTexture.bind(o,o.filterFrame),this.uniforms.uSampler=a;var l=a;a=o,o=l,s.shader.bind(this),s.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,a,i,r),t.returnFilterTexture(n)}},i.blur.get=function(){return this.strength},i.blur.set=function(t){this.padding=1+2*Math.abs(t),this.strength=t},i.quality.get=function(){return this._quality},i.quality.set=function(t){this._quality=t,this.passes=t},Object.defineProperties(e.prototype,i),e}(r.Filter),h=function(t){function e(e,i,r,s){t.call(this),this.blurXFilter=new a(!0,e,i,r,s),this.blurYFilter=new a(!1,e,i,r,s),this.resolution=r||n.settings.RESOLUTION,this.quality=i||4,this.blur=e||8,this.repeatEdgePixels=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={blur:{configurable:!0},quality:{configurable:!0},blurX:{configurable:!0},blurY:{configurable:!0},blendMode:{configurable:!0},repeatEdgePixels:{configurable:!0}};return e.prototype.apply=function(t,e,i,r){var n=Math.abs(this.blurXFilter.strength),s=Math.abs(this.blurYFilter.strength);if(n&&s){var o=t.getFilterTexture();this.blurXFilter.apply(t,e,o,!0),this.blurYFilter.apply(t,o,i,r),t.returnFilterTexture(o)}else s?this.blurYFilter.apply(t,e,i,r):this.blurXFilter.apply(t,e,i,r)},e.prototype.updatePadding=function(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))},i.blur.get=function(){return this.blurXFilter.blur},i.blur.set=function(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()},i.quality.get=function(){return this.blurXFilter.quality},i.quality.set=function(t){this.blurXFilter.quality=this.blurYFilter.quality=t},i.blurX.get=function(){return this.blurXFilter.blur},i.blurX.set=function(t){this.blurXFilter.blur=t,this.updatePadding()},i.blurY.get=function(){return this.blurYFilter.blur},i.blurY.set=function(t){this.blurYFilter.blur=t,this.updatePadding()},i.blendMode.get=function(){return this.blurYFilter.blendMode},i.blendMode.set=function(t){this.blurYFilter.blendMode=t},i.repeatEdgePixels.get=function(){return this._repeatEdgePixels},i.repeatEdgePixels.set=function(t){this._repeatEdgePixels=t,this.updatePadding()},Object.defineProperties(e.prototype,i),e}(r.Filter);i.BlurFilter=h,i.BlurFilterPass=a},{"@pixi/core":4,"@pixi/settings":26}],9:[function(t,e,i){
/*!
 * @pixi/filter-color-matrix - v5.2.2
 * Compiled Tue, 21 Apr 2020 03:53:51 UTC
 *
 * @pixi/filter-color-matrix is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=t("@pixi/core"),n=function(t){function e(){var e={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};t.call(this,r.defaultFilterVertex,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n",e),this.alpha=1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={matrix:{configurable:!0},alpha:{configurable:!0}};return e.prototype._loadMatrix=function(t,e){void 0===e&&(e=!1);var i=t;e&&(this._multiply(i,this.uniforms.m,t),i=this._colorMatrix(i)),this.uniforms.m=i},e.prototype._multiply=function(t,e,i){return t[0]=e[0]*i[0]+e[1]*i[5]+e[2]*i[10]+e[3]*i[15],t[1]=e[0]*i[1]+e[1]*i[6]+e[2]*i[11]+e[3]*i[16],t[2]=e[0]*i[2]+e[1]*i[7]+e[2]*i[12]+e[3]*i[17],t[3]=e[0]*i[3]+e[1]*i[8]+e[2]*i[13]+e[3]*i[18],t[4]=e[0]*i[4]+e[1]*i[9]+e[2]*i[14]+e[3]*i[19]+e[4],t[5]=e[5]*i[0]+e[6]*i[5]+e[7]*i[10]+e[8]*i[15],t[6]=e[5]*i[1]+e[6]*i[6]+e[7]*i[11]+e[8]*i[16],t[7]=e[5]*i[2]+e[6]*i[7]+e[7]*i[12]+e[8]*i[17],t[8]=e[5]*i[3]+e[6]*i[8]+e[7]*i[13]+e[8]*i[18],t[9]=e[5]*i[4]+e[6]*i[9]+e[7]*i[14]+e[8]*i[19]+e[9],t[10]=e[10]*i[0]+e[11]*i[5]+e[12]*i[10]+e[13]*i[15],t[11]=e[10]*i[1]+e[11]*i[6]+e[12]*i[11]+e[13]*i[16],t[12]=e[10]*i[2]+e[11]*i[7]+e[12]*i[12]+e[13]*i[17],t[13]=e[10]*i[3]+e[11]*i[8]+e[12]*i[13]+e[13]*i[18],t[14]=e[10]*i[4]+e[11]*i[9]+e[12]*i[14]+e[13]*i[19]+e[14],t[15]=e[15]*i[0]+e[16]*i[5]+e[17]*i[10]+e[18]*i[15],t[16]=e[15]*i[1]+e[16]*i[6]+e[17]*i[11]+e[18]*i[16],t[17]=e[15]*i[2]+e[16]*i[7]+e[17]*i[12]+e[18]*i[17],t[18]=e[15]*i[3]+e[16]*i[8]+e[17]*i[13]+e[18]*i[18],t[19]=e[15]*i[4]+e[16]*i[9]+e[17]*i[14]+e[18]*i[19]+e[19],t},e.prototype._colorMatrix=function(t){var e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e},e.prototype.brightness=function(t,e){var i=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(i,e)},e.prototype.greyscale=function(t,e){var i=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(i,e)},e.prototype.blackAndWhite=function(t){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],t)},e.prototype.hue=function(t,e){t=(t||0)/180*Math.PI;var i=Math.cos(t),r=Math.sin(t),n=1/3,s=(0,Math.sqrt)(n),o=[i+(1-i)*n,n*(1-i)-s*r,n*(1-i)+s*r,0,0,n*(1-i)+s*r,i+n*(1-i),n*(1-i)-s*r,0,0,n*(1-i)-s*r,n*(1-i)+s*r,i+n*(1-i),0,0,0,0,0,1,0];this._loadMatrix(o,e)},e.prototype.contrast=function(t,e){var i=(t||0)+1,r=-.5*(i-1),n=[i,0,0,0,r,0,i,0,0,r,0,0,i,0,r,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.saturate=function(t,e){void 0===t&&(t=0);var i=2*t/3+1,r=-.5*(i-1),n=[i,r,r,0,0,r,i,r,0,0,r,r,i,0,0,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.desaturate=function(){this.saturate(-1)},e.prototype.negative=function(t){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],t)},e.prototype.sepia=function(t){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],t)},e.prototype.technicolor=function(t){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],t)},e.prototype.polaroid=function(t){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],t)},e.prototype.toBGR=function(t){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],t)},e.prototype.kodachrome=function(t){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],t)},e.prototype.browni=function(t){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],t)},e.prototype.vintage=function(t){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],t)},e.prototype.colorTone=function(t,e,i,r,n){var s=((i=i||16770432)>>16&255)/255,o=(i>>8&255)/255,a=(255&i)/255,h=((r=r||3375104)>>16&255)/255,l=(r>>8&255)/255,u=(255&r)/255,c=[.3,.59,.11,0,0,s,o,a,t=t||.2,0,h,l,u,e=e||.15,0,s-h,o-l,a-u,0,0];this._loadMatrix(c,n)},e.prototype.night=function(t,e){var i=[-2*(t=t||.1),-t,0,0,0,-t,0,t,0,0,0,t,2*t,0,0,0,0,0,1,0];this._loadMatrix(i,e)},e.prototype.predator=function(t,e){var i=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(i,e)},e.prototype.lsd=function(t){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],t)},e.prototype.reset=function(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)},i.matrix.get=function(){return this.uniforms.m},i.matrix.set=function(t){this.uniforms.m=t},i.alpha.get=function(){return this.uniforms.uAlpha},i.alpha.set=function(t){this.uniforms.uAlpha=t},Object.defineProperties(e.prototype,i),e}(r.Filter);n.prototype.grayscale=n.prototype.greyscale,i.ColorMatrixFilter=n},{"@pixi/core":4}],10:[function(t,e,i){
/*!
 * @pixi/filter-displacement - v5.2.2
 * Compiled Tue, 21 Apr 2020 03:53:51 UTC
 *
 * @pixi/filter-displacement is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=t("@pixi/core"),n=t("@pixi/math"),s=function(t){function e(e,i){var r=new n.Matrix;e.renderable=!1,t.call(this,"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n\tgl_Position = filterVertexPosition();\n\tvTextureCoord = filterTextureCoord();\n\tvFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\nuniform mat2 rotation;\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform highp vec4 inputSize;\nuniform vec4 inputClamp;\n\nvoid main(void)\n{\n  vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n  map -= 0.5;\n  map.xy = scale * inputSize.zw * (rotation * map.xy);\n\n  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));\n}\n",{mapSampler:e._texture,filterMatrix:r,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=e,this.maskMatrix=r,null==i&&(i=20),this.scale=new n.Point(i,i)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={map:{configurable:!0}};return e.prototype.apply=function(t,e,i,r){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;var n=this.maskSprite.transform.worldTransform,s=Math.sqrt(n.a*n.a+n.b*n.b),o=Math.sqrt(n.c*n.c+n.d*n.d);0!==s&&0!==o&&(this.uniforms.rotation[0]=n.a/s,this.uniforms.rotation[1]=n.b/s,this.uniforms.rotation[2]=n.c/o,this.uniforms.rotation[3]=n.d/o),t.applyFilter(this,e,i,r)},i.map.get=function(){return this.uniforms.mapSampler},i.map.set=function(t){this.uniforms.mapSampler=t},Object.defineProperties(e.prototype,i),e}(r.Filter);i.DisplacementFilter=s},{"@pixi/core":4,"@pixi/math":16}],11:[function(t,e,i){
/*!
 * @pixi/filter-fxaa - v5.2.2
 * Compiled Tue, 21 Apr 2020 03:53:51 UTC
 *
 * @pixi/filter-fxaa is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=t("@pixi/core"),n=function(t){function e(){t.call(this,"\nattribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\n\nuniform vec4 inputPixel;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvoid texcoords(vec2 fragCoord, vec2 inverseVP,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = filterVertexPosition();\n\n   vFragCoord = aVertexPosition * outputFrame.zw;\n\n   texcoords(vFragCoord, inputPixel.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n",'varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\nuniform sampler2D uSampler;\nuniform highp vec4 inputPixel;\n\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n\n --\n\n From:\n https://github.com/mitsuhiko/webgl-meincraft\n\n Copyright (c) 2011 by Armin Ronacher.\n\n Some rights reserved.\n\n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n\n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n\n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n\n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n\n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n\n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec4 color;\n\n      color = fxaa(uSampler, vFragCoord, inputPixel.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n')}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(r.Filter);i.FXAAFilter=n},{"@pixi/core":4}],12:[function(t,e,i){
/*!
 * @pixi/filter-noise - v5.2.2
 * Compiled Tue, 21 Apr 2020 03:53:51 UTC
 *
 * @pixi/filter-noise is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=t("@pixi/core"),n=function(t){function e(e,i){void 0===e&&(e=.5),void 0===i&&(i=Math.random()),t.call(this,r.defaultFilterVertex,"precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n",{uNoise:0,uSeed:0}),this.noise=e,this.seed=i}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={noise:{configurable:!0},seed:{configurable:!0}};return i.noise.get=function(){return this.uniforms.uNoise},i.noise.set=function(t){this.uniforms.uNoise=t},i.seed.get=function(){return this.uniforms.uSeed},i.seed.set=function(t){this.uniforms.uSeed=t},Object.defineProperties(e.prototype,i),e}(r.Filter);i.NoiseFilter=n},{"@pixi/core":4}],13:[function(t,e,i){
/*!
 * @pixi/graphics - v5.2.2
 * Compiled Tue, 21 Apr 2020 03:53:51 UTC
 *
 * @pixi/graphics is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=t("@pixi/core"),n=t("@pixi/math"),s=t("@pixi/utils"),o=t("@pixi/constants"),a=t("@pixi/display"),h={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,_segmentsCount:function(t,e){if(void 0===e&&(e=20),!this.adaptive||!t||isNaN(t))return e;var i=Math.ceil(t/this.maxLength);return i<this.minSegments?i=this.minSegments:i>this.maxSegments&&(i=this.maxSegments),i}},l=function(){this.reset()};l.prototype.clone=function(){var t=new l;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t},l.prototype.reset=function(){this.color=16777215,this.alpha=1,this.texture=r.Texture.WHITE,this.matrix=null,this.visible=!1},l.prototype.destroy=function(){this.texture=null,this.matrix=null};var u={build:function(t){t.points=t.shape.points.slice()},triangulate:function(t,e){var i=t.points,r=t.holes,n=e.points,o=e.indices;if(i.length>=6){for(var a=[],h=0;h<r.length;h++){var l=r[h];a.push(i.length/2),i=i.concat(l.points)}var u=s.earcut(i,a,2);if(!u)return;for(var c=n.length/2,d=0;d<u.length;d+=3)o.push(u[d]+c),o.push(u[d+1]+c),o.push(u[d+2]+c);for(var p=0;p<i.length;p++)n.push(i[p])}}},c={build:function(t){var e,i,r=t.shape,s=t.points,o=r.x,a=r.y;if(s.length=0,t.type===n.SHAPES.CIRC?(e=r.radius,i=r.radius):(e=r.width,i=r.height),0!==e&&0!==i){var h=Math.floor(30*Math.sqrt(r.radius))||Math.floor(15*Math.sqrt(r.width+r.height));h/=2.3;for(var l=2*Math.PI/h,u=0;u<h-.5;u++)s.push(o+Math.sin(-l*u)*e,a+Math.cos(-l*u)*i);s.push(s[0],s[1])}},triangulate:function(t,e){var i=t.points,r=e.points,n=e.indices,s=r.length/2,o=s,a=t.shape,h=t.matrix,l=a.x,u=a.y;r.push(t.matrix?h.a*l+h.c*u+h.tx:l,t.matrix?h.b*l+h.d*u+h.ty:u);for(var c=0;c<i.length;c+=2)r.push(i[c],i[c+1]),n.push(s++,o,s)}},d={build:function(t){var e=t.shape,i=e.x,r=e.y,n=e.width,s=e.height,o=t.points;o.length=0,o.push(i,r,i+n,r,i+n,r+s,i,r+s)},triangulate:function(t,e){var i=t.points,r=e.points,n=r.length/2;r.push(i[0],i[1],i[2],i[3],i[6],i[7],i[4],i[5]),e.indices.push(n,n+1,n+2,n+1,n+2,n+3)}},p={build:function(t){var e=t.shape,i=t.points,r=e.x,n=e.y,s=e.width,o=e.height,a=Math.max(0,Math.min(e.radius,Math.min(s,o)/2));i.length=0,a?(g(r,n+a,r,n,r+a,n,i),g(r+s-a,n,r+s,n,r+s,n+a,i),g(r+s,n+o-a,r+s,n+o,r+s-a,n+o,i),g(r+a,n+o,r,n+o,r,n+o-a,i)):i.push(r,n,r+s,n,r+s,n+o,r,n+o)},triangulate:function(t,e){for(var i=t.points,r=e.points,n=e.indices,o=r.length/2,a=s.earcut(i,null,2),h=0,l=a.length;h<l;h+=3)n.push(a[h]+o),n.push(a[h+1]+o),n.push(a[h+2]+o);for(var u=0,c=i.length;u<c;u++)r.push(i[u],i[++u])}};function f(t,e,i){return t+(e-t)*i}function g(t,e,i,r,n,s,o){void 0===o&&(o=[]);for(var a=o,h=0,l=0,u=0,c=0,d=0,p=0,g=0,m=0;g<=20;++g)h=f(t,i,m=g/20),l=f(e,r,m),u=f(i,n,m),c=f(r,s,m),d=f(h,u,m),p=f(l,c,m),a.push(d,p);return a}function m(t,e){t.lineStyle.native?function(t,e){var i=0,r=t.shape,s=t.points||r.points,o=r.type!==n.SHAPES.POLY||r.closeStroke;if(0===s.length)return;var a=e.points,h=e.indices,l=s.length/2,u=a.length/2,c=u;for(a.push(s[0],s[1]),i=1;i<l;i++)a.push(s[2*i],s[2*i+1]),h.push(c,c+1),c++;o&&h.push(c,u)}(t,e):function(t,e){var i=t.shape,r=t.points||i.points.slice(),s=e.closePointEps;if(0===r.length)return;var o=t.lineStyle,a=new n.Point(r[0],r[1]),h=new n.Point(r[r.length-2],r[r.length-1]),l=i.type!==n.SHAPES.POLY||i.closeStroke,u=Math.abs(a.x-h.x)<s&&Math.abs(a.y-h.y)<s;if(l){r=r.slice(),u&&(r.pop(),r.pop(),h.set(r[r.length-2],r[r.length-1]));var c=h.x+.5*(a.x-h.x),d=h.y+.5*(a.y-h.y);r.unshift(c,d),r.push(c,d)}var p=e.points,f=r.length/2,g=r.length,m=p.length/2,y=o.width/2,_=r[0],v=r[1],x=r[2],b=r[3],w=0,T=0,E=-(v-b),S=_-x,P=0,O=0,C=0,I=0,M=Math.sqrt(E*E+S*S);E/=M,S/=M,E*=y,S*=y;var A=o.alignment,R=2*(1-A),D=2*A;p.push(_-E*R,v-S*R),p.push(_+E*D,v+S*D);for(var N=1;N<f-1;++N){_=r[2*(N-1)],v=r[2*(N-1)+1],x=r[2*N],b=r[2*N+1],w=r[2*(N+1)],T=r[2*(N+1)+1],E=-(v-b),S=_-x,M=Math.sqrt(E*E+S*S),E/=M,S/=M,E*=y,S*=y,P=-(b-T),O=x-w,M=Math.sqrt(P*P+O*O),P/=M,O/=M;var L=-S+v-(-S+b),k=-E+x-(-E+_),F=(-E+_)*(-S+b)-(-E+x)*(-S+v),B=-(O*=y)+T-(-O+b),U=-(P*=y)+x-(-P+w),j=(-P+w)*(-O+b)-(-P+x)*(-O+T),H=L*U-B*k;if(Math.abs(H)<.1)H+=10.1,p.push(x-E*R,b-S*R),p.push(x+E*D,b+S*D);else{var X=(k*j-U*F)/H,z=(B*F-L*j)/H;(X-x)*(X-x)+(z-b)*(z-b)>196*y*y?(C=E-P,I=S-O,M=Math.sqrt(C*C+I*I),C/=M,I/=M,C*=y,I*=y,p.push(x-C*R,b-I*R),p.push(x+C*D,b+I*D),p.push(x-C*D*R,b-I*R),g++):(p.push(x+(X-x)*R,b+(z-b)*R),p.push(x-(X-x)*D,b-(z-b)*D))}}_=r[2*(f-2)],v=r[2*(f-2)+1],x=r[2*(f-1)],b=r[2*(f-1)+1],E=-(v-b),S=_-x,M=Math.sqrt(E*E+S*S),E/=M,S/=M,E*=y,S*=y,p.push(x-E*R,b-S*R),p.push(x+E*D,b+S*D);for(var G=e.indices,W=0;W<g-2;++W)G.push(m,m+1,m+2),m++}(t,e)}var y=function(t){function e(e,i,r,s,o,a){o=o||s/2;for(var h=-1*Math.PI/2+a,l=2*r,u=n.PI_2/l,c=[],d=0;d<l;d++){var p=d%2?o:s,f=d*u+h;c.push(e+p*Math.cos(f),i+p*Math.sin(f))}t.call(this,c)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(n.Polygon),_=function(){};_.curveTo=function(t,e,i,r,n,s){var o=s[s.length-2],a=s[s.length-1]-e,h=o-t,l=r-e,u=i-t,c=Math.abs(a*u-h*l);if(c<1e-8||0===n)return s[s.length-2]===t&&s[s.length-1]===e||s.push(t,e),null;var d=a*a+h*h,p=l*l+u*u,f=a*l+h*u,g=n*Math.sqrt(d)/c,m=n*Math.sqrt(p)/c,y=g*f/d,_=m*f/p,v=g*u+m*h,x=g*l+m*a,b=h*(m+y),w=a*(m+y),T=u*(g+_),E=l*(g+_);return{cx:v+t,cy:x+e,radius:n,startAngle:Math.atan2(w-x,b-v),endAngle:Math.atan2(E-x,T-v),anticlockwise:h*l>u*a}},_.arc=function(t,e,i,r,s,o,a,l,u){for(var c=a-o,d=h._segmentsCount(Math.abs(c)*s,40*Math.ceil(Math.abs(c)/n.PI_2)),p=c/(2*d),f=2*p,g=Math.cos(p),m=Math.sin(p),y=d-1,_=y%1/y,v=0;v<=y;++v){var x=p+o+f*(v+_*v),b=Math.cos(x),w=-Math.sin(x);u.push((g*b+m*w)*s+i,(g*-w+m*b)*s+r)}};var v=function(){};v.curveLength=function(t,e,i,r,n,s,o,a){for(var h=0,l=0,u=0,c=0,d=0,p=0,f=0,g=0,m=0,y=0,_=0,v=t,x=e,b=1;b<=10;++b)y=v-(g=(f=(p=(d=1-(l=b/10))*d)*d)*t+3*p*l*i+3*d*(u=l*l)*n+(c=u*l)*o),_=x-(m=f*e+3*p*l*r+3*d*u*s+c*a),v=g,x=m,h+=Math.sqrt(y*y+_*_);return h},v.curveTo=function(t,e,i,r,n,s,o){var a=o[o.length-2],l=o[o.length-1];o.length-=2;var u=h._segmentsCount(v.curveLength(a,l,t,e,i,r,n,s)),c=0,d=0,p=0,f=0,g=0;o.push(a,l);for(var m=1,y=0;m<=u;++m)p=(d=(c=1-(y=m/u))*c)*c,g=(f=y*y)*y,o.push(p*a+3*d*y*t+3*c*f*i+g*n,p*l+3*d*y*e+3*c*f*r+g*s)};var x=function(){};x.curveLength=function(t,e,i,r,n,s){var o=t-2*i+n,a=e-2*r+s,h=2*i-2*t,l=2*r-2*e,u=4*(o*o+a*a),c=4*(o*h+a*l),d=h*h+l*l,p=2*Math.sqrt(u+c+d),f=Math.sqrt(u),g=2*u*f,m=2*Math.sqrt(d),y=c/f;return(g*p+f*c*(p-m)+(4*d*u-c*c)*Math.log((2*f+y+p)/(y+m)))/(4*g)},x.curveTo=function(t,e,i,r,n){for(var s=n[n.length-2],o=n[n.length-1],a=h._segmentsCount(x.curveLength(s,o,t,e,i,r)),l=0,u=0,c=1;c<=a;++c){var d=c/a;l=s+(t-s)*d,u=o+(e-o)*d,n.push(l+(t+(i-t)*d-l)*d,u+(e+(r-e)*d-u)*d)}};var b=function(){this.reset()};b.prototype.begin=function(t,e,i){this.reset(),this.style=t,this.start=e,this.attribStart=i},b.prototype.end=function(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start},b.prototype.reset=function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0};var w={};w[n.SHAPES.POLY]=u,w[n.SHAPES.CIRC]=c,w[n.SHAPES.ELIP]=c,w[n.SHAPES.RECT]=d,w[n.SHAPES.RREC]=p;var T=[],E=[],S={buildPoly:u,buildCircle:c,buildRectangle:d,buildRoundedRectangle:p,FILL_COMMANDS:w,BATCH_POOL:T,DRAW_CALL_POOL:E,buildLine:m,buildComplexPoly:function(t,e){var i=t.points.slice();if(!(i.length<6)){var r=e.indices;e.points=i,e.alpha=t.fillAlpha,e.color=s.hex2rgb(t.fillColor);for(var n=1/0,o=-1/0,a=1/0,h=-1/0,l=0,u=0,c=0;c<i.length;c+=2)n=(l=i[c])<n?l:n,o=l>o?l:o,a=(u=i[c+1])<a?u:a,h=u>h?u:h;i.push(n,a,o,a,o,h,n,h);for(var d=i.length/2,p=0;p<d;p++)r.push(p)}},bezierCurveTo:function(t,e,i,r,n,s,o,a,h,l){void 0===l&&(l=[]);var u=0,c=0,d=0,p=0,f=0;l.push(t,e);for(var g=1,m=0;g<=h;++g)d=(c=(u=1-(m=g/h))*u)*u,f=(p=m*m)*m,l.push(d*t+3*c*m*i+3*u*p*n+f*o,d*e+3*c*m*r+3*u*p*s+f*a);return l},Star:y,ArcUtils:_,BezierUtils:v,QuadraticUtils:x,BatchPart:b},P=function(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=null),void 0===r&&(r=null),this.shape=t,this.lineStyle=i,this.fillStyle=e,this.matrix=r,this.type=t.type,this.points=[],this.holes=[]};P.prototype.clone=function(){return new P(this.shape,this.fillStyle,this.lineStyle,this.matrix)},P.prototype.destroy=function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null};var O=new n.Point,C=new a.Bounds,I=function(t){function e(){t.call(this),this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.dirty=0,this.batchDirty=-1,this.cacheDirty=-1,this.clearDirty=0,this.drawCalls=[],this.batches=[],this.shapeIndex=0,this._bounds=new a.Bounds,this.boundsDirty=-1,this.boundsPadding=0,this.batchable=!1,this.indicesUint16=null,this.uvsFloat32=null,this.closePointEps=1e-4}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={bounds:{configurable:!0}};return i.bounds.get=function(){return this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds},e.prototype.invalidate=function(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var t=0;t<this.drawCalls.length;t++)this.drawCalls[t].textures.length=0,E.push(this.drawCalls[t]);this.drawCalls.length=0;for(var e=0;e<this.batches.length;e++){var i=this.batches[e];i.reset(),T.push(i)}this.batches.length=0},e.prototype.clear=function(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this},e.prototype.drawShape=function(t,e,i,r){var n=new P(t,e,i,r);return this.graphicsData.push(n),this.dirty++,this},e.prototype.drawHole=function(t,e){if(!this.graphicsData.length)return null;var i=new P(t,null,null,e),r=this.graphicsData[this.graphicsData.length-1];return i.lineStyle=r.lineStyle,r.holes.push(i),this.dirty++,this},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e);for(var i=0;i<this.graphicsData.length;++i)this.graphicsData[i].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null},e.prototype.containsPoint=function(t){for(var e=this.graphicsData,i=0;i<e.length;++i){var r=e[i];if(r.fillStyle.visible&&(r.shape&&(r.matrix?r.matrix.applyInverse(t,O):O.copyFrom(t),r.shape.contains(O.x,O.y)))){var n=!1;if(r.holes)for(var s=0;s<r.holes.length;s++){if(r.holes[s].shape.contains(O.x,O.y)){n=!0;break}}if(!n)return!0}}return!1},e.prototype.updateBatches=function(){if(this.graphicsData.length){if(this.validateBatching()){this.cacheDirty=this.dirty;var t=this.uvs,e=this.graphicsData,i=null,r=null;this.batches.length>0&&(r=(i=this.batches[this.batches.length-1]).style);for(var n=this.shapeIndex;n<e.length;n++){this.shapeIndex++;var s=e[n],a=s.fillStyle,h=s.lineStyle;w[s.type].build(s),s.matrix&&this.transformPoints(s.points,s.matrix);for(var l=0;l<2;l++){var u=0===l?a:h;if(u.visible){var c=u.texture.baseTexture,d=this.indices.length,p=this.points.length/2;c.wrapMode=o.WRAP_MODES.REPEAT,0===l?this.processFill(s):this.processLine(s);var f=this.points.length/2-p;0!==f&&(i&&!this._compareStyles(r,u)&&(i.end(d,p),i=null),i||((i=T.pop()||new b).begin(u,d,p),this.batches.push(i),r=u),this.addUvs(this.points,t,u.texture,p,f,u.matrix))}}}if(i){var g=this.indices.length,m=this.points.length/2;i.end(g,m)}0!==this.batches.length?(this.indicesUint16=new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()):this.batchable=!0}}else this.batchable=!0},e.prototype._compareStyles=function(t,e){return!(!t||!e)&&(t.texture.baseTexture===e.texture.baseTexture&&(t.color+t.alpha===e.color+e.alpha&&!!t.native==!!e.native))},e.prototype.validateBatching=function(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var t=0,e=this.graphicsData.length;t<e;t++){var i=this.graphicsData[t],r=i.fillStyle,n=i.lineStyle;if(r&&!r.texture.baseTexture.valid)return!1;if(n&&!n.texture.baseTexture.valid)return!1}return!0},e.prototype.packBatches=function(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var t=this.batches,e=0,i=t.length;e<i;e++)for(var r=t[e],n=0;n<r.size;n++){var s=r.start+n;this.indicesUint16[s]=this.indicesUint16[s]-r.attribStart}},e.prototype.isBatchable=function(){for(var t=this.batches,i=0;i<t.length;i++)if(t[i].style.native)return!1;return this.points.length<2*e.BATCHABLE_SIZE},e.prototype.buildDrawCalls=function(){for(var t=++r.BaseTexture._globalBatch,e=0;e<this.drawCalls.length;e++)this.drawCalls[e].textures.length=0,E.push(this.drawCalls[e]);this.drawCalls.length=0;var i=this.colors,n=this.textureIds,s=E.pop();s||((s=new r.BatchDrawCall).textures=new r.BatchTextureArray),s.textures.count=0,s.start=0,s.size=0,s.type=o.DRAW_MODES.TRIANGLES;var a=0,h=null,l=0,u=!1,c=o.DRAW_MODES.TRIANGLES,d=0;this.drawCalls.push(s);for(var p=0;p<this.batches.length;p++){var f=this.batches[p],g=f.style,m=g.texture.baseTexture;u!==!!g.native&&(c=(u=!!g.native)?o.DRAW_MODES.LINES:o.DRAW_MODES.TRIANGLES,h=null,a=8,t++),h!==m&&(h=m,m._batchEnabled!==t&&(8===a&&(t++,a=0,s.size>0&&((s=E.pop())||((s=new r.BatchDrawCall).textures=new r.BatchTextureArray),this.drawCalls.push(s)),s.start=d,s.size=0,s.textures.count=0,s.type=c),m.touched=1,m._batchEnabled=t,m._batchLocation=a,m.wrapMode=10497,s.textures.elements[s.textures.count++]=m,a++)),s.size+=f.size,d+=f.size,l=m._batchLocation,this.addColors(i,g.color,g.alpha,f.attribSize),this.addTextureIds(n,l,f.attribSize)}r.BaseTexture._globalBatch=t,this.packAttributes()},e.prototype.packAttributes=function(){for(var t=this.points,e=this.uvs,i=this.colors,r=this.textureIds,n=new ArrayBuffer(3*t.length*4),s=new Float32Array(n),o=new Uint32Array(n),a=0,h=0;h<t.length/2;h++)s[a++]=t[2*h],s[a++]=t[2*h+1],s[a++]=e[2*h],s[a++]=e[2*h+1],o[a++]=i[h],s[a++]=r[h];this._buffer.update(n),this._indexBuffer.update(this.indicesUint16)},e.prototype.processFill=function(t){t.holes.length?(this.processHoles(t.holes),u.triangulate(t,this)):w[t.type].triangulate(t,this)},e.prototype.processLine=function(t){m(t,this);for(var e=0;e<t.holes.length;e++)m(t.holes[e],this)},e.prototype.processHoles=function(t){for(var e=0;e<t.length;e++){var i=t[e];w[i.type].build(i),i.matrix&&this.transformPoints(i.points,i.matrix)}},e.prototype.calculateBounds=function(){var t=this._bounds,e=C,i=n.Matrix.IDENTITY;this._bounds.clear(),e.clear();for(var r=0;r<this.graphicsData.length;r++){var s=this.graphicsData[r],o=s.shape,a=s.type,h=s.lineStyle,l=s.matrix||n.Matrix.IDENTITY,u=0;if(h&&h.visible){var c=h.alignment;u=h.width,a===n.SHAPES.POLY?u*=.5+Math.abs(.5-c):u*=Math.max(0,c)}i!==l&&(e.isEmpty()||(t.addBoundsMatrix(e,i),e.clear()),i=l),a===n.SHAPES.RECT||a===n.SHAPES.RREC?e.addFramePad(o.x,o.y,o.x+o.width,o.y+o.height,u,u):a===n.SHAPES.CIRC?e.addFramePad(o.x,o.y,o.x,o.y,o.radius+u,o.radius+u):a===n.SHAPES.ELIP?e.addFramePad(o.x,o.y,o.x,o.y,o.width+u,o.height+u):t.addVerticesMatrix(i,o.points,0,o.points.length,u,u)}e.isEmpty()||t.addBoundsMatrix(e,i),t.pad(this.boundsPadding,this.boundsPadding)},e.prototype.transformPoints=function(t,e){for(var i=0;i<t.length/2;i++){var r=t[2*i],n=t[2*i+1];t[2*i]=e.a*r+e.c*n+e.tx,t[2*i+1]=e.b*r+e.d*n+e.ty}},e.prototype.addColors=function(t,e,i,r){for(var n=(e>>16)+(65280&e)+((255&e)<<16),o=s.premultiplyTint(n,i);r-- >0;)t.push(o)},e.prototype.addTextureIds=function(t,e,i){for(;i-- >0;)t.push(e)},e.prototype.addUvs=function(t,e,i,r,n,s){for(var o=0,a=e.length,h=i.frame;o<n;){var l=t[2*(r+o)],u=t[2*(r+o)+1];if(s){var c=s.a*l+s.c*u+s.tx;u=s.b*l+s.d*u+s.ty,l=c}o++,e.push(l/h.width,u/h.height)}var d=i.baseTexture;(h.width<d.width||h.height<d.height)&&this.adjustUvs(e,i,a,n)},e.prototype.adjustUvs=function(t,e,i,r){for(var n=e.baseTexture,s=1e-6,o=i+2*r,a=e.frame,h=a.width/n.width,l=a.height/n.height,u=a.x/a.width,c=a.y/a.height,d=Math.floor(t[i]+s),p=Math.floor(t[i+1]+s),f=i+2;f<o;f+=2)d=Math.min(d,Math.floor(t[f]+s)),p=Math.min(p,Math.floor(t[f+1]+s));u-=d,c-=p;for(var g=i;g<o;g+=2)t[g]=(t[g]+u)*h,t[g+1]=(t[g+1]+c)*l},Object.defineProperties(e.prototype,i),e}(r.BatchGeometry);I.BATCHABLE_SIZE=100;var M=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){var t=new e;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t},e.prototype.reset=function(){t.prototype.reset.call(this),this.color=0,this.width=0,this.alignment=.5,this.native=!1},e}(l),A=new Float32Array(3),R={},D=function(t){function e(e){void 0===e&&(e=null),t.call(this),this.geometry=e||new I,this.geometry.refCount++,this.shader=null,this.state=r.State.for2d(),this._fillStyle=new l,this._lineStyle=new M,this._matrix=null,this._holeMode=!1,this.currentPath=null,this.batches=[],this.batchTint=-1,this.vertexData=null,this._transformID=-1,this.batchDirty=-1,this.pluginName="batch",this.tint=16777215,this.blendMode=o.BLEND_MODES.NORMAL}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={blendMode:{configurable:!0},tint:{configurable:!0},fill:{configurable:!0},line:{configurable:!0}};return e.prototype.clone=function(){return this.finishPoly(),new e(this.geometry)},i.blendMode.set=function(t){this.state.blendMode=t},i.blendMode.get=function(){return this.state.blendMode},i.tint.get=function(){return this._tint},i.tint.set=function(t){this._tint=t},i.fill.get=function(){return this._fillStyle},i.line.get=function(){return this._lineStyle},e.prototype.lineStyle=function(t){if("number"==typeof t){var e=arguments;t={width:e[0]||0,color:e[1]||0,alpha:void 0!==e[2]?e[2]:1,alignment:void 0!==e[3]?e[3]:.5,native:!!e[4]}}return this.lineTextureStyle(t)},e.prototype.lineTextureStyle=function(t){if("number"==typeof t){s.deprecation("v5.2.0","Please use object-based options for Graphics#lineTextureStyle");var e=arguments[0],i=arguments[1],n=arguments[2],o=arguments[3],a=arguments[4],h=arguments[5],l=arguments[6];t={width:e,texture:i,color:n,alpha:o,matrix:a,alignment:h,native:l},Object.keys(t).forEach((function(e){return void 0===t[e]&&delete t[e]}))}t=Object.assign({width:0,texture:r.Texture.WHITE,color:t&&t.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1},t),this.currentPath&&this.startPoly();var u=t.width>0&&t.alpha>0;return u?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:u},t)):this._lineStyle.reset(),this},e.prototype.startPoly=function(){if(this.currentPath){var t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new n.Polygon,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new n.Polygon,this.currentPath.closeStroke=!1},e.prototype.finishPoly=function(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)},e.prototype.moveTo=function(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this},e.prototype.lineTo=function(t,e){this.currentPath||this.moveTo(0,0);var i=this.currentPath.points,r=i[i.length-2],n=i[i.length-1];return r===t&&n===e||i.push(t,e),this},e.prototype._initCurve=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[t,e]):this.moveTo(t,e)},e.prototype.quadraticCurveTo=function(t,e,i,r){this._initCurve();var n=this.currentPath.points;return 0===n.length&&this.moveTo(0,0),x.curveTo(t,e,i,r,n),this},e.prototype.bezierCurveTo=function(t,e,i,r,n,s){return this._initCurve(),v.curveTo(t,e,i,r,n,s,this.currentPath.points),this},e.prototype.arcTo=function(t,e,i,r,n){this._initCurve(t,e);var s=this.currentPath.points,o=_.curveTo(t,e,i,r,n,s);if(o){var a=o.cx,h=o.cy,l=o.radius,u=o.startAngle,c=o.endAngle,d=o.anticlockwise;this.arc(a,h,l,u,c,d)}return this},e.prototype.arc=function(t,e,i,r,s,o){if(void 0===o&&(o=!1),r===s)return this;if(!o&&s<=r?s+=n.PI_2:o&&r<=s&&(r+=n.PI_2),0===s-r)return this;var a=t+Math.cos(r)*i,h=e+Math.sin(r)*i,l=this.geometry.closePointEps,u=this.currentPath?this.currentPath.points:null;if(u){var c=Math.abs(u[u.length-2]-a),d=Math.abs(u[u.length-1]-h);c<l&&d<l||u.push(a,h)}else this.moveTo(a,h),u=this.currentPath.points;return _.arc(a,h,t,e,i,r,s,o,u),this},e.prototype.beginFill=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=1),this.beginTextureFill({texture:r.Texture.WHITE,color:t,alpha:e})},e.prototype.beginTextureFill=function(t){if(t instanceof r.Texture){s.deprecation("v5.2.0","Please use object-based options for Graphics#beginTextureFill");var e=arguments[0],i=arguments[1],n=arguments[2],o=arguments[3];t={texture:e,color:i,alpha:n,matrix:o},Object.keys(t).forEach((function(e){return void 0===t[e]&&delete t[e]}))}t=Object.assign({texture:r.Texture.WHITE,color:16777215,alpha:1,matrix:null},t),this.currentPath&&this.startPoly();var a=t.alpha>0;return a?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:a},t)):this._fillStyle.reset(),this},e.prototype.endFill=function(){return this.finishPoly(),this._fillStyle.reset(),this},e.prototype.drawRect=function(t,e,i,r){return this.drawShape(new n.Rectangle(t,e,i,r))},e.prototype.drawRoundedRect=function(t,e,i,r,s){return this.drawShape(new n.RoundedRectangle(t,e,i,r,s))},e.prototype.drawCircle=function(t,e,i){return this.drawShape(new n.Circle(t,e,i))},e.prototype.drawEllipse=function(t,e,i,r){return this.drawShape(new n.Ellipse(t,e,i,r))},e.prototype.drawPolygon=function(t){var e=arguments,i=t,r=!0;if(i.points&&(r=i.closeStroke,i=i.points),!Array.isArray(i)){i=new Array(arguments.length);for(var s=0;s<i.length;++s)i[s]=e[s]}var o=new n.Polygon(i);return o.closeStroke=r,this.drawShape(o),this},e.prototype.drawShape=function(t){return this._holeMode?this.geometry.drawHole(t,this._matrix):this.geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this},e.prototype.drawStar=function(t,e,i,r,n,s){return void 0===s&&(s=0),this.drawPolygon(new y(t,e,i,r,n,s))},e.prototype.clear=function(){return this.geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._matrix=null,this._holeMode=!1,this.currentPath=null,this},e.prototype.isFastRect=function(){return 1===this.geometry.graphicsData.length&&this.geometry.graphicsData[0].shape.type===n.SHAPES.RECT&&!this.geometry.graphicsData[0].lineWidth},e.prototype._render=function(t){this.finishPoly();var e=this.geometry;e.updateBatches(),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))},e.prototype._populateBatches=function(){var t=this.geometry,e=this.blendMode;this.batches=[],this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.vertexData=new Float32Array(t.points);for(var i=0,r=t.batches.length;i<r;i++){var n=t.batches[i],o=n.style.color,a=new Float32Array(this.vertexData.buffer,4*n.attribStart*2,2*n.attribSize),h=new Float32Array(t.uvsFloat32.buffer,4*n.attribStart*2,2*n.attribSize),l={vertexData:a,blendMode:e,indices:new Uint16Array(t.indicesUint16.buffer,2*n.start,n.size),uvs:h,_batchRGB:s.hex2rgb(o),_tintRGB:o,_texture:n.style.texture,alpha:n.style.alpha,worldAlpha:1};this.batches[i]=l}},e.prototype._renderBatched=function(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(var e=0,i=this.batches.length;e<i;e++){var r=this.batches[e];r.worldAlpha=this.worldAlpha*r.alpha,t.plugins[this.pluginName].render(r)}}},e.prototype._renderDirect=function(t){var e=this._resolveDirectShader(t),i=this.geometry,r=this.tint,n=this.worldAlpha,s=e.uniforms,o=i.drawCalls;s.translationMatrix=this.transform.worldTransform,s.tint[0]=(r>>16&255)/255*n,s.tint[1]=(r>>8&255)/255*n,s.tint[2]=(255&r)/255*n,s.tint[3]=n,t.shader.bind(e),t.geometry.bind(i,e),t.state.set(this.state);for(var a=0,h=o.length;a<h;a++)this._renderDrawCallDirect(t,i.drawCalls[a])},e.prototype._renderDrawCallDirect=function(t,e){for(var i=e.textures,r=e.type,n=e.size,s=e.start,o=i.count,a=0;a<o;a++)t.texture.bind(i.elements[a],a);t.geometry.draw(r,n,s)},e.prototype._resolveDirectShader=function(t){var e=this.shader,i=this.pluginName;if(!e){if(!R[i]){for(var s=new Int32Array(16),o=0;o<16;o++)s[o]=o;var a={tint:new Float32Array([1,1,1,1]),translationMatrix:new n.Matrix,default:r.UniformGroup.from({uSamplers:s},!0)},h=t.plugins[i]._shader.program;R[i]=new r.Shader(h,a)}e=R[i]}return e},e.prototype._calculateBounds=function(){this.finishPoly();var t=this.geometry;if(t.graphicsData.length){var e=t.bounds,i=e.minX,r=e.minY,n=e.maxX,s=e.maxY;this._bounds.addFrame(this.transform,i,r,n,s)}},e.prototype.containsPoint=function(t){return this.worldTransform.applyInverse(t,e._TEMP_POINT),this.geometry.containsPoint(e._TEMP_POINT)},e.prototype.calculateTints=function(){if(this.batchTint!==this.tint){this.batchTint=this.tint;for(var t=s.hex2rgb(this.tint,A),e=0;e<this.batches.length;e++){var i=this.batches[e],r=i._batchRGB,n=(t[0]*r[0]*255<<16)+(t[1]*r[1]*255<<8)+(0|t[2]*r[2]*255);i._tintRGB=(n>>16)+(65280&n)+((255&n)<<16)}}},e.prototype.calculateVertices=function(){if(this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID;for(var t=this.transform.worldTransform,e=t.a,i=t.b,r=t.c,n=t.d,s=t.tx,o=t.ty,a=this.geometry.points,h=this.vertexData,l=0,u=0;u<a.length;u+=2){var c=a[u],d=a[u+1];h[l++]=e*c+r*d+s,h[l++]=n*d+i*c+o}}},e.prototype.closePath=function(){var t=this.currentPath;return t&&(t.closeStroke=!0),this},e.prototype.setMatrix=function(t){return this._matrix=t,this},e.prototype.beginHole=function(){return this.finishPoly(),this._holeMode=!0,this},e.prototype.endHole=function(){return this.finishPoly(),this._holeMode=!1,this},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.geometry.refCount--,0===this.geometry.refCount&&this.geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this.geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,t.prototype.destroy.call(this,e)},Object.defineProperties(e.prototype,i),e}(a.Container);D._TEMP_POINT=new n.Point,i.FillStyle=l,i.GRAPHICS_CURVES=h,i.Graphics=D,i.GraphicsData=P,i.GraphicsGeometry=I,i.LineStyle=M,i.graphicsUtils=S},{"@pixi/constants":3,"@pixi/core":4,"@pixi/display":5,"@pixi/math":16,"@pixi/utils":34}],14:[function(t,e,i){
/*!
 * @pixi/interaction - v5.2.2
 * Compiled Tue, 21 Apr 2020 03:53:51 UTC
 *
 * @pixi/interaction is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=t("@pixi/math"),n=t("@pixi/ticker"),s=t("@pixi/display"),o=t("@pixi/utils"),a=function(){this.global=new r.Point,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0},h={pointerId:{configurable:!0}};h.pointerId.get=function(){return this.identifier},a.prototype.getLocalPosition=function(t,e,i){return t.worldTransform.applyInverse(i||this.global,e)},a.prototype.copyEvent=function(t){t.isPrimary&&(this.isPrimary=!0),this.button=t.button,this.buttons=Number.isInteger(t.buttons)?t.buttons:t.which,this.width=t.width,this.height=t.height,this.tiltX=t.tiltX,this.tiltY=t.tiltY,this.pointerType=t.pointerType,this.pressure=t.pressure,this.rotationAngle=t.rotationAngle,this.twist=t.twist||0,this.tangentialPressure=t.tangentialPressure||0},a.prototype.reset=function(){this.isPrimary=!1},Object.defineProperties(a.prototype,h);var l=function(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null};l.prototype.stopPropagation=function(){this.stopped=!0,this.stopPropagationHint=!0,this.stopsPropagatingAt=this.currentTarget},l.prototype.reset=function(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.currentTarget=null,this.target=null};var u=function t(e){this._pointerId=e,this._flags=t.FLAGS.NONE},c={pointerId:{configurable:!0},flags:{configurable:!0},none:{configurable:!0},over:{configurable:!0},rightDown:{configurable:!0},leftDown:{configurable:!0}};u.prototype._doSet=function(t,e){this._flags=e?this._flags|t:this._flags&~t},c.pointerId.get=function(){return this._pointerId},c.flags.get=function(){return this._flags},c.flags.set=function(t){this._flags=t},c.none.get=function(){return this._flags===this.constructor.FLAGS.NONE},c.over.get=function(){return 0!=(this._flags&this.constructor.FLAGS.OVER)},c.over.set=function(t){this._doSet(this.constructor.FLAGS.OVER,t)},c.rightDown.get=function(){return 0!=(this._flags&this.constructor.FLAGS.RIGHT_DOWN)},c.rightDown.set=function(t){this._doSet(this.constructor.FLAGS.RIGHT_DOWN,t)},c.leftDown.get=function(){return 0!=(this._flags&this.constructor.FLAGS.LEFT_DOWN)},c.leftDown.set=function(t){this._doSet(this.constructor.FLAGS.LEFT_DOWN,t)},Object.defineProperties(u.prototype,c),u.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4});var d=function(){this._tempPoint=new r.Point};d.prototype.recursiveFindHit=function(t,e,i,r,n){if(!e||!e.visible)return!1;var s=t.data.global,o=!1,a=n=e.interactive||n,h=!0;if(e.hitArea?(r&&(e.worldTransform.applyInverse(s,this._tempPoint),e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?o=!0:(r=!1,h=!1)),a=!1):e._mask&&r&&(e._mask.containsPoint&&e._mask.containsPoint(s)||(r=!1)),h&&e.interactiveChildren&&e.children)for(var l=e.children,u=l.length-1;u>=0;u--){var c=l[u],d=this.recursiveFindHit(t,c,i,r,a);if(d){if(!c.parent)continue;a=!1,d&&(t.target&&(r=!1),o=!0)}}return n&&(r&&!t.target&&!e.hitArea&&e.containsPoint&&e.containsPoint(s)&&(o=!0),e.interactive&&(o&&!t.target&&(t.target=e),i&&i(t,e,!!o))),o},d.prototype.findHit=function(t,e,i,r){this.recursiveFindHit(t,e,i,r,!1)};var p={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return"pointer"===this.cursor},set buttonMode(t){t?this.cursor="pointer":"pointer"===this.cursor&&(this.cursor=null)},cursor:null,get trackedPointers(){return void 0===this._trackedPointers&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0};s.DisplayObject.mixin(p);var f={target:null,data:{global:null}},g=function(t){function e(e,i){t.call(this),i=i||{},this.renderer=e,this.autoPreventDefault=void 0===i.autoPreventDefault||i.autoPreventDefault,this.interactionFrequency=i.interactionFrequency||10,this.mouse=new a,this.mouse.identifier=1,this.mouse.global.set(-999999),this.activeInteractionData={},this.activeInteractionData[1]=this.mouse,this.interactionDataPool=[],this.eventData=new l,this.interactionDOMElement=null,this.moveWhenInside=!1,this.eventsAdded=!1,this.tickerAdded=!1,this.mouseOverRenderer=!1,this.supportsTouchEvents="ontouchstart"in window,this.supportsPointerEvents=!!window.PointerEvent,this.onPointerUp=this.onPointerUp.bind(this),this.processPointerUp=this.processPointerUp.bind(this),this.onPointerCancel=this.onPointerCancel.bind(this),this.processPointerCancel=this.processPointerCancel.bind(this),this.onPointerDown=this.onPointerDown.bind(this),this.processPointerDown=this.processPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.processPointerMove=this.processPointerMove.bind(this),this.onPointerOut=this.onPointerOut.bind(this),this.processPointerOverOut=this.processPointerOverOut.bind(this),this.onPointerOver=this.onPointerOver.bind(this),this.cursorStyles={default:"inherit",pointer:"pointer"},this.currentCursorMode=null,this.cursor=null,this.resolution=1,this.delayedEvents=[],this.search=new d,this._useSystemTicker=void 0===i.useSystemTicker||i.useSystemTicker,this.setTargetElement(this.renderer.view,this.renderer.resolution)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={useSystemTicker:{configurable:!0}};return i.useSystemTicker.get=function(){return this._useSystemTicker},i.useSystemTicker.set=function(t){this._useSystemTicker=t,t?this.addTickerListener():this.removeTickerListener()},e.prototype.hitTest=function(t,e){return f.target=null,f.data.global=t,e||(e=this.renderer._lastObjectRendered),this.processInteractive(f,e,null,!0),f.target},e.prototype.setTargetElement=function(t,e){void 0===e&&(e=1),this.removeTickerListener(),this.removeEvents(),this.interactionDOMElement=t,this.resolution=e,this.addEvents(),this.addTickerListener()},e.prototype.addTickerListener=function(){!this.tickerAdded&&this.interactionDOMElement&&this._useSystemTicker&&(n.Ticker.system.add(this.tickerUpdate,this,n.UPDATE_PRIORITY.INTERACTION),this.tickerAdded=!0)},e.prototype.removeTickerListener=function(){this.tickerAdded&&(n.Ticker.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)},e.prototype.addEvents=function(){!this.eventsAdded&&this.interactionDOMElement&&(window.navigator.msPointerEnabled?(this.interactionDOMElement.style["-ms-content-zooming"]="none",this.interactionDOMElement.style["-ms-touch-action"]="none"):this.supportsPointerEvents&&(this.interactionDOMElement.style["touch-action"]="none"),this.supportsPointerEvents?(window.document.addEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,!0),window.addEventListener("pointercancel",this.onPointerCancel,!0),window.addEventListener("pointerup",this.onPointerUp,!0)):(window.document.addEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,!0),window.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,!0)),this.eventsAdded=!0)},e.prototype.removeEvents=function(){this.eventsAdded&&this.interactionDOMElement&&(window.navigator.msPointerEnabled?(this.interactionDOMElement.style["-ms-content-zooming"]="",this.interactionDOMElement.style["-ms-touch-action"]=""):this.supportsPointerEvents&&(this.interactionDOMElement.style["touch-action"]=""),this.supportsPointerEvents?(window.document.removeEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,!0),window.removeEventListener("pointercancel",this.onPointerCancel,!0),window.removeEventListener("pointerup",this.onPointerUp,!0)):(window.document.removeEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,!0),window.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.interactionDOMElement=null,this.eventsAdded=!1)},e.prototype.tickerUpdate=function(t){this._deltaTime+=t,this._deltaTime<this.interactionFrequency||(this._deltaTime=0,this.update())},e.prototype.update=function(){if(this.interactionDOMElement)if(this.didMove)this.didMove=!1;else{for(var t in this.cursor=null,this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(t)){var e=this.activeInteractionData[t];if(e.originalEvent&&"touch"!==e.pointerType){var i=this.configureInteractionEventForDOMEvent(this.eventData,e.originalEvent,e);this.processInteractive(i,this.renderer._lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},e.prototype.setCursorMode=function(t){if(t=t||"default",this.currentCursorMode!==t){this.currentCursorMode=t;var e=this.cursorStyles[t];if(e)switch(typeof e){case"string":this.interactionDOMElement.style.cursor=e;break;case"function":e(t);break;case"object":Object.assign(this.interactionDOMElement.style,e)}else"string"!=typeof t||Object.prototype.hasOwnProperty.call(this.cursorStyles,t)||(this.interactionDOMElement.style.cursor=t)}},e.prototype.dispatchEvent=function(t,e,i){i.stopPropagationHint&&t!==i.stopsPropagatingAt||(i.currentTarget=t,i.type=e,t.emit(e,i),t[e]&&t[e](i))},e.prototype.delayDispatchEvent=function(t,e,i){this.delayedEvents.push({displayObject:t,eventString:e,eventData:i})},e.prototype.mapPositionToPoint=function(t,e,i){var r;r=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:0,height:0};var n=1/this.resolution;t.x=(e-r.left)*(this.interactionDOMElement.width/r.width)*n,t.y=(i-r.top)*(this.interactionDOMElement.height/r.height)*n},e.prototype.processInteractive=function(t,e,i,r){var n=this.search.findHit(t,e,i,r),s=this.delayedEvents;if(!s.length)return n;t.stopPropagationHint=!1;var o=s.length;this.delayedEvents=[];for(var a=0;a<o;a++){var h=s[a],l=h.displayObject,u=h.eventString,c=h.eventData;c.stopsPropagatingAt===l&&(c.stopPropagationHint=!0),this.dispatchEvent(l,u,c)}return n},e.prototype.onPointerDown=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);if(this.autoPreventDefault&&e[0].isNormalized)(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(var i=e.length,r=0;r<i;r++){var n=e[r],s=this.getInteractionDataForPointerId(n),o=this.configureInteractionEventForDOMEvent(this.eventData,n,s);if(o.data.originalEvent=t,this.processInteractive(o,this.renderer._lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",o),"touch"===n.pointerType)this.emit("touchstart",o);else if("mouse"===n.pointerType||"pen"===n.pointerType){var a=2===n.button;this.emit(a?"rightdown":"mousedown",this.eventData)}}}},e.prototype.processPointerDown=function(t,e,i){var r=t.data,n=t.data.identifier;if(i)if(e.trackedPointers[n]||(e.trackedPointers[n]=new u(n)),this.dispatchEvent(e,"pointerdown",t),"touch"===r.pointerType)this.dispatchEvent(e,"touchstart",t);else if("mouse"===r.pointerType||"pen"===r.pointerType){var s=2===r.button;s?e.trackedPointers[n].rightDown=!0:e.trackedPointers[n].leftDown=!0,this.dispatchEvent(e,s?"rightdown":"mousedown",t)}},e.prototype.onPointerComplete=function(t,e,i){for(var r=this.normalizeToPointerData(t),n=r.length,s=t.target!==this.interactionDOMElement?"outside":"",o=0;o<n;o++){var a=r[o],h=this.getInteractionDataForPointerId(a),l=this.configureInteractionEventForDOMEvent(this.eventData,a,h);if(l.data.originalEvent=t,this.processInteractive(l,this.renderer._lastObjectRendered,i,e||!s),this.emit(e?"pointercancel":"pointerup"+s,l),"mouse"===a.pointerType||"pen"===a.pointerType){var u=2===a.button;this.emit(u?"rightup"+s:"mouseup"+s,l)}else"touch"===a.pointerType&&(this.emit(e?"touchcancel":"touchend"+s,l),this.releaseInteractionDataForPointerId(a.pointerId,h))}},e.prototype.onPointerCancel=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!0,this.processPointerCancel)},e.prototype.processPointerCancel=function(t,e){var i=t.data,r=t.data.identifier;void 0!==e.trackedPointers[r]&&(delete e.trackedPointers[r],this.dispatchEvent(e,"pointercancel",t),"touch"===i.pointerType&&this.dispatchEvent(e,"touchcancel",t))},e.prototype.onPointerUp=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!1,this.processPointerUp)},e.prototype.processPointerUp=function(t,e,i){var r=t.data,n=t.data.identifier,s=e.trackedPointers[n],o="touch"===r.pointerType,a="mouse"===r.pointerType||"pen"===r.pointerType,h=!1;if(a){var l=2===r.button,c=u.FLAGS,d=l?c.RIGHT_DOWN:c.LEFT_DOWN,p=void 0!==s&&s.flags&d;i?(this.dispatchEvent(e,l?"rightup":"mouseup",t),p&&(this.dispatchEvent(e,l?"rightclick":"click",t),h=!0)):p&&this.dispatchEvent(e,l?"rightupoutside":"mouseupoutside",t),s&&(l?s.rightDown=!1:s.leftDown=!1)}i?(this.dispatchEvent(e,"pointerup",t),o&&this.dispatchEvent(e,"touchend",t),s&&(a&&!h||this.dispatchEvent(e,"pointertap",t),o&&(this.dispatchEvent(e,"tap",t),s.over=!1))):s&&(this.dispatchEvent(e,"pointerupoutside",t),o&&this.dispatchEvent(e,"touchendoutside",t)),s&&s.none&&delete e.trackedPointers[n]},e.prototype.onPointerMove=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);"mouse"!==e[0].pointerType&&"pen"!==e[0].pointerType||(this.didMove=!0,this.cursor=null);for(var i=e.length,r=0;r<i;r++){var n=e[r],s=this.getInteractionDataForPointerId(n),o=this.configureInteractionEventForDOMEvent(this.eventData,n,s);o.data.originalEvent=t,this.processInteractive(o,this.renderer._lastObjectRendered,this.processPointerMove,!0),this.emit("pointermove",o),"touch"===n.pointerType&&this.emit("touchmove",o),"mouse"!==n.pointerType&&"pen"!==n.pointerType||this.emit("mousemove",o)}"mouse"===e[0].pointerType&&this.setCursorMode(this.cursor)}},e.prototype.processPointerMove=function(t,e,i){var r=t.data,n="touch"===r.pointerType,s="mouse"===r.pointerType||"pen"===r.pointerType;s&&this.processPointerOverOut(t,e,i),this.moveWhenInside&&!i||(this.dispatchEvent(e,"pointermove",t),n&&this.dispatchEvent(e,"touchmove",t),s&&this.dispatchEvent(e,"mousemove",t))},e.prototype.onPointerOut=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t)[0];"mouse"===e.pointerType&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var i=this.getInteractionDataForPointerId(e),r=this.configureInteractionEventForDOMEvent(this.eventData,e,i);r.data.originalEvent=e,this.processInteractive(r,this.renderer._lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",r),"mouse"===e.pointerType||"pen"===e.pointerType?this.emit("mouseout",r):this.releaseInteractionDataForPointerId(i.identifier)}},e.prototype.processPointerOverOut=function(t,e,i){var r=t.data,n=t.data.identifier,s="mouse"===r.pointerType||"pen"===r.pointerType,o=e.trackedPointers[n];i&&!o&&(o=e.trackedPointers[n]=new u(n)),void 0!==o&&(i&&this.mouseOverRenderer?(o.over||(o.over=!0,this.delayDispatchEvent(e,"pointerover",t),s&&this.delayDispatchEvent(e,"mouseover",t)),s&&null===this.cursor&&(this.cursor=e.cursor)):o.over&&(o.over=!1,this.dispatchEvent(e,"pointerout",this.eventData),s&&this.dispatchEvent(e,"mouseout",t),o.none&&delete e.trackedPointers[n]))},e.prototype.onPointerOver=function(t){var e=this.normalizeToPointerData(t)[0],i=this.getInteractionDataForPointerId(e),r=this.configureInteractionEventForDOMEvent(this.eventData,e,i);r.data.originalEvent=e,"mouse"===e.pointerType&&(this.mouseOverRenderer=!0),this.emit("pointerover",r),"mouse"!==e.pointerType&&"pen"!==e.pointerType||this.emit("mouseover",r)},e.prototype.getInteractionDataForPointerId=function(t){var e,i=t.pointerId;return 1===i||"mouse"===t.pointerType?e=this.mouse:this.activeInteractionData[i]?e=this.activeInteractionData[i]:((e=this.interactionDataPool.pop()||new a).identifier=i,this.activeInteractionData[i]=e),e.copyEvent(t),e},e.prototype.releaseInteractionDataForPointerId=function(t){var e=this.activeInteractionData[t];e&&(delete this.activeInteractionData[t],e.reset(),this.interactionDataPool.push(e))},e.prototype.configureInteractionEventForDOMEvent=function(t,e,i){return t.data=i,this.mapPositionToPoint(i.global,e.clientX,e.clientY),"touch"===e.pointerType&&(e.globalX=i.global.x,e.globalY=i.global.y),i.originalEvent=e,t.reset(),t},e.prototype.normalizeToPointerData=function(t){var e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(var i=0,r=t.changedTouches.length;i<r;i++){var n=t.changedTouches[i];void 0===n.button&&(n.button=t.touches.length?1:0),void 0===n.buttons&&(n.buttons=t.touches.length?1:0),void 0===n.isPrimary&&(n.isPrimary=1===t.touches.length&&"touchstart"===t.type),void 0===n.width&&(n.width=n.radiusX||1),void 0===n.height&&(n.height=n.radiusY||1),void 0===n.tiltX&&(n.tiltX=0),void 0===n.tiltY&&(n.tiltY=0),void 0===n.pointerType&&(n.pointerType="touch"),void 0===n.pointerId&&(n.pointerId=n.identifier||0),void 0===n.pressure&&(n.pressure=n.force||.5),void 0===n.twist&&(n.twist=0),void 0===n.tangentialPressure&&(n.tangentialPressure=0),void 0===n.layerX&&(n.layerX=n.offsetX=n.clientX),void 0===n.layerY&&(n.layerY=n.offsetY=n.clientY),n.isNormalized=!0,e.push(n)}else!(t instanceof MouseEvent)||this.supportsPointerEvents&&t instanceof window.PointerEvent||(void 0===t.isPrimary&&(t.isPrimary=!0),void 0===t.width&&(t.width=1),void 0===t.height&&(t.height=1),void 0===t.tiltX&&(t.tiltX=0),void 0===t.tiltY&&(t.tiltY=0),void 0===t.pointerType&&(t.pointerType="mouse"),void 0===t.pointerId&&(t.pointerId=1),void 0===t.pressure&&(t.pressure=.5),void 0===t.twist&&(t.twist=0),void 0===t.tangentialPressure&&(t.tangentialPressure=0),t.isNormalized=!0),e.push(t);return e},e.prototype.destroy=function(){this.removeEvents(),this.removeTickerListener(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this.search=null},Object.defineProperties(e.prototype,i),e}(o.EventEmitter);i.InteractionData=a,i.InteractionEvent=l,i.InteractionManager=g,i.InteractionTrackingData=u,i.interactiveTarget=p},{"@pixi/display":5,"@pixi/math":16,"@pixi/ticker":33,"@pixi/utils":34}],15:[function(t,e,i){
/*!
 * @pixi/loaders - v5.2.2
 * Compiled Tue, 21 Apr 2020 03:53:51 UTC
 *
 * @pixi/loaders is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=t("resource-loader"),n=t("@pixi/utils"),s=t("@pixi/core"),o=function(){};o.use=function(t,e){t.data&&t.type===r.Resource.TYPE.IMAGE&&(t.texture=s.Texture.fromLoader(t.data,t.url,t.name)),e()};var a=function(t){function e(i,r){var s=this;t.call(this,i,r),n.EventEmitter.call(this);for(var o=0;o<e._plugins.length;++o){var a=e._plugins[o],h=a.pre,l=a.use;h&&this.pre(h),l&&this.use(l)}this.onStart.add((function(t){return s.emit("start",t)})),this.onProgress.add((function(t,e){return s.emit("progress",t,e)})),this.onError.add((function(t,e,i){return s.emit("error",t,e,i)})),this.onLoad.add((function(t,e){return s.emit("load",t,e)})),this.onComplete.add((function(t,e){return s.emit("complete",t,e)})),this._protected=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={shared:{configurable:!0}};return e.prototype.destroy=function(){this._protected||(this.removeAllListeners(),this.reset())},i.shared.get=function(){var t=e._shared;return t||((t=new e)._protected=!0,e._shared=t),t},Object.defineProperties(e,i),e}(r.Loader);Object.assign(a.prototype,n.EventEmitter.prototype),a._plugins=[],a.registerPlugin=function(t){return a._plugins.push(t),t.add&&t.add(),a},a.registerPlugin({use:r.middleware.parsing}),a.registerPlugin(o);var h=function(){};h.init=function(t){t=Object.assign({sharedLoader:!1},t),this.loader=t.sharedLoader?a.shared:new a},h.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)};var l=r.Resource;i.AppLoaderPlugin=h,i.Loader=a,i.LoaderResource=l,i.TextureLoader=o},{"@pixi/core":4,"@pixi/utils":34,"resource-loader":51}],16:[function(t,e,i){
/*!
 * @pixi/math - v5.2.2
 * Compiled Tue, 21 Apr 2020 03:53:51 UTC
 *
 * @pixi/math is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r,n=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},t.prototype.copyTo=function(t){return t.set(this.x,this.y),t},t.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this},t}(),s=function(){function t(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0),this._x=i,this._y=r,this.cb=t,this.scope=e}return t.prototype.clone=function(e,i){return void 0===e&&(e=this.cb),void 0===i&&(i=this.scope),new t(e,i,this._x,this._y)},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope)),this},t.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},t.prototype.copyTo=function(t){return t.set(this._x,this._y),t},t.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),t}(),o=2*Math.PI,a=180/Math.PI,h=Math.PI/180;(r=i.SHAPES||(i.SHAPES={}))[r.POLY=0]="POLY",r[r.RECT=1]="RECT",r[r.CIRC=2]="CIRC",r[r.ELIP=3]="ELIP",r[r.RREC=4]="RREC";var l=function(){function t(t,e,i,r,n,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),this.array=null,this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s}return t.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},t.prototype.set=function(t,e,i,r,n,s){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s,this},t.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i},t.prototype.apply=function(t,e){e=e||new n;var i=t.x,r=t.y;return e.x=this.a*i+this.c*r+this.tx,e.y=this.b*i+this.d*r+this.ty,e},t.prototype.applyInverse=function(t,e){e=e||new n;var i=1/(this.a*this.d+this.c*-this.b),r=t.x,s=t.y;return e.x=this.d*i*r+-this.c*i*s+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*s+-this.b*i*r+(-this.ty*this.a+this.tx*this.b)*i,e},t.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},t.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},t.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),r=this.a,n=this.c,s=this.tx;return this.a=r*e-this.b*i,this.b=r*i+this.b*e,this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=s*e-this.ty*i,this.ty=s*i+this.ty*e,this},t.prototype.append=function(t){var e=this.a,i=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*i+t.d*n,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this},t.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return this.a=Math.cos(o+h)*n,this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(i*this.a+r*this.c),this.ty=e-(i*this.b+r*this.d),this},t.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var i=this.a,r=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},t.prototype.decompose=function(t){var e=this.a,i=this.b,r=this.c,n=this.d,s=-Math.atan2(-r,n),a=Math.atan2(i,e),h=Math.abs(s+a);return h<1e-5||Math.abs(o-h)<1e-5?(t.rotation=a,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=a),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx,t.position.y=this.ty,t},t.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,r=this.d,n=this.tx,s=t*r-e*i;return this.a=r/s,this.b=-e/s,this.c=-i/s,this.d=t/s,this.tx=(i*this.ty-r*n)/s,this.ty=-(t*this.ty-e*n)/s,this},t.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},t.prototype.clone=function(){var e=new t;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},t.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},t.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty(t,"IDENTITY",{get:function(){return new t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"TEMP_MATRIX",{get:function(){return new t},enumerable:!0,configurable:!0}),t}(),u=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],c=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],d=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],p=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],f=[],g=[],m=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];f.push(e);for(var i=0;i<16;i++)for(var r=m(u[t]*u[i]+d[t]*c[i]),n=m(c[t]*u[i]+p[t]*c[i]),s=m(u[t]*d[i]+d[t]*p[i]),o=m(c[t]*d[i]+p[t]*p[i]),a=0;a<16;a++)if(u[a]===r&&c[a]===n&&d[a]===s&&p[a]===o){e.push(a);break}}for(t=0;t<16;t++){var h=new l;h.set(u[t],c[t],d[t],p[t],0,0),g.push(h)}}();var y={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return u[t]},uY:function(t){return c[t]},vX:function(t){return d[t]},vY:function(t){return p[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return f[t][e]},sub:function(t,e){return f[t][y.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t,e){return 2*Math.abs(t)<=Math.abs(e)?e>=0?y.S:y.N:2*Math.abs(e)<=Math.abs(t)?t>0?y.E:y.W:e>0?t>0?y.SE:y.SW:t>0?y.NE:y.NW},matrixAppendRotationInv:function(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0);var n=g[y.inv(e)];n.tx=i,n.ty=r,t.append(n)}},_=function(){function t(){this.worldTransform=new l,this.localTransform=new l,this.position=new s(this.onChange,this,0,0),this.scale=new s(this.onChange,this,1,1),this.pivot=new s(this.onChange,this,0,0),this.skew=new s(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return t.prototype.onChange=function(){this._localID++},t.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},t.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},t.prototype.updateTransform=function(t){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var i=t.worldTransform,r=this.worldTransform;r.a=e.a*i.a+e.b*i.c,r.b=e.a*i.b+e.b*i.d,r.c=e.c*i.a+e.d*i.c,r.d=e.c*i.b+e.d*i.d,r.tx=e.tx*i.a+e.ty*i.c+i.tx,r.ty=e.tx*i.b+e.ty*i.d+i.ty,this._parentID=t._worldID,this._worldID++}},t.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!0,configurable:!0}),t.IDENTITY=new t,t}(),v=function(){function t(t,e,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===n&&(n=0),this.x=Number(t),this.y=Number(e),this.width=Number(r),this.height=Number(n),this.type=i.SHAPES.RECT}return Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EMPTY",{get:function(){return new t(0,0,0,0)},enumerable:!0,configurable:!0}),t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},t.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},t.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height)},t.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},t.prototype.fit=function(t){var e=Math.max(this.x,t.x),i=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=r,this.height=Math.max(n-r,0),this},t.prototype.ceil=function(t,e){void 0===t&&(t=1),void 0===e&&(e=.001);var i=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=r-this.y,this},t.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=r,this.height=n-r,this},t}(),x=function(){function t(t,e,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),this.x=t,this.y=e,this.radius=r,this.type=i.SHAPES.CIRC}return t.prototype.clone=function(){return new t(this.x,this.y,this.radius)},t.prototype.contains=function(t,e){if(this.radius<=0)return!1;var i=this.radius*this.radius,r=this.x-t,n=this.y-e;return(r*=r)+(n*=n)<=i},t.prototype.getBounds=function(){return new v(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},t}(),b=function(){function t(t,e,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===n&&(n=0),this.x=t,this.y=e,this.width=r,this.height=n,this.type=i.SHAPES.ELIP}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var i=(t-this.x)/this.width,r=(e-this.y)/this.height;return(i*=i)+(r*=r)<=1},t.prototype.getBounds=function(){return new v(this.x-this.width,this.y-this.height,this.width,this.height)},t}(),w=function(){function t(){for(var t=arguments,e=[],r=0;r<arguments.length;r++)e[r]=t[r];if(Array.isArray(e[0])&&(e=e[0]),e[0]instanceof n){for(var s=[],o=0,a=(e=e).length;o<a;o++)s.push(e[o].x,e[o].y);e=s}this.points=e,this.type=i.SHAPES.POLY,this.closeStroke=!0}return t.prototype.clone=function(){var e=new t(this.points.slice());return e.closeStroke=this.closeStroke,e},t.prototype.contains=function(t,e){for(var i=!1,r=this.points.length/2,n=0,s=r-1;n<r;s=n++){var o=this.points[2*n],a=this.points[2*n+1],h=this.points[2*s],l=this.points[2*s+1];a>e!=l>e&&t<(e-a)/(l-a)*(h-o)+o&&(i=!i)}return i},t}(),T=function(){function t(t,e,r,n,s){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===n&&(n=0),void 0===s&&(s=20),this.x=t,this.y=e,this.width=r,this.height=n,this.radius=s,this.type=i.SHAPES.RREC}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height,this.radius)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var i=t-(this.x+this.radius),r=e-(this.y+this.radius),n=this.radius*this.radius;if(i*i+r*r<=n)return!0;if((i=t-(this.x+this.width-this.radius))*i+r*r<=n)return!0;if(i*i+(r=e-(this.y+this.height-this.radius))*r<=n)return!0;if((i=t-(this.x+this.radius))*i+r*r<=n)return!0}return!1},t}();i.Circle=x,i.DEG_TO_RAD=h,i.Ellipse=b,i.Matrix=l,i.ObservablePoint=s,i.PI_2=o,i.Point=n,i.Polygon=w,i.RAD_TO_DEG=a,i.Rectangle=v,i.RoundedRectangle=T,i.Transform=_,i.groupD8=y},{}],17:[function(t,e,i){
/*!
 * @pixi/mesh-extras - v5.2.2
 * Compiled Tue, 21 Apr 2020 03:53:51 UTC
 *
 * @pixi/mesh-extras is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=t("@pixi/mesh"),n=t("@pixi/constants"),s=t("@pixi/core"),o=function(t){function e(e,i,r,n){void 0===e&&(e=100),void 0===i&&(i=100),void 0===r&&(r=10),void 0===n&&(n=10),t.call(this),this.segWidth=r,this.segHeight=n,this.width=e,this.height=i,this.build()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.build=function(){for(var t=this.segWidth*this.segHeight,e=[],i=[],r=[],n=this.segWidth-1,s=this.segHeight-1,o=this.width/n,a=this.height/s,h=0;h<t;h++){var l=h%this.segWidth,u=h/this.segWidth|0;e.push(l*o,u*a),i.push(l/n,u/s)}for(var c=n*s,d=0;d<c;d++){var p=d%n,f=d/n|0,g=f*this.segWidth+p,m=f*this.segWidth+p+1,y=(f+1)*this.segWidth+p,_=(f+1)*this.segWidth+p+1;r.push(g,m,y,m,_,y)}this.buffers[0].data=new Float32Array(e),this.buffers[1].data=new Float32Array(i),this.indexBuffer.data=new Uint16Array(r),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()},e}(r.MeshGeometry),a=function(t){function e(e,i,r){void 0===e&&(e=200),void 0===r&&(r=0),t.call(this,new Float32Array(4*i.length),new Float32Array(4*i.length),new Uint16Array(6*(i.length-1))),this.points=i,this.width=e,this.textureScale=r,this.build()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.build=function(){var t=this.points;if(t){var e=this.getBuffer("aVertexPosition"),i=this.getBuffer("aTextureCoord"),r=this.getIndex();if(!(t.length<1)){e.data.length/4!==t.length&&(e.data=new Float32Array(4*t.length),i.data=new Float32Array(4*t.length),r.data=new Uint16Array(6*(t.length-1)));var n=i.data,s=r.data;n[0]=0,n[1]=0,n[2]=0,n[3]=1;for(var o=0,a=t[0],h=this.width*this.textureScale,l=t.length,u=0;u<l;u++){var c=4*u;if(this.textureScale>0){var d=a.x-t[u].x,p=a.y-t[u].y,f=Math.sqrt(d*d+p*p);a=t[u],o+=f/h}else o=u/(l-1);n[c]=o,n[c+1]=0,n[c+2]=o,n[c+3]=1}for(var g=0,m=0;m<l-1;m++){var y=2*m;s[g++]=y,s[g++]=y+1,s[g++]=y+2,s[g++]=y+2,s[g++]=y+1,s[g++]=y+3}i.update(),r.update(),this.updateVertices()}}},e.prototype.updateVertices=function(){var t=this.points;if(!(t.length<1)){for(var e,i=t[0],r=0,n=0,s=this.buffers[0].data,o=t.length,a=0;a<o;a++){var h=t[a],l=4*a;n=-((e=a<t.length-1?t[a+1]:h).x-i.x),r=e.y-i.y;var u=Math.sqrt(r*r+n*n),c=this.textureScale>0?this.textureScale*this.width/2:this.width/2;r/=u,n/=u,r*=c,n*=c,s[l]=h.x+r,s[l+1]=h.y+n,s[l+2]=h.x-r,s[l+3]=h.y-n,i=h}this.buffers[0].update()}},e.prototype.update=function(){this.textureScale>0?this.build():this.updateVertices()},e}(r.MeshGeometry),h=function(t){function e(e,i,s){void 0===s&&(s=0);var o=new a(e.height,i,s),h=new r.MeshMaterial(e);s>0&&(e.baseTexture.wrapMode=n.WRAP_MODES.REPEAT),t.call(this,o,h),this.autoUpdate=!0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._render=function(e){(this.autoUpdate||this.geometry.width!==this.shader.texture.height)&&(this.geometry.width=this.shader.texture.height,this.geometry.update()),t.prototype._render.call(this,e)},e}(r.Mesh),l=function(t){function e(e,i,n){var a=new o(e.width,e.height,i,n),h=new r.MeshMaterial(s.Texture.WHITE);t.call(this,a,h),this.texture=e}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={texture:{configurable:!0}};return e.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID,this.geometry.width=this.shader.texture.width,this.geometry.height=this.shader.texture.height,this.geometry.build()},i.texture.set=function(t){this.shader.texture!==t&&(this.shader.texture=t,this._textureID=-1,t.baseTexture.valid?this.textureUpdated():t.once("update",this.textureUpdated,this))},i.texture.get=function(){return this.shader.texture},e.prototype._render=function(e){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),t.prototype._render.call(this,e)},Object.defineProperties(e.prototype,i),e}(r.Mesh),u=function(t){function e(e,i,n,o,a){void 0===e&&(e=s.Texture.EMPTY);var h=new r.MeshGeometry(i,n,o);h.getBuffer("aVertexPosition").static=!1;var l=new r.MeshMaterial(e);t.call(this,h,l,null,a),this.autoUpdate=!0}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={vertices:{configurable:!0}};return i.vertices.get=function(){return this.geometry.getBuffer("aVertexPosition").data},i.vertices.set=function(t){this.geometry.getBuffer("aVertexPosition").data=t},e.prototype._render=function(e){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),t.prototype._render.call(this,e)},Object.defineProperties(e.prototype,i),e}(r.Mesh),c=function(t){function e(e,i,r,n,o){t.call(this,s.Texture.WHITE,4,4),this._origWidth=e.orig.width,this._origHeight=e.orig.height,this._width=this._origWidth,this._height=this._origHeight,this._leftWidth=void 0!==i?i:10,this._rightWidth=void 0!==n?n:10,this._topHeight=void 0!==r?r:10,this._bottomHeight=void 0!==o?o:10,this.texture=e}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={vertices:{configurable:!0},width:{configurable:!0},height:{configurable:!0},leftWidth:{configurable:!0},rightWidth:{configurable:!0},topHeight:{configurable:!0},bottomHeight:{configurable:!0}};return e.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID,this._refresh()},i.vertices.get=function(){return this.geometry.getBuffer("aVertexPosition").data},i.vertices.set=function(t){this.geometry.getBuffer("aVertexPosition").data=t},e.prototype.updateHorizontalVertices=function(){var t=this.vertices,e=this._getMinScale();t[9]=t[11]=t[13]=t[15]=this._topHeight*e,t[17]=t[19]=t[21]=t[23]=this._height-this._bottomHeight*e,t[25]=t[27]=t[29]=t[31]=this._height},e.prototype.updateVerticalVertices=function(){var t=this.vertices,e=this._getMinScale();t[2]=t[10]=t[18]=t[26]=this._leftWidth*e,t[4]=t[12]=t[20]=t[28]=this._width-this._rightWidth*e,t[6]=t[14]=t[22]=t[30]=this._width},e.prototype._getMinScale=function(){var t=this._leftWidth+this._rightWidth,e=this._width>t?1:this._width/t,i=this._topHeight+this._bottomHeight,r=this._height>i?1:this._height/i;return Math.min(e,r)},i.width.get=function(){return this._width},i.width.set=function(t){this._width=t,this._refresh()},i.height.get=function(){return this._height},i.height.set=function(t){this._height=t,this._refresh()},i.leftWidth.get=function(){return this._leftWidth},i.leftWidth.set=function(t){this._leftWidth=t,this._refresh()},i.rightWidth.get=function(){return this._rightWidth},i.rightWidth.set=function(t){this._rightWidth=t,this._refresh()},i.topHeight.get=function(){return this._topHeight},i.topHeight.set=function(t){this._topHeight=t,this._refresh()},i.bottomHeight.get=function(){return this._bottomHeight},i.bottomHeight.set=function(t){this._bottomHeight=t,this._refresh()},e.prototype._refresh=function(){var t=this.texture,e=this.geometry.buffers[1].data;this._origWidth=t.orig.width,this._origHeight=t.orig.height;var i=1/this._origWidth,r=1/this._origHeight;e[0]=e[8]=e[16]=e[24]=0,e[1]=e[3]=e[5]=e[7]=0,e[6]=e[14]=e[22]=e[30]=1,e[25]=e[27]=e[29]=e[31]=1,e[2]=e[10]=e[18]=e[26]=i*this._leftWidth,e[4]=e[12]=e[20]=e[28]=1-i*this._rightWidth,e[9]=e[11]=e[13]=e[15]=r*this._topHeight,e[17]=e[19]=e[21]=e[23]=1-r*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()},Object.defineProperties(e.prototype,i),e}(l);i.NineSlicePlane=c,i.PlaneGeometry=o,i.RopeGeometry=a,i.SimpleMesh=u,i.SimplePlane=l,i.SimpleRope=h},{"@pixi/constants":3,"@pixi/core":4,"@pixi/mesh":18}],18:[function(t,e,i){
/*!
 * @pixi/mesh - v5.2.2
 * Compiled Tue, 21 Apr 2020 03:53:51 UTC
 *
 * @pixi/mesh is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=t("@pixi/core"),n=t("@pixi/math"),s=t("@pixi/constants"),o=t("@pixi/display"),a=t("@pixi/settings"),h=t("@pixi/utils"),l=function(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0};l.prototype.update=function(t){if(t||this._bufferUpdateId!==this.uvBuffer._updateID||this._textureUpdateId!==this.uvMatrix._updateID){this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;var e=this.uvBuffer.data;this.data&&this.data.length===e.length||(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}};var u=new n.Point,c=new n.Polygon,d=function(t){function e(e,i,n,o){void 0===o&&(o=s.DRAW_MODES.TRIANGLES),t.call(this),this.geometry=e,e.refCount++,this.shader=i,this.state=n||r.State.for2d(),this.drawMode=o,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=0,this._transformID=-1,this.tint=16777215,this.blendMode=s.BLEND_MODES.NORMAL,this._roundPixels=a.settings.ROUND_PIXELS,this.batchUvs=null}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={uvBuffer:{configurable:!0},verticesBuffer:{configurable:!0},material:{configurable:!0},blendMode:{configurable:!0},roundPixels:{configurable:!0},tint:{configurable:!0},texture:{configurable:!0}};return i.uvBuffer.get=function(){return this.geometry.buffers[1]},i.verticesBuffer.get=function(){return this.geometry.buffers[0]},i.material.set=function(t){this.shader=t},i.material.get=function(){return this.shader},i.blendMode.set=function(t){this.state.blendMode=t},i.blendMode.get=function(){return this.state.blendMode},i.roundPixels.set=function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},i.roundPixels.get=function(){return this._roundPixels},i.tint.get=function(){return this.shader.tint},i.tint.set=function(t){this.shader.tint=t},i.texture.get=function(){return this.shader.texture},i.texture.set=function(t){this.shader.texture=t},e.prototype._render=function(t){var i=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===s.DRAW_MODES.TRIANGLES&&i.length<2*e.BATCHABLE_SIZE?this._renderToBatch(t):this._renderDefault(t)},e.prototype._renderDefault=function(t){var e=this.shader;e.alpha=this.worldAlpha,e.update&&e.update(),t.batch.flush(),e.program.uniformData.translationMatrix&&(e.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0)),t.shader.bind(e),t.state.set(this.state),t.geometry.bind(this.geometry,e),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)},e.prototype._renderToBatch=function(t){var e=this.geometry;this.shader.uvMatrix&&(this.shader.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=e.indexBuffer.data,this._tintRGB=this.shader._tintRGB,this._texture=this.shader.texture;var i=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[i]),t.plugins[i].render(this)},e.prototype.calculateVertices=function(){var t=this.geometry,e=t.buffers[0].data;if(t.vertexDirtyId!==this.vertexDirty||this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));for(var i=this.transform.worldTransform,r=i.a,n=i.b,s=i.c,o=i.d,h=i.tx,l=i.ty,u=this.vertexData,c=0;c<u.length/2;c++){var d=e[2*c],p=e[2*c+1];u[2*c]=r*d+s*p+h,u[2*c+1]=n*d+o*p+l}if(this._roundPixels)for(var f=a.settings.RESOLUTION,g=0;g<u.length;++g)u[g]=Math.round((u[g]*f|0)/f);this.vertexDirty=t.vertexDirtyId}},e.prototype.calculateUvs=function(){var t=this.geometry.buffers[1];this.shader.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new l(t,this.shader.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)},e.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)},e.prototype.containsPoint=function(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,u);for(var e=this.geometry.getBuffer("aVertexPosition").data,i=c.points,r=this.geometry.getIndex().data,n=r.length,s=4===this.drawMode?3:1,o=0;o+2<n;o+=s){var a=2*r[o],h=2*r[o+1],l=2*r[o+2];if(i[0]=e[a],i[1]=e[a+1],i[2]=e[h],i[3]=e[h+1],i[4]=e[l],i[5]=e[l+1],c.contains(u.x,u.y))return!0}return!1},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.geometry.refCount--,0===this.geometry.refCount&&this.geometry.dispose(),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null},Object.defineProperties(e.prototype,i),e}(o.Container);d.BATCHABLE_SIZE=100;var p=function(t){function e(e,i){var s={uSampler:e,alpha:1,uTextureMatrix:n.Matrix.IDENTITY,uColor:new Float32Array([1,1,1,1])};(i=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},i)).uniforms&&Object.assign(s,i.uniforms),t.call(this,i.program||r.Program.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTextureMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n"),s),this._colorDirty=!1,this.uvMatrix=new r.TextureMatrix(e),this.batchable=void 0===i.program,this.pluginName=i.pluginName,this.tint=i.tint,this.alpha=i.alpha}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={texture:{configurable:!0},alpha:{configurable:!0},tint:{configurable:!0}};return i.texture.get=function(){return this.uniforms.uSampler},i.texture.set=function(t){this.uniforms.uSampler!==t&&(this.uniforms.uSampler=t,this.uvMatrix.texture=t)},i.alpha.set=function(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)},i.alpha.get=function(){return this._alpha},i.tint.set=function(t){t!==this._tint&&(this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16),this._colorDirty=!0)},i.tint.get=function(){return this._tint},e.prototype.update=function(){if(this._colorDirty){this._colorDirty=!1;var t=this.texture.baseTexture;h.premultiplyTintToRgba(this._tint,this._alpha,this.uniforms.uColor,t.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)},Object.defineProperties(e.prototype,i),e}(r.Shader),f=function(t){function e(e,i,n){t.call(this);var o=new r.Buffer(e),a=new r.Buffer(i,!0),h=new r.Buffer(n,!0,!0);this.addAttribute("aVertexPosition",o,2,!1,s.TYPES.FLOAT).addAttribute("aTextureCoord",a,2,!1,s.TYPES.FLOAT).addIndex(h),this._updateId=-1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={vertexDirtyId:{configurable:!0}};return i.vertexDirtyId.get=function(){return this.buffers[0]._updateID},Object.defineProperties(e.prototype,i),e}(r.Geometry);i.Mesh=d,i.MeshBatchUvs=l,i.MeshGeometry=f,i.MeshMaterial=p},{"@pixi/constants":3,"@pixi/core":4,"@pixi/display":5,"@pixi/math":16,"@pixi/settings":26,"@pixi/utils":34}],19:[function(t,e,i){
/*!
 * @pixi/mixin-cache-as-bitmap - v5.2.2
 * Compiled Tue, 21 Apr 2020 03:53:51 UTC
 *
 * @pixi/mixin-cache-as-bitmap is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
"use strict";var r=t("@pixi/core"),n=t("@pixi/sprite"),s=t("@pixi/display"),o=t("@pixi/math"),a=t("@pixi/utils"),h=t("@pixi/settings"),l=new o.Matrix;s.DisplayObject.prototype._cacheAsBitmap=!1,s.DisplayObject.prototype._cacheData=!1;var u=function(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalHitTest=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.sprite=null};Object.defineProperties(s.DisplayObject.prototype,{cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(t){var e;this._cacheAsBitmap!==t&&(this._cacheAsBitmap=t,t?(this._cacheData||(this._cacheData=new u),(e=this._cacheData).originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):((e=this._cacheData).sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea))}}}),s.DisplayObject.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))},s.DisplayObject.prototype._initCachedDisplayObject=function(t){if(!this._cacheData||!this._cacheData.sprite){var e=this.alpha;this.alpha=1,t.batch.flush();var i=this.getLocalBounds().clone();if(this.filters){var s=this.filters[0].padding;i.pad(s)}i.ceil(h.settings.RESOLUTION);var o=t.renderTexture.current,u=t.renderTexture.sourceFrame.clone(),c=t.projection.transform,d=r.RenderTexture.create(i.width,i.height),p="cacheAsBitmap_"+a.uid();this._cacheData.textureCacheId=p,r.BaseTexture.addToCache(d.baseTexture,p),r.Texture.addToCache(d,p);var f=l;f.tx=-i.x,f.ty=-i.y,this.transform.worldTransform.identity(),this.render=this._cacheData.originalRender,t.render(this,d,!0,f,!0),t.projection.transform=c,t.renderTexture.bind(o,u),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null;var g=new n.Sprite(d);g.transform.worldTransform=this.transform.worldTransform,g.anchor.x=-i.x/i.width,g.anchor.y=-i.y/i.height,g.alpha=e,g._bounds=this._bounds,this._cacheData.sprite=g,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=g.containsPoint.bind(g)}},s.DisplayObject.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))},s.DisplayObject.prototype._initCachedDisplayObjectCanvas=function(t){if(!this._cacheData||!this._cacheData.sprite){var e=this.getLocalBounds(),i=this.alpha;this.alpha=1;var s=t.context,o=t._projTransform;e.ceil(h.settings.RESOLUTION);var u=r.RenderTexture.create(e.width,e.height),c="cacheAsBitmap_"+a.uid();this._cacheData.textureCacheId=c,r.BaseTexture.addToCache(u.baseTexture,c),r.Texture.addToCache(u,c);var d=l;this.transform.localTransform.copyTo(d),d.invert(),d.tx-=e.x,d.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,u,!0,d,!1),t.context=s,t._projTransform=o,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null;var p=new n.Sprite(u);p.transform.worldTransform=this.transform.worldTransform,p.anchor.x=-e.x/e.width,p.anchor.y=-e.y/e.height,p.alpha=i,p._bounds=this._bounds,this._cacheData.sprite=p,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=p.containsPoint.bind(p)}},s.DisplayObject.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._lastBoundsID=this._boundsID},s.DisplayObject.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds()},s.DisplayObject.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,r.BaseTexture.removeFromCache(this._cacheData.textureCacheId),r.Texture.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},s.DisplayObject.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)}},{"@pixi/core":4,"@pixi/display":5,"@pixi/math":16,"@pixi/settings":26,"@pixi/sprite":29,"@pixi/utils":34}],20:[function(t,e,i){
/*!
 * @pixi/mixin-get-child-by-name - v5.2.2
 * Compiled Tue, 21 Apr 2020 03:53:51 UTC
 *
 * @pixi/mixin-get-child-by-name is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
"use strict";var r=t("@pixi/display");r.DisplayObject.prototype.name=null,r.Container.prototype.getChildByName=function(t){for(var e=0;e<this.children.length;e++)if(this.children[e].name===t)return this.children[e];return null}},{"@pixi/display":5}],21:[function(t,e,i){
/*!
 * @pixi/mixin-get-global-position - v5.2.2
 * Compiled Tue, 21 Apr 2020 03:53:51 UTC
 *
 * @pixi/mixin-get-global-position is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
"use strict";var r=t("@pixi/display"),n=t("@pixi/math");r.DisplayObject.prototype.getGlobalPosition=function(t,e){return void 0===t&&(t=new n.Point),void 0===e&&(e=!1),this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t}},{"@pixi/display":5,"@pixi/math":16}],22:[function(t,e,i){
/*!
 * @pixi/particles - v5.2.2
 * Compiled Tue, 21 Apr 2020 03:53:51 UTC
 *
 * @pixi/particles is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=t("@pixi/constants"),n=t("@pixi/utils"),s=t("@pixi/display"),o=t("@pixi/core"),a=t("@pixi/math"),h=function(t){function e(e,i,n,s){void 0===e&&(e=1500),void 0===n&&(n=16384),void 0===s&&(s=!1),t.call(this);n>16384&&(n=16384),this._properties=[!1,!0,!1,!1,!1],this._maxSize=e,this._batchSize=n,this._buffers=null,this._bufferUpdateIDs=[],this._updateID=0,this.interactiveChildren=!1,this.blendMode=r.BLEND_MODES.NORMAL,this.autoResize=s,this.roundPixels=!0,this.baseTexture=null,this.setProperties(i),this._tint=0,this.tintRgb=new Float32Array(4),this.tint=16777215}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={tint:{configurable:!0}};return e.prototype.setProperties=function(t){t&&(this._properties[0]="vertices"in t||"scale"in t?!!t.vertices||!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="tint"in t||"alpha"in t?!!t.tint||!!t.alpha:this._properties[4])},e.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},i.tint.get=function(){return this._tint},i.tint.set=function(t){this._tint=t,n.hex2rgb(t,this.tintRgb)},e.prototype.render=function(t){var e=this;this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",(function(){return e.onChildrenChange(0)}))),t.batch.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))},e.prototype.onChildrenChange=function(t){for(var e=Math.floor(t/this._batchSize);this._bufferUpdateIDs.length<e;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[e]=++this._updateID},e.prototype.dispose=function(){if(this._buffers){for(var t=0;t<this._buffers.length;++t)this._buffers[t].destroy();this._buffers=null}},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null},Object.defineProperties(e.prototype,i),e}(s.Container),l=function(t,e,i){this.geometry=new o.Geometry,this.indexBuffer=null,this.size=i,this.dynamicProperties=[],this.staticProperties=[];for(var n=0;n<t.length;++n){var s=t[n];s={attributeName:s.attributeName,size:s.size,uploadFunction:s.uploadFunction,type:s.type||r.TYPES.FLOAT,offset:s.offset},e[n]?this.dynamicProperties.push(s):this.staticProperties.push(s)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()};l.prototype.initBuffers=function(){var t=this.geometry,e=0;this.indexBuffer=new o.Buffer(n.createIndicesForQuads(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(var i=0;i<this.dynamicProperties.length;++i){var s=this.dynamicProperties[i];s.offset=e,e+=s.size,this.dynamicStride+=s.size}var a=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(a),this.dynamicDataUint32=new Uint32Array(a),this.dynamicBuffer=new o.Buffer(this.dynamicData,!1,!1);var h=0;this.staticStride=0;for(var l=0;l<this.staticProperties.length;++l){var u=this.staticProperties[l];u.offset=h,h+=u.size,this.staticStride+=u.size}var c=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(c),this.staticDataUint32=new Uint32Array(c),this.staticBuffer=new o.Buffer(this.staticData,!0,!1);for(var d=0;d<this.dynamicProperties.length;++d){var p=this.dynamicProperties[d];t.addAttribute(p.attributeName,this.dynamicBuffer,0,p.type===r.TYPES.UNSIGNED_BYTE,p.type,4*this.dynamicStride,4*p.offset)}for(var f=0;f<this.staticProperties.length;++f){var g=this.staticProperties[f];t.addAttribute(g.attributeName,this.staticBuffer,0,g.type===r.TYPES.UNSIGNED_BYTE,g.type,4*this.staticStride,4*g.offset)}},l.prototype.uploadDynamic=function(t,e,i){for(var n=0;n<this.dynamicProperties.length;n++){var s=this.dynamicProperties[n];s.uploadFunction(t,e,i,s.type===r.TYPES.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,s.offset)}this.dynamicBuffer._updateID++},l.prototype.uploadStatic=function(t,e,i){for(var n=0;n<this.staticProperties.length;n++){var s=this.staticProperties[n];s.uploadFunction(t,e,i,s.type===r.TYPES.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,s.offset)}this.staticBuffer._updateID++},l.prototype.destroy=function(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()};var u=function(t){function e(e){t.call(this,e),this.shader=null,this.properties=null,this.tempMatrix=new a.Matrix,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:r.TYPES.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=o.Shader.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nattribute vec2 aPositionCoord;\nattribute float aRotation;\n\nuniform mat3 translationMatrix;\nuniform vec4 uColor;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void){\n    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);\n    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);\n\n    vec2 v = vec2(x, y);\n    v = v + aPositionCoord;\n\n    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vColor = aColor * uColor;\n}\n","varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;\n    gl_FragColor = color;\n}",{}),this.state=o.State.for2d()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.render=function(t){var e=t.children,i=t._maxSize,r=t._batchSize,s=this.renderer,o=e.length;if(0!==o){o>i&&!t.autoResize&&(o=i);var a=t._buffers;a||(a=t._buffers=this.generateBuffers(t));var h=e[0]._texture.baseTexture;this.state.blendMode=n.correctBlendMode(t.blendMode,h.alphaMode),s.state.set(this.state);var l=s.gl,u=t.worldTransform.copyTo(this.tempMatrix);u.prepend(s.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=u.toArray(!0),this.shader.uniforms.uColor=n.premultiplyRgba(t.tintRgb,t.worldAlpha,this.shader.uniforms.uColor,h.alphaMode),this.shader.uniforms.uSampler=h,this.renderer.shader.bind(this.shader);for(var c=!1,d=0,p=0;d<o;d+=r,p+=1){var f=o-d;f>r&&(f=r),p>=a.length&&a.push(this._generateOneMoreBuffer(t));var g=a[p];g.uploadDynamic(e,d,f);var m=t._bufferUpdateIDs[p]||0;(c=c||g._updateID<m)&&(g._updateID=t._updateID,g.uploadStatic(e,d,f)),s.geometry.bind(g.geometry),l.drawElements(l.TRIANGLES,6*f,l.UNSIGNED_SHORT,0)}}},e.prototype.generateBuffers=function(t){for(var e=[],i=t._maxSize,r=t._batchSize,n=t._properties,s=0;s<i;s+=r)e.push(new l(this.properties,n,r));return e},e.prototype._generateOneMoreBuffer=function(t){var e=t._batchSize,i=t._properties;return new l(this.properties,i,e)},e.prototype.uploadVertices=function(t,e,i,r,n,s){for(var o=0,a=0,h=0,l=0,u=0;u<i;++u){var c=t[e+u],d=c._texture,p=c.scale.x,f=c.scale.y,g=d.trim,m=d.orig;g?(o=(a=g.x-c.anchor.x*m.width)+g.width,h=(l=g.y-c.anchor.y*m.height)+g.height):(o=m.width*(1-c.anchor.x),a=m.width*-c.anchor.x,h=m.height*(1-c.anchor.y),l=m.height*-c.anchor.y),r[s]=a*p,r[s+1]=l*f,r[s+n]=o*p,r[s+n+1]=l*f,r[s+2*n]=o*p,r[s+2*n+1]=h*f,r[s+3*n]=a*p,r[s+3*n+1]=h*f,s+=4*n}},e.prototype.uploadPosition=function(t,e,i,r,n,s){for(var o=0;o<i;o++){var a=t[e+o].position;r[s]=a.x,r[s+1]=a.y,r[s+n]=a.x,r[s+n+1]=a.y,r[s+2*n]=a.x,r[s+2*n+1]=a.y,r[s+3*n]=a.x,r[s+3*n+1]=a.y,s+=4*n}},e.prototype.uploadRotation=function(t,e,i,r,n,s){for(var o=0;o<i;o++){var a=t[e+o].rotation;r[s]=a,r[s+n]=a,r[s+2*n]=a,r[s+3*n]=a,s+=4*n}},e.prototype.uploadUvs=function(t,e,i,r,n,s){for(var o=0;o<i;++o){var a=t[e+o]._texture._uvs;a?(r[s]=a.x0,r[s+1]=a.y0,r[s+n]=a.x1,r[s+n+1]=a.y1,r[s+2*n]=a.x2,r[s+2*n+1]=a.y2,r[s+3*n]=a.x3,r[s+3*n+1]=a.y3,s+=4*n):(r[s]=0,r[s+1]=0,r[s+n]=0,r[s+n+1]=0,r[s+2*n]=0,r[s+2*n+1]=0,r[s+3*n]=0,r[s+3*n+1]=0,s+=4*n)}},e.prototype.uploadTint=function(t,e,i,r,s,o){for(var a=0;a<i;++a){var h=t[e+a],l=h._texture.baseTexture.alphaMode>0,u=h.alpha,c=u<1&&l?n.premultiplyTint(h._tintRGB,u):h._tintRGB+(255*u<<24);r[o]=c,r[o+s]=c,r[o+2*s]=c,r[o+3*s]=c,o+=4*s}},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null},e}(o.ObjectRenderer);i.ParticleContainer=h,i.ParticleRenderer=u},{"@pixi/constants":3,"@pixi/core":4,"@pixi/display":5,"@pixi/math":16,"@pixi/utils":34}],23:[function(t,e,i){(function(e){
/*!
 * @pixi/polyfill - v5.2.2
 * Compiled Tue, 21 Apr 2020 03:53:51 UTC
 *
 * @pixi/polyfill is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
"use strict";var i,r=t("es6-promise-polyfill"),n=(i=t("object-assign"))&&"object"==typeof i&&"default"in i?i.default:i;window.Promise||(window.Promise=r.Polyfill),Object.assign||(Object.assign=n);var s="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{};if(Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),!s.performance||!s.performance.now){var o=Date.now();s.performance||(s.performance={}),s.performance.now=function(){return Date.now()-o}}for(var a=Date.now(),h=["ms","moz","webkit","o"],l=0;l<h.length&&!s.requestAnimationFrame;++l){var u=h[l];s.requestAnimationFrame=s[u+"RequestAnimationFrame"],s.cancelAnimationFrame=s[u+"CancelAnimationFrame"]||s[u+"CancelRequestAnimationFrame"]}s.requestAnimationFrame||(s.requestAnimationFrame=function(t){if("function"!=typeof t)throw new TypeError(t+"is not a function");var e=Date.now(),i=16+a-e;return i<0&&(i=0),a=e,setTimeout((function(){a=Date.now(),t(performance.now())}),i)}),s.cancelAnimationFrame||(s.cancelAnimationFrame=function(t){return clearTimeout(t)}),Math.sign||(Math.sign=function(t){return 0===(t=Number(t))||isNaN(t)?t:t>0?1:-1}),Number.isInteger||(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),window.ArrayBuffer||(window.ArrayBuffer=Array),window.Float32Array||(window.Float32Array=Array),window.Uint32Array||(window.Uint32Array=Array),window.Uint16Array||(window.Uint16Array=Array),window.Uint8Array||(window.Uint8Array=Array),window.Int32Array||(window.Int32Array=Array)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"es6-promise-polyfill":36,"object-assign":41}],24:[function(t,e,i){
/*!
 * @pixi/prepare - v5.2.2
 * Compiled Tue, 21 Apr 2020 03:53:51 UTC
 *
 * @pixi/prepare is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=t("@pixi/settings"),n=t("@pixi/core"),s=t("@pixi/graphics"),o=t("@pixi/ticker"),a=t("@pixi/display"),h=t("@pixi/text");r.settings.UPLOADS_PER_FRAME=4;var l=function(t){this.maxItemsPerFrame=t,this.itemsLeft=0};l.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},l.prototype.allowedToUpload=function(){return this.itemsLeft-- >0};var u=function(t){var e=this;this.limiter=new l(r.settings.UPLOADS_PER_FRAME),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){e.queue&&e.prepareItems()},this.registerFindHook(m),this.registerFindHook(y),this.registerFindHook(c),this.registerFindHook(d),this.registerFindHook(p),this.registerUploadHook(f),this.registerUploadHook(g)};function c(t,e){var i=!1;if(t&&t._textures&&t._textures.length)for(var r=0;r<t._textures.length;r++)if(t._textures[r]instanceof n.Texture){var s=t._textures[r].baseTexture;-1===e.indexOf(s)&&(e.push(s),i=!0)}return i}function d(t,e){if(t.baseTexture instanceof n.BaseTexture){var i=t.baseTexture;return-1===e.indexOf(i)&&e.push(i),!0}return!1}function p(t,e){if(t._texture&&t._texture instanceof n.Texture){var i=t._texture.baseTexture;return-1===e.indexOf(i)&&e.push(i),!0}return!1}function f(t,e){return e instanceof h.Text&&(e.updateText(!0),!0)}function g(t,e){if(e instanceof h.TextStyle){var i=e.toFontString();return h.TextMetrics.measureFont(i),!0}return!1}function m(t,e){if(t instanceof h.Text){-1===e.indexOf(t.style)&&e.push(t.style),-1===e.indexOf(t)&&e.push(t);var i=t._texture.baseTexture;return-1===e.indexOf(i)&&e.push(i),!0}return!1}function y(t,e){return t instanceof h.TextStyle&&(-1===e.indexOf(t)&&e.push(t),!0)}u.prototype.upload=function(t,e){"function"==typeof t&&(e=t,t=null),t&&this.add(t),this.queue.length?(e&&this.completes.push(e),this.ticking||(this.ticking=!0,o.Ticker.system.addOnce(this.tick,this,o.UPDATE_PRIORITY.UTILITY))):e&&e()},u.prototype.tick=function(){setTimeout(this.delayedTick,0)},u.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var t=this.queue[0],e=!1;if(t&&!t._destroyed)for(var i=0,r=this.uploadHooks.length;i<r;i++)if(this.uploadHooks[i](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}e||this.queue.shift()}if(this.queue.length)o.Ticker.system.addOnce(this.tick,this,o.UPDATE_PRIORITY.UTILITY);else{this.ticking=!1;var n=this.completes.slice(0);this.completes.length=0;for(var s=0,a=n.length;s<a;s++)n[s]()}},u.prototype.registerFindHook=function(t){return t&&this.addHooks.push(t),this},u.prototype.registerUploadHook=function(t){return t&&this.uploadHooks.push(t),this},u.prototype.add=function(t){for(var e=0,i=this.addHooks.length;e<i&&!this.addHooks[e](t,this.queue);e++);if(t instanceof a.Container)for(var r=t.children.length-1;r>=0;r--)this.add(t.children[r]);return this},u.prototype.destroy=function(){this.ticking&&o.Ticker.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null};var _=function(t){function e(e){t.call(this,e),this.uploadHookHelper=this.renderer,this.registerFindHook(b),this.registerUploadHook(v),this.registerUploadHook(x)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(u);function v(t,e){return e instanceof n.BaseTexture&&(e._glTextures[t.CONTEXT_UID]||t.texture.bind(e),!0)}function x(t,e){if(!(e instanceof s.Graphics))return!1;var i=e.geometry;e.finishPoly(),i.updateBatches();for(var r=i.batches,n=0;n<r.length;n++){var o=r[n].style.texture;o&&v(t,o.baseTexture)}return i.batchable||t.geometry.bind(i,e._resolveDirectShader(t)),!0}function b(t,e){return t instanceof s.Graphics&&(e.push(t),!0)}var w=function(t){this.maxMilliseconds=t,this.frameStart=0};w.prototype.beginFrame=function(){this.frameStart=Date.now()},w.prototype.allowedToUpload=function(){return Date.now()-this.frameStart<this.maxMilliseconds},i.BasePrepare=u,i.CountLimiter=l,i.Prepare=_,i.TimeLimiter=w},{"@pixi/core":4,"@pixi/display":5,"@pixi/graphics":13,"@pixi/settings":26,"@pixi/text":32,"@pixi/ticker":33}],25:[function(t,e,i){
/*!
 * @pixi/runner - v5.2.2
 * Compiled Tue, 21 Apr 2020 03:53:51 UTC
 *
 * @pixi/runner is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function t(t){this.items=[],this._name=t,this._aliasCount=0}return t.prototype.emit=function(t,e,i,r,n,s,o,a){if(arguments.length>8)throw new Error("max arguments reached");var h=this,l=h.name,u=h.items;this._aliasCount++;for(var c=0,d=u.length;c<d;c++)u[c][l](t,e,i,r,n,s,o,a);return u===this.items&&this._aliasCount--,this},t.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},t.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},t.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},t.prototype.contains=function(t){return-1!==this.items.indexOf(t)},t.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},t.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),t}();Object.defineProperties(r.prototype,{dispatch:{value:r.prototype.emit},run:{value:r.prototype.emit}}),i.Runner=r},{}],26:[function(t,e,i){
/*!
 * @pixi/settings - v5.2.2
 * Compiled Tue, 21 Apr 2020 03:53:51 UTC
 *
 * @pixi/settings is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r,n=((r=t("ismobilejs"))&&"object"==typeof r&&"default"in r?r.default:r)(window.navigator);var s={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(t){var e=!0;if(n.tablet||n.phone){if(e=!1,n.apple.device){var i=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(i)parseInt(i[1],10)>=11&&(e=!0)}if(n.android.device){var r=navigator.userAgent.match(/Android\s([0-9.]*)/);if(r)parseInt(r[1],10)>=7&&(e=!0)}}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:n.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:!n.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};i.isMobile=n,i.settings=s},{ismobilejs:38}],27:[function(t,e,i){
/*!
 * @pixi/sprite-animated - v5.2.2
 * Compiled Tue, 21 Apr 2020 03:53:51 UTC
 *
 * @pixi/sprite-animated is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=t("@pixi/core"),n=t("@pixi/sprite"),s=t("@pixi/ticker"),o=function(t){function e(e,i){t.call(this,e[0]instanceof r.Texture?e[0]:e[0].texture),this._textures=null,this._durations=null,this._autoUpdate=!1!==i,this._isConnectedToTicker=!1,this.animationSpeed=1,this.loop=!0,this.updateAnchor=!1,this.onComplete=null,this.onFrameChange=null,this.onLoop=null,this._currentTime=0,this._playing=!1,this._previousFrame=null,this.textures=e}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={totalFrames:{configurable:!0},textures:{configurable:!0},currentFrame:{configurable:!0},playing:{configurable:!0},autoUpdate:{configurable:!0}};return e.prototype.stop=function(){this.playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(s.Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1))},e.prototype.play=function(){this.playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(s.Ticker.shared.add(this.update,this,s.UPDATE_PRIORITY.HIGH),this._isConnectedToTicker=!0))},e.prototype.gotoAndStop=function(t){this.stop();var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture()},e.prototype.gotoAndPlay=function(t){var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture(),this.play()},e.prototype.update=function(t){var e=this.animationSpeed*t,i=this.currentFrame;if(null!==this._durations){var r=this._currentTime%1*this._durations[this.currentFrame];for(r+=e/60*1e3;r<0;)this._currentTime--,r+=this._durations[this.currentFrame];var n=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);r>=this._durations[this.currentFrame];)r-=this._durations[this.currentFrame]*n,this._currentTime+=n;this._currentTime+=r/this._durations[this.currentFrame]}else this._currentTime+=e;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):i!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<i||this.animationSpeed<0&&this.currentFrame>i)&&this.onLoop(),this.updateTexture())},e.prototype.updateTexture=function(){var t=this.currentFrame;this._previousFrame!==t&&(this._previousFrame=t,this._texture=this._textures[t],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))},e.prototype.destroy=function(e){this.stop(),t.prototype.destroy.call(this,e),this.onComplete=null,this.onFrameChange=null,this.onLoop=null},e.fromFrames=function(t){for(var i=[],n=0;n<t.length;++n)i.push(r.Texture.from(t[n]));return new e(i)},e.fromImages=function(t){for(var i=[],n=0;n<t.length;++n)i.push(r.Texture.from(t[n]));return new e(i)},i.totalFrames.get=function(){return this._textures.length},i.textures.get=function(){return this._textures},i.textures.set=function(t){if(t[0]instanceof r.Texture)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(var e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()},i.currentFrame.get=function(){var t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t},i.playing.get=function(){return this._playing},i.autoUpdate.get=function(){return this._autoUpdate},i.autoUpdate.set=function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(s.Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(s.Ticker.shared.add(this.update,this),this._isConnectedToTicker=!0))},Object.defineProperties(e.prototype,i),e}(n.Sprite);i.AnimatedSprite=o},{"@pixi/core":4,"@pixi/sprite":29,"@pixi/ticker":33}],28:[function(t,e,i){
/*!
 * @pixi/sprite-tiling - v5.2.2
 * Compiled Tue, 21 Apr 2020 03:53:51 UTC
 *
 * @pixi/sprite-tiling is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=t("@pixi/core"),n=t("@pixi/math"),s=t("@pixi/utils"),o=t("@pixi/sprite"),a=t("@pixi/constants"),h=new n.Point,l=function(t){function e(e,i,s){void 0===i&&(i=100),void 0===s&&(s=100),t.call(this,e),this.tileTransform=new n.Transform,this._width=i,this._height=s,this._canvasPattern=null,this.uvMatrix=e.uvMatrix||new r.TextureMatrix(e),this.pluginName="tilingSprite",this.uvRespectAnchor=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={clampMargin:{configurable:!0},tileScale:{configurable:!0},tilePosition:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return i.clampMargin.get=function(){return this.uvMatrix.clampMargin},i.clampMargin.set=function(t){this.uvMatrix.clampMargin=t,this.uvMatrix.update(!0)},i.tileScale.get=function(){return this.tileTransform.scale},i.tileScale.set=function(t){this.tileTransform.scale.copyFrom(t)},i.tilePosition.get=function(){return this.tileTransform.position},i.tilePosition.set=function(t){this.tileTransform.position.copyFrom(t)},e.prototype._onTextureUpdate=function(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215},e.prototype._render=function(t){var e=this._texture;e&&e.valid&&(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))},e.prototype._calculateBounds=function(){var t=this._width*-this._anchor._x,e=this._height*-this._anchor._y,i=this._width*(1-this._anchor._x),r=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,t,e,i,r)},e.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new n.Rectangle),e=this._localBoundsRect),this._bounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,h);var e=this._width,i=this._height,r=-e*this.anchor._x;if(h.x>=r&&h.x<r+e){var n=-i*this.anchor._y;if(h.y>=n&&h.y<n+i)return!0}return!1},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.tileTransform=null,this.uvMatrix=null},e.from=function(t,i,n){return new e(r.Texture.from(t),i,n)},e.fromFrame=function(t,i,r){var n=s.TextureCache[t];if(!n)throw new Error('The frameId "'+t+'" does not exist in the texture cache '+this);return new e(n,i,r)},e.fromImage=function(t,i,n,s){return s&&"object"!=typeof s&&(s={scaleMode:arguments[4],resourceOptions:{crossorigin:arguments[3]}}),new e(r.Texture.from(t,s),i,n)},i.width.get=function(){return this._width},i.width.set=function(t){this._width=t},i.height.get=function(){return this._height},i.height.set=function(t){this._height=t},Object.defineProperties(e.prototype,i),e}(o.Sprite),u="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n",c=new n.Matrix,d=function(t){function e(e){t.call(this,e);var i={globals:this.renderer.globalUniforms};this.shader=r.Shader.from(u,"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord - floor(vTextureCoord - uClampOffset);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 texSample = texture2D(uSampler, coord);\n    gl_FragColor = texSample * uColor;\n}\n",i),this.simpleShader=r.Shader.from(u,"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 sample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = sample * uColor;\n}\n",i),this.quad=new r.QuadUv,this.state=r.State.for2d()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.render=function(t){var e=this.renderer,i=this.quad,r=i.vertices;r[0]=r[6]=t._width*-t.anchor.x,r[1]=r[3]=t._height*-t.anchor.y,r[2]=r[4]=t._width*(1-t.anchor.x),r[5]=r[7]=t._height*(1-t.anchor.y),t.uvRespectAnchor&&((r=i.uvs)[0]=r[6]=-t.anchor.x,r[1]=r[3]=-t.anchor.y,r[2]=r[4]=1-t.anchor.x,r[5]=r[7]=1-t.anchor.y),i.invalidate();var n=t._texture,o=n.baseTexture,h=t.tileTransform.localTransform,l=t.uvMatrix,u=o.isPowerOfTwo&&n.frame.width===o.width&&n.frame.height===o.height;u&&(o._glTextures[e.CONTEXT_UID]?u=o.wrapMode!==a.WRAP_MODES.CLAMP:o.wrapMode===a.WRAP_MODES.CLAMP&&(o.wrapMode=a.WRAP_MODES.REPEAT));var d=u?this.simpleShader:this.shader,p=n.width,f=n.height,g=t._width,m=t._height;c.set(h.a*p/g,h.b*p/m,h.c*f/g,h.d*f/m,h.tx/g,h.ty/m),c.invert(),u?c.prepend(l.mapCoord):(d.uniforms.uMapCoord=l.mapCoord.toArray(!0),d.uniforms.uClampFrame=l.uClampFrame,d.uniforms.uClampOffset=l.uClampOffset),d.uniforms.uTransform=c.toArray(!0),d.uniforms.uColor=s.premultiplyTintToRgba(t.tint,t.worldAlpha,d.uniforms.uColor,o.alphaMode),d.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),d.uniforms.uSampler=n,e.shader.bind(d),e.geometry.bind(i),this.state.blendMode=s.correctBlendMode(t.blendMode,o.alphaMode),e.state.set(this.state),e.geometry.draw(this.renderer.gl.TRIANGLES,6,0)},e}(r.ObjectRenderer);i.TilingSprite=l,i.TilingSpriteRenderer=d},{"@pixi/constants":3,"@pixi/core":4,"@pixi/math":16,"@pixi/sprite":29,"@pixi/utils":34}],29:[function(t,e,i){
/*!
 * @pixi/sprite - v5.2.2
 * Compiled Tue, 21 Apr 2020 03:53:51 UTC
 *
 * @pixi/sprite is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=t("@pixi/math"),n=t("@pixi/utils"),s=t("@pixi/core"),o=t("@pixi/constants"),a=t("@pixi/display"),h=t("@pixi/settings"),l=new r.Point,u=new Uint16Array([0,1,2,0,2,3]),c=function(t){function e(e){t.call(this),this._anchor=new r.ObservablePoint(this._onAnchorUpdate,this,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tint=null,this._tintRGB=null,this.tint=16777215,this.blendMode=o.BLEND_MODES.NORMAL,this.shader=null,this._cachedTint=16777215,this.uvs=null,this.texture=e||s.Texture.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=u,this.pluginName="batch",this.isSprite=!0,this._roundPixels=h.settings.ROUND_PIXELS}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={roundPixels:{configurable:!0},width:{configurable:!0},height:{configurable:!0},anchor:{configurable:!0},tint:{configurable:!0},texture:{configurable:!0}};return e.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=n.sign(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=n.sign(this.scale.y)*this._height/this._texture.orig.height)},e.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},e.prototype.calculateVertices=function(){var t=this._texture;if(this._transformID!==this.transform._worldID||this._textureID!==t._updateID){this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;var e=this.transform.worldTransform,i=e.a,r=e.b,n=e.c,s=e.d,o=e.tx,a=e.ty,l=this.vertexData,u=t.trim,c=t.orig,d=this._anchor,p=0,f=0,g=0,m=0;if(u?(p=(f=u.x-d._x*c.width)+u.width,g=(m=u.y-d._y*c.height)+u.height):(p=(f=-d._x*c.width)+c.width,g=(m=-d._y*c.height)+c.height),l[0]=i*f+n*m+o,l[1]=s*m+r*f+a,l[2]=i*p+n*m+o,l[3]=s*m+r*p+a,l[4]=i*p+n*g+o,l[5]=s*g+r*p+a,l[6]=i*f+n*g+o,l[7]=s*g+r*f+a,this._roundPixels)for(var y=h.settings.RESOLUTION,_=0;_<l.length;++_)l[_]=Math.round((l[_]*y|0)/y)}},e.prototype.calculateTrimmedVertices=function(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var t=this._texture,e=this.vertexTrimmedData,i=t.orig,r=this._anchor,n=this.transform.worldTransform,s=n.a,o=n.b,a=n.c,h=n.d,l=n.tx,u=n.ty,c=-r._x*i.width,d=c+i.width,p=-r._y*i.height,f=p+i.height;e[0]=s*c+a*p+l,e[1]=h*p+o*c+u,e[2]=s*d+a*p+l,e[3]=h*p+o*d+u,e[4]=s*d+a*f+l,e[5]=h*f+o*d+u,e[6]=s*c+a*f+l,e[7]=h*f+o*c+u},e.prototype._render=function(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},e.prototype._calculateBounds=function(){var t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},e.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._bounds.minX=this._texture.orig.width*-this._anchor._x,this._bounds.minY=this._texture.orig.height*-this._anchor._y,this._bounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._bounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new r.Rectangle),e=this._localBoundsRect),this._bounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,l);var e=this._texture.orig.width,i=this._texture.orig.height,r=-e*this.anchor.x,n=0;return l.x>=r&&l.x<r+e&&(n=-i*this.anchor.y,l.y>=n&&l.y<n+i)},e.prototype.destroy=function(e){if(t.prototype.destroy.call(this,e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,"boolean"==typeof e?e:e&&e.texture){var i="boolean"==typeof e?e:e&&e.baseTexture;this._texture.destroy(!!i)}this._texture=null,this.shader=null},e.from=function(t,i){return new e(t instanceof s.Texture?t:s.Texture.from(t,i))},i.roundPixels.set=function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},i.roundPixels.get=function(){return this._roundPixels},i.width.get=function(){return Math.abs(this.scale.x)*this._texture.orig.width},i.width.set=function(t){var e=n.sign(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},i.height.get=function(){return Math.abs(this.scale.y)*this._texture.orig.height},i.height.set=function(t){var e=n.sign(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},i.anchor.get=function(){return this._anchor},i.anchor.set=function(t){this._anchor.copyFrom(t)},i.tint.get=function(){return this._tint},i.tint.set=function(t){this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16)},i.texture.get=function(){return this._texture},i.texture.set=function(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||s.Texture.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))},Object.defineProperties(e.prototype,i),e}(a.Container);i.Sprite=c},{"@pixi/constants":3,"@pixi/core":4,"@pixi/display":5,"@pixi/math":16,"@pixi/settings":26,"@pixi/utils":34}],30:[function(t,e,i){
/*!
 * @pixi/spritesheet - v5.2.2
 * Compiled Tue, 21 Apr 2020 03:53:51 UTC
 *
 * @pixi/spritesheet is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=t("@pixi/math"),n=t("@pixi/core"),s=t("@pixi/utils"),o=t("@pixi/loaders"),a=function(t,e,i){void 0===i&&(i=null),this.baseTexture=t,this.textures={},this.animations={},this.data=e,this.resolution=this._updateResolution(i||(this.baseTexture.resource?this.baseTexture.resource.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null},h={BATCH_SIZE:{configurable:!0}};h.BATCH_SIZE.get=function(){return 1e3},a.prototype._updateResolution=function(t){var e=this.data.meta.scale,i=s.getResolutionOfUrl(t,null);return null===i&&(i=void 0!==e?parseFloat(e):1),1!==i&&this.baseTexture.setResolution(i),i},a.prototype.parse=function(t){this._batchIndex=0,this._callback=t,this._frameKeys.length<=a.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()},a.prototype._processFrames=function(t){for(var e=t,i=a.BATCH_SIZE;e-t<i&&e<this._frameKeys.length;){var s=this._frameKeys[e],o=this._frames[s],h=o.frame;if(h){var l=null,u=null,c=!1!==o.trimmed&&o.sourceSize?o.sourceSize:o.frame,d=new r.Rectangle(0,0,Math.floor(c.w)/this.resolution,Math.floor(c.h)/this.resolution);l=o.rotated?new r.Rectangle(Math.floor(h.x)/this.resolution,Math.floor(h.y)/this.resolution,Math.floor(h.h)/this.resolution,Math.floor(h.w)/this.resolution):new r.Rectangle(Math.floor(h.x)/this.resolution,Math.floor(h.y)/this.resolution,Math.floor(h.w)/this.resolution,Math.floor(h.h)/this.resolution),!1!==o.trimmed&&o.spriteSourceSize&&(u=new r.Rectangle(Math.floor(o.spriteSourceSize.x)/this.resolution,Math.floor(o.spriteSourceSize.y)/this.resolution,Math.floor(h.w)/this.resolution,Math.floor(h.h)/this.resolution)),this.textures[s]=new n.Texture(this.baseTexture,l,d,u,o.rotated?2:0,o.anchor),n.Texture.addToCache(this.textures[s],s)}e++}},a.prototype._processAnimations=function(){var t=this.data.animations||{};for(var e in t){this.animations[e]=[];for(var i=0;i<t[e].length;i++){var r=t[e][i];this.animations[e].push(this.textures[r])}}},a.prototype._parseComplete=function(){var t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)},a.prototype._nextBatch=function(){var t=this;this._processFrames(this._batchIndex*a.BATCH_SIZE),this._batchIndex++,setTimeout((function(){t._batchIndex*a.BATCH_SIZE<t._frameKeys.length?t._nextBatch():(t._processAnimations(),t._parseComplete())}),0)},a.prototype.destroy=function(t){for(var e in void 0===t&&(t=!1),this.textures)this.textures[e].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&this.baseTexture.destroy(),this.baseTexture=null},Object.defineProperties(a,h);var l=function(){};l.use=function(t,e){var i=t.name+"_image";if(t.data&&t.type===o.LoaderResource.TYPE.JSON&&t.data.frames&&!this.resources[i]){var r={crossOrigin:t.crossOrigin,metadata:t.metadata.imageMetadata,parentResource:t},n=l.getResourcePath(t,this.baseUrl);this.add(i,n,r,(function(i){if(i.error)e(i.error);else{var r=i.texture.baseTexture;i.texture.destroy();var n=new a(r,t.data,t.url);n.parse((function(){t.spritesheet=n,t.textures=n.textures,e()}))}}))}else e()},l.getResourcePath=function(t,e){return t.isDataUrl?t.data.meta.image:s.url.resolve(t.url.replace(e,""),t.data.meta.image)},i.Spritesheet=a,i.SpritesheetLoader=l},{"@pixi/core":4,"@pixi/loaders":15,"@pixi/math":16,"@pixi/utils":34}],31:[function(t,e,i){
/*!
 * @pixi/text-bitmap - v5.2.2
 * Compiled Tue, 21 Apr 2020 03:53:51 UTC
 *
 * @pixi/text-bitmap is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=t("@pixi/core"),n=t("@pixi/display"),s=t("@pixi/math"),o=t("@pixi/settings"),a=t("@pixi/sprite"),h=t("@pixi/utils"),l=t("@pixi/loaders"),u=function(t){function e(e,i){var r=this;void 0===i&&(i={}),t.call(this),this._textWidth=0,this._textHeight=0,this._glyphs=[],this._font={tint:void 0!==i.tint?i.tint:16777215,align:i.align||"left",name:null,size:0},this.font=i.font,this._text=e,this._maxWidth=0,this._maxLineHeight=0,this._letterSpacing=0,this._anchor=new s.ObservablePoint((function(){r.dirty=!0}),this,0,0),this.dirty=!1,this.roundPixels=o.settings.ROUND_PIXELS,this.updateText()}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={tint:{configurable:!0},align:{configurable:!0},anchor:{configurable:!0},font:{configurable:!0},text:{configurable:!0},maxWidth:{configurable:!0},maxLineHeight:{configurable:!0},textWidth:{configurable:!0},letterSpacing:{configurable:!0},textHeight:{configurable:!0}};return e.prototype.updateText=function(){for(var t=e.fonts[this._font.name],i=this._font.size/t.size,r=new s.Point,n=[],o=[],l=this._text.replace(/(?:\r\n|\r)/g,"\n")||" ",u=l.length,c=this._maxWidth*t.size/this._font.size,d=null,p=0,f=0,g=0,m=-1,y=0,_=0,v=0,x=0;x<u;x++){var b=l.charCodeAt(x),w=l.charAt(x);if(/(?:\s)/.test(w)&&(m=x,y=p),"\r"!==w&&"\n"!==w){var T=t.chars[b];T&&(d&&T.kerning[d]&&(r.x+=T.kerning[d]),n.push({texture:T.texture,line:g,charCode:b,position:new s.Point(r.x+T.xOffset+this._letterSpacing/2,r.y+T.yOffset)}),r.x+=T.xAdvance+this._letterSpacing,p=r.x,v=Math.max(v,T.yOffset+T.texture.height),d=b,-1!==m&&c>0&&r.x>c&&(++_,h.removeItems(n,1+m-_,1+x-m),x=m,m=-1,o.push(y),f=Math.max(f,y),g++,r.x=0,r.y+=t.lineHeight,d=null))}else o.push(p),f=Math.max(f,p),++g,++_,r.x=0,r.y+=t.lineHeight,d=null}var E=l.charAt(l.length-1);"\r"!==E&&"\n"!==E&&(/(?:\s)/.test(E)&&(p=y),o.push(p),f=Math.max(f,p));for(var S=[],P=0;P<=g;P++){var O=0;"right"===this._font.align?O=f-o[P]:"center"===this._font.align&&(O=(f-o[P])/2),S.push(O)}for(var C=n.length,I=this.tint,M=0;M<C;M++){var A=this._glyphs[M];A?A.texture=n[M].texture:((A=new a.Sprite(n[M].texture)).roundPixels=this.roundPixels,this._glyphs.push(A)),A.position.x=(n[M].position.x+S[n[M].line])*i,A.position.y=n[M].position.y*i,A.scale.x=A.scale.y=i,A.tint=I,A.parent||this.addChild(A)}for(var R=C;R<this._glyphs.length;++R)this.removeChild(this._glyphs[R]);if(this._textWidth=f*i,this._textHeight=(r.y+t.lineHeight)*i,0!==this.anchor.x||0!==this.anchor.y)for(var D=0;D<C;D++)this._glyphs[D].x-=this._textWidth*this.anchor.x,this._glyphs[D].y-=this._textHeight*this.anchor.y;this._maxLineHeight=v*i},e.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},e.prototype.getLocalBounds=function(){return this.validate(),t.prototype.getLocalBounds.call(this)},e.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},i.tint.get=function(){return this._font.tint},i.tint.set=function(t){this._font.tint="number"==typeof t&&t>=0?t:16777215,this.dirty=!0},i.align.get=function(){return this._font.align},i.align.set=function(t){this._font.align=t||"left",this.dirty=!0},i.anchor.get=function(){return this._anchor},i.anchor.set=function(t){"number"==typeof t?this._anchor.set(t):this._anchor.copyFrom(t)},i.font.get=function(){return this._font},i.font.set=function(t){t&&("string"==typeof t?(t=t.split(" "),this._font.name=1===t.length?t[0]:t.slice(1).join(" "),this._font.size=t.length>=2?parseInt(t[0],10):e.fonts[this._font.name].size):(this._font.name=t.name,this._font.size="number"==typeof t.size?t.size:parseInt(t.size,10)),this.dirty=!0)},i.text.get=function(){return this._text},i.text.set=function(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)},i.maxWidth.get=function(){return this._maxWidth},i.maxWidth.set=function(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)},i.maxLineHeight.get=function(){return this.validate(),this._maxLineHeight},i.textWidth.get=function(){return this.validate(),this._textWidth},i.letterSpacing.get=function(){return this._letterSpacing},i.letterSpacing.set=function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)},i.textHeight.get=function(){return this.validate(),this._textHeight},e.registerFont=function(t,i){var n={},o=t.getElementsByTagName("info")[0],a=t.getElementsByTagName("common")[0],l=t.getElementsByTagName("page"),u=h.getResolutionOfUrl(l[0].getAttribute("file")),c={};n.font=o.getAttribute("face"),n.size=parseInt(o.getAttribute("size"),10),n.lineHeight=parseInt(a.getAttribute("lineHeight"),10)/u,n.chars={},i instanceof r.Texture&&(i=[i]);for(var d=0;d<l.length;d++){var p=l[d].getAttribute("id"),f=l[d].getAttribute("file");c[p]=i instanceof Array?i[d]:i[f]}for(var g=t.getElementsByTagName("char"),m=0;m<g.length;m++){var y=g[m],_=parseInt(y.getAttribute("id"),10),v=y.getAttribute("page")||0,x=new s.Rectangle(parseInt(y.getAttribute("x"),10)/u+c[v].frame.x/u,parseInt(y.getAttribute("y"),10)/u+c[v].frame.y/u,parseInt(y.getAttribute("width"),10)/u,parseInt(y.getAttribute("height"),10)/u);n.chars[_]={xOffset:parseInt(y.getAttribute("xoffset"),10)/u,yOffset:parseInt(y.getAttribute("yoffset"),10)/u,xAdvance:parseInt(y.getAttribute("xadvance"),10)/u,kerning:{},texture:new r.Texture(c[v].baseTexture,x),page:v}}for(var b=t.getElementsByTagName("kerning"),w=0;w<b.length;w++){var T=b[w],E=parseInt(T.getAttribute("first"),10)/u,S=parseInt(T.getAttribute("second"),10)/u,P=parseInt(T.getAttribute("amount"),10)/u;n.chars[S]&&(n.chars[S].kerning[E]=P)}return e.fonts[n.font]=n,n},Object.defineProperties(e.prototype,i),e}(n.Container);u.fonts={};var c=function(){};c.parse=function(t,e){t.bitmapFont=u.registerFont(t.data,e)},c.add=function(){l.LoaderResource.setExtensionXhrType("fnt",l.LoaderResource.XHR_RESPONSE_TYPE.DOCUMENT)},c.dirname=function(t){var e=t.replace(/\\/g,"/").replace(/\/$/,"").replace(/\/[^\/]*$/,"");return e===t?".":""===e?"/":e},c.use=function(t,e){if(t.data&&t.type===l.LoaderResource.TYPE.XML)if(0!==t.data.getElementsByTagName("page").length&&0!==t.data.getElementsByTagName("info").length&&null!==t.data.getElementsByTagName("info")[0].getAttribute("face")){var i=t.isDataUrl?"":c.dirname(t.url);t.isDataUrl&&("."===i&&(i=""),this.baseUrl&&i&&"/"===this.baseUrl.charAt(this.baseUrl.length-1)&&(i+="/")),(i=i.replace(this.baseUrl,""))&&"/"!==i.charAt(i.length-1)&&(i+="/");for(var r=t.data.getElementsByTagName("page"),n={},s=function(i){n[i.metadata.pageFile]=i.texture,Object.keys(n).length===r.length&&(c.parse(t,n),e())},o=0;o<r.length;++o){var a=r[o].getAttribute("file"),h=i+a,u=!1;for(var d in this.resources){var p=this.resources[d];if(p.url===h){p.metadata.pageFile=a,p.texture?s(p):p.onAfterMiddleware.add(s),u=!0;break}}if(!u){var f={crossOrigin:t.crossOrigin,loadType:l.LoaderResource.LOAD_TYPE.IMAGE,metadata:Object.assign({pageFile:a},t.metadata.imageMetadata),parentResource:t};this.add(h,f,s)}}}else e();else e()},i.BitmapFontLoader=c,i.BitmapText=u},{"@pixi/core":4,"@pixi/display":5,"@pixi/loaders":15,"@pixi/math":16,"@pixi/settings":26,"@pixi/sprite":29,"@pixi/utils":34}],32:[function(t,e,i){
/*!
 * @pixi/text - v5.2.2
 * Compiled Tue, 21 Apr 2020 03:53:51 UTC
 *
 * @pixi/text is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=t("@pixi/sprite"),n=t("@pixi/core"),s=t("@pixi/settings"),o=t("@pixi/math"),a=t("@pixi/utils"),h={LINEAR_VERTICAL:0,LINEAR_HORIZONTAL:1},l={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:h.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},u=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],c=function(t){this.styleID=0,this.reset(),g(this,t,t)},d={align:{configurable:!0},breakWords:{configurable:!0},dropShadow:{configurable:!0},dropShadowAlpha:{configurable:!0},dropShadowAngle:{configurable:!0},dropShadowBlur:{configurable:!0},dropShadowColor:{configurable:!0},dropShadowDistance:{configurable:!0},fill:{configurable:!0},fillGradientType:{configurable:!0},fillGradientStops:{configurable:!0},fontFamily:{configurable:!0},fontSize:{configurable:!0},fontStyle:{configurable:!0},fontVariant:{configurable:!0},fontWeight:{configurable:!0},letterSpacing:{configurable:!0},lineHeight:{configurable:!0},leading:{configurable:!0},lineJoin:{configurable:!0},miterLimit:{configurable:!0},padding:{configurable:!0},stroke:{configurable:!0},strokeThickness:{configurable:!0},textBaseline:{configurable:!0},trim:{configurable:!0},whiteSpace:{configurable:!0},wordWrap:{configurable:!0},wordWrapWidth:{configurable:!0}};function p(t){return"number"==typeof t?a.hex2string(t):("string"==typeof t&&0===t.indexOf("0x")&&(t=t.replace("0x","#")),t)}function f(t){if(Array.isArray(t)){for(var e=0;e<t.length;++e)t[e]=p(t[e]);return t}return p(t)}function g(t,e,i){for(var r in i)Array.isArray(e[r])?t[r]=e[r].slice():t[r]=e[r]}c.prototype.clone=function(){var t={};return g(t,this,l),new c(t)},c.prototype.reset=function(){g(this,l,l)},d.align.get=function(){return this._align},d.align.set=function(t){this._align!==t&&(this._align=t,this.styleID++)},d.breakWords.get=function(){return this._breakWords},d.breakWords.set=function(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)},d.dropShadow.get=function(){return this._dropShadow},d.dropShadow.set=function(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)},d.dropShadowAlpha.get=function(){return this._dropShadowAlpha},d.dropShadowAlpha.set=function(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)},d.dropShadowAngle.get=function(){return this._dropShadowAngle},d.dropShadowAngle.set=function(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)},d.dropShadowBlur.get=function(){return this._dropShadowBlur},d.dropShadowBlur.set=function(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)},d.dropShadowColor.get=function(){return this._dropShadowColor},d.dropShadowColor.set=function(t){var e=f(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)},d.dropShadowDistance.get=function(){return this._dropShadowDistance},d.dropShadowDistance.set=function(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)},d.fill.get=function(){return this._fill},d.fill.set=function(t){var e=f(t);this._fill!==e&&(this._fill=e,this.styleID++)},d.fillGradientType.get=function(){return this._fillGradientType},d.fillGradientType.set=function(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)},d.fillGradientStops.get=function(){return this._fillGradientStops},d.fillGradientStops.set=function(t){(function(t,e){if(!Array.isArray(t)||!Array.isArray(e))return!1;if(t.length!==e.length)return!1;for(var i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0})(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)},d.fontFamily.get=function(){return this._fontFamily},d.fontFamily.set=function(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)},d.fontSize.get=function(){return this._fontSize},d.fontSize.set=function(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)},d.fontStyle.get=function(){return this._fontStyle},d.fontStyle.set=function(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)},d.fontVariant.get=function(){return this._fontVariant},d.fontVariant.set=function(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)},d.fontWeight.get=function(){return this._fontWeight},d.fontWeight.set=function(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)},d.letterSpacing.get=function(){return this._letterSpacing},d.letterSpacing.set=function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)},d.lineHeight.get=function(){return this._lineHeight},d.lineHeight.set=function(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)},d.leading.get=function(){return this._leading},d.leading.set=function(t){this._leading!==t&&(this._leading=t,this.styleID++)},d.lineJoin.get=function(){return this._lineJoin},d.lineJoin.set=function(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)},d.miterLimit.get=function(){return this._miterLimit},d.miterLimit.set=function(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)},d.padding.get=function(){return this._padding},d.padding.set=function(t){this._padding!==t&&(this._padding=t,this.styleID++)},d.stroke.get=function(){return this._stroke},d.stroke.set=function(t){var e=f(t);this._stroke!==e&&(this._stroke=e,this.styleID++)},d.strokeThickness.get=function(){return this._strokeThickness},d.strokeThickness.set=function(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)},d.textBaseline.get=function(){return this._textBaseline},d.textBaseline.set=function(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)},d.trim.get=function(){return this._trim},d.trim.set=function(t){this._trim!==t&&(this._trim=t,this.styleID++)},d.whiteSpace.get=function(){return this._whiteSpace},d.whiteSpace.set=function(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)},d.wordWrap.get=function(){return this._wordWrap},d.wordWrap.set=function(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)},d.wordWrapWidth.get=function(){return this._wordWrapWidth},d.wordWrapWidth.set=function(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)},c.prototype.toFontString=function(){var t="number"==typeof this.fontSize?this.fontSize+"px":this.fontSize,e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(var i=e.length-1;i>=0;i--){var r=e[i].trim();!/([\"\'])[^\'\"]+\1/.test(r)&&u.indexOf(r)<0&&(r='"'+r+'"'),e[i]=r}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+t+" "+e.join(",")},Object.defineProperties(c.prototype,d);var m=function(t,e,i,r,n,s,o,a,h){this.text=t,this.style=e,this.width=i,this.height=r,this.lines=n,this.lineWidths=s,this.lineHeight=o,this.maxLineWidth=a,this.fontProperties=h};m.measureText=function(t,e,i,r){void 0===r&&(r=m._canvas),i=null==i?e.wordWrap:i;var n=e.toFontString(),s=m.measureFont(n);0===s.fontSize&&(s.fontSize=e.fontSize,s.ascent=e.fontSize);var o=r.getContext("2d");o.font=n;for(var a=(i?m.wordWrap(t,e,r):t).split(/(?:\r\n|\r|\n)/),h=new Array(a.length),l=0,u=0;u<a.length;u++){var c=o.measureText(a[u]).width+(a[u].length-1)*e.letterSpacing;h[u]=c,l=Math.max(l,c)}var d=l+e.strokeThickness;e.dropShadow&&(d+=e.dropShadowDistance);var p=e.lineHeight||s.fontSize+e.strokeThickness,f=Math.max(p,s.fontSize+e.strokeThickness)+(a.length-1)*(p+e.leading);return e.dropShadow&&(f+=e.dropShadowDistance),new m(t,e,d,f,a,h,p+e.leading,l,s)},m.wordWrap=function(t,e,i){void 0===i&&(i=m._canvas);for(var r=i.getContext("2d"),n=0,s="",o="",a={},h=e.letterSpacing,l=e.whiteSpace,u=m.collapseSpaces(l),c=m.collapseNewlines(l),d=!u,p=e.wordWrapWidth+h,f=m.tokenize(t),g=0;g<f.length;g++){var y=f[g];if(m.isNewline(y)){if(!c){o+=m.addLine(s),d=!u,s="",n=0;continue}y=" "}if(u){var _=m.isBreakingSpace(y),v=m.isBreakingSpace(s[s.length-1]);if(_&&v)continue}var x=m.getFromCache(y,h,a,r);if(x>p)if(""!==s&&(o+=m.addLine(s),s="",n=0),m.canBreakWords(y,e.breakWords))for(var b=m.wordWrapSplit(y),w=0;w<b.length;w++){for(var T=b[w],E=1;b[w+E];){var S=b[w+E],P=T[T.length-1];if(m.canBreakChars(P,S,y,w,e.breakWords))break;T+=S,E++}w+=T.length-1;var O=m.getFromCache(T,h,a,r);O+n>p&&(o+=m.addLine(s),d=!1,s="",n=0),s+=T,n+=O}else{s.length>0&&(o+=m.addLine(s),s="",n=0);var C=g===f.length-1;o+=m.addLine(y,!C),d=!1,s="",n=0}else x+n>p&&(d=!1,o+=m.addLine(s),s="",n=0),(s.length>0||!m.isBreakingSpace(y)||d)&&(s+=y,n+=x)}return o+=m.addLine(s,!1)},m.addLine=function(t,e){return void 0===e&&(e=!0),t=m.trimRight(t),t=e?t+"\n":t},m.getFromCache=function(t,e,i,r){var n=i[t];if(void 0===n){var s=t.length*e;n=r.measureText(t).width+s,i[t]=n}return n},m.collapseSpaces=function(t){return"normal"===t||"pre-line"===t},m.collapseNewlines=function(t){return"normal"===t},m.trimRight=function(t){if("string"!=typeof t)return"";for(var e=t.length-1;e>=0;e--){var i=t[e];if(!m.isBreakingSpace(i))break;t=t.slice(0,-1)}return t},m.isNewline=function(t){return"string"==typeof t&&m._newlines.indexOf(t.charCodeAt(0))>=0},m.isBreakingSpace=function(t){return"string"==typeof t&&m._breakingSpaces.indexOf(t.charCodeAt(0))>=0},m.tokenize=function(t){var e=[],i="";if("string"!=typeof t)return e;for(var r=0;r<t.length;r++){var n=t[r];m.isBreakingSpace(n)||m.isNewline(n)?(""!==i&&(e.push(i),i=""),e.push(n)):i+=n}return""!==i&&e.push(i),e},m.canBreakWords=function(t,e){return e},m.canBreakChars=function(t,e,i,r,n){return!0},m.wordWrapSplit=function(t){return t.split("")},m.measureFont=function(t){if(m._fonts[t])return m._fonts[t];var e={},i=m._canvas,r=m._context;r.font=t;var n=m.METRICS_STRING+m.BASELINE_SYMBOL,s=Math.ceil(r.measureText(n).width),o=Math.ceil(r.measureText(m.BASELINE_SYMBOL).width),a=2*o;o=o*m.BASELINE_MULTIPLIER|0,i.width=s,i.height=a,r.fillStyle="#f00",r.fillRect(0,0,s,a),r.font=t,r.textBaseline="alphabetic",r.fillStyle="#000",r.fillText(n,0,o);var h=r.getImageData(0,0,s,a).data,l=h.length,u=4*s,c=0,d=0,p=!1;for(c=0;c<o;++c){for(var f=0;f<u;f+=4)if(255!==h[d+f]){p=!0;break}if(p)break;d+=u}for(e.ascent=o-c,d=l-u,p=!1,c=a;c>o;--c){for(var g=0;g<u;g+=4)if(255!==h[d+g]){p=!0;break}if(p)break;d-=u}return e.descent=c-o,e.fontSize=e.ascent+e.descent,m._fonts[t]=e,e},m.clearMetrics=function(t){void 0===t&&(t=""),t?delete m._fonts[t]:m._fonts={}};var y=function(){try{var t=new OffscreenCanvas(0,0),e=t.getContext("2d");return e&&e.measureText?t:document.createElement("canvas")}catch(t){return document.createElement("canvas")}}();y.width=y.height=10,m._canvas=y,m._context=y.getContext("2d"),m._fonts={},m.METRICS_STRING="|ÉqÅ",m.BASELINE_SYMBOL="M",m.BASELINE_MULTIPLIER=1.4,m._newlines=[10,13],m._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var _={texture:!0,children:!1,baseTexture:!0},v=function(t){function e(e,i,r){var a=!1;r||(r=document.createElement("canvas"),a=!0),r.width=3,r.height=3;var h=n.Texture.from(r);h.orig=new o.Rectangle,h.trim=new o.Rectangle,t.call(this,h),this._ownCanvas=a,this.canvas=r,this.context=this.canvas.getContext("2d"),this._resolution=s.settings.RESOLUTION,this._autoResolution=!0,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=e,this.style=i,this.localStyleID=-1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={width:{configurable:!0},height:{configurable:!0},style:{configurable:!0},text:{configurable:!0},resolution:{configurable:!0}};return e.prototype.updateText=function(t){var e=this._style;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),this.dirty||!t){this._font=this._style.toFontString();var i,r,n=this.context,s=m.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),o=s.width,h=s.height,l=s.lines,u=s.lineHeight,c=s.lineWidths,d=s.maxLineWidth,p=s.fontProperties;this.canvas.width=Math.ceil((Math.max(1,o)+2*e.padding)*this._resolution),this.canvas.height=Math.ceil((Math.max(1,h)+2*e.padding)*this._resolution),n.scale(this._resolution,this._resolution),n.clearRect(0,0,this.canvas.width,this.canvas.height),n.font=this._font,n.lineWidth=e.strokeThickness,n.textBaseline=e.textBaseline,n.lineJoin=e.lineJoin,n.miterLimit=e.miterLimit;for(var f=e.dropShadow?2:1,g=0;g<f;++g){var y=e.dropShadow&&0===g,_=y?2*h:0,v=_*this.resolution;if(y){n.fillStyle="black",n.strokeStyle="black";var x=e.dropShadowColor,b=a.hex2rgb("number"==typeof x?x:a.string2hex(x));n.shadowColor="rgba("+255*b[0]+","+255*b[1]+","+255*b[2]+","+e.dropShadowAlpha+")",n.shadowBlur=e.dropShadowBlur,n.shadowOffsetX=Math.cos(e.dropShadowAngle)*e.dropShadowDistance,n.shadowOffsetY=Math.sin(e.dropShadowAngle)*e.dropShadowDistance+v}else n.fillStyle=this._generateFillStyle(e,l,s),n.strokeStyle=e.stroke,n.shadowColor=0,n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0;for(var w=0;w<l.length;w++)i=e.strokeThickness/2,r=e.strokeThickness/2+w*u+p.ascent,"right"===e.align?i+=d-c[w]:"center"===e.align&&(i+=(d-c[w])/2),e.stroke&&e.strokeThickness&&this.drawLetterSpacing(l[w],i+e.padding,r+e.padding-_,!0),e.fill&&this.drawLetterSpacing(l[w],i+e.padding,r+e.padding-_)}this.updateTexture()}},e.prototype.drawLetterSpacing=function(t,e,i,r){void 0===r&&(r=!1);var n=this._style.letterSpacing;if(0!==n)for(var s=e,o=Array.from?Array.from(t):t.split(""),a=this.context.measureText(t).width,h=0,l=0;l<o.length;++l){var u=o[l];r?this.context.strokeText(u,s,i):this.context.fillText(u,s,i),s+=a-(h=this.context.measureText(t.substring(l+1)).width)+n,a=h}else r?this.context.strokeText(t,e,i):this.context.fillText(t,e,i)},e.prototype.updateTexture=function(){var t=this.canvas;if(this._style.trim){var e=a.trimCanvas(t);e.data&&(t.width=e.width,t.height=e.height,this.context.putImageData(e.data,0,0))}var i=this._texture,r=this._style,n=r.trim?0:r.padding,s=i.baseTexture;i.trim.width=i._frame.width=Math.ceil(t.width/this._resolution),i.trim.height=i._frame.height=Math.ceil(t.height/this._resolution),i.trim.x=-n,i.trim.y=-n,i.orig.width=i._frame.width-2*n,i.orig.height=i._frame.height-2*n,this._onTextureUpdate(),s.setRealSize(t.width,t.height,this._resolution),this.dirty=!1},e.prototype._render=function(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),t.prototype._render.call(this,e)},e.prototype.getLocalBounds=function(e){return this.updateText(!0),t.prototype.getLocalBounds.call(this,e)},e.prototype._calculateBounds=function(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)},e.prototype._onStyleChange=function(){this.dirty=!0},e.prototype._generateFillStyle=function(t,e,i){if(!Array.isArray(t.fill))return t.fill;if(1===t.fill.length)return t.fill[0];var r,n=t.dropShadow?t.dropShadowDistance:0,s=t.padding||0,o=Math.ceil(this.canvas.width/this._resolution)-n-2*s,a=Math.ceil(this.canvas.height/this._resolution)-n-2*s,l=t.fill.slice(),u=t.fillGradientStops.slice();if(!u.length)for(var c=l.length+1,d=1;d<c;++d)u.push(d/c);if(l.unshift(t.fill[0]),u.unshift(0),l.push(t.fill[t.fill.length-1]),u.push(1),t.fillGradientType===h.LINEAR_VERTICAL){r=this.context.createLinearGradient(o/2,s,o/2,a+s);for(var p=0,f=(i.fontProperties.fontSize+t.strokeThickness)/a,g=0;g<e.length;g++)for(var m=i.lineHeight*g,y=0;y<l.length;y++){var _=m/a+("number"==typeof u[y]?u[y]:y/l.length)*f,v=Math.max(p,_);v=Math.min(v,1),r.addColorStop(v,l[y]),p=v}}else{r=this.context.createLinearGradient(s,a/2,o+s,a/2);for(var x=l.length+1,b=1,w=0;w<l.length;w++){var T=void 0;T="number"==typeof u[w]?u[w]:b/x,r.addColorStop(T,l[w]),b++}}return r},e.prototype.destroy=function(e){"boolean"==typeof e&&(e={children:e}),e=Object.assign({},_,e),t.prototype.destroy.call(this,e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null},i.width.get=function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},i.width.set=function(t){this.updateText(!0);var e=a.sign(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},i.height.get=function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},i.height.set=function(t){this.updateText(!0);var e=a.sign(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},i.style.get=function(){return this._style},i.style.set=function(t){t=t||{},this._style=t instanceof c?t:new c(t),this.localStyleID=-1,this.dirty=!0},i.text.get=function(){return this._text},i.text.set=function(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)},i.resolution.get=function(){return this._resolution},i.resolution.set=function(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)},Object.defineProperties(e.prototype,i),e}(r.Sprite);i.TEXT_GRADIENT=h,i.Text=v,i.TextMetrics=m,i.TextStyle=c},{"@pixi/core":4,"@pixi/math":16,"@pixi/settings":26,"@pixi/sprite":29,"@pixi/utils":34}],33:[function(t,e,i){
/*!
 * @pixi/ticker - v5.2.2
 * Compiled Tue, 21 Apr 2020 03:53:51 UTC
 *
 * @pixi/ticker is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r,n=t("@pixi/settings");n.settings.TARGET_FPMS=.06,(r=i.UPDATE_PRIORITY||(i.UPDATE_PRIORITY={}))[r.INTERACTION=50]="INTERACTION",r[r.HIGH=25]="HIGH",r[r.NORMAL=0]="NORMAL",r[r.LOW=-25]="LOW",r[r.UTILITY=-50]="UTILITY";var s=function(){function t(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=0),void 0===r&&(r=!1),this.fn=t,this.context=e,this.priority=i,this.once=r,this.next=null,this.previous=null,this._destroyed=!1}return t.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},t.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},t.prototype.connect=function(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this},t.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},t}(),o=function(){function t(){var t=this;this._head=new s(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/n.settings.TARGET_FPMS,this.elapsedMS=1/n.settings.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&null===t._requestId&&t._head.next&&(t._requestId=requestAnimationFrame(t._tick)))}}return t.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},t.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},t.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},t.prototype.add=function(t,e,r){return void 0===r&&(r=i.UPDATE_PRIORITY.NORMAL),this._addListener(new s(t,e,r))},t.prototype.addOnce=function(t,e,r){return void 0===r&&(r=i.UPDATE_PRIORITY.NORMAL),this._addListener(new s(t,e,r,!0))},t.prototype._addListener=function(t){var e=this._head.next,i=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(i);break}i=e,e=e.next}t.previous||t.connect(i)}else t.connect(i);return this._startIfPossible(),this},t.prototype.remove=function(t,e){for(var i=this._head.next;i;)i=i.match(t,e)?i.destroy():i.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(t.prototype,"count",{get:function(){if(!this._head)return 0;for(var t=0,e=this._head;e=e.next;)t++;return t},enumerable:!0,configurable:!0}),t.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},t.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},t.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},t.prototype.update=function(t){var e;if(void 0===t&&(t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var i=t-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=t-i%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*n.settings.TARGET_FPMS;for(var r=this._head,s=r.next;s;)s=s.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(t.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,n.settings.TARGET_FPMS);this._maxElapsedMS=1/i},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"shared",{get:function(){if(!t._shared){var e=t._shared=new t;e.autoStart=!0,e._protected=!0}return t._shared},enumerable:!0,configurable:!0}),Object.defineProperty(t,"system",{get:function(){if(!t._system){var e=t._system=new t;e.autoStart=!0,e._protected=!0}return t._system},enumerable:!0,configurable:!0}),t}(),a=function(){function t(){}return t.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set:function(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,i.UPDATE_PRIORITY.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?o.shared:new o,t.autoStart&&this.start()},t.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}},t}();i.Ticker=o,i.TickerPlugin=a},{"@pixi/settings":26}],34:[function(t,e,i){
/*!
 * @pixi/utils - v5.2.2
 * Compiled Tue, 21 Apr 2020 03:53:51 UTC
 *
 * @pixi/utils is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
"use strict";function r(t){return t&&"object"==typeof t&&"default"in t?t.default:t}Object.defineProperty(i,"__esModule",{value:!0});var n=t("@pixi/settings"),s=r(t("eventemitter3")),o=r(t("earcut")),a=t("url"),h=r(a),l=t("@pixi/constants");n.settings.RETINA_PREFIX=/@([0-9\.]+)x/,n.settings.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0;var u,c=!1;var d=function(){for(var t=[],e=[],i=0;i<32;i++)t[i]=i,e[i]=i;t[l.BLEND_MODES.NORMAL_NPM]=l.BLEND_MODES.NORMAL,t[l.BLEND_MODES.ADD_NPM]=l.BLEND_MODES.ADD,t[l.BLEND_MODES.SCREEN_NPM]=l.BLEND_MODES.SCREEN,e[l.BLEND_MODES.NORMAL]=l.BLEND_MODES.NORMAL_NPM,e[l.BLEND_MODES.ADD]=l.BLEND_MODES.ADD_NPM,e[l.BLEND_MODES.SCREEN]=l.BLEND_MODES.SCREEN_NPM;var r=[];return r.push(e),r.push(t),r}();function p(t){if(4===t.BYTES_PER_ELEMENT)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array";return null}var f={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};var g=0;var m={};var y=Object.create(null),_=Object.create(null);var v=function(){function t(t,e,i){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=i||n.settings.RESOLUTION,this.resize(t,e)}return t.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},t.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(t.prototype,"width",{get:function(){return this.canvas.width},set:function(t){this.canvas.width=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.canvas.height},set:function(t){this.canvas.height=t},enumerable:!0,configurable:!0}),t}();var x,b=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;Object.defineProperty(i,"isMobile",{enumerable:!0,get:function(){return n.isMobile}}),i.EventEmitter=s,i.earcut=o,i.url=h,i.BaseTextureCache=_,i.CanvasRenderTarget=v,i.DATA_URI=b,i.ProgramCache={},i.TextureCache=y,i.clearTextureCache=function(){var t;for(t in y)delete y[t];for(t in _)delete _[t]},i.correctBlendMode=function(t,e){return d[e?1:0][t]},i.createIndicesForQuads=function(t,e){void 0===e&&(e=null);var i=6*t;if((e=e||new Uint16Array(i)).length!==i)throw new Error("Out buffer length is incorrect, got "+e.length+" and expected "+i);for(var r=0,n=0;r<i;r+=6,n+=4)e[r+0]=n+0,e[r+1]=n+1,e[r+2]=n+2,e[r+3]=n+0,e[r+4]=n+2,e[r+5]=n+3;return e},i.decomposeDataUri=function(t){var e=b.exec(t);if(e)return{mediaType:e[1]?e[1].toLowerCase():void 0,subType:e[2]?e[2].toLowerCase():void 0,charset:e[3]?e[3].toLowerCase():void 0,encoding:e[4]?e[4].toLowerCase():void 0,data:e[5]}},i.deprecation=function(t,e,i){if(void 0===i&&(i=3),!m[e]){var r=(new Error).stack;void 0===r?console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t):(r=r.split("\n").splice(i).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",e+"\nDeprecated since v"+t),console.warn(r),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t),console.warn(r))),m[e]=!0}},i.destroyTextureCache=function(){var t;for(t in y)y[t].destroy();for(t in _)_[t].destroy()},i.determineCrossOrigin=function(t,e){if(void 0===e&&(e=window.location),0===t.indexOf("data:"))return"";e=e||window.location,x||(x=document.createElement("a")),x.href=t;var i=a.parse(x.href),r=!i.port&&""===e.port||i.port===e.port;return i.hostname===e.hostname&&r&&i.protocol===e.protocol?"":"anonymous"},i.getBufferType=p,i.getResolutionOfUrl=function(t,e){var i=n.settings.RETINA_PREFIX.exec(t);return i?parseFloat(i[1]):void 0!==e?e:1},i.hex2rgb=function(t,e){return(e=e||[])[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e},i.hex2string=function(t){var e=t.toString(16);return"#"+(e="000000".substr(0,6-e.length)+e)},i.interleaveTypedArrays=function(t,e){for(var i=0,r=0,n={},s=0;s<t.length;s++)r+=e[s],i+=t[s].length;var o=new ArrayBuffer(4*i),a=null,h=0;for(s=0;s<t.length;s++){var l=e[s],u=t[s],c=p(u);n[c]||(n[c]=new f[c](o)),a=n[c];for(var d=0;d<u.length;d++){a[(d/l|0)*r+h+d%l]=u[d]}h+=l}return new Float32Array(o)},i.isPow2=function(t){return!(t&t-1||!t)},i.isWebGLSupported=function(){return void 0===u&&(u=function(){var t={stencil:!0,failIfMajorPerformanceCaveat:n.settings.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!window.WebGLRenderingContext)return!1;var e=document.createElement("canvas"),i=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),r=!(!i||!i.getContextAttributes().stencil);if(i){var s=i.getExtension("WEBGL_lose_context");s&&s.loseContext()}return i=null,r}catch(t){return!1}}()),u},i.log2=function(t){var e=(t>65535?1:0)<<4,i=((t>>>=e)>255?1:0)<<3;return e|=i,e|=i=((t>>>=i)>15?1:0)<<2,(e|=i=((t>>>=i)>3?1:0)<<1)|(t>>>=i)>>1},i.nextPow2=function(t){return t+=0===t?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1},i.premultiplyBlendMode=d,i.premultiplyRgba=function(t,e,i,r){return i=i||new Float32Array(4),r||void 0===r?(i[0]=t[0]*e,i[1]=t[1]*e,i[2]=t[2]*e):(i[0]=t[0],i[1]=t[1],i[2]=t[2]),i[3]=e,i},i.premultiplyTint=function(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var i=t>>16&255,r=t>>8&255,n=255&t;return(255*e<<24)+((i=i*e+.5|0)<<16)+((r=r*e+.5|0)<<8)+(n=n*e+.5|0)},i.premultiplyTintToRgba=function(t,e,i,r){return(i=i||new Float32Array(4))[0]=(t>>16&255)/255,i[1]=(t>>8&255)/255,i[2]=(255&t)/255,(r||void 0===r)&&(i[0]*=e,i[1]*=e,i[2]*=e),i[3]=e,i},i.removeItems=function(t,e,i){var r,n=t.length;if(!(e>=n||0===i)){var s=n-(i=e+i>n?n-e:i);for(r=e;r<s;++r)t[r]=t[r+i];t.length=s}},i.rgb2hex=function(t){return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)},i.sayHello=function(t){var e;if(!c){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var i=["\n %c %c %c PixiJS 5.2.2 - ✰ "+t+" ✰  %c  %c  http://www.pixijs.com/  %c %c ♥%c♥%c♥ \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];(e=window.console).log.apply(e,i)}else window.console&&window.console.log("PixiJS 5.2.2 - "+t+" - http://www.pixijs.com/");c=!0}},i.sign=function(t){return 0===t?0:t<0?-1:1},i.skipHello=function(){c=!0},i.string2hex=function(t){return"string"==typeof t&&"#"===t[0]&&(t=t.substr(1)),parseInt(t,16)},i.trimCanvas=function(t){var e,i,r,n=t.width,s=t.height,o=t.getContext("2d"),a=o.getImageData(0,0,n,s).data,h=a.length,l={top:null,left:null,right:null,bottom:null},u=null;for(e=0;e<h;e+=4)0!==a[e+3]&&(i=e/4%n,r=~~(e/4/n),null===l.top&&(l.top=r),(null===l.left||i<l.left)&&(l.left=i),(null===l.right||l.right<i)&&(l.right=i+1),(null===l.bottom||l.bottom<r)&&(l.bottom=r));return null!==l.top&&(n=l.right-l.left,s=l.bottom-l.top+1,u=o.getImageData(l.left,l.top,n,s)),{height:s,width:n,data:u}},i.uid=function(){return++g}},{"@pixi/constants":3,"@pixi/settings":26,earcut:35,eventemitter3:37,url:53}],35:[function(t,e,i){"use strict";function r(t,e,i){i=i||2;var r,a,h,l,u,p,f,m=e&&e.length,y=m?e[0]*i:t.length,_=n(t,0,y,i,!0),v=[];if(!_||_.next===_.prev)return v;if(m&&(_=function(t,e,i,r){var o,a,h,l,u,p=[];for(o=0,a=e.length;o<a;o++)h=e[o]*r,l=o<a-1?e[o+1]*r:t.length,(u=n(t,h,l,r,!1))===u.next&&(u.steiner=!0),p.push(g(u));for(p.sort(c),o=0;o<p.length;o++)d(p[o],i),i=s(i,i.next);return i}(t,e,_,i)),t.length>80*i){r=h=t[0],a=l=t[1];for(var x=i;x<y;x+=i)(u=t[x])<r&&(r=u),(p=t[x+1])<a&&(a=p),u>h&&(h=u),p>l&&(l=p);f=0!==(f=Math.max(h-r,l-a))?1/f:0}return o(_,v,i,r,a,f),v}function n(t,e,i,r,n){var s,o;if(n===C(t,e,i,r)>0)for(s=e;s<i;s+=r)o=S(s,t[s],t[s+1],o);else for(s=i-r;s>=e;s-=r)o=S(s,t[s],t[s+1],o);return o&&v(o,o.next)&&(P(o),o=o.next),o}function s(t,e){if(!t)return t;e||(e=t);var i,r=t;do{if(i=!1,r.steiner||!v(r,r.next)&&0!==_(r.prev,r,r.next))r=r.next;else{if(P(r),(r=e=r.prev)===r.next)break;i=!0}}while(i||r!==e);return e}function o(t,e,i,r,n,c,d){if(t){!d&&c&&function(t,e,i,r){var n=t;do{null===n.z&&(n.z=f(n.x,n.y,e,i,r)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==t);n.prevZ.nextZ=null,n.prevZ=null,function(t){var e,i,r,n,s,o,a,h,l=1;do{for(i=t,t=null,s=null,o=0;i;){for(o++,r=i,a=0,e=0;e<l&&(a++,r=r.nextZ);e++);for(h=l;a>0||h>0&&r;)0!==a&&(0===h||!r||i.z<=r.z)?(n=i,i=i.nextZ,a--):(n=r,r=r.nextZ,h--),s?s.nextZ=n:t=n,n.prevZ=s,s=n;i=r}s.nextZ=null,l*=2}while(o>1)}(n)}(t,r,n,c);for(var p,g,m=t;t.prev!==t.next;)if(p=t.prev,g=t.next,c?h(t,r,n,c):a(t))e.push(p.i/i),e.push(t.i/i),e.push(g.i/i),P(t),t=g.next,m=g.next;else if((t=g)===m){d?1===d?o(t=l(s(t),e,i),e,i,r,n,c,2):2===d&&u(t,e,i,r,n,c):o(s(t),e,i,r,n,c,1);break}}}function a(t){var e=t.prev,i=t,r=t.next;if(_(e,i,r)>=0)return!1;for(var n=t.next.next;n!==t.prev;){if(m(e.x,e.y,i.x,i.y,r.x,r.y,n.x,n.y)&&_(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function h(t,e,i,r){var n=t.prev,s=t,o=t.next;if(_(n,s,o)>=0)return!1;for(var a=n.x<s.x?n.x<o.x?n.x:o.x:s.x<o.x?s.x:o.x,h=n.y<s.y?n.y<o.y?n.y:o.y:s.y<o.y?s.y:o.y,l=n.x>s.x?n.x>o.x?n.x:o.x:s.x>o.x?s.x:o.x,u=n.y>s.y?n.y>o.y?n.y:o.y:s.y>o.y?s.y:o.y,c=f(a,h,e,i,r),d=f(l,u,e,i,r),p=t.prevZ,g=t.nextZ;p&&p.z>=c&&g&&g.z<=d;){if(p!==t.prev&&p!==t.next&&m(n.x,n.y,s.x,s.y,o.x,o.y,p.x,p.y)&&_(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,g!==t.prev&&g!==t.next&&m(n.x,n.y,s.x,s.y,o.x,o.y,g.x,g.y)&&_(g.prev,g,g.next)>=0)return!1;g=g.nextZ}for(;p&&p.z>=c;){if(p!==t.prev&&p!==t.next&&m(n.x,n.y,s.x,s.y,o.x,o.y,p.x,p.y)&&_(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;g&&g.z<=d;){if(g!==t.prev&&g!==t.next&&m(n.x,n.y,s.x,s.y,o.x,o.y,g.x,g.y)&&_(g.prev,g,g.next)>=0)return!1;g=g.nextZ}return!0}function l(t,e,i){var r=t;do{var n=r.prev,o=r.next.next;!v(n,o)&&x(n,r,r.next,o)&&T(n,o)&&T(o,n)&&(e.push(n.i/i),e.push(r.i/i),e.push(o.i/i),P(r),P(r.next),r=t=o),r=r.next}while(r!==t);return s(r)}function u(t,e,i,r,n,a){var h=t;do{for(var l=h.next.next;l!==h.prev;){if(h.i!==l.i&&y(h,l)){var u=E(h,l);return h=s(h,h.next),u=s(u,u.next),o(h,e,i,r,n,a),void o(u,e,i,r,n,a)}l=l.next}h=h.next}while(h!==t)}function c(t,e){return t.x-e.x}function d(t,e){if(e=function(t,e){var i,r=e,n=t.x,s=t.y,o=-1/0;do{if(s<=r.y&&s>=r.next.y&&r.next.y!==r.y){var a=r.x+(s-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=n&&a>o){if(o=a,a===n){if(s===r.y)return r;if(s===r.next.y)return r.next}i=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!i)return null;if(n===o)return i;var h,l=i,u=i.x,c=i.y,d=1/0;r=i;do{n>=r.x&&r.x>=u&&n!==r.x&&m(s<c?n:o,s,u,c,s<c?o:n,s,r.x,r.y)&&(h=Math.abs(s-r.y)/(n-r.x),T(r,t)&&(h<d||h===d&&(r.x>i.x||r.x===i.x&&p(i,r)))&&(i=r,d=h)),r=r.next}while(r!==l);return i}(t,e)){var i=E(e,t);s(e,e.next),s(i,i.next)}}function p(t,e){return _(t.prev,t,e.prev)<0&&_(e.next,t,t.next)<0}function f(t,e,i,r,n){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*n)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*n)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function g(t){var e=t,i=t;do{(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next}while(e!==t);return i}function m(t,e,i,r,n,s,o,a){return(n-o)*(e-a)-(t-o)*(s-a)>=0&&(t-o)*(r-a)-(i-o)*(e-a)>=0&&(i-o)*(s-a)-(n-o)*(r-a)>=0}function y(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&x(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}(t,e)&&(T(t,e)&&T(e,t)&&function(t,e){var i=t,r=!1,n=(t.x+e.x)/2,s=(t.y+e.y)/2;do{i.y>s!=i.next.y>s&&i.next.y!==i.y&&n<(i.next.x-i.x)*(s-i.y)/(i.next.y-i.y)+i.x&&(r=!r),i=i.next}while(i!==t);return r}(t,e)&&(_(t.prev,t,e.prev)||_(t,e.prev,e))||v(t,e)&&_(t.prev,t,t.next)>0&&_(e.prev,e,e.next)>0)}function _(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function v(t,e){return t.x===e.x&&t.y===e.y}function x(t,e,i,r){var n=w(_(t,e,i)),s=w(_(t,e,r)),o=w(_(i,r,t)),a=w(_(i,r,e));return n!==s&&o!==a||(!(0!==n||!b(t,i,e))||(!(0!==s||!b(t,r,e))||(!(0!==o||!b(i,t,r))||!(0!==a||!b(i,e,r)))))}function b(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function w(t){return t>0?1:t<0?-1:0}function T(t,e){return _(t.prev,t,t.next)<0?_(t,e,t.next)>=0&&_(t,t.prev,e)>=0:_(t,e,t.prev)<0||_(t,t.next,e)<0}function E(t,e){var i=new O(t.i,t.x,t.y),r=new O(e.i,e.x,e.y),n=t.next,s=e.prev;return t.next=e,e.prev=t,i.next=n,n.prev=i,r.next=i,i.prev=r,s.next=r,r.prev=s,r}function S(t,e,i,r){var n=new O(t,e,i);return r?(n.next=r.next,n.prev=r,r.next.prev=n,r.next=n):(n.prev=n,n.next=n),n}function P(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function O(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function C(t,e,i,r){for(var n=0,s=e,o=i-r;s<i;s+=r)n+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return n}e.exports=r,e.exports.default=r,r.deviation=function(t,e,i,r){var n=e&&e.length,s=n?e[0]*i:t.length,o=Math.abs(C(t,0,s,i));if(n)for(var a=0,h=e.length;a<h;a++){var l=e[a]*i,u=a<h-1?e[a+1]*i:t.length;o-=Math.abs(C(t,l,u,i))}var c=0;for(a=0;a<r.length;a+=3){var d=r[a]*i,p=r[a+1]*i,f=r[a+2]*i;c+=Math.abs((t[d]-t[f])*(t[p+1]-t[d+1])-(t[d]-t[p])*(t[f+1]-t[d+1]))}return 0===o&&0===c?0:Math.abs((c-o)/o)},r.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},r=0,n=0;n<t.length;n++){for(var s=0;s<t[n].length;s++)for(var o=0;o<e;o++)i.vertices.push(t[n][s][o]);n>0&&(r+=t[n-1].length,i.holes.push(r))}return i}},{}],36:[function(t,e,i){(function(t,e){!function(t){var r=t.Promise,n=r&&"resolve"in r&&"reject"in r&&"all"in r&&"race"in r&&function(){var t;return new r((function(e){t=e})),"function"==typeof t}();void 0!==i&&i?(i.Promise=n?r:x,i.Polyfill=x):"function"==typeof define&&define.amd?define((function(){return n?r:x})):n||(t.Promise=x);var s=function(){};function o(t){return"[object Array]"===Object.prototype.toString.call(t)}var a,h=void 0!==e?e:setTimeout,l=[];function u(){for(var t=0;t<l.length;t++)l[t][0](l[t][1]);l=[],a=!1}function c(t,e){l.push([t,e]),a||(a=!0,h(u,0))}function d(t){var e=t.owner,i=e.state_,r=e.data_,n=t[i],s=t.then;if("function"==typeof n){i="fulfilled";try{r=n(r)}catch(t){m(s,t)}}p(s,r)||("fulfilled"===i&&f(s,r),"rejected"===i&&m(s,r))}function p(t,e){var i;try{if(t===e)throw new TypeError("A promises callback cannot return that same promise.");if(e&&("function"==typeof e||"object"==typeof e)){var r=e.then;if("function"==typeof r)return r.call(e,(function(r){i||(i=!0,e!==r?f(t,r):g(t,r))}),(function(e){i||(i=!0,m(t,e))})),!0}}catch(e){return i||m(t,e),!0}return!1}function f(t,e){t!==e&&p(t,e)||g(t,e)}function g(t,e){"pending"===t.state_&&(t.state_="sealed",t.data_=e,c(_,t))}function m(t,e){"pending"===t.state_&&(t.state_="sealed",t.data_=e,c(v,t))}function y(t){var e=t.then_;t.then_=void 0;for(var i=0;i<e.length;i++)d(e[i])}function _(t){t.state_="fulfilled",y(t)}function v(t){t.state_="rejected",y(t)}function x(t){if("function"!=typeof t)throw new TypeError("Promise constructor takes a function argument");if(this instanceof x==!1)throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this.then_=[],function(t,e){function i(t){m(e,t)}try{t((function(t){f(e,t)}),i)}catch(t){i(t)}}(t,this)}x.prototype={constructor:x,state_:"pending",then_:null,data_:void 0,then:function(t,e){var i={owner:this,then:new this.constructor(s),fulfilled:t,rejected:e};return"fulfilled"===this.state_||"rejected"===this.state_?c(d,i):this.then_.push(i),i.then},catch:function(t){return this.then(null,t)}},x.all=function(t){if(!o(t))throw new TypeError("You must pass an array to Promise.all().");return new this((function(e,i){var r=[],n=0;function s(t){return n++,function(i){r[t]=i,--n||e(r)}}for(var o,a=0;a<t.length;a++)(o=t[a])&&"function"==typeof o.then?o.then(s(a),i):r[a]=o;n||e(r)}))},x.race=function(t){if(!o(t))throw new TypeError("You must pass an array to Promise.race().");return new this((function(e,i){for(var r,n=0;n<t.length;n++)(r=t[n])&&"function"==typeof r.then?r.then(e,i):e(r)}))},x.resolve=function(t){return t&&"object"==typeof t&&t.constructor===this?t:new this((function(e){e(t)}))},x.reject=function(t){return new this((function(e,i){i(t)}))}}("undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("timers").setImmediate)},{timers:52}],37:[function(t,e,i){"use strict";var r=Object.prototype.hasOwnProperty,n="~";function s(){}function o(t,e,i){this.fn=t,this.context=e,this.once=i||!1}function a(t,e,i,r,s){if("function"!=typeof i)throw new TypeError("The listener must be a function");var a=new o(i,r||t,s),h=n?n+e:e;return t._events[h]?t._events[h].fn?t._events[h]=[t._events[h],a]:t._events[h].push(a):(t._events[h]=a,t._eventsCount++),t}function h(t,e){0==--t._eventsCount?t._events=new s:delete t._events[e]}function l(){this._events=new s,this._eventsCount=0}Object.create&&(s.prototype=Object.create(null),(new s).__proto__||(n=!1)),l.prototype.eventNames=function(){var t,e,i=[];if(0===this._eventsCount)return i;for(e in t=this._events)r.call(t,e)&&i.push(n?e.slice(1):e);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(t)):i},l.prototype.listeners=function(t){var e=n?n+t:t,i=this._events[e];if(!i)return[];if(i.fn)return[i.fn];for(var r=0,s=i.length,o=new Array(s);r<s;r++)o[r]=i[r].fn;return o},l.prototype.listenerCount=function(t){var e=n?n+t:t,i=this._events[e];return i?i.fn?1:i.length:0},l.prototype.emit=function(t,e,i,r,s,o){var a=n?n+t:t;if(!this._events[a])return!1;var h,l,u=this._events[a],c=arguments.length;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),c){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,i),!0;case 4:return u.fn.call(u.context,e,i,r),!0;case 5:return u.fn.call(u.context,e,i,r,s),!0;case 6:return u.fn.call(u.context,e,i,r,s,o),!0}for(l=1,h=new Array(c-1);l<c;l++)h[l-1]=arguments[l];u.fn.apply(u.context,h)}else{var d,p=u.length;for(l=0;l<p;l++)switch(u[l].once&&this.removeListener(t,u[l].fn,void 0,!0),c){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,e);break;case 3:u[l].fn.call(u[l].context,e,i);break;case 4:u[l].fn.call(u[l].context,e,i,r);break;default:if(!h)for(d=1,h=new Array(c-1);d<c;d++)h[d-1]=arguments[d];u[l].fn.apply(u[l].context,h)}}return!0},l.prototype.on=function(t,e,i){return a(this,t,e,i,!1)},l.prototype.once=function(t,e,i){return a(this,t,e,i,!0)},l.prototype.removeListener=function(t,e,i,r){var s=n?n+t:t;if(!this._events[s])return this;if(!e)return h(this,s),this;var o=this._events[s];if(o.fn)o.fn!==e||r&&!o.once||i&&o.context!==i||h(this,s);else{for(var a=0,l=[],u=o.length;a<u;a++)(o[a].fn!==e||r&&!o[a].once||i&&o[a].context!==i)&&l.push(o[a]);l.length?this._events[s]=1===l.length?l[0]:l:h(this,s)}return this},l.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&h(this,e)):(this._events=new s,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=n,l.EventEmitter=l,void 0!==e&&(e.exports=l)},{}],38:[function(t,e,i){"use strict";i.__esModule=!0,function(t){for(var e in t)i.hasOwnProperty(e)||(i[e]=t[e])}(t("./isMobile"));var r=t("./isMobile");i.default=r.default},{"./isMobile":39}],39:[function(t,e,i){"use strict";i.__esModule=!0;var r=/iPhone/i,n=/iPod/i,s=/iPad/i,o=/\biOS-universal(?:.+)Mac\b/i,a=/\bAndroid(?:.+)Mobile\b/i,h=/Android/i,l=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,u=/Silk/i,c=/Windows Phone/i,d=/\bWindows(?:.+)ARM\b/i,p=/BlackBerry/i,f=/BB10/i,g=/Opera Mini/i,m=/\b(CriOS|Chrome)(?:.+)Mobile/i,y=/Mobile(?:.+)Firefox\b/i,_=function(t){return void 0!==t&&"MacIntel"===t.platform&&"number"==typeof t.maxTouchPoints&&t.maxTouchPoints>1&&"undefined"==typeof MSStream};i.default=function(t){var e={userAgent:"",platform:"",maxTouchPoints:0};t||"undefined"==typeof navigator?"string"==typeof t?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0}):e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var i=e.userAgent,v=i.split("[FBAN");void 0!==v[1]&&(i=v[0]),void 0!==(v=i.split("Twitter"))[1]&&(i=v[0]);var x=function(t){return function(e){return e.test(t)}}(i),b={apple:{phone:x(r)&&!x(c),ipod:x(n),tablet:!x(r)&&(x(s)||_(e))&&!x(c),universal:x(o),device:(x(r)||x(n)||x(s)||x(o)||_(e))&&!x(c)},amazon:{phone:x(l),tablet:!x(l)&&x(u),device:x(l)||x(u)},android:{phone:!x(c)&&x(l)||!x(c)&&x(a),tablet:!x(c)&&!x(l)&&!x(a)&&(x(u)||x(h)),device:!x(c)&&(x(l)||x(u)||x(a)||x(h))||x(/\bokhttp\b/i)},windows:{phone:x(c),tablet:x(d),device:x(c)||x(d)},other:{blackberry:x(p),blackberry10:x(f),opera:x(g),firefox:x(y),chrome:x(m),device:x(p)||x(f)||x(g)||x(y)||x(m)},any:!1,phone:!1,tablet:!1};return b.any=b.apple.device||b.android.device||b.windows.device||b.other.device,b.phone=b.apple.phone||b.android.phone||b.windows.phone,b.tablet=b.apple.tablet||b.android.tablet||b.windows.tablet,b}},{}],40:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}();function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var s=function(){function t(e,i,r){void 0===i&&(i=!1),n(this,t),this._fn=e,this._once=i,this._thisArg=r,this._next=this._prev=this._owner=null}return r(t,[{key:"detach",value:function(){return null!==this._owner&&(this._owner.detach(this),!0)}}]),t}();function o(t,e){return t._head?(t._tail._next=e,e._prev=t._tail,t._tail=e):(t._head=e,t._tail=e),e._owner=t,e}var a=function(){function t(){n(this,t),this._head=this._tail=void 0}return r(t,[{key:"handlers",value:function(){var t=!(arguments.length<=0||void 0===arguments[0])&&arguments[0],e=this._head;if(t)return!!e;for(var i=[];e;)i.push(e),e=e._next;return i}},{key:"has",value:function(t){if(!(t instanceof s))throw new Error("MiniSignal#has(): First arg must be a MiniSignalBinding object.");return t._owner===this}},{key:"dispatch",value:function(){var t=this._head;if(!t)return!1;for(;t;)t._once&&this.detach(t),t._fn.apply(t._thisArg,arguments),t=t._next;return!0}},{key:"add",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof t)throw new Error("MiniSignal#add(): First arg must be a Function.");return o(this,new s(t,!1,e))}},{key:"once",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof t)throw new Error("MiniSignal#once(): First arg must be a Function.");return o(this,new s(t,!0,e))}},{key:"detach",value:function(t){if(!(t instanceof s))throw new Error("MiniSignal#detach(): First arg must be a MiniSignalBinding object.");return t._owner!==this||(t._prev&&(t._prev._next=t._next),t._next&&(t._next._prev=t._prev),t===this._head?(this._head=t._next,null===t._next&&(this._tail=null)):t===this._tail&&(this._tail=t._prev,this._tail._next=null),t._owner=null),this}},{key:"detachAll",value:function(){var t=this._head;if(!t)return this;for(this._head=this._tail=null;t;)t._owner=null,t=t._next;return this}}]),t}();a.MiniSignalBinding=s,i.default=a,e.exports=i.default},{}],41:[function(t,e,i){
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/
"use strict";var r=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;function o(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}e.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},i=0;i<10;i++)e["_"+String.fromCharCode(i)]=i;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(t){r[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var i,a,h=o(t),l=1;l<arguments.length;l++){for(var u in i=Object(arguments[l]))n.call(i,u)&&(h[u]=i[u]);if(r){a=r(i);for(var c=0;c<a.length;c++)s.call(i,a[c])&&(h[a[c]]=i[a[c]])}}return h}},{}],42:[function(t,e,i){"use strict";e.exports=function(t,e){e=e||{};for(var i={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},r=i.parser[e.strictMode?"strict":"loose"].exec(t),n={},s=14;s--;)n[i.key[s]]=r[s]||"";return n[i.q.name]={},n[i.key[12]].replace(i.q.parser,(function(t,e,r){e&&(n[i.q.name][e]=r)})),n}},{}],43:[function(t,e,i){n||(n={}),Object.assign(PIXI.Container.prototype,{render:function(t){this._activeParentLayer&&this._activeParentLayer!=t._activeLayer||(this.visible?(this.displayOrder=t.incDisplayOrder(),this.worldAlpha<=0||!this.renderable||(t._activeLayer=null,this.containerRenderWebGL(t),t._activeLayer=this._activeParentLayer)):this.displayOrder=0)},renderCanvas:function(t){this._activeParentLayer&&this._activeParentLayer!=t._activeLayer||(this.visible?(this.displayOrder=t.incDisplayOrder(),this.worldAlpha<=0||!this.renderable||(t._activeLayer=null,this.containerRenderCanvas(t),t._activeLayer=this._activeParentLayer)):this.displayOrder=0)},containerRenderWebGL:PIXI.Container.prototype.render,containerRenderCanvas:PIXI.Container.prototype.renderCanvas}),Object.assign(PIXI.DisplayObject.prototype,{parentLayer:null,_activeParentLayer:null,parentGroup:null,zOrder:0,zIndex:0,updateOrder:0,displayOrder:0,layerableChildren:!0,isLayer:!1}),(PIXI.ParticleContainer||PIXI.ParticleContainer)&&(PIXI.ParticleContainer.prototype.layerableChildren=!1);var r,n,s=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});!function(t){var e=function(t){function e(e,i){var r=t.call(this)||this;return r._activeLayer=null,r._activeStage=null,r._activeChildren=[],r._lastUpdateId=-1,r.useRenderTexture=!1,r.useDoubleBuffer=!1,r.sortPriority=0,r.clearColor=new Float32Array([0,0,0,0]),r.canDrawWithoutLayer=!1,r.canDrawInParentStage=!0,r.zIndex=0,r.enableSort=!1,r._tempResult=[],r._tempZero=[],r.useZeroOptimization=!1,r.zIndex=e,r.enableSort=!!i,"function"==typeof i&&r.on("sort",i),r}return s(e,t),e.prototype.doSort=function(t,i){if(this.listeners("sort",!0))for(var r=0;r<i.length;r++)this.emit("sort",i[r]);this.useZeroOptimization?this.doSortWithZeroOptimization(t,i):i.sort(e.compareZIndex)},e.compareZIndex=function(t,e){return t.zOrder<e.zOrder?-1:t.zOrder>e.zOrder?1:t.updateOrder-e.updateOrder},e.prototype.doSortWithZeroOptimization=function(t,e){throw new Error("not implemented yet")},e.prototype.clear=function(){this._activeLayer=null,this._activeStage=null,this._activeChildren.length=0},e.prototype.addDisplayObject=function(t,e){this.check(t),e._activeParentLayer=this._activeLayer,this._activeLayer?this._activeLayer._activeChildren.push(e):this._activeChildren.push(e)},e.prototype.foundLayer=function(t,i){this.check(t),null!=this._activeLayer&&e.conflict(),this._activeLayer=i,this._activeStage=t},e.prototype.foundStage=function(t){this._activeLayer||this.canDrawInParentStage||this.clear()},e.prototype.check=function(t){if(this._lastUpdateId<e._layerUpdateId)this._lastUpdateId=e._layerUpdateId,this.clear(),this._activeStage=t;else if(this.canDrawInParentStage){for(var i=this._activeStage;i&&i!=t;)i=i._activeParentStage;if(this._activeStage=i,null==i)return void this.clear()}},e.conflict=function(){e._lastLayerConflict+5e3<Date.now()&&(e._lastLayerConflict=Date.now(),console.log("PIXI-display plugin found two layers with the same group in one stage - that's not healthy. Please place a breakpoint here and debug it"))},e._layerUpdateId=0,e._lastLayerConflict=0,e}(PIXI.utils.EventEmitter);t.Group=e}(n||(n={})),function(t){function e(e,i,r,n,s){this.search||(this.search=new t.LayersTreeSearch),this.search.findHit(e,i,r,n);var o=this.delayedEvents;if(o&&o.length){e.stopPropagationHint=!1;var a=o.length;this.delayedEvents=[];for(var h=0;h<a;h++){var l=o[h],u=l.displayObject,c=l.eventString,d=l.eventData;d.stopsPropagatingAt===u&&(d.stopPropagationHint=!0),this.dispatchEvent(u,c,d)}}}t.processInteractive51=e,t.patchInteractionManager=function(i){i&&(i.search?i.search.worksWithDisplay||(i.search=new t.LayersTreeSearch):i.processInteractive=e)}}(n||(n={})),function(t){var e=function(){function t(t){this.layer=t,this.renderTexture=null,this.doubleBuffer=null,this.currentBufferIndex=0,this._tempRenderTarget=null,this._tempRenderTargetSource=new PIXI.Rectangle}return t.prototype.initRenderTexture=function(t){var e=t?t.screen.width:100,i=t?t.screen.height:100,r=t?t.resolution:PIXI.settings.RESOLUTION;this.renderTexture=PIXI.RenderTexture.create({width:e,height:i,resolution:r}),this.layer.group.useDoubleBuffer&&(this.doubleBuffer=[PIXI.RenderTexture.create({width:e,height:i,resolution:r}),PIXI.RenderTexture.create({width:e,height:i,resolution:r})])},t.prototype.getRenderTexture=function(){return this.renderTexture||this.initRenderTexture(),this.renderTexture},t.prototype.pushTexture=function(t){var e=t.screen;this.renderTexture||this.initRenderTexture(t);var i=this.renderTexture,r=this.layer.group,n=this.doubleBuffer;if(i.width===e.width&&i.height===e.height&&i.baseTexture.resolution===t.resolution||(i.baseTexture.resolution=t.resolution,i.resize(e.width,e.height),n&&(n[0].baseTexture.resolution=t.resolution,n[0].resize(e.width,e.height),n[1].baseTexture.resolution=t.resolution,n[1].resize(e.width,e.height))),this._tempRenderTarget=t.renderTexture.current,this._tempRenderTargetSource.copyFrom(t.renderTexture.sourceFrame),t.batch.flush(),r.useDoubleBuffer){var s=n[this.currentBufferIndex];s.baseTexture._glTextures[t.CONTEXT_UID]||(t.renderTexture.bind(s,void 0,void 0),t.texture.bind(s),r.clearColor&&t.renderTexture.clear(r.clearColor)),t.texture.unbind(i),i.baseTexture._glTextures=s.baseTexture._glTextures,i.baseTexture.framebuffer=s.baseTexture.framebuffer,s=n[1-this.currentBufferIndex],t.renderTexture.bind(s,void 0,void 0)}else t.renderTexture.bind(i,void 0,void 0);r.clearColor&&t.renderTexture.clear(r.clearColor);var o=t.filter.defaultFilterStack;o.length>1&&(o[o.length-1].renderTexture=t.renderTexture.current)},t.prototype.popTexture=function(t){t.batch.flush();var e=t.filter.defaultFilterStack;e.length>1&&(e[e.length-1].renderTexture=this._tempRenderTarget),t.renderTexture.bind(this._tempRenderTarget,this._tempRenderTargetSource,void 0),this._tempRenderTarget=null;var i=this.renderTexture,r=this.layer.group,n=this.doubleBuffer;if(r.useDoubleBuffer){t.texture.unbind(i),this.currentBufferIndex=1-this.currentBufferIndex;var s=n[this.currentBufferIndex];i.baseTexture._glTextures=s.baseTexture._glTextures,i.baseTexture.framebuffer=s.baseTexture.framebuffer}},t.prototype.destroy=function(){this.renderTexture&&(this.renderTexture.destroy(),this.doubleBuffer&&(this.doubleBuffer[0].destroy(!0),this.doubleBuffer[1].destroy(!0)))},t}();t.LayerTextureCache=e;var i=function(i){function r(e){void 0===e&&(e=null);var r=i.call(this)||this;return r.isLayer=!0,r.group=null,r._activeChildren=[],r._tempChildren=null,r._activeStageParent=null,r._sortedChildren=[],r._tempLayerParent=null,r.insertChildrenBeforeActive=!0,r.insertChildrenAfterActive=!0,null!=e?(r.group=e,r.zIndex=e.zIndex):r.group=new t.Group(0,!1),r._tempChildren=r.children,r}return s(r,i),r.prototype.beginWork=function(t){var e=this._activeChildren;this._activeStageParent=t,this.group.foundLayer(t,this);var i=this.group._activeChildren;e.length=0;for(var r=0;r<i.length;r++)i[r]._activeParentLayer=this,e.push(i[r]);i.length=0},r.prototype.endWork=function(){for(var t=this.children,e=this._activeChildren,i=this._sortedChildren,r=0;r<e.length;r++)this.emit("display",e[r]);if(i.length=0,this.insertChildrenBeforeActive)for(r=0;r<t.length;r++)i.push(t[r]);for(r=0;r<e.length;r++)i.push(e[r]);if(!this.insertChildrenBeforeActive&&this.insertChildrenAfterActive)for(r=0;r<t.length;r++)i.push(t[r]);this.group.enableSort&&this.doSort()},Object.defineProperty(r.prototype,"useRenderTexture",{get:function(){return this.group.useRenderTexture},set:function(t){this.group.useRenderTexture=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"useDoubleBuffer",{get:function(){return this.group.useDoubleBuffer},set:function(t){this.group.useDoubleBuffer=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"clearColor",{get:function(){return this.group.clearColor},set:function(t){this.group.clearColor=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"sortPriority",{get:function(){return this.group.sortPriority},set:function(t){this.group.sortPriority=t},enumerable:!0,configurable:!0}),r.prototype.getRenderTexture=function(){return this.textureCache||(this.textureCache=new e(this)),this.textureCache.getRenderTexture()},r.prototype.updateDisplayLayers=function(){},r.prototype.doSort=function(){this.group.doSort(this,this._sortedChildren)},r.prototype._preRender=function(t){return(!this._activeParentLayer||this._activeParentLayer==t._activeLayer)&&(this.visible?(this.displayOrder=t.incDisplayOrder(),!(this.worldAlpha<=0||!this.renderable)&&(this.children!==this._sortedChildren&&this._tempChildren!=this.children&&(this._tempChildren=this.children),this._boundsID++,this.children=this._sortedChildren,this._tempLayerParent=t._activeLayer,t._activeLayer=this,!0)):(this.displayOrder=0,!1))},r.prototype._postRender=function(t){this.children=this._tempChildren,t._activeLayer=this._tempLayerParent,this._tempLayerParent=null},r.prototype.render=function(t){this._preRender(t)&&(this.group.useRenderTexture&&(this.textureCache||(this.textureCache=new e(this)),this.textureCache.pushTexture(t)),this.containerRenderWebGL(t),this._postRender(t),this.group.useRenderTexture&&this.textureCache.popTexture(t))},r.prototype.destroy=function(t){this.textureCache&&(this.textureCache.destroy(),this.textureCache=null),i.prototype.destroy.call(this,t)},r}(PIXI.Container);t.Layer=i,i.prototype.renderCanvas=function(t){this._preRender(t)&&(this.containerRenderCanvas(t),this._postRender(t))}}(n||(n={})),function(t){var e=PIXI.Point,i=function(){function t(){this._tempPoint=new e,this._queue=[[],[]],this._eventDisplayOrder=0,this.worksWithDisplay=!0}return t.prototype.recursiveFindHit=function(t,e,i,r,n){if(!e||!e.visible)return 0;var s=0,o=r=e.interactive||r;e.hitArea&&(o=!1),e._activeParentLayer&&(n=!1);var a=e._mask;i<1/0&&a&&(a.containsPoint(t)||(n=!0)),i<1/0&&e.filterArea&&(e.filterArea.contains(t.x,t.y)||(n=!0));var h=e.children;if(e.interactiveChildren&&h)for(var l=h.length-1;l>=0;l--){var u=h[l],c=this.recursiveFindHit(t,u,i,o,n);if(c){if(!u.parent)continue;s=c,i=c}}return r&&(n?e.interactive&&this._queueAdd(e,0):(i<e.displayOrder&&(e.hitArea?(e.worldTransform.applyInverse(t,this._tempPoint),e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)&&(s=e.displayOrder)):e.containsPoint&&e.containsPoint(t)&&(s=e.displayOrder)),e.interactive&&this._queueAdd(e,s===1/0?0:s))),s},t.prototype.findHit=function(t,e,i,r){var n=null,s=null;s=t.data&&t.data.global?(n=t).data.global:t,this._startInteractionProcess(),this.recursiveFindHit(s,e,r?0:1/0,!1,!1),this._finishInteractionProcess(n,i)},t.prototype._startInteractionProcess=function(){this._eventDisplayOrder=1,this._queue||(this._queue=[[],[]]),this._queue[0].length=0,this._queue[1].length=0},t.prototype._queueAdd=function(t,e){var i=this._queue;if(e<this._eventDisplayOrder)i[0].push(t);else{if(e>this._eventDisplayOrder){this._eventDisplayOrder=e;for(var r=i[1],n=0,s=r.length;n<s;n++)i[0].push(r[n]);i[1].length=0}i[1].push(t)}},t.prototype._finishInteractionProcess=function(t,e){for(var i=this._queue,r=i[0],n=0,s=r.length;n<s;n++)t?e&&e(t,r[n],!1):e(r[n],!1);for(n=0,s=(r=i[1]).length;n<s;n++)t?(t.target||(t.target=r[n]),e&&e(t,r[n],!0)):e(r[n],!0)},t}();t.LayersTreeSearch=i}(n||(n={})),function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.isStage=!0,t._tempGroups=[],t._activeLayers=[],t._activeParentStage=null,t}return s(i,e),i.prototype.clear=function(){this._activeLayers.length=0,this._tempGroups.length=0},i.prototype.destroy=function(t){this.clear(),e.prototype.destroy.call(this,t)},i.prototype._addRecursive=function(t){if(t.visible){if(t.isLayer){var e=t;this._activeLayers.push(e),e.beginWork(this)}if(t!=this&&t.isStage){t.updateAsChildStage(this)}else{var r=t.parentGroup;null!=r&&r.addDisplayObject(this,t);var n=t.parentLayer;if(null!=n&&(r=n.group).addDisplayObject(this,t),t.updateOrder=++i._updateOrderCounter,!(t.alpha<=0||!t.renderable||!t.layerableChildren||r&&r.sortPriority)){var s=t.children;if(s&&s.length)for(var o=0;o<s.length;o++)this._addRecursive(s[o])}}}},i.prototype._addRecursiveChildren=function(t){if(!(t.alpha<=0)&&t.renderable&&t.layerableChildren){var e=t.children;if(e&&e.length)for(var i=0;i<e.length;i++)this._addRecursive(e[i])}},i.prototype._updateStageInner=function(){this.clear(),this._addRecursive(this);for(var t=this._activeLayers,e=0;e<t.length;e++){if((n=t[e]).group.sortPriority){n.endWork();for(var i=n._sortedChildren,r=0;r<i.length;r++)this._addRecursiveChildren(i[r])}}for(e=0;e<t.length;e++){var n;(n=t[e]).group.sortPriority||n.endWork()}},i.prototype.updateAsChildStage=function(t){this._activeParentStage=t,i._updateOrderCounter=0,this._updateStageInner()},i.prototype.updateStage=function(){this._activeParentStage=null,t.Group._layerUpdateId++,this._updateStageInner()},i._updateOrderCounter=0,i}(t.Layer);t.Stage=e}(n||(n={})),function(t){Object.assign(PIXI.Renderer.prototype,{_lastDisplayOrder:0,_activeLayer:null,incDisplayOrder:function(){return++this._lastDisplayOrder},_oldRender:PIXI.Renderer.prototype.render,render:function(e,i,r,n,s){i||(this._lastDisplayOrder=0),this._activeLayer=null,e.isStage&&e.updateStage(),t.patchInteractionManager(this.plugins.interaction),this._oldRender(e,i,r,n,s)}});var e=PIXI.CanvasRenderer;e&&Object.assign(e.prototype,{_lastDisplayOrder:0,_activeLayer:null,incDisplayOrder:function(){return++this._lastDisplayOrder},_oldRender:e.prototype.render,render:function(e,i,r,n,s){i||(this._lastDisplayOrder=0),this._activeLayer=null,e.isStage&&e.updateStage(),t.patchInteractionManager(this.plugins.interaction),this._oldRender(e,i,r,n,s)}})}(n||(n={})),function(t){PIXI.display=t}(n||(n={}))},{}],44:[function(t,e,i){
/*!
 * pixi-sound - v3.0.4
 * https://github.com/pixijs/pixi-sound
 * Compiled Thu, 07 Nov 2019 23:26:22 UTC
 *
 * pixi-sound is licensed under the MIT license.
 * http://www.opensource.org/licenses/mit-license
 */
"use strict";var r=t("@pixi/loaders"),n=t("@pixi/ticker"),s=t("@pixi/utils"),o=t("@pixi/core"),a=function(){function t(t,e){this._output=e,this._input=t}return Object.defineProperty(t.prototype,"destination",{get:function(){return this._input},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filters",{get:function(){return this._filters},set:function(t){var e=this;if(this._filters&&(this._filters.forEach((function(t){t&&t.disconnect()})),this._filters=null,this._input.connect(this._output)),t&&t.length){this._filters=t.slice(0),this._input.disconnect();var i=null;t.forEach((function(t){null===i?e._input.connect(t.destination):i.connect(t.destination),i=t})),i.connect(this._output)}},enumerable:!0,configurable:!0}),t.prototype.destroy=function(){this.filters=null,this._input=null,this._output=null},t}(),h=function(){function t(t,e){this.init(t,e)}return t.prototype.init=function(t,e){this.destination=t,this.source=e||t},t.prototype.connect=function(t){this.source.connect(t)},t.prototype.disconnect=function(){this.source.disconnect()},t.prototype.destroy=function(){this.disconnect(),this.destination=null,this.source=null},t}(),l=function(t,e){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};function u(t,e){function i(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var c,d=function(){return(d=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};function p(){return c}var f=function(){function t(){}return t.setParamValue=function(t,e){if(t.setValueAtTime){var i=p().context;t.setValueAtTime(e,i.audioContext.currentTime)}else t.value=e;return e},t}(),g=0,m=function(t){function e(e){var i=t.call(this)||this;return i.id=g++,i._media=null,i._paused=!1,i._muted=!1,i._elapsed=0,i.init(e),i}return u(e,t),e.prototype.set=function(t,e){if(void 0===this[t])throw new Error("Property with name "+t+" does not exist.");return this[t]=e,this},e.prototype.stop=function(){this._source&&(this._internalStop(),this.emit("stop"))},Object.defineProperty(e.prototype,"speed",{get:function(){return this._speed},set:function(t){this._speed=t,this.refresh(),this._update(!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"volume",{get:function(){return this._volume},set:function(t){this._volume=t,this.refresh()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"muted",{get:function(){return this._muted},set:function(t){this._muted=t,this.refresh()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=t,this.refresh()},enumerable:!0,configurable:!0}),e.prototype.refresh=function(){if(this._source){var t=this._media.context,e=this._media.parent;this._source.loop=this._loop||e.loop;var i=t.volume*(t.muted?0:1),r=e.volume*(e.muted?0:1),n=this._volume*(this._muted?0:1);f.setParamValue(this._gain.gain,n*r*i),f.setParamValue(this._source.playbackRate,this._speed*e.speed*t.speed)}},e.prototype.refreshPaused=function(){var t=this._media.context,e=this._media.parent,i=this._paused||e.paused||t.paused;i!==this._pausedReal&&(this._pausedReal=i,i?(this._internalStop(),this.emit("paused")):(this.emit("resumed"),this.play({start:this._elapsed%this._duration,end:this._end,speed:this._speed,loop:this._loop,volume:this._volume})),this.emit("pause",i))},e.prototype.play=function(t){var e=t.start,i=t.end,r=t.speed,n=t.loop,s=t.volume,o=t.muted;this._paused=!1;var a=this._media.nodes.cloneBufferSource(),h=a.source,l=a.gain;this._source=h,this._gain=l,this._speed=r,this._volume=s,this._loop=!!n,this._muted=o,this.refresh();var u=this._source.buffer.duration;this._duration=u,this._end=i,this._lastUpdate=this._now(),this._elapsed=e,this._source.onended=this._onComplete.bind(this),this._loop?(this._source.loopEnd=i,this._source.loopStart=e,this._source.start(0,e)):i?this._source.start(0,e,i-e):this._source.start(0,e),this.emit("start"),this._update(!0),this._enabled=!0},e.prototype._toSec=function(t){return t>10&&(t/=1e3),t||0},Object.defineProperty(e.prototype,"_enabled",{set:function(t){n.Ticker.shared.remove(this._updateListener,this),t&&n.Ticker.shared.add(this._updateListener,this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"progress",{get:function(){return this._progress},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paused",{get:function(){return this._paused},set:function(t){this._paused=t,this.refreshPaused()},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.removeAllListeners(),this._internalStop(),this._gain&&(this._gain.disconnect(),this._gain=null),this._media&&(this._media.context.events.off("refresh",this.refresh,this),this._media.context.events.off("refreshPaused",this.refreshPaused,this),this._media=null),this._end=null,this._speed=1,this._volume=1,this._loop=!1,this._elapsed=0,this._duration=0,this._paused=!1,this._muted=!1,this._pausedReal=!1},e.prototype.toString=function(){return"[WebAudioInstance id="+this.id+"]"},e.prototype._now=function(){return this._media.context.audioContext.currentTime},e.prototype._updateListener=function(){this._update()},e.prototype._update=function(t){if(void 0===t&&(t=!1),this._source){var e=this._now(),i=e-this._lastUpdate;if(i>0||t){var r=this._source.playbackRate.value;this._elapsed+=i*r,this._lastUpdate=e;var n=this._duration,s=void 0;if(this._source.loopStart){var o=this._source.loopEnd-this._source.loopStart;s=(this._source.loopStart+this._elapsed%o)/n}else s=this._elapsed%n/n;this._progress=s,this.emit("progress",this._progress,n)}}},e.prototype.init=function(t){this._media=t,t.context.events.on("refresh",this.refresh,this),t.context.events.on("refreshPaused",this.refreshPaused,this)},e.prototype._internalStop=function(){this._source&&(this._enabled=!1,this._source.onended=null,this._source.stop(0),this._source.disconnect(),this._source=null)},e.prototype._onComplete=function(){this._source&&(this._enabled=!1,this._source.onended=null,this._source.disconnect()),this._source=null,this._progress=1,this.emit("progress",1,this._duration),this.emit("end",this)},e}(s.EventEmitter),y=function(t){function e(e){var i=this,r=e.audioContext,n=r.createBufferSource(),s=r.createGain(),o=r.createAnalyser();return n.connect(o),o.connect(s),s.connect(e.destination),(i=t.call(this,o,s)||this).context=e,i.bufferSource=n,i.gain=s,i.analyser=o,i}return u(e,t),Object.defineProperty(e.prototype,"script",{get:function(){return this._script||(this._script=this.context.audioContext.createScriptProcessor(e.BUFFER_SIZE),this._script.connect(this.context.destination)),this._script},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){t.prototype.destroy.call(this),this.bufferSource.disconnect(),this._script&&this._script.disconnect(),this.gain.disconnect(),this.analyser.disconnect(),this.bufferSource=null,this._script=null,this.gain=null,this.analyser=null,this.context=null},e.prototype.cloneBufferSource=function(){var t=this.bufferSource,e=this.context.audioContext.createBufferSource();e.buffer=t.buffer,f.setParamValue(e.playbackRate,t.playbackRate.value),e.loop=t.loop;var i=this.context.audioContext.createGain();return e.connect(i),i.connect(this.destination),{source:e,gain:i}},Object.defineProperty(e.prototype,"bufferSize",{get:function(){return this.script.bufferSize},enumerable:!0,configurable:!0}),e.BUFFER_SIZE=0,e}(a),_=function(){function t(){}return t.prototype.init=function(t){this.parent=t,this._nodes=new y(this.context),this._source=this._nodes.bufferSource,this.source=t.options.source},t.prototype.destroy=function(){this.parent=null,this._nodes.destroy(),this._nodes=null,this._source=null,this.source=null},t.prototype.create=function(){return new m(this)},Object.defineProperty(t.prototype,"context",{get:function(){return this.parent.context},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPlayable",{get:function(){return!!this._source&&!!this._source.buffer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filters",{get:function(){return this._nodes.filters},set:function(t){this._nodes.filters=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){return this._source.buffer.duration},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"buffer",{get:function(){return this._source.buffer},set:function(t){this._source.buffer=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nodes",{get:function(){return this._nodes},enumerable:!0,configurable:!0}),t.prototype.load=function(t){this.source?this._decode(this.source,t):this.parent.url?this._loadUrl(t):t&&t(new Error("sound.url or sound.source must be set"))},t.prototype._loadUrl=function(t){var e=this,i=new XMLHttpRequest,r=this.parent.url;i.open("GET",r,!0),i.responseType="arraybuffer",i.onload=function(){e.source=i.response,e._decode(i.response,t)},i.send()},t.prototype._decode=function(t,e){var i=this;this.parent.context.decode(t,(function(t,r){if(t)e&&e(t);else{i.parent.isLoaded=!0,i.buffer=r;var n=i.parent.autoPlayStart();e&&e(null,i.parent,n)}}))},t}(),v=function(t){function e(){var i=this,r=window,n=new e.AudioContext,o=n.createDynamicsCompressor(),a=n.createAnalyser();return a.connect(o),o.connect(n.destination),(i=t.call(this,a,o)||this)._ctx=n,i._offlineCtx=new e.OfflineAudioContext(1,2,r.OfflineAudioContext?n.sampleRate:44100),i._unlocked=!1,i.compressor=o,i.analyser=a,i.events=new s.EventEmitter,i.volume=1,i.speed=1,i.muted=!1,i.paused=!1,"running"!==n.state&&(i._unlock(),i._unlock=i._unlock.bind(i),document.addEventListener("mousedown",i._unlock,!0),document.addEventListener("touchstart",i._unlock,!0),document.addEventListener("touchend",i._unlock,!0)),i}return u(e,t),e.prototype._unlock=function(){this._unlocked||(this.playEmptySound(),"running"===this._ctx.state&&(document.removeEventListener("mousedown",this._unlock,!0),document.removeEventListener("touchend",this._unlock,!0),document.removeEventListener("touchstart",this._unlock,!0),this._unlocked=!0))},e.prototype.playEmptySound=function(){var t=this._ctx.createBufferSource();t.buffer=this._ctx.createBuffer(1,1,22050),t.connect(this._ctx.destination),t.start(0,0,0),"suspended"===t.context.state&&t.context.resume()},Object.defineProperty(e,"AudioContext",{get:function(){var t=window;return t.AudioContext||t.webkitAudioContext||null},enumerable:!0,configurable:!0}),Object.defineProperty(e,"OfflineAudioContext",{get:function(){var t=window;return t.OfflineAudioContext||t.webkitOfflineAudioContext||null},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){t.prototype.destroy.call(this);var e=this._ctx;void 0!==e.close&&e.close(),this.events.removeAllListeners(),this.analyser.disconnect(),this.compressor.disconnect(),this.analyser=null,this.compressor=null,this.events=null,this._offlineCtx=null,this._ctx=null},Object.defineProperty(e.prototype,"audioContext",{get:function(){return this._ctx},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"offlineContext",{get:function(){return this._offlineCtx},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paused",{get:function(){return this._paused},set:function(t){t&&"running"===this._ctx.state?this._ctx.suspend():t||"suspended"!==this._ctx.state||this._ctx.resume(),this._paused=t},enumerable:!0,configurable:!0}),e.prototype.refresh=function(){this.events.emit("refresh")},e.prototype.refreshPaused=function(){this.events.emit("refreshPaused")},e.prototype.toggleMute=function(){return this.muted=!this.muted,this.refresh(),this.muted},e.prototype.togglePause=function(){return this.paused=!this.paused,this.refreshPaused(),this._paused},e.prototype.decode=function(t,e){this._offlineCtx.decodeAudioData(t,(function(t){e(null,t)}),(function(t){e(new Error(t.message||"Unable to decode file"))}))},e}(a),x={WebAudioMedia:_,WebAudioInstance:m,WebAudioNodes:y,WebAudioContext:v,WebAudioUtils:f},b={Filter:h,EqualizerFilter:function(t){function e(i,r,n,s,o,a,h,l,u,c){void 0===i&&(i=0),void 0===r&&(r=0),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),void 0===l&&(l=0),void 0===u&&(u=0),void 0===c&&(c=0);var d=this;if(!p().useLegacy){var g=[{f:e.F32,type:"lowshelf",gain:i},{f:e.F64,type:"peaking",gain:r},{f:e.F125,type:"peaking",gain:n},{f:e.F250,type:"peaking",gain:s},{f:e.F500,type:"peaking",gain:o},{f:e.F1K,type:"peaking",gain:a},{f:e.F2K,type:"peaking",gain:h},{f:e.F4K,type:"peaking",gain:l},{f:e.F8K,type:"peaking",gain:u},{f:e.F16K,type:"highshelf",gain:c}].map((function(t){var e=p().context.audioContext.createBiquadFilter();return e.type=t.type,f.setParamValue(e.Q,1),e.frequency.value=t.f,f.setParamValue(e.gain,t.gain),e}));(d=t.call(this,g[0],g[g.length-1])||this).bands=g,d.bandsMap={};for(var m=0;m<d.bands.length;m++){var y=d.bands[m];m>0&&d.bands[m-1].connect(y),d.bandsMap[y.frequency.value]=y}return d}d=t.call(this,null)||this}return u(e,t),e.prototype.setGain=function(t,e){if(void 0===e&&(e=0),!this.bandsMap[t])throw new Error("No band found for frequency "+t);f.setParamValue(this.bandsMap[t].gain,e)},e.prototype.getGain=function(t){if(!this.bandsMap[t])throw new Error("No band found for frequency "+t);return this.bandsMap[t].gain.value},Object.defineProperty(e.prototype,"f32",{get:function(){return this.getGain(e.F32)},set:function(t){this.setGain(e.F32,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"f64",{get:function(){return this.getGain(e.F64)},set:function(t){this.setGain(e.F64,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"f125",{get:function(){return this.getGain(e.F125)},set:function(t){this.setGain(e.F125,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"f250",{get:function(){return this.getGain(e.F250)},set:function(t){this.setGain(e.F250,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"f500",{get:function(){return this.getGain(e.F500)},set:function(t){this.setGain(e.F500,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"f1k",{get:function(){return this.getGain(e.F1K)},set:function(t){this.setGain(e.F1K,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"f2k",{get:function(){return this.getGain(e.F2K)},set:function(t){this.setGain(e.F2K,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"f4k",{get:function(){return this.getGain(e.F4K)},set:function(t){this.setGain(e.F4K,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"f8k",{get:function(){return this.getGain(e.F8K)},set:function(t){this.setGain(e.F8K,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"f16k",{get:function(){return this.getGain(e.F16K)},set:function(t){this.setGain(e.F16K,t)},enumerable:!0,configurable:!0}),e.prototype.reset=function(){this.bands.forEach((function(t){f.setParamValue(t.gain,0)}))},e.prototype.destroy=function(){this.bands.forEach((function(t){t.disconnect()})),this.bands=null,this.bandsMap=null},e.F32=32,e.F64=64,e.F125=125,e.F250=250,e.F500=500,e.F1K=1e3,e.F2K=2e3,e.F4K=4e3,e.F8K=8e3,e.F16K=16e3,e}(h),DistortionFilter:function(t){function e(e){void 0===e&&(e=0);var i=this;if(!p().useLegacy){var r=p().context.audioContext.createWaveShaper();return(i=t.call(this,r)||this)._distortion=r,i.amount=e,i}i=t.call(this,null)||this}return u(e,t),Object.defineProperty(e.prototype,"amount",{get:function(){return this._amount},set:function(t){t*=1e3,this._amount=t;for(var e,i=new Float32Array(44100),r=Math.PI/180,n=0;n<44100;++n)e=2*n/44100-1,i[n]=(3+t)*e*20*r/(Math.PI+t*Math.abs(e));this._distortion.curve=i,this._distortion.oversample="4x"},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this._distortion=null,t.prototype.destroy.call(this)},e}(h),StereoFilter:function(t){function e(e){void 0===e&&(e=0);var i=this;if(!p().useLegacy){var r,n,s,o=p().context.audioContext;return o.createStereoPanner?s=r=o.createStereoPanner():((n=o.createPanner()).panningModel="equalpower",s=n),(i=t.call(this,s)||this)._stereo=r,i._panner=n,i.pan=e,i}i=t.call(this,null)||this}return u(e,t),Object.defineProperty(e.prototype,"pan",{get:function(){return this._pan},set:function(t){this._pan=t,this._stereo?f.setParamValue(this._stereo.pan,t):this._panner.setPosition(t,0,1-Math.abs(t))},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){t.prototype.destroy.call(this),this._stereo=null,this._panner=null},e}(h),ReverbFilter:function(t){function e(e,i,r){void 0===e&&(e=3),void 0===i&&(i=2),void 0===r&&(r=!1);var n=this;if(!p().useLegacy)return(n=t.call(this,null)||this)._seconds=n._clamp(e,1,50),n._decay=n._clamp(i,0,100),n._reverse=r,n._rebuild(),n;n=t.call(this,null)||this}return u(e,t),e.prototype._clamp=function(t,e,i){return Math.min(i,Math.max(e,t))},Object.defineProperty(e.prototype,"seconds",{get:function(){return this._seconds},set:function(t){this._seconds=this._clamp(t,1,50),this._rebuild()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"decay",{get:function(){return this._decay},set:function(t){this._decay=this._clamp(t,0,100),this._rebuild()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reverse",{get:function(){return this._reverse},set:function(t){this._reverse=t,this._rebuild()},enumerable:!0,configurable:!0}),e.prototype._rebuild=function(){for(var t,e=p().context.audioContext,i=e.sampleRate,r=i*this._seconds,n=e.createBuffer(2,r,i),s=n.getChannelData(0),o=n.getChannelData(1),a=0;a<r;a++)t=this._reverse?r-a:a,s[a]=(2*Math.random()-1)*Math.pow(1-t/r,this._decay),o[a]=(2*Math.random()-1)*Math.pow(1-t/r,this._decay);var h=p().context.audioContext.createConvolver();h.buffer=n,this.init(h)},e}(h),MonoFilter:function(t){function e(){var e=this;if(!p().useLegacy){var i=p().context.audioContext,r=i.createChannelSplitter(),n=i.createChannelMerger();return n.connect(r),(e=t.call(this,n,r)||this)._merger=n,e}e=t.call(this,null)||this}return u(e,t),e.prototype.destroy=function(){this._merger.disconnect(),this._merger=null,t.prototype.destroy.call(this)},e}(h),TelephoneFilter:function(t){function e(){if(!p().useLegacy){var e=p().context.audioContext,i=e.createBiquadFilter(),r=e.createBiquadFilter(),n=e.createBiquadFilter(),s=e.createBiquadFilter();return i.type="lowpass",f.setParamValue(i.frequency,2e3),r.type="lowpass",f.setParamValue(r.frequency,2e3),n.type="highpass",f.setParamValue(n.frequency,500),s.type="highpass",f.setParamValue(s.frequency,500),i.connect(r),r.connect(n),n.connect(s),t.call(this,i,s)||this}t.call(this,null)}return u(e,t),e}(h)},w=0,T=function(t){function e(e){var i=t.call(this)||this;return i.id=w++,i.init(e),i}return u(e,t),e.prototype.set=function(t,e){if(void 0===this[t])throw new Error("Property with name "+t+" does not exist.");return this[t]=e,this},Object.defineProperty(e.prototype,"progress",{get:function(){return this._source.currentTime/this._duration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paused",{get:function(){return this._paused},set:function(t){this._paused=t,this.refreshPaused()},enumerable:!0,configurable:!0}),e.prototype._onPlay=function(){this._playing=!0},e.prototype._onPause=function(){this._playing=!1},e.prototype.init=function(t){this._playing=!1,this._duration=t.source.duration;var e=this._source=t.source.cloneNode(!1);e.src=t.parent.url,e.onplay=this._onPlay.bind(this),e.onpause=this._onPause.bind(this),t.context.on("refresh",this.refresh,this),t.context.on("refreshPaused",this.refreshPaused,this),this._media=t},e.prototype._internalStop=function(){this._source&&this._playing&&(this._source.onended=null,this._source.pause())},e.prototype.stop=function(){this._internalStop(),this._source&&this.emit("stop")},Object.defineProperty(e.prototype,"speed",{get:function(){return this._speed},set:function(t){this._speed=t,this.refresh()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"volume",{get:function(){return this._volume},set:function(t){this._volume=t,this.refresh()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=t,this.refresh()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"muted",{get:function(){return this._muted},set:function(t){this._muted=t,this.refresh()},enumerable:!0,configurable:!0}),e.prototype.refresh=function(){var t=this._media.context,e=this._media.parent;this._source.loop=this._loop||e.loop;var i=t.volume*(t.muted?0:1),r=e.volume*(e.muted?0:1),n=this._volume*(this._muted?0:1);this._source.volume=n*i*r,this._source.playbackRate=this._speed*t.speed*e.speed},e.prototype.refreshPaused=function(){var t=this._media.context,e=this._media.parent,i=this._paused||e.paused||t.paused;i!==this._pausedReal&&(this._pausedReal=i,i?(this._internalStop(),this.emit("paused")):(this.emit("resumed"),this.play({start:this._source.currentTime,end:this._end,volume:this._volume,speed:this._speed,loop:this._loop})),this.emit("pause",i))},e.prototype.play=function(t){var i=this,r=t.start,s=t.end,o=t.speed,a=t.loop,h=t.volume,l=t.muted;this._speed=o,this._volume=h,this._loop=!!a,this._muted=l,this.refresh(),this.loop&&null!==s&&(this.loop=!1),this._start=r,this._end=s||this._duration,this._start=Math.max(0,this._start-e.PADDING),this._end=Math.min(this._end+e.PADDING,this._duration),this._source.onloadedmetadata=function(){i._source&&(i._source.currentTime=r,i._source.onloadedmetadata=null,i.emit("progress",r,i._duration),n.Ticker.shared.add(i._onUpdate,i))},this._source.onended=this._onComplete.bind(this),this._source.play(),this.emit("start")},e.prototype._onUpdate=function(){this.emit("progress",this.progress,this._duration),this._source.currentTime>=this._end&&!this._source.loop&&this._onComplete()},e.prototype._onComplete=function(){n.Ticker.shared.remove(this._onUpdate,this),this._internalStop(),this.emit("progress",1,this._duration),this.emit("end",this)},e.prototype.destroy=function(){n.Ticker.shared.remove(this._onUpdate,this),this.removeAllListeners();var t=this._source;t&&(t.onended=null,t.onplay=null,t.onpause=null,this._internalStop()),this._source=null,this._speed=1,this._volume=1,this._loop=!1,this._end=null,this._start=0,this._duration=0,this._playing=!1,this._pausedReal=!1,this._paused=!1,this._muted=!1,this._media&&(this._media.context.off("refresh",this.refresh,this),this._media.context.off("refreshPaused",this.refreshPaused,this),this._media=null)},e.prototype.toString=function(){return"[HTMLAudioInstance id="+this.id+"]"},e.PADDING=.1,e}(s.EventEmitter),E=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.init=function(t){this.parent=t,this._source=t.options.source||new Audio,t.url&&(this._source.src=t.url)},e.prototype.create=function(){return new T(this)},Object.defineProperty(e.prototype,"isPlayable",{get:function(){return!!this._source&&4===this._source.readyState},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this._source.duration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"context",{get:function(){return this.parent.context},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"filters",{get:function(){return null},set:function(t){},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.removeAllListeners(),this.parent=null,this._source&&(this._source.src="",this._source.load(),this._source=null)},Object.defineProperty(e.prototype,"source",{get:function(){return this._source},enumerable:!0,configurable:!0}),e.prototype.load=function(t){var e=this._source,i=this.parent;if(4!==e.readyState){if(!i.url)return t(new Error("sound.url or sound.source must be set"));e.src=i.url;var r=function(){e.removeEventListener("canplaythrough",n),e.removeEventListener("load",n),e.removeEventListener("abort",s),e.removeEventListener("error",o)},n=function(){r(),i.isLoaded=!0;var e=i.autoPlayStart();t&&t(null,i,e)},s=function(){r(),t&&t(new Error("Sound loading has been aborted"))},o=function(){r();var i="Failed to load audio element (code: "+e.error.code+")";t&&t(new Error(i))};e.addEventListener("canplaythrough",n,!1),e.addEventListener("load",n,!1),e.addEventListener("abort",s,!1),e.addEventListener("error",o,!1),e.load()}else{i.isLoaded=!0;var a=i.autoPlayStart();t&&setTimeout((function(){t(null,i,a)}),0)}},e}(s.EventEmitter),S=function(t){function e(){var e=t.call(this)||this;return e.speed=1,e.volume=1,e.muted=!1,e.paused=!1,e}return u(e,t),e.prototype.refresh=function(){this.emit("refresh")},e.prototype.refreshPaused=function(){this.emit("refreshPaused")},Object.defineProperty(e.prototype,"filters",{get:function(){return null},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"audioContext",{get:function(){return null},enumerable:!0,configurable:!0}),e.prototype.toggleMute=function(){return this.muted=!this.muted,this.refresh(),this.muted},e.prototype.togglePause=function(){return this.paused=!this.paused,this.refreshPaused(),this.paused},e.prototype.destroy=function(){this.removeAllListeners()},e}(s.EventEmitter),P={HTMLAudioMedia:E,HTMLAudioInstance:T,HTMLAudioContext:S},O=["mp3","ogg","oga","opus","mpeg","wav","m4a","aiff","wma","mid"];var C,I,M,A,R=(C={m4a:"mp4",oga:"ogg"},I=document.createElement("audio"),M={},A=/^no$/,O.forEach((function(t){var e=C[t]||t,i=I.canPlayType("audio/"+t).replace(A,""),r=I.canPlayType("audio/"+e).replace(A,"");M[t]=!!i||!!r})),Object.freeze(M)),D=/\.(\{([^\}]+)\})(\?.*)?$/;function N(t){var e=D,i="string"==typeof t?t:t.url;if(e.test(i)){for(var r=e.exec(i),n=r[2].split(","),s=n[n.length-1],o=0,a=n.length;o<a;o++){var h=n[o];if(R[h]){s=h;break}}var l=i.replace(r[1],s);return"string"!=typeof t&&(t.extension=s,t.url=l),l}return i}var L=function(){function t(){}return t.add=function(){t.legacy=p().useLegacy},Object.defineProperty(t,"legacy",{set:function(t){var e=O;t?e.forEach((function(t){r.LoaderResource.setExtensionXhrType(t,r.LoaderResource.XHR_RESPONSE_TYPE.DEFAULT),r.LoaderResource.setExtensionLoadType(t,r.LoaderResource.LOAD_TYPE.AUDIO)})):e.forEach((function(t){r.LoaderResource.setExtensionXhrType(t,r.LoaderResource.XHR_RESPONSE_TYPE.BUFFER),r.LoaderResource.setExtensionLoadType(t,r.LoaderResource.LOAD_TYPE.XHR)}))},enumerable:!0,configurable:!0}),t.pre=function(t,e){N(t),e()},t.use=function(t,e){t.data&&O.indexOf(t.extension)>-1?t.sound=p().add(t.name,{loaded:e,preload:!0,url:t.url,source:t.data}):e()},t}(),k=function(){function t(t,e){this.parent=t,Object.assign(this,e),this.duration=this.end-this.start}return t.prototype.play=function(t){return this.parent.play({complete:t,speed:this.speed||this.parent.speed,end:this.end,start:this.start,loop:this.loop})},t.prototype.destroy=function(){this.parent=null},t}(),F=function(){function t(t,e){this.media=t,this.options=e,this._instances=[],this._sprites={},this.media.init(this);var i=e.complete;this._autoPlayOptions=i?{complete:i}:null,this.isLoaded=!1,this.isPlaying=!1,this.autoPlay=e.autoPlay,this.singleInstance=e.singleInstance,this.preload=e.preload||this.autoPlay,this.url=e.url,this.speed=e.speed,this.volume=e.volume,this.loop=e.loop,e.sprites&&this.addSprites(e.sprites),this.preload&&this._preload(e.loaded)}return t.from=function(e){var i={};return"string"==typeof e?i.url=e:e instanceof ArrayBuffer||e instanceof HTMLAudioElement?i.source=e:i=e,(i=d({autoPlay:!1,singleInstance:!1,url:null,source:null,preload:!1,volume:1,speed:1,complete:null,loaded:null,loop:!1},i)).url&&(i.url=N(i.url)),Object.freeze(i),new t(p().useLegacy?new E:new _,i)},Object.defineProperty(t.prototype,"context",{get:function(){return p().context},enumerable:!0,configurable:!0}),t.prototype.pause=function(){return this.isPlaying=!1,this.paused=!0,this},t.prototype.resume=function(){return this.isPlaying=this._instances.length>0,this.paused=!1,this},Object.defineProperty(t.prototype,"paused",{get:function(){return this._paused},set:function(t){this._paused=t,this.refreshPaused()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"speed",{get:function(){return this._speed},set:function(t){this._speed=t,this.refresh()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filters",{get:function(){return this.media.filters},set:function(t){this.media.filters=t},enumerable:!0,configurable:!0}),t.prototype.addSprites=function(t,e){if("object"==typeof t){var i={};for(var r in t)i[r]=this.addSprites(r,t[r]);return i}if("string"==typeof t){var n=new k(this,e);return this._sprites[t]=n,n}},t.prototype.destroy=function(){this._removeInstances(),this.removeSprites(),this.media.destroy(),this.media=null,this._sprites=null,this._instances=null},t.prototype.removeSprites=function(t){if(t){var e=this._sprites[t];void 0!==e&&(e.destroy(),delete this._sprites[t])}else for(var i in this._sprites)this.removeSprites(i);return this},Object.defineProperty(t.prototype,"isPlayable",{get:function(){return this.isLoaded&&this.media&&this.media.isPlayable},enumerable:!0,configurable:!0}),t.prototype.stop=function(){if(!this.isPlayable)return this.autoPlay=!1,this._autoPlayOptions=null,this;this.isPlaying=!1;for(var t=this._instances.length-1;t>=0;t--)this._instances[t].stop();return this},t.prototype.play=function(t,e){var i,r=this;if("string"==typeof t?i={sprite:s=t,loop:this.loop,complete:e}:"function"==typeof t?(i={}).complete=t:i=t,(i=d({complete:null,loaded:null,sprite:null,end:null,start:0,volume:1,speed:1,muted:!1,loop:!1},i||{})).sprite){var n=i.sprite,s=this._sprites[n];i.start=s.start,i.end=s.end,i.speed=s.speed||1,i.loop=s.loop||i.loop,delete i.sprite}if(i.offset&&(i.start=i.offset),!this.isLoaded)return new Promise((function(t,e){r.autoPlay=!0,r._autoPlayOptions=i,r._preload((function(r,n,s){r?e(r):(i.loaded&&i.loaded(r,n,s),t(s))}))}));this.singleInstance&&this._removeInstances();var o=this._createInstance();return this._instances.push(o),this.isPlaying=!0,o.once("end",(function(){i.complete&&i.complete(r),r._onComplete(o)})),o.once("stop",(function(){r._onComplete(o)})),o.play(i),o},t.prototype.refresh=function(){for(var t=this._instances.length,e=0;e<t;e++)this._instances[e].refresh()},t.prototype.refreshPaused=function(){for(var t=this._instances.length,e=0;e<t;e++)this._instances[e].refreshPaused()},Object.defineProperty(t.prototype,"volume",{get:function(){return this._volume},set:function(t){this._volume=t,this.refresh()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"muted",{get:function(){return this._muted},set:function(t){this._muted=t,this.refresh()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=t,this.refresh()},enumerable:!0,configurable:!0}),t.prototype._preload=function(t){this.media.load(t)},Object.defineProperty(t.prototype,"instances",{get:function(){return this._instances},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sprites",{get:function(){return this._sprites},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){return this.media.duration},enumerable:!0,configurable:!0}),t.prototype.autoPlayStart=function(){var t;return this.autoPlay&&(t=this.play(this._autoPlayOptions)),t},t.prototype._removeInstances=function(){for(var t=this._instances.length-1;t>=0;t--)this._poolInstance(this._instances[t]);this._instances.length=0},t.prototype._onComplete=function(t){if(this._instances){var e=this._instances.indexOf(t);e>-1&&this._instances.splice(e,1),this.isPlaying=this._instances.length>0}this._poolInstance(t)},t.prototype._createInstance=function(){if(t._pool.length>0){var e=t._pool.pop();return e.init(this.media),e}return this.media.create()},t.prototype._poolInstance=function(e){e.destroy(),t._pool.indexOf(e)<0&&t._pool.push(e)},t._pool=[],t}(),B=function(){function t(){this.init()}return t.prototype.init=function(){return this.supported&&(this._webAudioContext=new v),this._htmlAudioContext=new S,this._sounds={},this.useLegacy=!this.supported,this},Object.defineProperty(t.prototype,"context",{get:function(){return this._context},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filtersAll",{get:function(){return this.useLegacy?[]:this._context.filters},set:function(t){this.useLegacy||(this._context.filters=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"supported",{get:function(){return null!==v.AudioContext},enumerable:!0,configurable:!0}),t.prototype.add=function(t,e){if("object"==typeof t){var i={};for(var r in t){var n=this._getOptions(t[r],e);i[r]=this.add(r,n)}return i}if("string"==typeof t){if(e instanceof F)return this._sounds[t]=e,e;n=this._getOptions(e);var s=F.from(n);return this._sounds[t]=s,s}},t.prototype._getOptions=function(t,e){var i;return i="string"==typeof t?{url:t}:t instanceof ArrayBuffer||t instanceof HTMLAudioElement?{source:t}:t,d({},i,e||{})},Object.defineProperty(t.prototype,"useLegacy",{get:function(){return this._useLegacy},set:function(t){L.legacy=t,this._useLegacy=t,this._context=!t&&this.supported?this._webAudioContext:this._htmlAudioContext},enumerable:!0,configurable:!0}),t.prototype.remove=function(t){return this.exists(t,!0),this._sounds[t].destroy(),delete this._sounds[t],this},Object.defineProperty(t.prototype,"volumeAll",{get:function(){return this._context.volume},set:function(t){this._context.volume=t,this._context.refresh()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"speedAll",{get:function(){return this._context.speed},set:function(t){this._context.speed=t,this._context.refresh()},enumerable:!0,configurable:!0}),t.prototype.togglePauseAll=function(){return this._context.togglePause()},t.prototype.pauseAll=function(){return this._context.paused=!0,this._context.refreshPaused(),this},t.prototype.resumeAll=function(){return this._context.paused=!1,this._context.refreshPaused(),this},t.prototype.toggleMuteAll=function(){return this._context.toggleMute()},t.prototype.muteAll=function(){return this._context.muted=!0,this._context.refresh(),this},t.prototype.unmuteAll=function(){return this._context.muted=!1,this._context.refresh(),this},t.prototype.removeAll=function(){for(var t in this._sounds)this._sounds[t].destroy(),delete this._sounds[t];return this},t.prototype.stopAll=function(){for(var t in this._sounds)this._sounds[t].stop();return this},t.prototype.exists=function(t,e){return void 0===e&&(e=!1),!!this._sounds[t]},t.prototype.find=function(t){return this.exists(t,!0),this._sounds[t]},t.prototype.play=function(t,e){return this.find(t).play(e)},t.prototype.stop=function(t){return this.find(t).stop()},t.prototype.pause=function(t){return this.find(t).pause()},t.prototype.resume=function(t){return this.find(t).resume()},t.prototype.volume=function(t,e){var i=this.find(t);return void 0!==e&&(i.volume=e),i.volume},t.prototype.speed=function(t,e){var i=this.find(t);return void 0!==e&&(i.speed=e),i.speed},t.prototype.duration=function(t){return this.find(t).duration},t.prototype.close=function(){return this.removeAll(),this._sounds=null,this._webAudioContext&&(this._webAudioContext.destroy(),this._webAudioContext=null),this._htmlAudioContext&&(this._htmlAudioContext.destroy(),this._htmlAudioContext=null),this._context=null,this},t}(),U=0;var j={get PLAY_ID(){return U},playOnce:function(t,e){var i="alias"+U++;return p().add(i,{url:t,preload:!0,autoPlay:!0,loaded:function(t){t&&(p().remove(i),e&&e(t))},complete:function(){p().remove(i),e&&e(null)}}),i},render:function(t,e){var i=document.createElement("canvas");e=d({width:512,height:128,fill:"black"},e||{}),i.width=e.width,i.height=e.height;var r=o.BaseTexture.from(i);if(!(t.media instanceof _))return r;var n=t.media,s=i.getContext("2d");s.fillStyle=e.fill;for(var a=n.buffer.getChannelData(0),h=Math.ceil(a.length/e.width),l=e.height/2,u=0;u<e.width;u++){for(var c=1,p=-1,f=0;f<h;f++){var g=a[u*h+f];g<c&&(c=g),g>p&&(p=g)}s.fillRect(u,(1+c)*l,1,Math.max(1,(p-c)*l))}return r},resolveUrl:N,sineTone:function(t,e){void 0===t&&(t=200),void 0===e&&(e=1);var i=F.from({singleInstance:!0});if(!(i.media instanceof _))return i;for(var r=i.media,n=i.context.audioContext.createBuffer(1,48e3*e,48e3),s=n.getChannelData(0),o=0;o<s.length;o++){var a=t*(o/n.sampleRate)*Math.PI;s[o]=2*Math.sin(a)}return r.buffer=n,i.isLoaded=!0,i},extensions:O,supported:R},H=function(t){return c=t,t}(new B);r.Loader.registerPlugin(L),Object.defineProperties(H,{Filterable:{get:function(){return a}},filters:{get:function(){return b}},htmlaudio:{get:function(){return P}},Sound:{get:function(){return F}},SoundLibrary:{get:function(){return B}},SoundSprite:{get:function(){return k}},utils:{get:function(){return j}},webaudio:{get:function(){return x}},sound:{get:function(){return H}}}),e.exports=H},{"@pixi/core":4,"@pixi/loaders":15,"@pixi/ticker":33,"@pixi/utils":34}],45:[function(t,e,i){
/*!
 * pixi.js - v5.2.2
 * Compiled Tue, 21 Apr 2020 03:53:51 UTC
 *
 * pixi.js is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
"use strict";Object.defineProperty(i,"__esModule",{value:!0}),t("@pixi/polyfill");var r=t("@pixi/accessibility"),n=t("@pixi/interaction"),s=t("@pixi/utils"),o=t("@pixi/app"),a=t("@pixi/core"),h=t("@pixi/extract"),l=t("@pixi/loaders"),u=t("@pixi/particles"),c=t("@pixi/prepare"),d=t("@pixi/spritesheet"),p=t("@pixi/sprite-tiling"),f=t("@pixi/text-bitmap"),g=t("@pixi/ticker"),m=t("@pixi/filter-alpha"),y=t("@pixi/filter-blur"),_=t("@pixi/filter-color-matrix"),v=t("@pixi/filter-displacement"),x=t("@pixi/filter-fxaa"),b=t("@pixi/filter-noise");t("@pixi/mixin-cache-as-bitmap"),t("@pixi/mixin-get-child-by-name"),t("@pixi/mixin-get-global-position");var w=t("@pixi/constants"),T=t("@pixi/display"),E=t("@pixi/graphics"),S=t("@pixi/math"),P=t("@pixi/mesh"),O=t("@pixi/mesh-extras"),C=t("@pixi/runner"),I=t("@pixi/sprite"),M=t("@pixi/sprite-animated"),A=t("@pixi/text"),R=t("@pixi/settings"),D="5.0.0";a.Renderer.registerPlugin("accessibility",r.AccessibilityManager),a.Renderer.registerPlugin("extract",h.Extract),a.Renderer.registerPlugin("interaction",n.InteractionManager),a.Renderer.registerPlugin("particle",u.ParticleRenderer),a.Renderer.registerPlugin("prepare",c.Prepare),a.Renderer.registerPlugin("batch",a.BatchRenderer),a.Renderer.registerPlugin("tilingSprite",p.TilingSpriteRenderer),l.Loader.registerPlugin(f.BitmapFontLoader),l.Loader.registerPlugin(d.SpritesheetLoader),o.Application.registerPlugin(g.TickerPlugin),o.Application.registerPlugin(l.AppLoaderPlugin);var N={AlphaFilter:m.AlphaFilter,BlurFilter:y.BlurFilter,BlurFilterPass:y.BlurFilterPass,ColorMatrixFilter:_.ColorMatrixFilter,DisplacementFilter:v.DisplacementFilter,FXAAFilter:x.FXAAFilter,NoiseFilter:b.NoiseFilter};Object.keys(o).forEach((function(t){Object.defineProperty(i,t,{enumerable:!0,get:function(){return o[t]}})})),Object.keys(a).forEach((function(t){Object.defineProperty(i,t,{enumerable:!0,get:function(){return a[t]}})})),Object.keys(h).forEach((function(t){Object.defineProperty(i,t,{enumerable:!0,get:function(){return h[t]}})})),Object.keys(l).forEach((function(t){Object.defineProperty(i,t,{enumerable:!0,get:function(){return l[t]}})})),Object.keys(u).forEach((function(t){Object.defineProperty(i,t,{enumerable:!0,get:function(){return u[t]}})})),Object.keys(c).forEach((function(t){Object.defineProperty(i,t,{enumerable:!0,get:function(){return c[t]}})})),Object.keys(d).forEach((function(t){Object.defineProperty(i,t,{enumerable:!0,get:function(){return d[t]}})})),Object.keys(p).forEach((function(t){Object.defineProperty(i,t,{enumerable:!0,get:function(){return p[t]}})})),Object.keys(f).forEach((function(t){Object.defineProperty(i,t,{enumerable:!0,get:function(){return f[t]}})})),Object.keys(g).forEach((function(t){Object.defineProperty(i,t,{enumerable:!0,get:function(){return g[t]}})})),Object.keys(w).forEach((function(t){Object.defineProperty(i,t,{enumerable:!0,get:function(){return w[t]}})})),Object.keys(T).forEach((function(t){Object.defineProperty(i,t,{enumerable:!0,get:function(){return T[t]}})})),Object.keys(E).forEach((function(t){Object.defineProperty(i,t,{enumerable:!0,get:function(){return E[t]}})})),Object.keys(S).forEach((function(t){Object.defineProperty(i,t,{enumerable:!0,get:function(){return S[t]}})})),Object.keys(P).forEach((function(t){Object.defineProperty(i,t,{enumerable:!0,get:function(){return P[t]}})})),Object.keys(O).forEach((function(t){Object.defineProperty(i,t,{enumerable:!0,get:function(){return O[t]}})})),Object.keys(C).forEach((function(t){Object.defineProperty(i,t,{enumerable:!0,get:function(){return C[t]}})})),Object.keys(I).forEach((function(t){Object.defineProperty(i,t,{enumerable:!0,get:function(){return I[t]}})})),Object.keys(M).forEach((function(t){Object.defineProperty(i,t,{enumerable:!0,get:function(){return M[t]}})})),Object.keys(A).forEach((function(t){Object.defineProperty(i,t,{enumerable:!0,get:function(){return A[t]}})})),Object.keys(R).forEach((function(t){Object.defineProperty(i,t,{enumerable:!0,get:function(){return R[t]}})})),i.accessibility=r,i.interaction=n,i.utils=s,i.VERSION="5.2.2",i.filters=N,i.useDeprecated=function(){var t=this;Object.defineProperties(t,{SVG_SIZE:{get:function(){return s.deprecation(D,"PIXI.utils.SVG_SIZE property has moved to PIXI.resources.SVGResource.SVG_SIZE"),t.SVGResource.SVG_SIZE}},TransformStatic:{get:function(){return s.deprecation(D,"PIXI.TransformStatic class has been removed, use PIXI.Transform"),t.Transform}},TransformBase:{get:function(){return s.deprecation(D,"PIXI.TransformBase class has been removed, use PIXI.Transform"),t.Transform}},TRANSFORM_MODE:{get:function(){return s.deprecation(D,"PIXI.TRANSFORM_MODE property has been removed"),{STATIC:0,DYNAMIC:1}}},WebGLRenderer:{get:function(){return s.deprecation(D,"PIXI.WebGLRenderer class has moved to PIXI.Renderer"),t.Renderer}},CanvasRenderTarget:{get:function(){return s.deprecation(D,"PIXI.CanvasRenderTarget class has moved to PIXI.utils.CanvasRenderTarget"),t.utils.CanvasRenderTarget}},loader:{get:function(){return s.deprecation(D,"PIXI.loader instance has moved to PIXI.Loader.shared"),t.Loader.shared}},FilterManager:{get:function(){return s.deprecation(D,"PIXI.FilterManager class has moved to PIXI.systems.FilterSystem"),t.systems.FilterSystem}},CanvasTinter:{get:function(){return s.deprecation("5.2.0","PIXI.CanvasTinter namespace has moved to PIXI.canvasUtils"),t.canvasUtils}},GroupD8:{get:function(){return s.deprecation("5.2.0","PIXI.GroupD8 namespace has moved to PIXI.groupD8"),t.groupD8}}}),t.prepare={},Object.defineProperties(t.prepare,{BasePrepare:{get:function(){return s.deprecation("5.2.1","PIXI.prepare.BasePrepare moved to PIXI.BasePrepare"),t.BasePrepare}},Prepare:{get:function(){return s.deprecation("5.2.1","PIXI.prepare.Prepare moved to PIXI.Prepare"),t.Prepare}},CanvasPrepare:{get:function(){return s.deprecation("5.2.1","PIXI.prepare.CanvasPrepare moved to PIXI.CanvasPrepare"),t.CanvasPrepare}}}),t.extract={},Object.defineProperties(t.extract,{Extract:{get:function(){return s.deprecation("5.2.1","PIXI.extract.Extract moved to PIXI.Extract"),t.Extract}},CanvasExtract:{get:function(){return s.deprecation("5.2.1","PIXI.extract.CanvasExtract moved to PIXI.CanvasExtract"),t.CanvasExtract}}}),t.extras={},Object.defineProperties(t.extras,{TilingSprite:{get:function(){return s.deprecation(D,"PIXI.extras.TilingSprite class has moved to PIXI.TilingSprite"),t.TilingSprite}},TilingSpriteRenderer:{get:function(){return s.deprecation(D,"PIXI.extras.TilingSpriteRenderer class has moved to PIXI.TilingSpriteRenderer"),t.TilingSpriteRenderer}},AnimatedSprite:{get:function(){return s.deprecation(D,"PIXI.extras.AnimatedSprite class has moved to PIXI.AnimatedSprite"),t.AnimatedSprite}},BitmapText:{get:function(){return s.deprecation(D,"PIXI.extras.BitmapText class has moved to PIXI.BitmapText"),t.BitmapText}}}),Object.defineProperties(t.utils,{getSvgSize:{get:function(){return s.deprecation(D,"PIXI.utils.getSvgSize function has moved to PIXI.resources.SVGResource.getSize"),t.SVGResource.getSize}}}),t.mesh={},Object.defineProperties(t.mesh,{Mesh:{get:function(){return s.deprecation(D,"PIXI.mesh.Mesh class has moved to PIXI.SimpleMesh"),t.SimpleMesh}},NineSlicePlane:{get:function(){return s.deprecation(D,"PIXI.mesh.NineSlicePlane class has moved to PIXI.NineSlicePlane"),t.NineSlicePlane}},Plane:{get:function(){return s.deprecation(D,"PIXI.mesh.Plane class has moved to PIXI.SimplePlane"),t.SimplePlane}},Rope:{get:function(){return s.deprecation(D,"PIXI.mesh.Rope class has moved to PIXI.SimpleRope"),t.SimpleRope}},RawMesh:{get:function(){return s.deprecation(D,"PIXI.mesh.RawMesh class has moved to PIXI.Mesh"),t.Mesh}},CanvasMeshRenderer:{get:function(){return s.deprecation(D,"PIXI.mesh.CanvasMeshRenderer class has moved to PIXI.CanvasMeshRenderer"),t.CanvasMeshRenderer}},MeshRenderer:{get:function(){return s.deprecation(D,"PIXI.mesh.MeshRenderer class has moved to PIXI.MeshRenderer"),t.MeshRenderer}}}),t.particles={},Object.defineProperties(t.particles,{ParticleContainer:{get:function(){return s.deprecation(D,"PIXI.particles.ParticleContainer class has moved to PIXI.ParticleContainer"),t.ParticleContainer}},ParticleRenderer:{get:function(){return s.deprecation(D,"PIXI.particles.ParticleRenderer class has moved to PIXI.ParticleRenderer"),t.ParticleRenderer}}}),t.ticker={},Object.defineProperties(t.ticker,{Ticker:{get:function(){return s.deprecation(D,"PIXI.ticker.Ticker class has moved to PIXI.Ticker"),t.Ticker}},shared:{get:function(){return s.deprecation(D,"PIXI.ticker.shared instance has moved to PIXI.Ticker.shared"),t.Ticker.shared}}}),t.loaders={},Object.defineProperties(t.loaders,{Loader:{get:function(){return s.deprecation(D,"PIXI.loaders.Loader class has moved to PIXI.Loader"),t.Loader}},Resource:{get:function(){return s.deprecation(D,"PIXI.loaders.Resource class has moved to PIXI.LoaderResource"),t.LoaderResource}},bitmapFontParser:{get:function(){return s.deprecation(D,"PIXI.loaders.bitmapFontParser function has moved to PIXI.BitmapFontLoader.use"),t.BitmapFontLoader.use}},parseBitmapFontData:{get:function(){return s.deprecation(D,"PIXI.loaders.parseBitmapFontData function has moved to PIXI.BitmapFontLoader.parse"),t.BitmapFontLoader.parse}},spritesheetParser:{get:function(){return s.deprecation(D,"PIXI.loaders.spritesheetParser function has moved to PIXI.SpritesheetLoader.use"),t.SpritesheetLoader.use}},getResourcePath:{get:function(){return s.deprecation(D,"PIXI.loaders.getResourcePath property has moved to PIXI.SpritesheetLoader.getResourcePath"),t.SpritesheetLoader.getResourcePath}}}),t.Loader.addPixiMiddleware=function(e){return s.deprecation(D,"PIXI.loaders.Loader.addPixiMiddleware function is deprecated, use PIXI.loaders.Loader.registerPlugin"),t.loaders.Loader.registerPlugin({use:e()})},Object.defineProperty(t.extract,"WebGLExtract",{get:function(){return s.deprecation(D,"PIXI.extract.WebGLExtract method has moved to PIXI.Extract"),t.Extract}}),Object.defineProperty(t.prepare,"WebGLPrepare",{get:function(){return s.deprecation(D,"PIXI.prepare.WebGLPrepare class has moved to PIXI.Prepare"),t.Prepare}}),t.Container.prototype._renderWebGL=function(t){s.deprecation(D,"PIXI.Container._renderWebGL method has moved to PIXI.Container._render"),this._render(t)},t.Container.prototype.renderWebGL=function(t){s.deprecation(D,"PIXI.Container.renderWebGL method has moved to PIXI.Container.render"),this.render(t)},t.DisplayObject.prototype.renderWebGL=function(t){s.deprecation(D,"PIXI.DisplayObject.renderWebGL method has moved to PIXI.DisplayObject.render"),this.render(t)},t.Container.prototype.renderAdvancedWebGL=function(t){s.deprecation(D,"PIXI.Container.renderAdvancedWebGL method has moved to PIXI.Container.renderAdvanced"),this.renderAdvanced(t)},Object.defineProperties(t.settings,{TRANSFORM_MODE:{get:function(){return s.deprecation(D,"PIXI.settings.TRANSFORM_MODE property has been removed"),0},set:function(){s.deprecation(D,"PIXI.settings.TRANSFORM_MODE property has been removed")}}});var e=t.BaseTexture;e.prototype.loadSource=function(e){s.deprecation(D,"PIXI.BaseTexture.loadSource method has been deprecated");var i=t.resources.autoDetectResource(e);i.internal=!0,this.setResource(i),this.update()};var i=!1;Object.defineProperties(e.prototype,{hasLoaded:{get:function(){return s.deprecation(D,"PIXI.BaseTexture.hasLoaded property has been removed, use PIXI.BaseTexture.valid"),this.valid}},imageUrl:{get:function(){return s.deprecation(D,"PIXI.BaseTexture.imageUrl property has been removed, use PIXI.BaseTexture.resource.url"),this.resource&&this.resource.url},set:function(t){s.deprecation(D,"PIXI.BaseTexture.imageUrl property has been removed, use PIXI.BaseTexture.resource.url"),this.resource&&(this.resource.url=t)}},source:{get:function(){return s.deprecation(D,"PIXI.BaseTexture.source property has been moved, use `PIXI.BaseTexture.resource.source`"),this.resource&&this.resource.source},set:function(t){s.deprecation(D,"PIXI.BaseTexture.source property has been moved, use `PIXI.BaseTexture.resource.source` if you want to set HTMLCanvasElement. Otherwise, create new BaseTexture."),this.resource&&(this.resource.source=t)}},premultiplyAlpha:{get:function(){return s.deprecation("5.2.0","PIXI.BaseTexture.premultiplyAlpha property has been changed to `alphaMode`, see `PIXI.ALPHA_MODES`"),0!==this.alphaMode},set:function(t){s.deprecation("5.2.0","PIXI.BaseTexture.premultiplyAlpha property has been changed to `alphaMode`, see `PIXI.ALPHA_MODES`"),this.alphaMode=Number(t)}},_id:{get:function(){return i||(s.deprecation("5.2.0","PIXI.BaseTexture._id batch local field has been changed to `_batchLocation`"),i=!0),this._batchLocation},set:function(t){this._batchLocation=t}}}),e.fromImage=function(t,i,r,n){s.deprecation(D,"PIXI.BaseTexture.fromImage method has been replaced with PIXI.BaseTexture.from");var o={scale:n,crossorigin:i};return e.from(t,{scaleMode:r,resourceOptions:o})},e.fromCanvas=function(t,i){return s.deprecation(D,"PIXI.BaseTexture.fromCanvas method has been replaced with PIXI.BaseTexture.from"),e.from(t,{scaleMode:i})},e.fromSVG=function(t,i,r,n){s.deprecation(D,"PIXI.BaseTexture.fromSVG method has been replaced with PIXI.BaseTexture.from");var o={scale:n,crossorigin:i};return e.from(t,{scaleMode:r,resourceOptions:o})},Object.defineProperties(t.resources.ImageResource.prototype,{premultiplyAlpha:{get:function(){return s.deprecation("5.2.0","PIXI.resources.ImageResource.premultiplyAlpha property has been changed to `alphaMode`, see `PIXI.ALPHA_MODES`"),0!==this.alphaMode},set:function(t){s.deprecation("5.2.0","PIXI.resources.ImageResource.premultiplyAlpha property has been changed to `alphaMode`, see `PIXI.ALPHA_MODES`"),this.alphaMode=Number(t)}}}),t.Point.prototype.copy=function(t){return s.deprecation(D,"PIXI.Point.copy method has been replaced with PIXI.Point.copyFrom"),this.copyFrom(t)},t.ObservablePoint.prototype.copy=function(t){return s.deprecation(D,"PIXI.ObservablePoint.copy method has been replaced with PIXI.ObservablePoint.copyFrom"),this.copyFrom(t)},t.Rectangle.prototype.copy=function(t){return s.deprecation(D,"PIXI.Rectangle.copy method has been replaced with PIXI.Rectangle.copyFrom"),this.copyFrom(t)},t.Matrix.prototype.copy=function(t){return s.deprecation(D,"PIXI.Matrix.copy method has been replaced with PIXI.Matrix.copyTo"),this.copyTo(t)},t.systems.StateSystem.prototype.setState=function(t){return s.deprecation("v5.1.0","StateSystem.setState has been renamed to StateSystem.set"),this.set(t)},Object.assign(t.systems.FilterSystem.prototype,{getRenderTarget:function(t,e){return s.deprecation(D,"PIXI.FilterManager.getRenderTarget method has been replaced with PIXI.systems.FilterSystem#getFilterTexture"),this.getFilterTexture(e)},returnRenderTarget:function(t){s.deprecation(D,"PIXI.FilterManager.returnRenderTarget method has been replaced with PIXI.systems.FilterSystem.returnFilterTexture"),this.returnFilterTexture(t)},calculateScreenSpaceMatrix:function(t){s.deprecation(D,"PIXI.systems.FilterSystem.calculateScreenSpaceMatrix method is removed, use `(vTextureCoord * inputSize.xy) + outputFrame.xy` instead");var e=t.identity(),i=this.activeState,r=i.sourceFrame,n=i.destinationFrame;return e.translate(r.x/n.width,r.y/n.height),e.scale(n.width,n.height),e},calculateNormalizedScreenSpaceMatrix:function(t){s.deprecation(D,"PIXI.systems.FilterManager.calculateNormalizedScreenSpaceMatrix method is removed, use `((vTextureCoord * inputSize.xy) + outputFrame.xy) / outputFrame.zw` instead.");var e=this.activeState,i=e.sourceFrame,r=e.destinationFrame,n=t.identity();n.translate(i.x/r.width,i.y/r.height);var o=r.width/i.width,a=r.height/i.height;return n.scale(o,a),n}}),Object.defineProperties(t.RenderTexture.prototype,{sourceFrame:{get:function(){return s.deprecation(D,"PIXI.RenderTexture.sourceFrame property has been removed"),this.filterFrame}},size:{get:function(){return s.deprecation(D,"PIXI.RenderTexture.size property has been removed"),this._frame}}});var r=function(t){function e(e,i,r,n){s.deprecation(D,"PIXI.filters.BlurXFilter class is deprecated, use PIXI.filters.BlurFilterPass"),t.call(this,!0,e,i,r,n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(t.filters.BlurFilterPass),n=function(t){function e(e,i,r,n){s.deprecation(D,"PIXI.filters.BlurYFilter class is deprecated, use PIXI.filters.BlurFilterPass"),t.call(this,!1,e,i,r,n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(t.filters.BlurFilterPass);Object.assign(t.filters,{BlurXFilter:r,BlurYFilter:n});var o=t.Sprite,a=t.Texture,h=t.Graphics;function l(t,e,i,r){return s.deprecation(D,"PIXI.Sprite."+t+" method is deprecated, use PIXI.Sprite.from"),o.from(e,{resourceOptions:{scale:r,crossorigin:i}})}function u(t,e,i,r){return s.deprecation(D,"PIXI.Texture."+t+" method is deprecated, use PIXI.Texture.from"),a.from(e,{resourceOptions:{scale:r,crossorigin:i}})}h.prototype.generateCanvasTexture||(h.prototype.generateCanvasTexture=function(){s.deprecation(D,'PIXI.Graphics.generateCanvasTexture method is only available in "pixi.js-legacy"')}),Object.defineProperty(t.Graphics.prototype,"graphicsData",{get:function(){return s.deprecation(D,"PIXI.Graphics.graphicsData property is deprecated, use PIXI.Graphics.geometry.graphicsData"),this.geometry.graphicsData}}),Object.defineProperty(t.SimpleRope.prototype,"points",{get:function(){return s.deprecation(D,"PIXI.SimpleRope.points property is deprecated, use PIXI.SimpleRope.geometry.points"),this.geometry.points},set:function(t){s.deprecation(D,"PIXI.SimpleRope.points property is deprecated, use PIXI.SimpleRope.geometry.points"),this.geometry.points=t}}),o.fromImage=l.bind(null,"fromImage"),o.fromSVG=l.bind(null,"fromSVG"),o.fromCanvas=l.bind(null,"fromCanvas"),o.fromVideo=l.bind(null,"fromVideo"),o.fromFrame=l.bind(null,"fromFrame"),a.fromImage=u.bind(null,"fromImage"),a.fromSVG=u.bind(null,"fromSVG"),a.fromCanvas=u.bind(null,"fromCanvas"),a.fromVideo=u.bind(null,"fromVideo"),a.fromFrame=u.bind(null,"fromFrame"),Object.defineProperty(t.AbstractRenderer.prototype,"autoResize",{get:function(){return s.deprecation(D,"PIXI.AbstractRenderer.autoResize property is deprecated, use PIXI.AbstractRenderer.autoDensity"),this.autoDensity},set:function(t){s.deprecation(D,"PIXI.AbstractRenderer.autoResize property is deprecated, use PIXI.AbstractRenderer.autoDensity"),this.autoDensity=t}}),Object.defineProperty(t.Renderer.prototype,"textureManager",{get:function(){return s.deprecation(D,"PIXI.Renderer.textureManager property is deprecated, use PIXI.Renderer.texture"),this.texture}}),t.utils.mixins={mixin:function(){s.deprecation(D,"PIXI.utils.mixins.mixin function is no longer available")},delayMixin:function(){s.deprecation(D,"PIXI.utils.mixins.delayMixin function is no longer available")},performMixins:function(){s.deprecation(D,"PIXI.utils.mixins.performMixins function is no longer available")}}}},{"@pixi/accessibility":1,"@pixi/app":2,"@pixi/constants":3,"@pixi/core":4,"@pixi/display":5,"@pixi/extract":6,"@pixi/filter-alpha":7,"@pixi/filter-blur":8,"@pixi/filter-color-matrix":9,"@pixi/filter-displacement":10,"@pixi/filter-fxaa":11,"@pixi/filter-noise":12,"@pixi/graphics":13,"@pixi/interaction":14,"@pixi/loaders":15,"@pixi/math":16,"@pixi/mesh":18,"@pixi/mesh-extras":17,"@pixi/mixin-cache-as-bitmap":19,"@pixi/mixin-get-child-by-name":20,"@pixi/mixin-get-global-position":21,"@pixi/particles":22,"@pixi/polyfill":23,"@pixi/prepare":24,"@pixi/runner":25,"@pixi/settings":26,"@pixi/sprite":29,"@pixi/sprite-animated":27,"@pixi/sprite-tiling":28,"@pixi/spritesheet":30,"@pixi/text":32,"@pixi/text-bitmap":31,"@pixi/ticker":33,"@pixi/utils":34}],46:[function(t,e,i){var r,n,s=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function h(t){if(r===setTimeout)return setTimeout(t,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:o}catch(t){r=o}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(t){n=a}}();var l,u=[],c=!1,d=-1;function p(){c&&l&&(c=!1,l.length?u=l.concat(u):d=-1,u.length&&f())}function f(){if(!c){var t=h(p);c=!0;for(var e=u.length;e;){for(l=u,u=[];++d<e;)l&&l[d].run();d=-1,e=u.length}l=null,c=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function g(t,e){this.fun=t,this.array=e}function m(){}s.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];u.push(new g(t,e)),1!==u.length||c||h(f)},g.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=m,s.addListener=m,s.once=m,s.off=m,s.removeListener=m,s.removeAllListeners=m,s.emit=m,s.prependListener=m,s.prependOnceListener=m,s.listeners=function(t){return[]},s.binding=function(t){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(t){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},{}],47:[function(t,e,i){(function(t){!function(r){var n="object"==typeof i&&i&&!i.nodeType&&i,s="object"==typeof e&&e&&!e.nodeType&&e,o="object"==typeof t&&t;o.global!==o&&o.window!==o&&o.self!==o||(r=o);var a,h,l=2147483647,u=/^xn--/,c=/[^\x20-\x7E]/,d=/[\x2E\u3002\uFF0E\uFF61]/g,p={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},f=Math.floor,g=String.fromCharCode;function m(t){throw RangeError(p[t])}function y(t,e){for(var i=t.length,r=[];i--;)r[i]=e(t[i]);return r}function _(t,e){var i=t.split("@"),r="";return i.length>1&&(r=i[0]+"@",t=i[1]),r+y((t=t.replace(d,".")).split("."),e).join(".")}function v(t){for(var e,i,r=[],n=0,s=t.length;n<s;)(e=t.charCodeAt(n++))>=55296&&e<=56319&&n<s?56320==(64512&(i=t.charCodeAt(n++)))?r.push(((1023&e)<<10)+(1023&i)+65536):(r.push(e),n--):r.push(e);return r}function x(t){return y(t,(function(t){var e="";return t>65535&&(e+=g((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+=g(t)})).join("")}function b(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function w(t,e,i){var r=0;for(t=i?f(t/700):t>>1,t+=f(t/e);t>455;r+=36)t=f(t/35);return f(r+36*t/(t+38))}function T(t){var e,i,r,n,s,o,a,h,u,c,d,p=[],g=t.length,y=0,_=128,v=72;for((i=t.lastIndexOf("-"))<0&&(i=0),r=0;r<i;++r)t.charCodeAt(r)>=128&&m("not-basic"),p.push(t.charCodeAt(r));for(n=i>0?i+1:0;n<g;){for(s=y,o=1,a=36;n>=g&&m("invalid-input"),((h=(d=t.charCodeAt(n++))-48<10?d-22:d-65<26?d-65:d-97<26?d-97:36)>=36||h>f((l-y)/o))&&m("overflow"),y+=h*o,!(h<(u=a<=v?1:a>=v+26?26:a-v));a+=36)o>f(l/(c=36-u))&&m("overflow"),o*=c;v=w(y-s,e=p.length+1,0==s),f(y/e)>l-_&&m("overflow"),_+=f(y/e),y%=e,p.splice(y++,0,_)}return x(p)}function E(t){var e,i,r,n,s,o,a,h,u,c,d,p,y,_,x,T=[];for(p=(t=v(t)).length,e=128,i=0,s=72,o=0;o<p;++o)(d=t[o])<128&&T.push(g(d));for(r=n=T.length,n&&T.push("-");r<p;){for(a=l,o=0;o<p;++o)(d=t[o])>=e&&d<a&&(a=d);for(a-e>f((l-i)/(y=r+1))&&m("overflow"),i+=(a-e)*y,e=a,o=0;o<p;++o)if((d=t[o])<e&&++i>l&&m("overflow"),d==e){for(h=i,u=36;!(h<(c=u<=s?1:u>=s+26?26:u-s));u+=36)x=h-c,_=36-c,T.push(g(b(c+x%_,0))),h=f(x/_);T.push(g(b(h,0))),s=w(i,y,r==n),i=0,++r}++i,++e}return T.join("")}if(a={version:"1.3.2",ucs2:{decode:v,encode:x},decode:T,encode:E,toASCII:function(t){return _(t,(function(t){return c.test(t)?"xn--"+E(t):t}))},toUnicode:function(t){return _(t,(function(t){return u.test(t)?T(t.slice(4).toLowerCase()):t}))}},"function"==typeof define&&"object"==typeof define.amd&&define.amd)define("punycode",(function(){return a}));else if(n&&s)if(e.exports==n)s.exports=a;else for(h in a)a.hasOwnProperty(h)&&(n[h]=a[h]);else r.punycode=a}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],48:[function(t,e,i){"use strict";function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.exports=function(t,e,i,s){e=e||"&",i=i||"=";var o={};if("string"!=typeof t||0===t.length)return o;var a=/\+/g;t=t.split(e);var h=1e3;s&&"number"==typeof s.maxKeys&&(h=s.maxKeys);var l=t.length;h>0&&l>h&&(l=h);for(var u=0;u<l;++u){var c,d,p,f,g=t[u].replace(a,"%20"),m=g.indexOf(i);m>=0?(c=g.substr(0,m),d=g.substr(m+1)):(c=g,d=""),p=decodeURIComponent(c),f=decodeURIComponent(d),r(o,p)?n(o[p])?o[p].push(f):o[p]=[o[p],f]:o[p]=f}return o};var n=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},{}],49:[function(t,e,i){"use strict";var r=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};e.exports=function(t,e,i,a){return e=e||"&",i=i||"=",null===t&&(t=void 0),"object"==typeof t?s(o(t),(function(o){var a=encodeURIComponent(r(o))+i;return n(t[o])?s(t[o],(function(t){return a+encodeURIComponent(r(t))})).join(e):a+encodeURIComponent(r(t[o]))})).join(e):a?encodeURIComponent(r(a))+i+encodeURIComponent(r(t)):""};var n=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function s(t,e){if(t.map)return t.map(e);for(var i=[],r=0;r<t.length;r++)i.push(e(t[r],r));return i}var o=Object.keys||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.push(i);return e}},{}],50:[function(t,e,i){"use strict";i.decode=i.parse=t("./decode"),i.encode=i.stringify=t("./encode")},{"./decode":48,"./encode":49}],51:[function(t,e,i){
/*!
 * resource-loader - v3.0.1
 * https://github.com/pixijs/pixi-sound
 * Compiled Tue, 02 Jul 2019 14:06:18 UTC
 *
 * resource-loader is licensed under the MIT license.
 * http://www.opensource.org/licenses/mit-license
 */
"use strict";function r(t){return t&&"object"==typeof t&&"default"in t?t.default:t}Object.defineProperty(i,"__esModule",{value:!0});var n=r(t("parse-uri")),s=r(t("mini-signals"));function o(){}function a(t,e,i,r){var n=0,s=t.length;!function o(a){a||n===s?i&&i(a):r?setTimeout((function(){e(t[n++],o)}),1):e(t[n++],o)}()}function h(t){return function(){if(null===t)throw new Error("Callback was already called.");var e=t;t=null,e.apply(this,arguments)}}function l(t,e){if(null==e)e=1;else if(0===e)throw new Error("Concurrency must not be zero");var i=0,r={_tasks:[],concurrency:e,saturated:o,unsaturated:o,buffer:e/4,empty:o,drain:o,error:o,started:!1,paused:!1,push:function(t,e){n(t,!1,e)},kill:function(){i=0,r.drain=o,r.started=!1,r._tasks=[]},unshift:function(t,e){n(t,!0,e)},process:function(){for(;!r.paused&&i<r.concurrency&&r._tasks.length;){var e=r._tasks.shift();0===r._tasks.length&&r.empty(),(i+=1)===r.concurrency&&r.saturated(),t(e.data,h(s(e)))}},length:function(){return r._tasks.length},running:function(){return i},idle:function(){return r._tasks.length+i===0},pause:function(){!0!==r.paused&&(r.paused=!0)},resume:function(){if(!1!==r.paused){r.paused=!1;for(var t=1;t<=r.concurrency;t++)r.process()}}};function n(t,e,i){if(null!=i&&"function"!=typeof i)throw new Error("task callback must be a function");if(r.started=!0,null==t&&r.idle())setTimeout((function(){return r.drain()}),1);else{var n={data:t,callback:"function"==typeof i?i:o};e?r._tasks.unshift(n):r._tasks.push(n),setTimeout((function(){return r.process()}),1)}}function s(t){return function(){i-=1,t.callback.apply(t,arguments),null!=arguments[0]&&r.error(arguments[0],t.data),i<=r.concurrency-r.buffer&&r.unsaturated(),r.idle()&&r.drain(),r.process()}}return r}var u={eachSeries:a,queue:l},c={};function d(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t,e,i){return e&&d(t.prototype,e),i&&d(t,i),t}var f=!(!window.XDomainRequest||"withCredentials"in new XMLHttpRequest),g=null;function m(){}var y=function(){function t(e,i,r){if("string"!=typeof e||"string"!=typeof i)throw new Error("Both name and url are required for constructing a resource.");r=r||{},this._flags=0,this._setFlag(t.STATUS_FLAGS.DATA_URL,0===i.indexOf("data:")),this.name=e,this.url=i,this.extension=this._getExtension(),this.data=null,this.crossOrigin=!0===r.crossOrigin?"anonymous":r.crossOrigin,this.timeout=r.timeout||0,this.loadType=r.loadType||this._determineLoadType(),this.xhrType=r.xhrType,this.metadata=r.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=t.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=m,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundOnTimeout=this._onTimeout.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this.onStart=new s,this.onProgress=new s,this.onComplete=new s,this.onAfterMiddleware=new s}t.setExtensionLoadType=function(e,i){_(t._loadTypeMap,e,i)},t.setExtensionXhrType=function(e,i){_(t._xhrTypeMap,e,i)};var e=t.prototype;return e.complete=function(){this._clearEvents(),this._finish()},e.abort=function(e){if(!this.error){if(this.error=new Error(e),this._clearEvents(),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=t.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this._finish()}},e.load=function(e){var i=this;if(!this.isLoading)if(this.isComplete)e&&setTimeout((function(){return e(i)}),1);else switch(e&&this.onComplete.once(e),this._setFlag(t.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),!1!==this.crossOrigin&&"string"==typeof this.crossOrigin||(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case t.LOAD_TYPE.IMAGE:this.type=t.TYPE.IMAGE,this._loadElement("image");break;case t.LOAD_TYPE.AUDIO:this.type=t.TYPE.AUDIO,this._loadSourceElement("audio");break;case t.LOAD_TYPE.VIDEO:this.type=t.TYPE.VIDEO,this._loadSourceElement("video");break;case t.LOAD_TYPE.XHR:default:f&&this.crossOrigin?this._loadXdr():this._loadXhr()}},e._hasFlag=function(t){return 0!=(this._flags&t)},e._setFlag=function(t,e){this._flags=e?this._flags|t:this._flags&~t},e._clearEvents=function(){clearTimeout(this._elementTimer),this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null))},e._finish=function(){if(this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(t.STATUS_FLAGS.COMPLETE,!0),this._setFlag(t.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},e._loadElement=function(t){this.metadata.loadElement?this.data=this.metadata.loadElement:"image"===t&&void 0!==window.Image?this.data=new Image:this.data=document.createElement(t),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},e._loadSourceElement=function(t){if(this.metadata.loadElement?this.data=this.metadata.loadElement:"audio"===t&&void 0!==window.Audio?this.data=new Audio:this.data=document.createElement(t),null!==this.data){if(this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var e=this.metadata.mimeType,i=0;i<this.url.length;++i)this.data.appendChild(this._createSource(t,this.url[i],Array.isArray(e)?e[i]:e));else{var r=this.metadata.mimeType;this.data.appendChild(this._createSource(t,this.url,Array.isArray(r)?r[0]:r))}this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load(),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))}else this.abort("Unsupported element: "+t)},e._loadXhr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var e=this.xhr=new XMLHttpRequest;e.open("GET",this.url,!0),e.timeout=this.timeout,this.xhrType===t.XHR_RESPONSE_TYPE.JSON||this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT?e.responseType=t.XHR_RESPONSE_TYPE.TEXT:e.responseType=this.xhrType,e.addEventListener("error",this._boundXhrOnError,!1),e.addEventListener("timeout",this._boundXhrOnTimeout,!1),e.addEventListener("abort",this._boundXhrOnAbort,!1),e.addEventListener("progress",this._boundOnProgress,!1),e.addEventListener("load",this._boundXhrOnLoad,!1),e.send()},e._loadXdr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XDomainRequest;t.timeout=this.timeout||5e3,t.onerror=this._boundXhrOnError,t.ontimeout=this._boundXhrOnTimeout,t.onprogress=this._boundOnProgress,t.onload=this._boundXhrOnLoad,t.open("GET",this.url,!0),setTimeout((function(){return t.send()}),1)},e._createSource=function(t,e,i){i||(i=t+"/"+this._getExtension(e));var r=document.createElement("source");return r.src=e,r.type=i,r},e._onError=function(t){this.abort("Failed to load element using: "+t.target.nodeName)},e._onProgress=function(t){t&&t.lengthComputable&&this.onProgress.dispatch(this,t.loaded/t.total)},e._onTimeout=function(){this.abort("Load timed out.")},e._xhrOnError=function(){var t=this.xhr;this.abort(v(t)+" Request failed. Status: "+t.status+', text: "'+t.statusText+'"')},e._xhrOnTimeout=function(){var t=this.xhr;this.abort(v(t)+" Request timed out.")},e._xhrOnAbort=function(){var t=this.xhr;this.abort(v(t)+" Request was aborted by the user.")},e._xhrOnLoad=function(){var e=this.xhr,i="",r=void 0===e.status?200:e.status;if(""!==e.responseType&&"text"!==e.responseType&&void 0!==e.responseType||(i=e.responseText),0===r&&(i.length>0||e.responseType===t.XHR_RESPONSE_TYPE.BUFFER)?r=200:1223===r&&(r=204),2===(r/100|0)){if(this.xhrType===t.XHR_RESPONSE_TYPE.TEXT)this.data=i,this.type=t.TYPE.TEXT;else if(this.xhrType===t.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(i),this.type=t.TYPE.JSON}catch(t){return void this.abort("Error trying to parse loaded json: "+t)}else if(this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser){var n=new DOMParser;this.data=n.parseFromString(i,"text/xml")}else{var s=document.createElement("div");s.innerHTML=i,this.data=s}this.type=t.TYPE.XML}catch(t){return void this.abort("Error trying to parse loaded xml: "+t)}else this.data=e.response||i;this.complete()}else this.abort("["+e.status+"] "+e.statusText+": "+e.responseURL)},e._determineCrossOrigin=function(t,e){if(0===t.indexOf("data:"))return"";if(window.origin!==window.location.origin)return"anonymous";e=e||window.location,g||(g=document.createElement("a")),g.href=t;var i=!(t=n(g.href,{strictMode:!0})).port&&""===e.port||t.port===e.port,r=t.protocol?t.protocol+":":"";return t.host===e.hostname&&i&&r===e.protocol?"":"anonymous"},e._determineXhrType=function(){return t._xhrTypeMap[this.extension]||t.XHR_RESPONSE_TYPE.TEXT},e._determineLoadType=function(){return t._loadTypeMap[this.extension]||t.LOAD_TYPE.XHR},e._getExtension=function(){var t=this.url,e="";if(this.isDataUrl){var i=t.indexOf("/");e=t.substring(i+1,t.indexOf(";",i))}else{var r=t.indexOf("?"),n=t.indexOf("#"),s=Math.min(r>-1?r:t.length,n>-1?n:t.length);e=(t=t.substring(0,s)).substring(t.lastIndexOf(".")+1)}return e.toLowerCase()},e._getMimeFromXhrType=function(e){switch(e){case t.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case t.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case t.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case t.XHR_RESPONSE_TYPE.JSON:return"application/json";case t.XHR_RESPONSE_TYPE.DEFAULT:case t.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},p(t,[{key:"isDataUrl",get:function(){return this._hasFlag(t.STATUS_FLAGS.DATA_URL)}},{key:"isComplete",get:function(){return this._hasFlag(t.STATUS_FLAGS.COMPLETE)}},{key:"isLoading",get:function(){return this._hasFlag(t.STATUS_FLAGS.LOADING)}}]),t}();function _(t,e,i){e&&0===e.indexOf(".")&&(e=e.substring(1)),e&&(t[e]=i)}function v(t){return t.toString().replace("object ","")}y.STATUS_FLAGS={NONE:0,DATA_URL:1,COMPLETE:2,LOADING:4},y.TYPE={UNKNOWN:0,JSON:1,XML:2,IMAGE:3,AUDIO:4,VIDEO:5,TEXT:6},y.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4},y.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"},y._loadTypeMap={gif:y.LOAD_TYPE.IMAGE,png:y.LOAD_TYPE.IMAGE,bmp:y.LOAD_TYPE.IMAGE,jpg:y.LOAD_TYPE.IMAGE,jpeg:y.LOAD_TYPE.IMAGE,tif:y.LOAD_TYPE.IMAGE,tiff:y.LOAD_TYPE.IMAGE,webp:y.LOAD_TYPE.IMAGE,tga:y.LOAD_TYPE.IMAGE,svg:y.LOAD_TYPE.IMAGE,"svg+xml":y.LOAD_TYPE.IMAGE,mp3:y.LOAD_TYPE.AUDIO,ogg:y.LOAD_TYPE.AUDIO,wav:y.LOAD_TYPE.AUDIO,mp4:y.LOAD_TYPE.VIDEO,webm:y.LOAD_TYPE.VIDEO},y._xhrTypeMap={xhtml:y.XHR_RESPONSE_TYPE.DOCUMENT,html:y.XHR_RESPONSE_TYPE.DOCUMENT,htm:y.XHR_RESPONSE_TYPE.DOCUMENT,xml:y.XHR_RESPONSE_TYPE.DOCUMENT,tmx:y.XHR_RESPONSE_TYPE.DOCUMENT,svg:y.XHR_RESPONSE_TYPE.DOCUMENT,tsx:y.XHR_RESPONSE_TYPE.DOCUMENT,gif:y.XHR_RESPONSE_TYPE.BLOB,png:y.XHR_RESPONSE_TYPE.BLOB,bmp:y.XHR_RESPONSE_TYPE.BLOB,jpg:y.XHR_RESPONSE_TYPE.BLOB,jpeg:y.XHR_RESPONSE_TYPE.BLOB,tif:y.XHR_RESPONSE_TYPE.BLOB,tiff:y.XHR_RESPONSE_TYPE.BLOB,webp:y.XHR_RESPONSE_TYPE.BLOB,tga:y.XHR_RESPONSE_TYPE.BLOB,json:y.XHR_RESPONSE_TYPE.JSON,text:y.XHR_RESPONSE_TYPE.TEXT,txt:y.XHR_RESPONSE_TYPE.TEXT,ttf:y.XHR_RESPONSE_TYPE.BUFFER,otf:y.XHR_RESPONSE_TYPE.BUFFER},y.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";function x(t){for(var e="",i=0;i<t.length;){for(var r=[0,0,0],n=[0,0,0,0],s=0;s<r.length;++s)i<t.length?r[s]=255&t.charCodeAt(i++):r[s]=0;switch(n[0]=r[0]>>2,n[1]=(3&r[0])<<4|r[1]>>4,n[2]=(15&r[1])<<2|r[2]>>6,n[3]=63&r[2],i-(t.length-1)){case 2:n[3]=64,n[2]=64;break;case 1:n[3]=64}for(var o=0;o<n.length;++o)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(n[o])}return e}var b=window.URL||window.webkitURL;var w={caching:function(t,e){var i=this;c[t.url]?(t.data=c[t.url],t.complete()):t.onComplete.once((function(){return c[i.url]=i.data})),e()},parsing:function(t,e){if(t.data){if(t.xhr&&t.xhrType===y.XHR_RESPONSE_TYPE.BLOB)if(window.Blob&&"string"!=typeof t.data){if(0===t.data.type.indexOf("image")){var i=b.createObjectURL(t.data);return t.blob=t.data,t.data=new Image,t.data.src=i,t.type=y.TYPE.IMAGE,void(t.data.onload=function(){b.revokeObjectURL(i),t.data.onload=null,e()})}}else{var r=t.xhr.getResponseHeader("content-type");if(r&&0===r.indexOf("image"))return t.data=new Image,t.data.src="data:"+r+";base64,"+x(t.xhr.responseText),t.type=y.TYPE.IMAGE,void(t.data.onload=function(){t.data.onload=null,e()})}e()}else e()}},T=/(#[\w-]+)?$/,E=function(){function t(e,i){var r=this;void 0===e&&(e=""),void 0===i&&(i=10),this.baseUrl=e,this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(t,e){return r._loadResource(t,e)},this._queue=l(this._boundLoadResource,i),this._queue.pause(),this.resources={},this.onProgress=new s,this.onError=new s,this.onLoad=new s,this.onStart=new s,this.onComplete=new s;for(var n=0;n<t._defaultBeforeMiddleware.length;++n)this.pre(t._defaultBeforeMiddleware[n]);for(var o=0;o<t._defaultAfterMiddleware.length;++o)this.use(t._defaultAfterMiddleware[o])}var e=t.prototype;return e.add=function(t,e,i,r){if(Array.isArray(t)){for(var n=0;n<t.length;++n)this.add(t[n]);return this}if("object"==typeof t&&(r=e||t.callback||t.onComplete,i=t,e=t.url,t=t.name||t.key||t.url),"string"!=typeof e&&(r=i,i=e,e=t),"string"!=typeof e)throw new Error("No url passed to add resource to loader.");if("function"==typeof i&&(r=i,i=null),this.loading&&(!i||!i.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[t])throw new Error('Resource named "'+t+'" already exists.');if(e=this._prepareUrl(e),this.resources[t]=new y(t,e,i),"function"==typeof r&&this.resources[t].onAfterMiddleware.once(r),this.loading){for(var s=i.parentResource,o=[],a=0;a<s.children.length;++a)s.children[a].isComplete||o.push(s.children[a]);var h=s.progressChunk*(o.length+1)/(o.length+2);s.children.push(this.resources[t]),s.progressChunk=h;for(var l=0;l<o.length;++l)o[l].progressChunk=h;this.resources[t].progressChunk=h}return this._queue.push(this.resources[t]),this},e.pre=function(t){return this._beforeMiddleware.push(t),this},e.use=function(t){return this._afterMiddleware.push(t),this},e.reset=function(){for(var t in this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause(),this.resources){var e=this.resources[t];e._onLoadBinding&&e._onLoadBinding.detach(),e.isLoading&&e.abort()}return this.resources={},this},e.load=function(t){if("function"==typeof t&&this.onComplete.once(t),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var e=100/this._queue._tasks.length,i=0;i<this._queue._tasks.length;++i)this._queue._tasks[i].data.progressChunk=e;this._onStart(),this._queue.resume()}return this},e._prepareUrl=function(t){var e,i=n(t,{strictMode:!0});if(e=i.protocol||!i.path||0===t.indexOf("//")?t:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&"/"!==t.charAt(0)?this.baseUrl+"/"+t:this.baseUrl+t,this.defaultQueryString){var r=T.exec(e)[0];-1!==(e=e.substr(0,e.length-r.length)).indexOf("?")?e+="&"+this.defaultQueryString:e+="?"+this.defaultQueryString,e+=r}return e},e._loadResource=function(t,e){var i=this;t._dequeue=e,a(this._beforeMiddleware,(function(e,r){e.call(i,t,(function(){r(t.isComplete?{}:null)}))}),(function(){t.isComplete?i._onLoad(t):(t._onLoadBinding=t.onComplete.once(i._onLoad,i),t.load())}),!0)},e._onStart=function(){this.progress=0,this.loading=!0,this.onStart.dispatch(this)},e._onComplete=function(){this.progress=100,this.loading=!1,this.onComplete.dispatch(this,this.resources)},e._onLoad=function(t){var e=this;t._onLoadBinding=null,this._resourcesParsing.push(t),t._dequeue(),a(this._afterMiddleware,(function(i,r){i.call(e,t,r)}),(function(){t.onAfterMiddleware.dispatch(t),e.progress=Math.min(100,e.progress+t.progressChunk),e.onProgress.dispatch(e,t),t.error?e.onError.dispatch(t.error,e,t):e.onLoad.dispatch(e,t),e._resourcesParsing.splice(e._resourcesParsing.indexOf(t),1),e._queue.idle()&&0===e._resourcesParsing.length&&e._onComplete()}),!0)},p(t,[{key:"concurrency",get:function(){return this._queue.concurrency},set:function(t){this._queue.concurrency=t}}]),t}();E._defaultBeforeMiddleware=[],E._defaultAfterMiddleware=[],E.pre=function(t){return E._defaultBeforeMiddleware.push(t),E},E.use=function(t){return E._defaultAfterMiddleware.push(t),E},i.Loader=E,i.Resource=y,i.async=u,i.encodeBinary=x,i.middleware=w},{"mini-signals":40,"parse-uri":42}],52:[function(t,e,i){(function(e,r){var n=t("process/browser.js").nextTick,s=Function.prototype.apply,o=Array.prototype.slice,a={},h=0;function l(t,e){this._id=t,this._clearFn=e}i.setTimeout=function(){return new l(s.call(setTimeout,window,arguments),clearTimeout)},i.setInterval=function(){return new l(s.call(setInterval,window,arguments),clearInterval)},i.clearTimeout=i.clearInterval=function(t){t.close()},l.prototype.unref=l.prototype.ref=function(){},l.prototype.close=function(){this._clearFn.call(window,this._id)},i.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},i.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},i._unrefActive=i.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},i.setImmediate="function"==typeof e?e:function(t){var e=h++,r=!(arguments.length<2)&&o.call(arguments,1);return a[e]=!0,n((function(){a[e]&&(r?t.apply(null,r):t.call(null),i.clearImmediate(e))})),e},i.clearImmediate="function"==typeof r?r:function(t){delete a[t]}}).call(this,t("timers").setImmediate,t("timers").clearImmediate)},{"process/browser.js":46,timers:52}],53:[function(t,e,i){"use strict";var r=t("punycode"),n=t("./util");function s(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}i.parse=v,i.resolve=function(t,e){return v(t,!1,!0).resolve(e)},i.resolveObject=function(t,e){return t?v(t,!1,!0).resolveObject(e):e},i.format=function(t){n.isString(t)&&(t=v(t));return t instanceof s?t.format():s.prototype.format.call(t)},i.Url=s;var o=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,h=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,l=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),u=["'"].concat(l),c=["%","/","?",";","#"].concat(u),d=["/","?","#"],p=/^[+a-z0-9A-Z_-]{0,63}$/,f=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,g={javascript:!0,"javascript:":!0},m={javascript:!0,"javascript:":!0},y={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},_=t("querystring");function v(t,e,i){if(t&&n.isObject(t)&&t instanceof s)return t;var r=new s;return r.parse(t,e,i),r}s.prototype.parse=function(t,e,i){if(!n.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var s=t.indexOf("?"),a=-1!==s&&s<t.indexOf("#")?"?":"#",l=t.split(a);l[0]=l[0].replace(/\\/g,"/");var v=t=l.join(a);if(v=v.trim(),!i&&1===t.split("#").length){var x=h.exec(v);if(x)return this.path=v,this.href=v,this.pathname=x[1],x[2]?(this.search=x[2],this.query=e?_.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var b=o.exec(v);if(b){var w=(b=b[0]).toLowerCase();this.protocol=w,v=v.substr(b.length)}if(i||b||v.match(/^\/\/[^@\/]+@[^@\/]+/)){var T="//"===v.substr(0,2);!T||b&&m[b]||(v=v.substr(2),this.slashes=!0)}if(!m[b]&&(T||b&&!y[b])){for(var E,S,P=-1,O=0;O<d.length;O++){-1!==(C=v.indexOf(d[O]))&&(-1===P||C<P)&&(P=C)}-1!==(S=-1===P?v.lastIndexOf("@"):v.lastIndexOf("@",P))&&(E=v.slice(0,S),v=v.slice(S+1),this.auth=decodeURIComponent(E)),P=-1;for(O=0;O<c.length;O++){var C;-1!==(C=v.indexOf(c[O]))&&(-1===P||C<P)&&(P=C)}-1===P&&(P=v.length),this.host=v.slice(0,P),v=v.slice(P),this.parseHost(),this.hostname=this.hostname||"";var I="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!I)for(var M=this.hostname.split(/\./),A=(O=0,M.length);O<A;O++){var R=M[O];if(R&&!R.match(p)){for(var D="",N=0,L=R.length;N<L;N++)R.charCodeAt(N)>127?D+="x":D+=R[N];if(!D.match(p)){var k=M.slice(0,O),F=M.slice(O+1),B=R.match(f);B&&(k.push(B[1]),F.unshift(B[2])),F.length&&(v="/"+F.join(".")+v),this.hostname=k.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),I||(this.hostname=r.toASCII(this.hostname));var U=this.port?":"+this.port:"",j=this.hostname||"";this.host=j+U,this.href+=this.host,I&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==v[0]&&(v="/"+v))}if(!g[w])for(O=0,A=u.length;O<A;O++){var H=u[O];if(-1!==v.indexOf(H)){var X=encodeURIComponent(H);X===H&&(X=escape(H)),v=v.split(H).join(X)}}var z=v.indexOf("#");-1!==z&&(this.hash=v.substr(z),v=v.slice(0,z));var G=v.indexOf("?");if(-1!==G?(this.search=v.substr(G),this.query=v.substr(G+1),e&&(this.query=_.parse(this.query)),v=v.slice(0,G)):e&&(this.search="",this.query={}),v&&(this.pathname=v),y[w]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){U=this.pathname||"";var W=this.search||"";this.path=U+W}return this.href=this.format(),this},s.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",i=this.pathname||"",r=this.hash||"",s=!1,o="";this.host?s=t+this.host:this.hostname&&(s=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(s+=":"+this.port)),this.query&&n.isObject(this.query)&&Object.keys(this.query).length&&(o=_.stringify(this.query));var a=this.search||o&&"?"+o||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||y[e])&&!1!==s?(s="//"+(s||""),i&&"/"!==i.charAt(0)&&(i="/"+i)):s||(s=""),r&&"#"!==r.charAt(0)&&(r="#"+r),a&&"?"!==a.charAt(0)&&(a="?"+a),e+s+(i=i.replace(/[?#]/g,(function(t){return encodeURIComponent(t)})))+(a=a.replace("#","%23"))+r},s.prototype.resolve=function(t){return this.resolveObject(v(t,!1,!0)).format()},s.prototype.resolveObject=function(t){if(n.isString(t)){var e=new s;e.parse(t,!1,!0),t=e}for(var i=new s,r=Object.keys(this),o=0;o<r.length;o++){var a=r[o];i[a]=this[a]}if(i.hash=t.hash,""===t.href)return i.href=i.format(),i;if(t.slashes&&!t.protocol){for(var h=Object.keys(t),l=0;l<h.length;l++){var u=h[l];"protocol"!==u&&(i[u]=t[u])}return y[i.protocol]&&i.hostname&&!i.pathname&&(i.path=i.pathname="/"),i.href=i.format(),i}if(t.protocol&&t.protocol!==i.protocol){if(!y[t.protocol]){for(var c=Object.keys(t),d=0;d<c.length;d++){var p=c[d];i[p]=t[p]}return i.href=i.format(),i}if(i.protocol=t.protocol,t.host||m[t.protocol])i.pathname=t.pathname;else{for(var f=(t.pathname||"").split("/");f.length&&!(t.host=f.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==f[0]&&f.unshift(""),f.length<2&&f.unshift(""),i.pathname=f.join("/")}if(i.search=t.search,i.query=t.query,i.host=t.host||"",i.auth=t.auth,i.hostname=t.hostname||t.host,i.port=t.port,i.pathname||i.search){var g=i.pathname||"",_=i.search||"";i.path=g+_}return i.slashes=i.slashes||t.slashes,i.href=i.format(),i}var v=i.pathname&&"/"===i.pathname.charAt(0),x=t.host||t.pathname&&"/"===t.pathname.charAt(0),b=x||v||i.host&&t.pathname,w=b,T=i.pathname&&i.pathname.split("/")||[],E=(f=t.pathname&&t.pathname.split("/")||[],i.protocol&&!y[i.protocol]);if(E&&(i.hostname="",i.port=null,i.host&&(""===T[0]?T[0]=i.host:T.unshift(i.host)),i.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===f[0]?f[0]=t.host:f.unshift(t.host)),t.host=null),b=b&&(""===f[0]||""===T[0])),x)i.host=t.host||""===t.host?t.host:i.host,i.hostname=t.hostname||""===t.hostname?t.hostname:i.hostname,i.search=t.search,i.query=t.query,T=f;else if(f.length)T||(T=[]),T.pop(),T=T.concat(f),i.search=t.search,i.query=t.query;else if(!n.isNullOrUndefined(t.search)){if(E)i.hostname=i.host=T.shift(),(I=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@"))&&(i.auth=I.shift(),i.host=i.hostname=I.shift());return i.search=t.search,i.query=t.query,n.isNull(i.pathname)&&n.isNull(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.href=i.format(),i}if(!T.length)return i.pathname=null,i.search?i.path="/"+i.search:i.path=null,i.href=i.format(),i;for(var S=T.slice(-1)[0],P=(i.host||t.host||T.length>1)&&("."===S||".."===S)||""===S,O=0,C=T.length;C>=0;C--)"."===(S=T[C])?T.splice(C,1):".."===S?(T.splice(C,1),O++):O&&(T.splice(C,1),O--);if(!b&&!w)for(;O--;O)T.unshift("..");!b||""===T[0]||T[0]&&"/"===T[0].charAt(0)||T.unshift(""),P&&"/"!==T.join("/").substr(-1)&&T.push("");var I,M=""===T[0]||T[0]&&"/"===T[0].charAt(0);E&&(i.hostname=i.host=M?"":T.length?T.shift():"",(I=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@"))&&(i.auth=I.shift(),i.host=i.hostname=I.shift()));return(b=b||i.host&&T.length)&&!M&&T.unshift(""),T.length?i.pathname=T.join("/"):(i.pathname=null,i.path=null),n.isNull(i.pathname)&&n.isNull(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.auth=t.auth||i.auth,i.slashes=i.slashes||t.slashes,i.href=i.format(),i},s.prototype.parseHost=function(){var t=this.host,e=a.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},{"./util":54,punycode:47,querystring:50}],54:[function(t,e,i){"use strict";e.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},{}],55:[function(t,e,i){"use strict";var r=this&&this.__awaiter||function(t,e,i,r){return new(i||(i=Promise))((function(n,s){function o(t){try{h(r.next(t))}catch(t){s(t)}}function a(t){try{h(r.throw(t))}catch(t){s(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((r=r.apply(t,e||[])).next())}))};Object.defineProperty(i,"__esModule",{value:!0});const n=t("./resources"),s=t("./scene"),o=t("./ui"),a=t("pixi.js"),h=t("pixi-sound");a.sound=h,window.PIXI=a,t("pixi-layers"),function(){r(this,void 0,void 0,(function*(){a.settings.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1,a.sound.volumeAll=.5;const t=new a.Application({width:1200,height:700,resolution:1,antialias:!1}),e=new a.display.Stage;t.stage=e,t.renderer.backgroundColor=o.Colors.background;const i=new n.Resources(t.loader);yield i.load(),document.getElementById("container").appendChild(t.view),new s.SceneController(i,t,e).keyBind()}))}()},{"./resources":83,"./scene":85,"./ui":97,"pixi-layers":43,"pixi-sound":44,"pixi.js":45}],56:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const r=t("./ui"),n=t("pixi.js");class s extends n.Container{constructor(t){super(),this._color=t.color,this._width=t.width||0,this._widthMax=t.widthMax,this._rect=new n.Graphics,this._labelCenter=t.labelCenter||!1,this._label=new n.BitmapText("",{font:{name:"alagard",size:16}}),this._label.anchor=new n.Point(this._labelCenter?.5:0,.5),this._label.position.set((r.Sizes.uiBorder<<1)+(this._labelCenter?this._widthMax>>1:0),r.Sizes.uiBorder+9),super.addChild(this._rect,this._label)}set color(t){this._color=t,this.updateRect()}set width(t){this._width=t,this.updateRect()}set label(t){this._label.text=t}set widthMax(t){this._widthMax=t,this._label.position.set((r.Sizes.uiBorder<<1)+(this._labelCenter?this._widthMax>>1:0),r.Sizes.uiBorder+9),this.updateRect()}updateRect(){this._rect.clear().beginFill(r.Colors.uiBackground,.3).drawRect(0,0,this._widthMax+(r.Sizes.uiBorder<<1),18+(r.Sizes.uiBorder<<1)).endFill().beginFill(this._color,.3).drawRect(r.Sizes.uiBorder,r.Sizes.uiBorder,this._width,18).endFill()}}i.BarView=s},{"./ui":97,"pixi.js":45}],57:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const r=t("./dungeon.map"),n=t("./dungeon.light"),s=t("./ui"),o=t("pixi.js");var a;!function(t){t[t.UNLIT=0]="UNLIT",t[t.LIGHT=1]="LIGHT",t[t.LIT=2]="LIT"}(a=i.BonfireState||(i.BonfireState={}));i.Bonfire=class{constructor(t,e,i,n){this.width=1,this.height=1,this.static=!0,this.interacting=!0,this.dungeon=t,this.x=e,this.y=i,this._state=a.UNLIT,this._sprite=this.dungeon.animated(this.x,this.y,"bonfire_unlit"),this._sprite.zIndex=r.DungeonZIndexes.static+this.y*r.DungeonZIndexes.row,this.dungeon.set(this.x,this.y,this),n&&this.light()}get state(){return this._state}destroy(){this.dungeon.remove(this.x,this.y,this),this._sprite.destroy()}interact(t){switch(this._state){case a.UNLIT:t.character.bonfires.add(this.dungeon.level),this.light();break;case a.LIGHT:case a.LIT:this.dungeon.controller.showBonfire(t.character)}}collide(t){return!0}light(){this._state===a.UNLIT&&(this._state=a.LIGHT,this._sprite.destroy(),this._sprite=this.dungeon.animated(this.x,this.y,"bonfire_light"),this._sprite.zIndex=r.DungeonZIndexes.static+this.y*r.DungeonZIndexes.row,this._sprite.loop=!1,this._sprite.onComplete=()=>this.lit(),this.dungeon.light.addLight({x:16*this.x+8,y:16*this.y-16},n.LightType.BONFIRE))}lit(){var t;this._state=a.LIT,null===(t=this._sprite)||void 0===t||t.destroy(),this._sprite=this.dungeon.animated(this.x,this.y,"bonfire_lit"),this._sprite.zIndex=r.DungeonZIndexes.static+this.y*r.DungeonZIndexes.row}};i.BonfireDialogModal=class{constructor(t,e){this.container=null,this.background=null,this.selectable=null,this.controller=t,this.hero=e}init(){this.selectable=new s.SelectableGrid(this.controller.joystick),this.background=new o.Graphics,this.background.beginFill(0).drawRect(0,0,400,400).endFill(),this.background.zIndex=0,this.container=new o.Container,this.container.addChild(this.background),this.container.sortChildren(),this.container.position.set((this.controller.app.screen.width>>1)-200,(this.controller.app.screen.height>>1)-200),this.controller.stage.addChild(this.container),this.controller.app.ticker.add(this.handleInput,this);const t=new s.Layout;t.offset(s.Sizes.uiMargin,s.Sizes.uiMargin),t.commit();let e=0;const i=(i,r)=>{const n=new s.Button({label:i,width:400-2*s.Sizes.uiMargin,height:32,textSize:24});this.container.addChild(n),n.position.set(t.x,t.y),t.offset(0,32),t.offset(0,s.Sizes.uiMargin),this.selectable.set(0,e,n,r),e++},r=[...this.hero.bonfires].sort((t,e)=>t-e);for(const t of r)i("Level "+t,()=>this.goto(t));i("Cancel",()=>this.cancel())}goto(t){this.controller.closeModal(),this.controller.generateDungeon({hero:this.hero,level:t})}cancel(){this.controller.closeModal()}handleInput(){var t;null===(t=this.selectable)||void 0===t||t.handleInput()}destroy(){var t,e;this.controller.app.ticker.remove(this.handleInput,this),null===(t=this.container)||void 0===t||t.destroy(),this.container=null,null===(e=this.background)||void 0===e||e.destroy(),this.background=null,this.selectable=null}}},{"./dungeon.light":66,"./dungeon.map":67,"./ui":97,"pixi.js":45}],58:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const r=t("./dungeon.map"),n=t("./monster"),s=t("./tiny.monster"),o=t("./ui"),a=t("./bar.view"),h=t("./character"),l=t("pixi.js");i.bossMonsters=[{name:"big_zombie",category:n.MonsterCategory.ZOMBIE},{name:"big_demon",category:n.MonsterCategory.DEMON},{name:"ogre",category:n.MonsterCategory.ORC}];class u extends n.MonsterCharacter{constructor(t,e){super({name:t.name,category:t.category,type:n.MonsterType.LEADER,speed:.5,healthMax:50+Math.floor(10*e),level:e,luck:.4,damage:7+.5*e,xp:100+50*e,spawn:5})}}i.BossMonster=u;class c extends n.MonsterAI{constructor(t,e,i,n){super(e,{width:2,height:2,x:i,y:n,zIndex:r.DungeonZIndexes.character}),this.max_distance=7,this.character=t,this.init();const s=e.controller.app.screen.width,o=new d(this.character);o.zIndex=13,o.position.set(s>>1,64),e.controller.stage.addChild(o)}action(t){if(!this.character.dead.get()){const e=this.animation instanceof h.IdleAnimation;if(t&&this.spawnMinions())return!1;if((e||t)&&this.moveToHero())return!0;if((e||t)&&this.moveByPath())return!0;if(this.ready(),t&&this.randomMove())return!0}return!1}drop(){var t;for(let e=0;e<9;e++)null===(t=this.findDropCell())||void 0===t||t.randomDrop()}spawnMinion(t,e){const i=s.tinyMonsters.filter(t=>t.category===this.character.category&&t.type!==n.MonsterType.LEADER);if(0===i.length)return console.warn("no minion config found",this.character.category),null;const r=this.dungeon.rng.choice(i),o=new s.TinyMonster(r,this.dungeon.level);return new s.TinyMonsterAI(o,this.dungeon,t,e)}}i.BossMonsterAI=c;class d extends l.Container{constructor(t){super(),this.destroyed=!1,this.boss=t;this.pointWidth=Math.min(4,Math.floor(500/t.healthMax.get())),this.widthMax=this.pointWidth*t.healthMax.get(),this.health=new a.BarView({color:o.Colors.uiRed,widthMax:this.widthMax,labelCenter:!0}),this.health.position.set(-(this.widthMax>>1),0),this.addChild(this.health),t.health.subscribe(this.updateHealth,this),t.dead.subscribe(this.updateDead,this)}destroy(){this.destroyed||(super.destroy({children:!0}),this.destroyed=!0,this.boss.health.unsubscribe(this.updateHealth,this),this.boss.dead.unsubscribe(this.updateDead,this))}updateHealth(t){this.health.width=this.pointWidth*t,this.health.label=`${this.boss.name} - ${t}`}updateDead(t){t&&this.destroy()}}i.BossHealthView=d},{"./bar.view":56,"./character":59,"./dungeon.map":67,"./monster":78,"./tiny.monster":89,"./ui":97,"pixi.js":45}],59:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const r=t("./dungeon.map"),n=t("./observable"),s=t("./curves"),o=t("./pathfinding"),a=t("pixi.js");var h;i.Character=class{constructor(t){this.name=t.name,this._speed=new n.ObservableVar(t.speed),this._healthMax=new n.ObservableVar(t.healthMax),this._health=new n.ObservableVar(t.healthMax),this._dead=new n.ObservableVar(!1),this._killedBy=new n.ObservableVar(null)}get speed(){return this._speed.get()}get healthMax(){return this._healthMax}get health(){return this._health}get dead(){return this._dead}get killedBy(){return this._killedBy}heal(t){this._health.update(e=>Math.min(this._healthMax.get(),e+t))}hitDamage(t,e){this._dead.get()||(this._health.update(t=>Math.max(0,t-e)),0===this._health.get()&&(this._killedBy.set(t),this._dead.set(!0)))}},function(t){t[t.LEFT=1]="LEFT",t[t.RIGHT=2]="RIGHT",t[t.AROUND=4]="AROUND"}(h=i.ScanDirection||(i.ScanDirection={}));i.BaseCharacterAI=class{constructor(t,e){this.static=!1,this._animation=null,this.dungeon=t,this.width=e.width,this.height=e.height,this._x=e.x,this._y=e.y,this.view=new d(t,e.zIndex,e.width,e.on_position)}get x(){return this._x}get y(){return this._y}set animation(t){var e;null===(e=this._animation)||void 0===e||e.cancel(),this._animation=t,this._animation.run()}get animation(){return this._animation}init(){this.setPosition(this._x,this._y),this.character.killedBy.subscribe(this.handleKilledBy,this),this.character.dead.subscribe(this.handleDead,this),this.idle()}destroy(){var t;null===(t=this._animation)||void 0===t||t.cancel(),this.character.killedBy.unsubscribe(this.handleKilledBy,this),this.character.dead.unsubscribe(this.handleDead,this),this.dungeon.remove(this._x,this._y,this),this.view.destroy()}collide(t){return this!==t}handleKilledBy(t){t&&this.onKilledBy(t)}handleDead(t){t&&this.onDead()}findDropCell(t=5){return this.findCell(t,t=>t.hasFloor&&!t.hasObject&&!t.hasDrop)}findSpawnCell(t=5){return this.findCell(t,t=>t.hasFloor&&!t.hasObject)}findCell(t,e){const i=this.x,r=this.y,n=this.view.is_left;let s=null,o=null;const a=Math.max(0,i-t),h=Math.min(this.dungeon.width-1,i+t),l=Math.max(0,r-t),u=Math.min(this.dungeon.width-1,r+t);for(let t=a;t<=h;t++)for(let a=l;a<=u;a++){const h=this.dungeon.cell(t,a);if(h.hasFloor&&e(h)){const t=(c=h,Math.max(Math.abs(c.x-i),Math.abs(c.y-r))+(c.y!==r?.5:0)+(c.x===i&&c.y===r?0:1)+(n?c.x<i?0:1:c.x>i?0:.5));(null===o||o>t)&&(s=h,o=t)}}var c;return s}move(t,e){t>0&&(this.view.is_left=!1),t<0&&(this.view.is_left=!0);const i=this.x+t,r=this.y+e;return!!this.dungeon.available(i,r,this)&&(this.run(i,r),!0)}findPath(t){const e=this.dungeon,i=new o.PathFinding(e.width,e.height);for(let r=0;r<e.height;r++)for(let n=0;n<e.width;n++){const s=e.cell(n,r),o=s.object;!s.hasFloor||s.collide(this)&&o!==t?i.mark(n,r):i.clear(n,r)}const r=new a.Point(this.x,this.y),n=new a.Point(t.x,t.y);return i.find(r,n)}idle(){this.animation=new u(this,this.dungeon.ticker,{sprite:this.character.name+"_idle",speed:this.character.speed,update:t=>{this.action(!1)&&t.cancel()},finish:()=>{this.action(!0)||this.idle()}})}run(t,e){this.animation=new c(this,this.dungeon.ticker,{new_x:t,new_y:e,sprite:this.character.name+"_run",speed:this.character.speed,finish:()=>{this.action(!0)||this.idle()}})}setPosition(t,e){this.dungeon.remove(this._x,this._y,this),this._x=Math.floor(t),this._y=Math.floor(e),this.dungeon.set(this._x,this._y,this),this.view.setPosition(t,e)}lookAt(t){t.x<this.x&&(this.view.is_left=!0),t.x>this.x&&(this.view.is_left=!1)}scanObjects(t,e,i){const r=this.scanCells(t,e,t=>t.hasObject&&i(t.object)).map(t=>t.object);return[...new Set(r)]}scanCells(t,e,i){const r=this.x,n=this.y,s=t===h.AROUND||t===h.LEFT,o=t===h.AROUND||t===h.RIGHT,a=s?Math.max(0,r-e):r,l=o?Math.min(this.dungeon.width-1,r+e):r,u=Math.max(0,n-e),c=Math.min(this.dungeon.height-1,n+e),d=[];for(let t=u;t<=c;t++)for(let e=a;e<=l;e++){const r=this.dungeon.cell(e,t);i(r)&&d.push(r)}return d}};class l{constructor(t,e,i){this._spriteTime=0,this._spritePlay=!1,this._terminated=!1,this.character=t,this.view=t.view,this.ticker=e,this.sprite=i.sprite,this.speed=i.speed,this.curve=i.curve||s.LinearCurve.line(),this.on_start=i.start||null,this.on_update=i.update||null,this.on_frame=i.frame||null,this.on_cancel=i.cancel||null,this.on_finish=i.finish}get spriteTime(){return this._spriteTime}run(){this._spritePlay=!0,this._terminated=!1,this.start(),this.ticker.add(this.tick,this),this.on_start&&this.on_start(this)}cancel(){this._terminated||(this.terminate(),this.canceled(),this.on_cancel&&this.on_cancel(this))}tick(t){this.updateSprite(t),this.update(),this.on_update&&this.on_update(this),this._terminated||this._spritePlay||(this.terminate(),this.finish(),this.on_finish&&this.on_finish(this),console.assert(this.character.animation!==this))}terminate(){this._terminated||(this._terminated=!0,this.ticker.remove(this.tick,this))}updateSprite(t){const e=this.view.sprite;if(!e)return console.warn("no sprite found"),this._spriteTime=0,void(this._spritePlay=!1);const i=e.animationSpeed*t,r=e.currentFrame;this._spriteTime+=i;let n=Math.floor(this._spriteTime)%e.totalFrames;n<0&&(n+=e.totalFrames),this._spriteTime<0?(this._spriteTime=0,this._spritePlay=!1):this._spriteTime>=e.totalFrames?(this._spriteTime=e.totalFrames-1,this._spritePlay=!1):r!==n&&(e.gotoAndStop(n),this.on_frame&&this.on_frame(this))}}i.Animation=l;class u extends l{constructor(t,e,i){super(t,e,i)}start(){this.view.setSprite(this.sprite,this.speed)}update(){}finish(){}canceled(){}}i.IdleAnimation=u;class c extends l{constructor(t,e,i){super(t,e,i),this.x=t.x,this.y=t.y,this.new_x=i.new_x,this.new_y=i.new_y}start(){this.view.setSprite(this.sprite,this.speed),this.character.dungeon.set(this.new_x,this.new_y,this.character)}update(){const t=this.spriteTime/this.view.sprite.totalFrames,e=this.x+(this.new_x-this.x)*t,i=this.y+(this.new_y-this.y)*t;this.character.view.setPosition(e,i)}finish(){this.character.dungeon.remove(this.x,this.y,this.character),this.character.dungeon.remove(this.new_x,this.new_y,this.character),this.character.setPosition(this.new_x,this.new_y)}canceled(){this.character.dungeon.remove(this.x,this.y,this.character),this.character.dungeon.remove(this.new_x,this.new_y,this.character),this.character.setPosition(this.character.x,this.character.y)}}i.RunAnimation=c;i.HitAnimation=class extends l{constructor(t,e,i){super(t,e,i)}start(){this.view.setSprite(this.sprite,this.speed)}update(){const t=this.view.weaponSprite;if(t){const e=this.view.sprite,i=this._spriteTime/e.totalFrames,r=this.curve(i);t.angle=(this.view.is_left?-90:90)*r}}finish(){const t=this.view.weaponSprite;t&&(t.angle=0)}canceled(){}};class d extends a.Container{constructor(t,e,i,r){super(),this._is_left=!1,this._sprite=null,this._weaponSprite=null,this.resources=t.controller.resources,this.base_zIndex=e,this.grid_width=i,this.on_position=r||null,t.container.addChild(this)}get is_left(){return this._is_left}set is_left(t){this._is_left=t,this.updateSpriteOrientation(),this.updateWeaponOrientation()}get sprite(){return this._sprite}get weaponSprite(){return this._weaponSprite}destroy(){var t,e;null===(t=this._sprite)||void 0===t||t.destroy(),this._sprite=null,null===(e=this._weaponSprite)||void 0===e||e.destroy(),this._weaponSprite=null,super.destroy()}setPosition(t,e){this.position.set(16*t,16*e),this.zIndex=this.base_zIndex+Math.floor(e)*r.DungeonZIndexes.row,this.on_position&&this.on_position(16*t,16*e)}setSprite(t,e){var i;null===(i=this._sprite)||void 0===i||i.destroy(),this._sprite=this.resources.animated(t,!1),this._sprite.loop=!1,this._sprite.animationSpeed=.2*e,this._sprite.anchor.set(0,1),this._sprite.position.y=14,this._sprite.zIndex=1,this.addChild(this._sprite),this.updateSpriteOrientation(),this.updateWeaponOrientation()}setWeapon(t){var e;null===(e=this._weaponSprite)||void 0===e||e.destroy(),this._weaponSprite=null,t&&(this._weaponSprite=t.sprite(),this._weaponSprite.zIndex=2,this._weaponSprite.position.x=16,this._weaponSprite.position.y=12,this.is_left&&(this._weaponSprite.position.x=0,this._weaponSprite.scale.x=-1),this._weaponSprite.anchor.set(.5,1),this.addChild(this._weaponSprite),this.sortChildren())}updateSpriteOrientation(){this._sprite&&(this._is_left?(this._sprite.position.x=this._sprite.width,this._sprite.width>16*this.grid_width&&(this._sprite.position.x-=(this._sprite.width-16*this.grid_width)/2),this._sprite.scale.x=-1):(this._sprite.position.x=0,this._sprite.width>16*this.grid_width&&(this._sprite.position.x-=(this._sprite.width-16*this.grid_width)/2),this._sprite.scale.x=1))}updateWeaponOrientation(){this._weaponSprite&&(this.is_left?(this._weaponSprite.position.x=0,this._weaponSprite.scale.x=-1):(this._weaponSprite.position.x=16,this._weaponSprite.scale.x=1))}}i.BaseCharacterView=d},{"./curves":61,"./dungeon.map":67,"./observable":80,"./pathfinding":81,"pixi.js":45}],60:[function(t,e,i){"use strict";var r=this&&this.__awaiter||function(t,e,i,r){return new(i||(i=Promise))((function(n,s){function o(t){try{h(r.next(t))}catch(t){s(t)}}function a(t){try{h(r.throw(t))}catch(t){s(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((r=r.apply(t,e||[])).next())}))};Object.defineProperty(i,"__esModule",{value:!0}),i.yields=function(t=0){return r(this,void 0,void 0,(function*(){return yield new Promise(e=>setTimeout(e,t))}))}},{}],61:[function(t,e,i){"use strict";function r(t){let e=1;for(let i=2;i<=t;i++)e*=i;return e}Object.defineProperty(i,"__esModule",{value:!0});i.LinearCurve=class{static line(){return t=>t}};class n{static basis(t,e,i){return r(e)/(r(t)*r(e-t))*Math.pow(i,t)*Math.pow(1-i,e-t)}static line(...t){const e=t.length-1;return i=>{i>1&&(i=1);let r=0;for(let s=0;s<t.length;s++){let o=n.basis(s,e,i);r+=t[s]*o}return r}}static matrix(...t){const e=t.length-1,i=t[0].length;return r=>{r>1&&(r=1);let s=[];for(let t=0;t<i;t++)s[t]=0;for(let o=0;o<t.length;o++){let a=n.basis(o,e,r);for(let e=0;e<i;e++)s[e]+=t[o][e]*a}return s}}}i.BezierCurve=n},{}],62:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const r=t("pixi.js");i.YouDeadScene=class{constructor(t){this.controller=t}init(){this.renderTitle(),this.renderHelp(),this.controller.app.ticker.add(this.handleInput,this)}destroy(){this.controller.app.ticker.remove(this.handleInput,this),this.controller.stage.removeChildren()}pause(){}resume(){}renderTitle(){let t=new r.BitmapText("ROGUELIKE DUNGEON",{font:{name:"alagard",size:64}});t.anchor=new r.Point(.5,0),t.position.set(this.controller.app.screen.width>>1,64),this.controller.stage.addChild(t);let e=new r.BitmapText("YOU DEAD",{font:{name:"alagard",size:128},tint:16711680});e.anchor=.5,e.position.set(this.controller.app.screen.width>>1,256),this.controller.stage.addChild(e)}renderHelp(){const t=new r.BitmapText("PRESS F TO RESTART",{font:{name:"alagard",size:32}});t.anchor=.5,t.position.set(this.controller.app.screen.width>>1,this.controller.app.screen.height-64),this.controller.stage.addChild(t)}handleInput(){this.controller.joystick.hit.once()&&this.controller.selectHero()}}},{"pixi.js":45}],63:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const r=t("./ui"),n=t("./observable"),s=t("./expression"),o=t("./template"),a=t("pixi.js");i.DialogManager=class{constructor(t){this.controller=t,this.config=t.app.loader.resources["dialogs.json"].data}dialog(t,e){const i=this.config[e.name]||this.config.default;return new h(this.controller,t,e,i)}};class h{constructor(t,e,i,r){this._question=new n.EventPublisher,this.controller=t,this.hero=e,this.npc=i,this._config=r,this._expression=new s.Expression,this._expression.register("goto",100,!0,this.goto.bind(this)),this._expression.register("exit",100,!1,this.exit.bind(this)),this._expression.register("context",100,!1,this.context.bind(this)),this._expression.register("hasSkill",100,!1,this.hasSkill.bind(this)),this._expression.register("skill",100,!1,this.skill.bind(this)),this._template=new o.Template,this._template.add("hero",this.hero),this._template.add("npc",this.npc)}get question(){return this._question}start(){this.goto(...this._config.start)}hasSkill(t){return this.npc.hasSkill(t)}skill(t){var e;null===(e=this.npc.getSkill(t))||void 0===e||e.use(this.hero)}exit(){this.controller.closeModal()}context(t,e){return void 0===e?this.npc.getContext(t):(this.npc.setContext(t,e),null)}goto(...t){for(let e of t){const t=this._config.questions[e];if(this.check(t.conditions||[])){const e=this._template.render(t.text),i=new l(this,e);for(let e of t.answers)if(this.check(e.conditions)){const t=this._template.render(e.text);i.add(t,e.commands)}return void this._question.send(i)}}}check(t){if(t)for(let e of t)if(!this.evaluate(e))return!1;return!0}evaluate(t){return this._expression.evaluate(t)}}i.Dialog=h;class l{constructor(t,e){this.answers=[],this.dialog=t,this.text=e}add(t,e){this.answers.push(new u(this.dialog,t,e))}}i.DialogQuestion=l;class u{constructor(t,e,i){this.dialog=t,this.text=e,this.commands=i}action(){for(let t of this.commands)this.dialog.evaluate(t)}}i.DialogAnswer=u;i.DialogModalScene=class{constructor(t,e){this.container=null,this.background=null,this.selectable=null,this._width=0,this._layout=new r.Layout,this._question=null,this._answers=[],this.controller=t,this.dialog=e}init(){this.background=new a.Graphics,this.selectable=new r.SelectableGrid(this.controller.joystick);this.background.beginFill(0).drawRect(0,0,600,400).endFill(),this.background.zIndex=0,this.container=new a.Container,this.container.addChild(this.background),this.container.sortChildren(),this.container.position.set((this.controller.app.screen.width>>1)-300,(this.controller.app.screen.height>>1)-200);const t=this._layout;t.offset(r.Sizes.uiMargin,r.Sizes.uiMargin);const e=this.controller.resources.animated(this.dialog.npc.name+"_idle");e.animationSpeed=.2,e.play(),e.width=4*e.width,e.height=4*e.height,e.position.set(t.x+r.Sizes.uiBorder,t.y+r.Sizes.uiBorder);const i=new a.Graphics;i.beginFill(r.Colors.uiBackground).drawRect(t.x,t.y,e.width+2*r.Sizes.uiBorder,e.height+2*r.Sizes.uiBorder).endFill(),t.reset(),t.offset(e.width,0),t.offset(r.Sizes.uiMargin,0),t.offset(2*r.Sizes.uiBorder,0),t.commit(),this._width=600-t.x,this.container.addChild(i,e),this.controller.stage.addChild(this.container),this.controller.app.ticker.add(this.handleInput,this),this.dialog.question.subscribe(this.onQuestion,this),this.dialog.start()}destroy(){var t,e;this.dialog.question.unsubscribe(this.onQuestion,this),this.controller.app.ticker.remove(this.handleInput,this),null===(t=this.container)||void 0===t||t.destroy(),this.container=null,null===(e=this.background)||void 0===e||e.destroy(),this.background=null,this.selectable=null}onQuestion(t){var e;null===(e=this._question)||void 0===e||e.destroy();for(let t=0;t<this._answers.length;t++){this._answers[t].destroy(),this.selectable.remove(0,t)}this.selectable.reset(),this._answers=[];const i=this._width-2*r.Sizes.uiMargin,n=this._layout;n.reset(),n.offset(r.Sizes.uiMargin,r.Sizes.uiMargin),this._question=new c(t,i),this._question.position.set(n.x,n.y),this.container.addChild(this._question),n.offset(0,this._question.height),n.offset(0,r.Sizes.uiMargin);for(let e=0;e<t.answers.length;e++){let s=t.answers[e];const o=new d(s,i);this.selectable.set(0,e,o,s.action.bind(s)),o.position.set(n.x,n.y),n.offset(0,o.height),n.offset(0,r.Sizes.uiMargin),this._answers.push(o),this.container.addChild(o)}this.selectable.reset()}handleInput(){var t;null===(t=this.selectable)||void 0===t||t.handleInput()}};class c extends a.Container{constructor(t,e){super(),this._text=new a.BitmapText(t.text,{font:{name:"alagard",size:16}}),this._text.maxWidth=e-2*r.Sizes.uiBorder,this._text.calculateBounds(),this._text.position.set(r.Sizes.uiBorder,r.Sizes.uiBorder);const i=this._text.height+2*r.Sizes.uiBorder;this._background=new a.Graphics,this._background.clear().beginFill(r.Colors.uiBackground,.3).drawRect(0,0,e,i).endFill(),this.addChild(this._background,this._text)}}class d extends a.Container{constructor(t,e){super(),this._selected=!1,this._background=new a.Graphics,this._text=new a.BitmapText(t.text,{font:{name:"alagard",size:16}}),this._text.maxWidth=e-2*r.Sizes.uiBorder,this._text.calculateBounds(),this._text.position.set(r.Sizes.uiBorder,r.Sizes.uiBorder),this._width=e,this._height=this._text.height+2*r.Sizes.uiBorder,this.selected=!1,this.addChild(this._background,this._text)}get selected(){return this._selected}set selected(t){this._selected=t,this._background.clear().beginFill(t?r.Colors.uiSelected:r.Colors.uiNotSelected).drawRect(0,0,this._width,this._height).endFill()}}},{"./expression":69,"./observable":80,"./template":88,"./ui":97,"pixi.js":45}],64:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const r=t("./curves");i.Coins=class{constructor(t,e){this.spriteName="coin",this.resources=e,this.coins=t.nextRange(1,30)}pickedUp(t){return t.addCoins(this.coins),!0}sprite(){return this.resources.animated(this.spriteName)}};class n{constructor(t){this.spriteName="flask_red.png",this.resources=t,this.health=2}info(){return{name:"Health flask",health:this.health}}pickedUp(t){return t.inventory.add(this)}same(t){return t instanceof n}use(t,e){e.heal(this.health),t.decrease()}sprite(){return this.resources.sprite(this.spriteName)}}i.HealthFlask=n;class s{constructor(t){this.spriteName="flask_big_red.png",this.resources=t,this.health=5}info(){return{name:"Big health flask",health:this.health}}pickedUp(t){return t.inventory.add(this)}sprite(){return this.resources.sprite(this.spriteName)}same(t){return t instanceof s}use(t,e){e.heal(this.health),t.decrease()}}i.HealthBigFlask=s;class o{constructor(t,e,i,r,n,s){this.name=t,this.speed=e,this.distance=i,this.damage=r,this.level=n,this.price=s}create(t){return new a(t,this)}}i.WeaponConfig=o,o.configs=[new o("weapon_knife",1.4,1,1.5,1,12),new o("weapon_rusty_sword",1,1,4,1,15),new o("weapon_regular_sword",1,1,5,3,20),new o("weapon_red_gem_sword",1,1,6,3,30),new o("weapon_hammer",.7,1,7,5,38),new o("weapon_big_hammer",.5,2,10,5,40),new o("weapon_baton_with_spikes",.6,1,7,5,42),new o("weapon_mace",.6,1,7,5,45),new o("weapon_katana",1.5,1,8,7,100),new o("weapon_saw_sword",1.5,1,9,7,110),new o("weapon_anime_sword",.7,1,12,7,130),new o("weapon_axe",.8,1,12,7,115),new o("weapon_machete",1,1,11,9,150),new o("weapon_cleaver",1,1,12,9,160),new o("weapon_duel_sword",1.5,1,13,9,170),new o("weapon_knight_sword",1.5,1,14,9,180),new o("weapon_golden_sword",1.5,1,15,11,220),new o("weapon_lavish_sword",1.5,1,16,11,240)];class a{constructor(t,e){this.curve=r.BezierCurve.line(0,-.5,-1,0,1,2,0),this.resources=t,this.name=e.name,this.speed=e.speed,this.distance=e.distance,this.damage=e.damage,this.price=e.price}get spriteName(){return this.name+".png"}info(){return{name:this.name.replace(/weapon_/,""),speed:this.speed,distance:this.distance,damage:this.damage,price:this.price}}sprite(){return this.resources.sprite(this.spriteName)}pickedUp(t){return t.inventory.add(this)}same(t){return!1}use(t,e){const i=e.inventory.equipment.weapon.item.get();e.inventory.equipment.weapon.clear(),e.inventory.equipment.weapon.set(this),t.clear(),i&&t.set(i)}}i.Weapon=a},{"./curves":61}],65:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const r=t("./dungeon.map"),n=t("./hero"),s=t("./tiny.monster"),o=t("./boss.monster"),a=t("./npc"),h=t("./dungeon.light"),l=t("./monster"),u=t("./bonfire"),c=t("pixi.js");i.BaseDungeonGenerator=class{constructor(t){this.resources=t.resources,this.controller=t}createDungeon(t,e,i,n,s){return new r.DungeonMap(this.controller,new c.Ticker,t,e,i,n,s)}replaceFloorRandomly(t,e){const i=["floor_2.png","floor_3.png","floor_4.png","floor_5.png","floor_6.png","floor_7.png","floor_8.png"];for(let r=0;r<e.height;r++)for(let n=0;n<e.width;n++){const s=e.cell(n,r);s.hasFloor&&t.nextFloat()<.2&&(s.floorName=t.choice(i))}}replaceWallRandomly(t,e){const i=["wall_banner_red.png","wall_banner_blue.png","wall_banner_green.png","wall_banner_yellow.png"],r=["wall_goo.png"],n=["wall_fountain_mid_red","wall_fountain_mid_blue"],s=["wall_hole_1.png","wall_hole_2.png"];for(let o=0;o<e.height;o++)for(let a=0;a<e.width;a++){if("wall_mid.png"===e.cell(a,o).wallName&&t.nextFloat()<.3){const h=[...s],l=o+1<e.height&&"floor_1.png"===e.cell(a,o+1).floorName;l&&(h.push(...i),h.push(...r)),o>0&&"wall_top_mid.png"===e.cell(a,o-1).wallName&&l&&h.push(...n);const u=t.choice(h);switch(u){case"wall_goo.png":e.cell(a,o).wallName="wall_goo.png",e.cell(a,o+1).floorName="wall_goo_base.png";break;case"wall_fountain_mid_red":e.cell(a,o-1).wallName="wall_fountain_top.png",e.cell(a,o).wallName="wall_fountain_mid_red",e.cell(a,o+1).floorName="wall_fountain_basin_red";break;case"wall_fountain_mid_blue":e.cell(a,o-1).wallName="wall_fountain_top.png",e.cell(a,o).wallName="wall_fountain_mid_blue",e.cell(a,o+1).floorName="wall_fountain_basin_blue";break;default:e.cell(a,o).wallName=u}}}}distance(t,e){return Math.max(Math.abs(t.x-e.x),Math.abs(t.y-e.y))}findFreePositions(t,e,i){const r=[];for(let n=i;n<t.height;n++)for(let s=0;s<t.width-e;s++){let o=!0;for(let r=0;r<i&&o;r++)for(let i=0;i<e&&o;i++){const e=t.cell(s+i,n-r);o=e.hasFloor&&!e.hasObject}o&&r.push(t.cell(s,n))}return r}placeHero(t,e,i){const r=this.findFreePositions(e,2,2);if(0===r.length)throw"hero not placed";const s=t.choice(r),o=new n.HeroAI(i,e,s.x,s.y);return e.light.addLight(o.view,h.LightType.HERO),o}placeNpc(t,e,i){for(let r=0;r<5;r++){const r=this.findFreePositions(e,2,2).filter(t=>this.distance(i,t)<10);0===r.length&&console.warn("no free place for npc");const n=t.nextRange(0,r.length),[s]=r.splice(n,1),o=t.choice(a.npcCharacters);new a.NpcAI(o,e,this.controller,s.x,s.y)}}placeMonsters(t,e,i){const r=e.width*e.height,n=Math.floor(.4*r),s=Math.floor(.2*n),o=Math.floor(.07*s);console.log("floor_space: "+n),console.log("monster_count: "+o);for(let r=0;r<o&&this.placeMonster(t,e,i);r++);}placeMonster(t,e,i){const r=this.bossConfig(e).category,n=s.tinyMonsters.filter(t=>t.category===r||t.category!=l.MonsterCategory.DEMON&&t.category!=l.MonsterCategory.ORC&&t.category!=l.MonsterCategory.ZOMBIE);if(0===n.length)return console.warn("no tiny monster config found"),!1;const o=this.findFreePositions(e,2,2).filter(t=>this.distance(i,t)>15);if(0===o.length)return console.warn("no free place for tiny monster"),!1;const a=t.nextRange(0,o.length);let[h]=o.splice(a,1);const u=t.choice(n),c=new s.TinyMonster(u,1);return new s.TinyMonsterAI(c,e,h.x,h.y),!0}placeBoss(t,e,i){const r=this.findFreePositions(e,2,2).filter(t=>this.distance(i,t)>20);if(r.length>0){const i=t.nextRange(0,r.length);let[n]=r.splice(i,1);const s=this.bossConfig(e),a=new o.BossMonster(s,e.level);new o.BossMonsterAI(a,e,n.x,n.y)}else console.error("boss not placed")}bossConfig(t){return o.bossMonsters[Math.floor(t.level/5)%o.bossMonsters.length]}placeDrop(t,e){const i=[];for(let t=0;t<e.height;t++)for(let r=0;r<e.height;r++){const n=e.cell(r,t);!n.hasFloor||n.hasDrop||n.hasObject||i.push(n)}const r=Math.floor(3*i.length/100);for(let e=0;e<r&&i.length>0;e++){const e=t.nextRange(0,i.length);i.splice(e,1)[0].randomDrop()}}placeLadder(t,e,i){const r=[],n=[],s=[[-1,-1],[0,-1],[1,-1],[-1,0],[1,0],[-1,1],[0,1],[1,1]];for(let t=1;t<e.height-1;t++)for(let o=1;o<e.height-1;o++){const a=e.cell(o,t);if(a.hasFloor){let h=0;for(let[i,r]of s)e.cell(o+i,t+r).hasFloor&&h++;const l=this.distance(i,{x:o,y:t});h===s.length?r.push([a,l]):n.push([a,l])}}r.sort((t,e)=>t[1]-e[1]),n.sort((t,e)=>t[1]-e[1]);const o=[...n,...r].reverse().splice(0,10);if(0==o.length)throw"ladder not set";t.choice(o)[0].ladder()}placeBonfire(t,e,i){const r=this.findFreePositions(e,2,2).filter(t=>this.distance(i,t)<10);if(r.length>0){const n=t.choice(r),s=i.character.bonfires.has(e.level);return new u.Bonfire(e,n.x,n.y,s)}throw"bonfire not placed"}}},{"./bonfire":57,"./boss.monster":58,"./dungeon.light":66,"./dungeon.map":67,"./hero":72,"./monster":78,"./npc":79,"./tiny.monster":89,"pixi.js":45}],66:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const r=t("./shadow.caster"),n=t("pixi.js");class s{constructor(t){this.lights=[],this.wall_top={default:[{x1:0,y1:12,x2:16,y2:12,type:r.SegmentType.NORMAL},{x1:0,y1:12,x2:0,y2:16,type:r.SegmentType.NORMAL},{x1:16,y1:12,x2:16,y2:16,type:r.SegmentType.NORMAL}],top:[{x1:0,y1:0,x2:16,y2:0,type:r.SegmentType.TOP}],left:[{x1:0,y1:0,x2:0,y2:12,type:r.SegmentType.NORMAL}],right:[{x1:16,y1:0,x2:16,y2:12,type:r.SegmentType.NORMAL}],bottom:[]},this.wall_side_left={default:[{x1:11,y1:0,x2:11,y2:16,type:r.SegmentType.NORMAL},{x1:11,y1:0,x2:16,y2:0,type:r.SegmentType.NORMAL},{x1:11,y1:16,x2:16,y2:16,type:r.SegmentType.TOP}],top:[{x1:0,y1:0,x2:11,y2:0,type:r.SegmentType.TOP}],left:[{x1:0,y1:0,x2:0,y2:16,type:r.SegmentType.NORMAL}],right:[],bottom:[{x1:0,y1:16,x2:11,y2:16,type:r.SegmentType.NORMAL}]},this.wall_side_right={default:[{x1:5,y1:0,x2:5,y2:16,type:r.SegmentType.NORMAL},{x1:0,y1:0,x2:5,y2:0,type:r.SegmentType.NORMAL},{x1:0,y1:16,x2:5,y2:16,type:r.SegmentType.TOP}],top:[{x1:5,y1:0,x2:16,y2:0,type:r.SegmentType.TOP}],left:[],right:[{x1:16,y1:0,x2:16,y2:16,type:r.SegmentType.NORMAL}],bottom:[{x1:5,y1:16,x2:16,y2:16,type:r.SegmentType.NORMAL}]},this.wall_corner_left={default:[{x1:5,y1:0,x2:5,y2:12,type:r.SegmentType.NORMAL},{x1:5,y1:12,x2:16,y2:12,type:r.SegmentType.NORMAL},{x1:16,y1:12,x2:16,y2:16,type:r.SegmentType.NORMAL}],top:[{x1:5,y1:0,x2:16,y2:0,type:r.SegmentType.TOP}],left:[],right:[{x1:16,y1:0,x2:16,y2:12,type:r.SegmentType.NORMAL}],bottom:[]},this.wall_corner_right={default:[{x1:11,y1:0,x2:11,y2:12,type:r.SegmentType.NORMAL},{x1:0,y1:12,x2:11,y2:12,type:r.SegmentType.NORMAL},{x1:0,y1:12,x2:0,y2:16,type:r.SegmentType.NORMAL}],top:[{x1:0,y1:0,x2:11,y2:0,type:r.SegmentType.TOP}],left:[{x1:0,y1:0,x2:0,y2:12,type:r.SegmentType.NORMAL}],right:[],bottom:[]},this.wall_default={default:[],top:[{x1:0,y1:0,x2:16,y2:0,type:r.SegmentType.TOP}],left:[{x1:0,y1:0,x2:0,y2:16,type:r.SegmentType.NORMAL}],right:[{x1:16,y1:0,x2:16,y2:16,type:r.SegmentType.NORMAL}],bottom:[{x1:0,y1:16,x2:16,y2:16,type:r.SegmentType.NORMAL}]},this.config={"wall_top_mid.png":this.wall_top,"wall_side_front_left.png":this.wall_side_left,"wall_side_front_right.png":this.wall_side_right,"wall_side_mid_left.png":this.wall_side_left,"wall_side_mid_right.png":this.wall_side_right,"wall_side_top_left.png":{default:[{x1:11,y1:12,x2:16,y2:12,type:r.SegmentType.NORMAL},{x1:11,y1:12,x2:11,y2:16,type:r.SegmentType.NORMAL}],top:[{x1:0,y1:0,x2:16,y2:0,type:r.SegmentType.TOP}],left:[{x1:0,y1:0,x2:0,y2:16,type:r.SegmentType.NORMAL}],right:[{x1:16,y1:0,x2:16,y2:12,type:r.SegmentType.NORMAL}],bottom:[{x1:0,y1:16,x2:11,y2:16,type:r.SegmentType.NORMAL}]},"wall_side_top_right.png":{default:[{x1:0,y1:12,x2:5,y2:12,type:r.SegmentType.NORMAL},{x1:5,y1:12,x2:5,y2:16,type:r.SegmentType.NORMAL}],top:[{x1:0,y1:0,x2:16,y2:0,type:r.SegmentType.TOP}],left:[{x1:0,y1:12,x2:0,y2:16,type:r.SegmentType.NORMAL}],right:[{x1:16,y1:0,x2:16,y2:16,type:r.SegmentType.NORMAL}],bottom:[{x1:5,y1:16,x2:16,y2:16,type:r.SegmentType.NORMAL}]},"wall_inner_corner_t_top_left.png":this.wall_top,"wall_inner_corner_t_top_right.png":this.wall_top,"wall_inner_corner_l_top_left.png":this.wall_corner_left,"wall_inner_corner_l_top_right.png":this.wall_corner_right,"wall_corner_bottom_left.png":this.wall_corner_left,"wall_corner_bottom_right.png":this.wall_corner_right,"wall_corner_top_left.png":this.wall_top,"wall_corner_top_right.png":this.wall_top,"wall_fountain_top.png":{default:[{x1:0,y1:12,x2:0,y2:16,type:r.SegmentType.NORMAL},{x1:0,y1:12,x2:2,y2:12,type:r.SegmentType.NORMAL},{x1:2,y1:9,x2:2,y2:12,type:r.SegmentType.NORMAL},{x1:2,y1:9,x2:14,y2:9,type:r.SegmentType.NORMAL},{x1:14,y1:9,x2:14,y2:12,type:r.SegmentType.NORMAL},{x1:14,y1:12,x2:16,y2:12,type:r.SegmentType.NORMAL},{x1:16,y1:12,x2:16,y2:16,type:r.SegmentType.NORMAL}],top:[{x1:0,y1:0,x2:16,y2:0,type:r.SegmentType.TOP}],left:[{x1:0,y1:0,x2:0,y2:12,type:r.SegmentType.NORMAL}],right:[{x1:16,y1:0,x2:16,y2:12,type:r.SegmentType.NORMAL}],bottom:[]},"wall_one_top.png":this.wall_top,"wall_one_corner_left.png":this.wall_corner_left,"wall_one_corner_right.png":this.wall_corner_right},this.dungeon=t,this.layer=new n.display.Layer,this.layer.useRenderTexture=!0,this.layer.on("display",t=>{t.blendMode=n.BLEND_MODES.MULTIPLY}),this.layer.clearColor=[0,0,0,1],this.container=new n.Container,this.layer.addChild(this.container),this.heroLightTexture=s.gradient("white",150),this.fountainRedTexture=s.gradient("rgb(211,78,56)",50),this.fountainBlueTexture=s.gradient("rgb(86,152,204)",50),this.bonfireTexture=s.gradient("rgb(255,239,204)",100),this.shadowCaster=new r.ShadowCaster,this.dungeon.ticker.add(this.update,this)}destroy(){this.dungeon.ticker.remove(this.update,this),this.lights.forEach(t=>t.destroy()),this.heroLightTexture.destroy(),this.fountainBlueTexture.destroy(),this.fountainRedTexture.destroy(),this.bonfireTexture.destroy(),this.container.destroy(),this.layer.destroy()}loadMap(){this.shadowCaster.init();const t=this.dungeon;for(let e=0;e<t.height;e++)for(let i=0;i<t.width;i++){const r=t.cell(i,e);if(r.hasFloor){switch(r.floorName){case"wall_fountain_basin_red":this.addLight(new n.Point(16*i,16*e),o.RED_BASIN);break;case"wall_fountain_basin_blue":this.addLight(new n.Point(16*i,16*e),o.BLUE_BASIN)}const s=e>0&&t.cell(i,e-1).hasFloor,a=e+1<t.height&&t.cell(i,e+1).hasFloor,h=i>0&&t.cell(i-1,e).hasFloor,l=i+1<t.width&&t.cell(i+1,e).hasFloor;let u;const c=r.wallName;u=c&&this.config[c]&&this.config[c]||this.wall_default,this.add(i,e,u.default),s||this.add(i,e,u.top),a||this.add(i,e,u.bottom),h||this.add(i,e,u.left),l||this.add(i,e,u.right)}}this.shadowCaster.optimize()}addLight(t,e){switch(e){case o.HERO:this.lights.push(new a(t,350,this.heroLightTexture,this.container));break;case o.RED_BASIN:this.lights.push(new a(t,150,this.fountainRedTexture,this.container));break;case o.BLUE_BASIN:this.lights.push(new a(t,150,this.fountainBlueTexture,this.container));break;case o.BONFIRE:this.lights.push(new a(t,250,this.bonfireTexture,this.container))}}add(t,e,i){for(let r of i)this.shadowCaster.addSegment(16*t+r.x1,16*e+r.y1,16*t+r.x2,16*e+r.y2,r.type)}update(){this.lights.forEach(t=>{const e=new n.Point(t.position.x+8,t.position.y+8);this.shadowCaster.setLightLocation(e.x,e.y,t.maxDistance);const i=this.shadowCaster.sweep();t.sprite.position.set(e.x,e.y),t.mask.clear().beginFill(16777215,1).drawPolygon(i).endFill()})}static gradient(t,e){const i=e<<1,r=document.createElement("canvas");r.width=i,r.height=i;const s=r.getContext("2d");if(s){const r=s.createRadialGradient(e,e,0,e,e,e);r.addColorStop(.1,t),r.addColorStop(1,"transparent"),s.fillStyle=r,s.fillRect(0,0,i,i)}return n.Texture.from(r)}}var o;i.DungeonLight=s,function(t){t[t.HERO=0]="HERO",t[t.RED_BASIN=1]="RED_BASIN",t[t.BLUE_BASIN=2]="BLUE_BASIN",t[t.BONFIRE=3]="BONFIRE"}(o=i.LightType||(i.LightType={}));class a{constructor(t,e,i,r){this.position=t,this.maxDistance=e,this.mask=new n.Graphics,this.mask.isMask=!0,this.sprite=new n.Sprite(i),this.sprite.anchor.set(.5,.5),this.sprite.mask=this.mask,this.sprite.blendMode=n.BLEND_MODES.ADD,r.addChild(this.mask),r.addChild(this.sprite)}destroy(){this.sprite.destroy(),this.mask.destroy()}}},{"./shadow.caster":87,"pixi.js":45}],67:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const r=t("./drop"),n=t("./dungeon.light"),s=t("pixi.js");i.DungeonZIndexes={character:60,hero:70,drop:50,static:40,floor:1,wall:100,row:256};i.DungeonMap=class{constructor(t,e,i,r,a,h,l){this.scale=2,this.controller=t,this.ticker=e,this.rng=i,this.seed=r,this.level=a,this.width=h,this.height=l,this.cells=[];for(let t=0;t<this.width;t++){this.cells[t]=[];for(let e=0;e<this.height;e++)this.cells[t][e]=new o(this,e,t)}this.container=new s.Container,this.container.zIndex=0,this.container.sortableChildren=!0,this.container.scale.set(this.scale,this.scale),this.light=new n.DungeonLight(this),this.light.layer.zIndex=1,this.light.container.scale.set(this.scale,this.scale),this.lighting=new s.Sprite(this.light.layer.getRenderTexture()),this.lighting.blendMode=s.BLEND_MODES.MULTIPLY,this.lighting.zIndex=2}destroy(){for(let t=0;t<this.height;t++)for(let e=0;e<this.width;e++)this.cells[t][e].destroy();this.lighting.destroy(),this.light.destroy(),this.container.destroy({children:!0})}log(t){console.info(t)}cell(t,e){return this.cells[e][t]}remove(t,e,i){for(let r=0;r<i.width;r++)for(let n=0;n<i.height;n++){const s=this.cell(t+r,e-n),o=s.object;o&&o===i&&(s.object=null)}}set(t,e,i){for(let r=0;r<i.width;r++)for(let n=0;n<i.height;n++)this.cell(t+r,e-n).object=i}available(t,e,i){for(let r=0;r<i.width;r++)for(let n=0;n<i.height;n++){const s=this.cell(t+r,e-n);if(!s.hasFloor||s.collide(i))return!1}return!0}camera(t,e){const i=this.controller.app.screen.width,r=this.controller.app.screen.height,n=(i>>1)-t*this.scale,s=(r>>1)-e*this.scale;this.container.position.set(n,s),this.light.container.position.set(n,s)}sprite(t,e,i){let r;if(i.endsWith(".png"))r=this.controller.resources.sprite(i);else{const t=this.controller.resources.animated(i);t.animationSpeed=.2,t.play(),r=t}return r.position.set(16*t,16*e),this.container.addChild(r),r}animated(t,e,i){const r=this.controller.resources.animated(i);return r.animationSpeed=.2,r.play(),r.position.set(16*t,16*e),this.container.addChild(r),r}};class o{constructor(t,e,i){this._floor=null,this._wall=null,this._drop=null,this._object=null,this.dungeon=t,this.x=e,this.y=i}destroy(){var t,e,i,r;null===(t=this._floor)||void 0===t||t.destroy(),this._floor=null,null===(e=this._wall)||void 0===e||e.destroy(),this._wall=null,null===(i=this._drop)||void 0===i||i.destroy(),this._drop=null,null===(r=this._object)||void 0===r||r.destroy(),this._object=null}set floorName(t){var e;null===(e=this._floor)||void 0===e||e.destroy(),this._floor=null,t&&(this._floor=new h(this.dungeon,this.x,this.y,t))}get floorName(){var t;return(null===(t=this._floor)||void 0===t?void 0:t.name)||null}get floor(){return this._floor}get hasFloor(){return!!this._floor}get wallName(){var t;return(null===(t=this._wall)||void 0===t?void 0:t.name)||null}set wallName(t){var e;null===(e=this._wall)||void 0===e||e.destroy(),this._wall=null,t&&(this._wall=new u(this.dungeon,this.x,this.y,t))}get wall(){return this._wall}set dropItem(t){var e;null===(e=this._drop)||void 0===e||e.destroy(),this._drop=null,t&&(this._drop=new c(this.dungeon,this.x,this.y,t))}get drop(){return this._drop}get hasDrop(){return!!this._drop}randomDrop(){const t=this.dungeon.rng,e=this.dungeon.controller.resources;let i=50*t.nextFloat();if((i-=10)<=0){const e=r.WeaponConfig.configs.filter(t=>t.level<=this.dungeon.level);this.dropItem=t.choice(e).create(this.dungeon.controller.resources)}else(i-=10)<=0?this.dropItem=new r.HealthBigFlask(e):(i-=10)<=0?this.dropItem=new r.HealthFlask(e):i-20<=0&&(this.dropItem=new r.Coins(t,e));return this.hasDrop}get object(){return this._object}set object(t){if(t&&null!==this._object&&this._object!==t)throw console.log("current char",this._object),console.log("new char",t),"error while set char to cell";this._object=t}get hasObject(){return null!=this._object}ladder(){var t;null===(t=this._floor)||void 0===t||t.destroy(),this._floor=new l(this.dungeon,this.x,this.y)}get interacting(){var t,e,i,r;return(null===(t=this._floor)||void 0===t?void 0:t.interacting)||(null===(e=this._wall)||void 0===e?void 0:e.interacting)||(null===(i=this._drop)||void 0===i?void 0:i.interacting)||(null===(r=this._object)||void 0===r?void 0:r.interacting)||!1}interact(t){this._object&&this._object.interacting?this._object.interact(t):this._drop&&this._drop.interacting?this._drop.interact(t):this._wall&&this._wall.interacting?this._wall.interact(t):this._floor&&this._floor.interacting&&this._floor.interact(t)}collide(t){return this._object&&this._object.collide(t)||this._wall&&this._wall.collide(t)||!1}}i.MapCell=o;class a{constructor(t,e,r,n){this.height=1,this.width=1,this.static=!0,this.dungeon=t,this.x=e,this.y=r,this.name=n,this.sprite=t.sprite(e,r,n),this.sprite.zIndex=i.DungeonZIndexes.floor}collide(t){return!1}destroy(){this.sprite.destroy()}}i.DungeonFloor=a;class h extends a{constructor(t,e,i,r){super(t,e,i,r),this.interacting=!1}interact(t){}}i.DefaultDungeonFloor=h;class l extends a{constructor(t,e,i){super(t,e,i,"floor_ladder.png"),this.interacting=!0}interact(t){this.dungeon.controller.updateHero(t.character,this.dungeon.level+1)}}i.DungeonLadder=l;class u{constructor(t,e,r,n){this.height=1,this.width=1,this.static=!0,this.interacting=!1,this.dungeon=t,this.x=e,this.y=r,this.name=n,this.sprite=t.sprite(e,r,n),this.sprite.zIndex=i.DungeonZIndexes.wall+r*i.DungeonZIndexes.row}interact(t){}collide(t){return!this.dungeon.cell(this.x,this.y).hasFloor}destroy(){this.sprite.destroy()}}i.DungeonWall=u;class c{constructor(t,e,r,n){this.height=1,this.width=1,this.static=!0,this.interacting=!0,this.dungeon=t,this.x=e,this.y=r,this.drop=n,this.sprite=t.sprite(e,r,n.spriteName),this.sprite.zIndex=i.DungeonZIndexes.drop+r*i.DungeonZIndexes.row,this.sprite.x+=8,this.sprite.y+=14,this.sprite.anchor.set(.5,1),this.sprite instanceof s.AnimatedSprite&&(this.sprite.animationSpeed=.2,this.sprite.play())}pickedUp(t){return!!this.drop.pickedUp(t)&&(this.dungeon.cell(this.x,this.y).dropItem=null,!0)}interact(t){}collide(t){return!1}destroy(){this.sprite.destroy()}}i.DungeonDrop=c;class d extends s.Container{constructor(){super(),this.title=new s.BitmapText("",{font:{name:"alagard",size:32}}),this.title.anchor=.5,this.title.position.set(0,16),this.addChild(this.title)}set level(t){this.title.text="LEVEL "+t}destroy(){this.title.destroy()}}i.DungeonTitle=d},{"./drop":64,"./dungeon.light":66,"pixi.js":45}],68:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const r=t("./hero"),n=t("./dungeon.map"),s=t("./inventory");i.DungeonScene=class{constructor(t,e,i){this.controller=t,this.dungeon=i,this.titleView=new n.DungeonTitle,this.inventoryView=new s.BeltInventoryView(e.inventory.belt),this.healthView=new r.HeroStateView(e,{fixedHPSize:!1})}init(){const t=this.controller.app.screen.width,e=this.controller.app.screen.height;this.titleView.position.set(t>>1,16),this.titleView.zIndex=10,this.controller.stage.addChild(this.titleView);const i=this.inventoryView.width;this.inventoryView.position.set((t>>1)-(i>>1),e-52),this.inventoryView.zIndex=11,this.controller.stage.addChild(this.inventoryView),this.healthView.position.set(16,16),this.healthView.zIndex=12,this.controller.stage.addChild(this.healthView),this.titleView.level=this.dungeon.level,this.dungeon.container.zIndex=0,this.controller.stage.addChild(this.dungeon.container),this.dungeon.light.layer.zIndex=1,this.controller.stage.addChild(this.dungeon.light.layer),this.dungeon.lighting.zIndex=2,this.dungeon.lighting.alpha=.8,this.controller.stage.addChild(this.dungeon.lighting),this.controller.stage.sortChildren(),this.dungeon.ticker.start()}destroy(){this.titleView.destroy(),this.healthView.destroy(),this.inventoryView.destroy(),this.dungeon.destroy(),this.controller.stage.removeChildren()}pause(){this.dungeon.ticker.stop()}resume(){this.dungeon.ticker.start()}}},{"./dungeon.map":67,"./hero":72,"./inventory":76}],69:[function(t,e,i){"use strict";var r,n;Object.defineProperty(i,"__esModule",{value:!0}),function(t){t[t.Started=1]="Started",t[t.ParsingNumber=2]="ParsingNumber",t[t.ParsingStringStarted=3]="ParsingStringStarted",t[t.ParsingString=4]="ParsingString",t[t.ParsingStringFinished=5]="ParsingStringFinished",t[t.ParsingFunction=6]="ParsingFunction",t[t.Finished=7]="Finished",t[t.ParsingContext=8]="ParsingContext",t[t.ParsingBracket=9]="ParsingBracket",t[t.Error=10]="Error"}(r||(r={})),function(t){t[t.Delimiter=1]="Delimiter",t[t.Digit=2]="Digit",t[t.Bracket=3]="Bracket",t[t.Other=4]="Other",t[t.ContextBracket=5]="ContextBracket",t[t.Quote=6]="Quote"}(n||(n={}));const s={[r.Started]:{[n.Delimiter]:r.Started,[n.Digit]:r.ParsingNumber,[n.Bracket]:r.ParsingBracket,[n.Other]:r.ParsingFunction,[n.ContextBracket]:r.ParsingContext,[n.Quote]:r.ParsingStringStarted},[r.ParsingNumber]:{[n.Delimiter]:r.Finished,[n.Digit]:r.ParsingNumber,[n.Bracket]:r.Finished,[n.Other]:r.Finished,[n.ContextBracket]:r.Error,[n.Quote]:r.Error},[r.ParsingFunction]:{[n.Delimiter]:r.Finished,[n.Digit]:r.ParsingFunction,[n.Bracket]:r.Finished,[n.Other]:r.ParsingFunction,[n.ContextBracket]:r.Error,[n.Quote]:r.Error},[r.ParsingContext]:{[n.Delimiter]:r.Finished,[n.Digit]:r.ParsingContext,[n.Bracket]:r.Finished,[n.Other]:r.ParsingContext,[n.ContextBracket]:r.ParsingContext,[n.Quote]:r.Error},[r.ParsingBracket]:{[n.Delimiter]:r.Finished,[n.Digit]:r.Finished,[n.Bracket]:r.Finished,[n.Other]:r.Finished,[n.ContextBracket]:r.Finished,[n.Quote]:r.Finished},[r.ParsingStringStarted]:{[n.Delimiter]:r.ParsingString,[n.Digit]:r.ParsingString,[n.Bracket]:r.ParsingString,[n.Other]:r.ParsingString,[n.ContextBracket]:r.ParsingString,[n.Quote]:r.Finished},[r.ParsingString]:{[n.Delimiter]:r.ParsingString,[n.Digit]:r.ParsingString,[n.Bracket]:r.ParsingString,[n.Other]:r.ParsingString,[n.ContextBracket]:r.ParsingString,[n.Quote]:r.ParsingStringFinished},[r.ParsingStringFinished]:{[n.Delimiter]:r.Finished,[n.Digit]:r.Finished,[n.Bracket]:r.Finished,[n.Other]:r.Finished,[n.ContextBracket]:r.Finished,[n.Quote]:r.Finished}};class o{constructor(){this.operations={"+":{priority:0,variable:!1,apply:(t,e)=>t+e},"-":{priority:0,variable:!1,apply:(t,e)=>t-e},"*":{priority:1,variable:!1,apply:(t,e)=>t*e},"/":{priority:1,variable:!1,apply:(t,e)=>t/e},"%":{priority:1,variable:!1,apply:(t,e)=>t%e},or:{priority:0,variable:!1,apply:(t,e)=>t||e},and:{priority:1,variable:!1,apply:(t,e)=>t&&e},"!":{priority:2,variable:!1,apply:t=>!t},true:{priority:100,variable:!1,apply:()=>!0},false:{priority:100,variable:!1,apply:()=>!1},$$getContextValue:{priority:100,variable:!1,apply:(t,e)=>e[t.substring(1,t.length-1)]}},this.context={}}static classifySymbol(t){return-1!==o.delimiters.indexOf(t)?n.Delimiter:-1!==o.brackets.indexOf(t)?n.Bracket:-1!==o.digits.indexOf(t)?n.Digit:-1!==o.contextBrackets.indexOf(t)?n.ContextBracket:-1!==o.quotes.indexOf(t)?n.Quote:n.Other}isOfMoreOrEqualPriority(t,e){return this.operations[t].priority<=this.operations[e].priority}scanToken(t,e){let i=r.Started,n=r.Error,a="",h=e;for(;h<t.length&&i!==r.Finished&&i!==r.Error;){let e=o.classifySymbol(t[h]);i=s[i][e],i===r.ParsingFunction&&void 0!==this.operations[a]&&(i=r.Finished),i===r.ParsingFunction||i===r.ParsingNumber||i===r.ParsingBracket||i===r.ParsingContext||i===r.ParsingString?(n=i,a+=t[h++]):i!==r.Started&&i!==r.ParsingStringStarted&&i!==r.ParsingStringFinished||h++}return""===a&&(n=r.Error),{workingState:n,tokenString:a,pos:h}}convertToRPN(t){let e,i=[],r=[],n=0;for(let s=0;s<t.length;s++)if("n"!==t[s].type)if("("!==t[s].type)if(")"!==t[s].type){if(-1!==Object.keys(this.operations).indexOf(t[s].type)){if(i.length>0){do{e=i.pop(),r[n++]=e}while(i.length>0&&-1===o.brackets.indexOf(r[n-1].type)&&this.isOfMoreOrEqualPriority(t[s].type,r[n-1].type));-1===o.brackets.indexOf(r[n-1].type)&&this.isOfMoreOrEqualPriority(t[s].type,r[n-1].type)||(i.push(e),n--)}i.push(t[s])}}else{do{e=i.pop(),r[n++]=e}while("("!==r[n-1].type);n--}else i.push(t[s]);else r[n++]=t[s];for(;i.length>0;)e=i.pop(),r[n++]=e;return r}calculateRPN(t){var e;let i=[];if(0===t.length)return null;for(let e=0;e<t.length;e++)if("n"===t[e].type)i.push(t[e]);else{let r=this.operations[t[e].type],n=r.apply,s=r.variable?i.length:n.length,o=i.splice(i.length-s).map(t=>t.value),a=n.apply(null,o);i.push({type:"n",value:a})}return(null===(e=i.shift())||void 0===e?void 0:e.value)||null}tokenize(t){const e=[];for(let i=0;i<t.length;){let n=this.scanToken(t,i);n.workingState!==r.Error&&(n.workingState===r.ParsingNumber?e.push({type:"n",value:-1!==n.tokenString.indexOf(".")?parseFloat(n.tokenString):parseInt(n.tokenString)}):n.workingState===r.ParsingContext?(e.push({type:"$$getContextValue",value:null}),e.push({type:"n",value:n.tokenString}),e.push({type:"n",value:this.context})):n.workingState===r.ParsingString?e.push({type:"n",value:n.tokenString}):e.push({type:n.tokenString,value:null})),i=n.pos}return e}register(t,e,i,r){this.operations[t]={priority:e,variable:i,apply:r}}evaluate(t,e={}){this.context=e;const i=this.tokenize(t),r=this.convertToRPN(i);return this.calculateRPN(r)}}i.Expression=o,o.digits="0123456789.",o.brackets="()",o.contextBrackets="{}",o.delimiters=" ,\r\r\n",o.quotes="'\""},{}],70:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const r=t("./wfc/dungeon.generator"),n=t("./ui"),s=t("pixi.js");i.GenerateDungeonScene=class{constructor(t,e){this.title=null,this.controller=t,this.generator=new r.HybridDungeonGenerator(this.controller),this.promise=this.generator.generate(e),this.promise.then(t=>this.controller.dungeon(e.hero,t)),this.progressBar=new s.Graphics}init(){this.renderTitle(),this.renderProgressBar(),this.controller.app.ticker.add(this.update,this)}destroy(){var t,e;this.controller.app.ticker.remove(this.update,this),null===(t=this.title)||void 0===t||t.destroy(),null===(e=this.progressBar)||void 0===e||e.destroy()}pause(){}resume(){}renderTitle(){this.title=new s.BitmapText("ROGUELIKE DUNGEON",{font:{name:"alagard",size:64}}),this.title.anchor=new s.Point(.5,0),this.title.position.set(this.controller.app.screen.width>>1,64),this.controller.stage.addChild(this.title)}renderProgressBar(){this.progressBar=new s.Graphics,this.controller.stage.addChild(this.progressBar)}update(){const t=this.controller.app.screen.width,e=this.controller.app.screen.height,i=t-40-40,r=Math.floor((i-4-4)*this.generator.percent/100);this.progressBar.clear(),this.progressBar.beginFill(n.Colors.uiBackground,.3),this.progressBar.drawRect(40,e-40-60-4-4,i,60),this.progressBar.endFill(),this.progressBar.beginFill(n.Colors.uiSelected,.3),this.progressBar.drawRect(44,e-40-60-4,r,52),this.progressBar.endFill()}}},{"./ui":97,"./wfc/dungeon.generator":99,"pixi.js":45}],71:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});class r{constructor(t,e,i,r){this.x=t,this.y=e,this.w=i,this.h=r}mutable(){return new n(this.x,this.y,this.w,this.h)}expand(){const t=this;return new r(t.x-2,t.y-3,t.w+2+2,t.h+3+3)}expandV(){const t=this;return new r(t.x-2,t.y,t.w+2+2,t.h)}expandH(){const t=this;return new r(t.x,t.y-3,t.w,t.h+3+3)}isOverlap(t){const e=this;return e.x<t.x+t.w&&e.x+e.w>t.x&&e.y<t.y+t.h&&e.y+e.h>t.y}toString(){return`{x=${this.x},y=${this.y},w=${this.w},h=${this.h}}`}}i.ImmutableRect=r;class n{constructor(t,e,i,r){this.x=t,this.y=e,this.w=i,this.h=r}static from(t){return new n(t.x,t.y,t.w,t.h)}immutable(){return new r(this.x,this.y,this.w,this.h)}isOverlap(t){const e=this;return e.x<t.x+t.w&&e.x+e.w>t.x&&e.y<t.y+t.h&&e.y+e.h>t.y}toString(){return`{x=${this.x},y=${this.y},w=${this.w},h=${this.h}}`}}i.MutableRect=n},{}],72:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const r=t("./inventory"),n=t("./character"),s=t("./dungeon.map"),o=t("./drop"),a=t("./observable"),h=t("./bar.view"),l=t("./ui"),u=t("./monster"),c=t("pixi.js");i.heroCharacterNames=["elf_f","elf_m","knight_f","knight_m","wizard_f","wizard_m"];const d={coins:0,baseDamage:3,level:1,levelXp:0,skillPoints:0,xp:0,healthMax:30,speed:1};class p extends n.Character{constructor(t,e,i){super({name:t,speed:e.speed,healthMax:e.healthMax}),this.inventory=new r.Inventory(this),this.dungeonSeeds=new Map,this.bonfires=new Set,this.persistent=i,this._coins=new a.ObservableVar(e.coins),this._baseDamage=new a.ObservableVar(e.baseDamage),this._level=new a.ObservableVar(e.level),this._levelXp=new a.ObservableVar(e.levelXp),this._skillPoints=new a.ObservableVar(e.skillPoints),this._xp=new a.ObservableVar(e.xp),this.subscribe()}get coins(){return this._coins}addCoins(t){this._coins.update(e=>e+t)}get damage(){const t=this.inventory.equipment.weapon.item.get();return this._baseDamage.get()+((null==t?void 0:t.damage)||0)}get level(){return this._level}get levelXp(){return this._levelXp}get skillPoints(){return this._skillPoints}get xp(){return this._xp}addXp(t){this._xp.update(e=>{let i=e+t;for(;;){const t=this._levelXp.get();if(!(i>=t))break;i-=t,this._level.update(t=>t+1),this._levelXp.update(t=>t+1e3),this._skillPoints.update(t=>t+1)}return i})}increaseHealth(){this._skillPoints.update(t=>(t>0&&(t--,this._healthMax.update(t=>t+1),this._health.update(t=>t+1)),t))}subscribe(){this._coins.subscribe(this.save,this),this._baseDamage.subscribe(this.save,this),this._level.subscribe(this.save,this),this._levelXp.subscribe(this.save,this),this._skillPoints.subscribe(this.save,this),this._xp.subscribe(this.save,this),this._healthMax.subscribe(this.save,this),this._speed.subscribe(this.save,this)}save(){this.persistent.global.save(this.name,this.state)}get state(){return{coins:this._coins.get(),baseDamage:this._baseDamage.get(),level:this._level.get(),levelXp:this._levelXp.get(),skillPoints:this._skillPoints.get(),xp:this._xp.get(),healthMax:this._healthMax.get(),speed:this._speed.get()}}static load(t,e){let i=e.global.load(t)||d;return new p(t,i,e)}}i.Hero=p;class f extends n.BaseCharacterAI{constructor(t,e,i,r){super(e,{x:i,y:r,width:1,height:1,zIndex:s.DungeonZIndexes.hero,on_position:e.camera.bind(e)}),this.interacting=!1,this.character=t,this.init(),this.character.inventory.equipment.weapon.item.subscribe(this.onWeaponUpdate,this),this.character.inventory.drop.subscribe(this.onDrop,this)}destroy(){super.destroy(),this.character.inventory.equipment.weapon.item.unsubscribe(this.onWeaponUpdate,this),this.character.inventory.drop.unsubscribe(this.onDrop,this)}interact(){}onKilledBy(t){this.dungeon.log(`${this.character.name} killed by ${t.name}`)}onDead(){this.dungeon.controller.dead()}onDrop(t){let[e]=t;const i=this.findDropCell();i&&(i.dropItem=e)}onWeaponUpdate(t){this.view.setWeapon(t)}action(t){if(!this.character.dead.get()){const e=this.animation instanceof n.IdleAnimation;t&&this.scanDrop();const i=this.dungeon.controller.joystick;if(e&&i.inventory.once())return this.dungeon.controller.showInventory(this.character),this.idle(),!0;for(let t=0;t<=9;t++){const r=(t+1)%10;if(i.digit(r).once()){const i=this.character.inventory.belt.cell(t),r=i.item.get();r&&(r instanceof o.Weapon||e)&&i.use()}}if(e&&i.drop.once()&&this.character.inventory.equipment.weapon.drop(),e||t){const t=i.hit.triggered,e=i.hit.once();if(e){const t=this.view.is_left?n.ScanDirection.LEFT:n.ScanDirection.RIGHT,[e]=this.scanInteracting(t,1);if(e)return this.idle(),e.interact(this),!0}if(t||e)return this.hit(),!0}if(e||t){const t=f.delta(i.moveLeft,i.moveRight),e=f.delta(i.moveUp,i.moveDown);if((0!==t||0!==e)&&this.move(t,e))return!0}}return!1}static delta(t,e){return t.triggered?-1:e.triggered?1:0}scanDrop(){var t;(null===(t=this.dungeon.cell(this.x,this.y).drop)||void 0===t?void 0:t.pickedUp(this.character))&&c.sound.play("fruit_collect")}scanHit(){const t=this.character.inventory.equipment.weapon.item.get(),e=(null==t?void 0:t.distance)||1,i=this.view.is_left?n.ScanDirection.LEFT:n.ScanDirection.RIGHT,r=this.scanMonsters(i,e);for(let t of r)t.character.hitDamage(this.character,this.character.damage);if(r.length>0){const t=this.character.inventory.equipment.weapon.item.get(),e=t?t.speed:1;c.sound.play("hit_damage",{speed:e})}}hit(){const t=this.character.inventory.equipment.weapon.item.get();this.animation=new n.HitAnimation(this,this.dungeon.ticker,{sprite:this.character.name+"_idle",speed:(null==t?void 0:t.speed)||this.character.speed,curve:null==t?void 0:t.curve,start:()=>this.lookAtMonsters(),finish:()=>{this.scanHit(),this.action(!0)||this.idle()}})}lookAtMonsters(){const t=this.character.inventory.equipment.weapon.item.get(),e=(null==t?void 0:t.distance)||1,i=this.monstersHealth(n.ScanDirection.LEFT,e),r=this.monstersHealth(n.ScanDirection.RIGHT,e);i>0&&i>r?this.view.is_left=!0:r>0&&r>i&&(this.view.is_left=!1)}scanInteracting(t,e){return this.scanCells(t,e,t=>t.interacting)}scanMonsters(t,e){return this.scanObjects(t,e,t=>t instanceof u.MonsterAI)}monstersHealth(t,e){return this.scanMonsters(t,e).map(t=>t.character.health.get()).reduce((t,e)=>t+e,0)}}i.HeroAI=f;class g extends c.Container{constructor(t,e){super(),this.fixedHPSize=e.fixedHPSize,this.hpBarSize=e.hpBarSize||8,this.maxBarSize=e.maxBarSize||256,this.maxBarInnerSize=this.maxBarSize-(l.Sizes.uiBorder<<1);const i=18+(l.Sizes.uiBorder<<1)+l.Sizes.uiMargin;this.heroState=t,this.health=new h.BarView({color:l.Colors.uiRed,width:0,widthMax:this.maxBarInnerSize}),this.xp=new h.BarView({color:l.Colors.uiYellow,width:0,widthMax:this.maxBarInnerSize}),this.xp.position.set(0,i),this.coins=new c.BitmapText("",{font:{name:"alagard",size:16}}),this.coins.position.set(0,2*i),super.addChild(this.health,this.xp,this.coins),t.health.subscribe(this.updateHealth,this),t.healthMax.subscribe(this.updateHealthMax,this),t.level.subscribe(this.updateXp,this),t.levelXp.subscribe(this.updateXp,this),t.skillPoints.subscribe(this.updateXp,this),t.xp.subscribe(this.updateXp,this),t.coins.subscribe(this.updateCoins,this)}destroy(){super.destroy(),this.heroState.health.unsubscribe(this.updateHealth,this),this.heroState.healthMax.unsubscribe(this.updateHealthMax,this),this.heroState.level.unsubscribe(this.updateXp,this),this.heroState.levelXp.unsubscribe(this.updateXp,this),this.heroState.skillPoints.unsubscribe(this.updateXp,this),this.heroState.xp.unsubscribe(this.updateXp,this),this.heroState.coins.unsubscribe(this.updateCoins,this)}updateHealthMax(t){const e=this.heroState.health.get();this.fixedHPSize||(this.health.widthMax=this.hpBarSize*t),this.health.label=`${e}/${t}`}updateHealth(t){const e=this.heroState.healthMax.get();this.fixedHPSize?this.health.width=Math.floor(this.maxBarInnerSize*t/e):this.health.width=this.hpBarSize*t,this.health.label=`${t}/${e}`}updateXp(){const t=this.heroState.level.get(),e=this.heroState.levelXp.get(),i=this.heroState.skillPoints.get(),r=this.heroState.xp.get();this.xp.widthMax=this.maxBarInnerSize,this.xp.width=Math.floor(this.maxBarInnerSize*r/e),this.xp.label=`L:${t} XP:${r}/${e} SP:${i}`}updateCoins(t){this.coins.text="$"+t}}i.HeroStateView=g},{"./bar.view":56,"./character":59,"./drop":64,"./dungeon.map":67,"./inventory":76,"./monster":78,"./observable":80,"./ui":97,"pixi.js":45}],73:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});class r{constructor(t){this.values=[],this.equality=t}index(t){for(let e=0;e<this.values.length;e++)if(this.equality(t,this.values[e]))return e;return this.values.push(t),this.values.length-1}get(t){return this.values[t]}static array(){return new r((t,e)=>{if(t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0})}static identity(){return new r((t,e)=>t===e)}}i.Indexer=r},{}],74:[function(t,e,i){"use strict";var r;Object.defineProperty(i,"__esModule",{value:!0}),function(t){t[t.Await=1]="Await",t[t.Pressed=2]="Pressed"}(r||(r={}));class n{constructor(t){this.code=t,this.state=r.Await,this._triggered=!1,this._processed=!0}get triggered(){return this._triggered}once(){return!this._processed&&(this._processed=!0,!0)}keydown(t){t.code===this.code&&(t.preventDefault(),this.state===r.Await&&(this._triggered=!0,this._processed=!1,this.state=r.Pressed))}keyup(t){t.code===this.code&&(t.preventDefault(),this.state===r.Pressed&&(this._triggered=!1,this.state=r.Await))}reset(){this._triggered=!1,this._processed=!0}}i.KeyBind=n;i.Joystick=class{constructor(){this.moveUp=new n("KeyW"),this.moveLeft=new n("KeyA"),this.moveDown=new n("KeyS"),this.moveRight=new n("KeyD"),this.hit=new n("KeyF"),this.drop=new n("KeyQ"),this.inventory=new n("KeyI"),this.digit1=new n("Digit1"),this.digit2=new n("Digit2"),this.digit3=new n("Digit3"),this.digit4=new n("Digit4"),this.digit5=new n("Digit5"),this.digit6=new n("Digit6"),this.digit7=new n("Digit7"),this.digit8=new n("Digit8"),this.digit9=new n("Digit9"),this.digit0=new n("Digit0"),this.bindings={};for(const t of Object.getOwnPropertyNames(this)){const e=this[t];e&&e instanceof n&&(this.bindings[e.code]=e)}window.addEventListener("keydown",this.keydown.bind(this)),window.addEventListener("keyup",this.keyup.bind(this))}digit(t){switch(t){case 1:return this.digit1;case 2:return this.digit2;case 3:return this.digit3;case 4:return this.digit4;case 5:return this.digit5;case 6:return this.digit6;case 7:return this.digit7;case 8:return this.digit8;case 9:return this.digit9;case 0:return this.digit0}}reset(){var t;for(const e of Object.getOwnPropertyNames(this.bindings))null===(t=this.bindings[e])||void 0===t||t.reset()}keydown(t){var e;null===(e=this.bindings[t.code])||void 0===e||e.keydown(t)}keyup(t){var e;null===(e=this.bindings[t.code])||void 0===e||e.keyup(t)}}},{}],75:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const r=t("./ui"),n=t("./inventory");i.InventoryModalScene=class{constructor(t,e,i){this.container=null,this.background=null,this.selectable=null,this.inventoryView=null,this.controller=t,this.hero=e,this.npc=i}init(){let t;this.background=new PIXI.Graphics,this.selectable=new r.SelectableGrid(this.controller.joystick),t=this.npc?new n.SellingInventoryActionsController(this.hero,this.npc):new n.DefaultInventoryActionsController(this.hero.inventory),this.inventoryView=new n.InventoryView(this.hero.inventory,t,this.selectable,0),this.inventoryView.position.set(r.Sizes.uiMargin,r.Sizes.uiMargin),this.inventoryView.calculateBounds(),this.inventoryView.zIndex=1;const e=this.inventoryView.width+(r.Sizes.uiMargin<<1),i=this.inventoryView.height+(r.Sizes.uiMargin<<1);this.background.beginFill(0).drawRect(0,0,e,i).endFill(),this.background.zIndex=0,this.container=new PIXI.Container,this.container.addChild(this.background,this.inventoryView),this.container.sortChildren(),this.container.position.set((this.controller.app.screen.width>>1)-(e>>1),(this.controller.app.screen.height>>1)-(i>>1)),this.controller.stage.addChild(this.container),this.controller.app.ticker.add(this.handleInput,this)}destroy(){var t,e,i;this.controller.app.ticker.remove(this.handleInput,this),null===(t=this.container)||void 0===t||t.destroy(),this.container=null,null===(e=this.background)||void 0===e||e.destroy(),this.background=null,null===(i=this.inventoryView)||void 0===i||i.destroy(),this.inventoryView=null,this.selectable=null}handleInput(){var t;this.controller.joystick.inventory.once()?this.controller.closeModal():null===(t=this.selectable)||void 0===t||t.handleInput()}}},{"./inventory":76,"./ui":97}],76:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const r=t("./drop"),n=t("./observable"),s=t("./ui"),o=t("pixi.js");i.Inventory=class{constructor(t){this._drop=new n.EventPublisher,this.equipment=new a(t,this._drop),this.belt=new h(t,this._drop),this.backpack=new l(t,this._drop)}get drop(){return this._drop}stack(t){return this.belt.stack(t)||this.backpack.stack(t)}set(t){return this.belt.set(t)||this.backpack.set(t)}add(t){return this.stack(t)||this.set(t)}};class a{constructor(t,e){this.weapon=new u(t,1,t=>t instanceof r.Weapon,e,this)}}i.EquipmentInventory=a;class h{constructor(t,e){this.length=10,this.cells=[];for(let i=0;i<10;i++)this.cells[i]=new u(t,3,()=>!0,e,this)}cell(t){return this.cells[t]}stack(t){for(let e=0;e<this.cells.length;e++)if(this.cells[e].stack(t))return!0;return!1}set(t){for(let e=0;e<this.cells.length;e++)if(this.cells[e].set(t))return!0;return!1}add(t){return this.stack(t)||this.set(t)}}i.BeltInventory=h;class l{constructor(t,e){this.width=10,this.height=5,this.cells=[];for(let i=0;i<this.height;i++){this.cells.push([]);for(let r=0;r<this.width;r++)this.cells[i][r]=new u(t,3,()=>!0,e,this)}}cell(t,e){return this.cells[e][t]}stack(t){for(let e=0;e<this.height;e++)for(let i=0;i<this.width;i++)if(this.cells[e][i].stack(t))return!0;return!1}set(t){for(let e=0;e<this.height;e++)for(let i=0;i<this.width;i++)if(this.cells[e][i].set(t))return!0;return!1}add(t){return this.stack(t)||this.set(t)}}i.BackpackInventory=l;class u{constructor(t,e,i,r,s){this._item=new n.ObservableVar(null),this._count=new n.ObservableVar(0),this._hero=t,this._maxInStack=e,this._predicate=i,this._drop=r,this.parent=s}get item(){return this._item}get count(){return this._count}supports(t){return this._predicate(t)}stack(t){var e;return!!((null===(e=this._item.get())||void 0===e?void 0:e.same(t))&&this._count.get()<this._maxInStack)&&(this._count.update(t=>t+1),!0)}clear(){this._item.get()&&(this._item.set(null),this._count.set(0))}set(t){return!(this._item.get()||!this._predicate(t))&&(this._item.set(t),this._count.set(1),!0)}decrease(){this._count.update(t=>Math.max(0,t-1)),this._count.get()<=0&&(this._item.set(null),this._count.set(0))}get isEmpty(){return null==this._item.get()}use(){const t=this._item.get();return!!t&&(t.use(this,this._hero),!0)}equip(){const t=this._item.get(),e=this._hero.inventory.equipment.weapon;if(t&&e.supports(t)){const i=e.item.get();e.clear(),e.set(t),this.clear(),i&&this.set(i)}}toBelt(){const t=this._item.get();for(;t&&!this.isEmpty&&this._hero.inventory.belt.add(t);)this.decrease()}toBackpack(){const t=this._item.get();for(;t&&!this.isEmpty&&this._hero.inventory.backpack.add(t);)this.decrease()}drop(){const t=this._item.get(),e=this._count.get();t&&(this._item.set(null),this._count.set(0),this._drop.send([t,e]))}}i.InventoryCell=u;class c{constructor(t){this.inventory=t}handle(t,e){t.removeButtons(),e&&(this.basicButtons(t,e),this.additionalButtons(t,e))}basicButtons(t,e){const i=t.cell;(i.parent instanceof h||i.parent instanceof l)&&(this.inventory.equipment.weapon.supports(e)?t.addButton("Equip",()=>i.equip()):t.addButton("Use item",()=>i.use())),i.parent instanceof h||t.addButton("To belt",()=>i.toBelt()),i.parent instanceof l||t.addButton("To backpack",()=>i.toBackpack()),t.addButton("Drop",()=>i.drop())}}i.BaseInventoryActionsController=c;i.DefaultInventoryActionsController=class extends c{constructor(t){super(t)}additionalButtons(t,e){}};i.SellingInventoryActionsController=class extends c{constructor(t,e){super(t.inventory),this.hero=t,this.npc=e}additionalButtons(t,e){const i=e.info().price;i&&t.addButton("Sell",()=>{t.cell.decrease(),this.hero.addCoins(i)})}};class d extends o.Container{constructor(t,e,i,r){super(),this.selectable=i,this.selectableOffset=r;const n=new s.Layout;this.equipment=new p(t.equipment),this.equipment.position.set(n.x,n.y),this.equipment.calculateBounds(),n.offset(0,this.equipment.height),n.offset(0,s.Sizes.uiMargin),i.set(r,0,this.equipment.weapon,()=>this.show(t.equipment.weapon)),i.merge(r,0,10,1),this.belt=new f(t.belt),this.belt.position.set(n.x,n.y),this.belt.calculateBounds(),n.offset(0,this.belt.height),n.offset(0,s.Sizes.uiMargin);for(let e=0;e<this.belt.length;e++){const i=t.belt.cell(e);this.selectable.set(r+e,1,this.belt.cell(e),()=>this.show(i))}this.backpack=new g(t.backpack),this.backpack.position.set(n.x,n.y),this.backpack.calculateBounds(),n.offset(0,this.backpack.height),n.offset(0,s.Sizes.uiMargin);for(let e=0;e<t.backpack.width;e++)for(let i=0;i<t.backpack.height;i++){const n=t.backpack.cell(e,i);this.selectable.set(r+e,i+2,this.backpack.cell(e,i),()=>this.show(n))}this.actions=new _(this.selectable,this.selectableOffset,e),this.actions.position.set(n.x,n.y),n.offset(0,32),n.offset(0,s.Sizes.uiMargin),n.offset(0,32);const o=n.y;n.reset(),n.offset(this.backpack.width,0),n.offset(s.Sizes.uiMargin,0),this.card=new y({width:400,height:o}),this.card.position.set(n.x,n.y),this.card.calculateBounds(),this.addChild(this.equipment,this.belt,this.backpack,this.card,this.actions)}destroy(){super.destroy(),this.equipment.destroy(),this.belt.destroy(),this.backpack.destroy(),this.card.destroy()}show(t){this.card.publisher=t.item,this.actions.cell=t}}i.InventoryView=d;class p extends o.Container{constructor(t){super(),this.equipment=t;const e=(new o.Graphics).beginFill(s.Colors.uiBackground,.3).drawRect(0,0,32+(s.Sizes.uiBorder<<1),32+(s.Sizes.uiBorder<<1)).endFill();super.addChild(e),this.weapon=new m({item:this.equipment.weapon.item,count:new n.ObservableVar(null)}),this.weapon.position.set(s.Sizes.uiBorder,s.Sizes.uiBorder),super.addChild(this.weapon)}}i.EquipmentInventoryView=p;class f extends o.Container{constructor(t){super(),this.inventory=t;const e=(new o.Graphics).beginFill(s.Colors.uiBackground,.3).drawRect(0,0,s.Sizes.uiBorder+(32+s.Sizes.uiBorder)*t.length,32+(s.Sizes.uiBorder<<1)).endFill();super.addChild(e),this.cells=[];for(let e=0;e<t.length;e++){const i=t.cell(e),r=new m({item:i.item,count:i.count});r.position.set(s.Sizes.uiBorder+(32+s.Sizes.uiBorder)*e,s.Sizes.uiBorder),this.cells.push(r),super.addChild(r)}}get length(){return this.inventory.length}cell(t){return this.cells[t]}}i.BeltInventoryView=f;class g extends o.Container{constructor(t){super();const e=(new o.Graphics).beginFill(s.Colors.uiBackground,.3).drawRect(0,0,s.Sizes.uiBorder+(32+s.Sizes.uiBorder)*t.width,s.Sizes.uiBorder+(32+s.Sizes.uiBorder)*t.height).endFill();super.addChild(e),this.cells=[];for(let e=0;e<t.height;e++){this.cells.push([]);for(let i=0;i<t.width;i++){const r=t.cell(i,e),n=new m({item:r.item,count:r.count});n.position.set(s.Sizes.uiBorder+(32+s.Sizes.uiBorder)*i,s.Sizes.uiBorder+(32+s.Sizes.uiBorder)*e),this.cells[e][i]=n,super.addChild(n)}}}cell(t,e){return this.cells[e][t]}}i.BackpackInventoryView=g;class m extends o.Container{constructor(t){super(),this.sprite=null,this._selected=!1,this._item=t.item,this._count=t.count,this._alpha=t.alpha||.3,this.background=new o.Graphics,this.selected=!1,this.counter=new o.BitmapText("0",{font:{name:"alagard",size:16}}),this.counter.anchor=new o.Point(1,0),this.counter.position.set(32-s.Sizes.uiBorder,0),super.addChild(this.background,this.counter),this._item.subscribe(this.updateItem,this),this._count.subscribe(this.updateCounter,this)}destroy(){super.destroy(),this._item.unsubscribe(this.updateItem,this),this._count.unsubscribe(this.updateCounter,this)}get selected(){return this._selected}set selected(t){this._selected=t,this.background.clear().beginFill(t?s.Colors.uiSelected:s.Colors.uiNotSelected,this._alpha).drawRect(0,0,32,32).endFill()}updateCounter(t){this.counter.text=null===t||0===t?"":t.toString()}updateItem(t){var e;if(null===(e=this.sprite)||void 0===e||e.destroy(),this.sprite=null,t){this.sprite=t.sprite();const e=(32-(s.Sizes.uiBorder<<1))/Math.max(this.sprite.width,this.sprite.height);this.sprite.scale.set(e,e),this.sprite.anchor.set(.5,0),this.sprite.position.set(16,s.Sizes.uiBorder),super.addChild(this.sprite)}}}i.InventoryCellView=m;class y extends o.Container{constructor(t){super(),this._sprite=null,this._publisher=null,this._width=t.width||400,this._height=t.height||400,this._sprite_size=128+(s.Sizes.uiMargin<<1);const e=(new o.Graphics).beginFill(s.Colors.uiBackground,.3).drawRect(0,0,this._width,this._height).endFill().beginFill(s.Colors.uiNotSelected,.3).drawRect(s.Sizes.uiMargin,s.Sizes.uiMargin+32+s.Sizes.uiMargin,this._sprite_size,this._sprite_size).endFill();this._title=new o.BitmapText("",{font:{name:"alagard",size:32}}),this._title.anchor=new o.Point(.5,0),this._title.position.set(this._width>>1,s.Sizes.uiMargin),this._description=new o.BitmapText("",{font:{name:"alagard",size:16}}),this._description.position.set(s.Sizes.uiMargin+this._sprite_size+s.Sizes.uiMargin,s.Sizes.uiMargin+32+s.Sizes.uiMargin),super.addChild(e,this._title,this._description)}destroy(){var t;super.destroy(),null===(t=this._publisher)||void 0===t||t.unsubscribe(this.handle,this),this._publisher=null}set publisher(t){var e;null===(e=this._publisher)||void 0===e||e.unsubscribe(this.handle,this),this._publisher=null,this._publisher=t,this._publisher.subscribe(this.handle,this)}handle(t){var e;if(null===(e=this._sprite)||void 0===e||e.destroy(),this._sprite=null,this._title.text="",this._description.text="",t){const e=this._sprite=t.sprite();super.addChild(e),e.anchor=new o.Point(.5,.5),e.position.set(s.Sizes.uiMargin+(this._sprite_size>>1),s.Sizes.uiMargin+(this._sprite_size>>1)+32+s.Sizes.uiMargin);const i=e.width,r=e.height,n=this._sprite_size-s.Sizes.uiMargin;i>r?(this._sprite.width=n,this._sprite.height=n/i*r):(this._sprite.height=n,this._sprite.width=n/r*i);const a=t.info();this._title.text=a.name;const h=[];a.health&&h.push("health: "+a.health),a.speed&&h.push(`speed: ${100*a.speed}%`),a.distance&&h.push("distance: "+a.distance),a.damage&&h.push("damage: "+a.damage),a.price&&h.push(`price: ${a.price}$`),this._description.text=h.join("\n")}}}i.InventoryCellCardView=y;class _ extends o.Container{constructor(t,e,i){super(),this.buttons=[],this._cell=null,this.selectable=t,this.selectableOffset=e,this.controller=i}destroy(){var t;super.destroy(),null===(t=this._cell)||void 0===t||t.item.unsubscribe(this.handle,this),this._cell=null,this.removeButtons()}set cell(t){var e;null===(e=this._cell)||void 0===e||e.item.unsubscribe(this.handle,this),this.removeButtons(),this._cell=t,this._cell.item.subscribe(this.handle,this)}get cell(){return this._cell}handle(t){this.controller.handle(this,t)}removeButtons(){for(let[t,e,i]of this.buttons)this.selectable.unmerge(e,i),this.selectable.remove(e,i),t.destroy();this.selectable.reset(),this.buttons.splice(0,this.buttons.length)}addButton(t,e){const i=this.buttons.length,r=i>>1,n=i%2,o=this.selectableOffset+5*n,a=10+r,h=new s.Button({label:t,width:170,height:32});h.position.set(n*(170+s.Sizes.uiMargin),r*(32+s.Sizes.uiMargin)),this.buttons.push([h,o,a]),this.selectable.set(o,a,h,e),this.selectable.merge(o,a,5,1),this.addChild(h)}}i.InventoryCellActionsView=_},{"./drop":64,"./observable":80,"./ui":97,"pixi.js":45}],77:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const r=t("pixi.js");i.KeyBindScene=class{constructor(t){this.controller=t}init(){this.renderTitle(),this.renderHelp(),this.controller.app.ticker.add(this.handleInput,this)}destroy(){this.controller.app.ticker.remove(this.handleInput,this),this.controller.stage.removeChildren()}pause(){}resume(){}renderTitle(){let t=new r.BitmapText("ROGUELIKE DUNGEON",{font:{name:"alagard",size:64}});t.anchor=new r.Point(.5,0),t.position.set(this.controller.app.screen.width>>1,64),this.controller.stage.addChild(t)}renderHelp(){const t=["WASD - top, left, bottom, right","F - action","Q - drop weapon","I - inventory","1 ... 0 - belt","","PRESS F TO CONTINUE"];for(let e=0;e<t.length;e++){const i=t[e];if(i.length>0){const t=new r.BitmapText(i,{font:{name:"alagard",size:32}});t.position.set(40,200+30*e),this.controller.stage.addChild(t)}}}handleInput(){this.controller.joystick.hit.once()&&this.controller.selectHero()}}},{"pixi.js":45}],78:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const r=t("./hero"),n=t("./character");var s,o;!function(t){t[t.DEMON=1]="DEMON",t[t.ZOMBIE=2]="ZOMBIE",t[t.ORC=3]="ORC",t[t.SLIME=4]="SLIME",t[t.UNDEAD=5]="UNDEAD"}(i.MonsterCategory||(i.MonsterCategory={})),function(t){t[t.NORMAL=1]="NORMAL",t[t.LEADER=2]="LEADER",t[t.MINION=3]="MINION"}(s=i.MonsterType||(i.MonsterType={})),function(t){t[t.READY=0]="READY",t[t.ALARM=1]="ALARM"}(o=i.MonsterState||(i.MonsterState={}));class a extends n.Character{constructor(t){super(t),this.level=t.level,this.luck=t.luck,this.damage=t.damage,this.xp=t.xp,this.category=t.category,this.type=t.type,this.spawn=t.spawn}}i.MonsterCharacter=a;class h extends n.BaseCharacterAI{constructor(t,e){super(t,e),this.interacting=!1,this._state=o.READY,this.last_path=[],this.spawned=[]}interact(){}onKilledBy(t){t&&t instanceof r.Hero&&(this.dungeon.log(`${this.character.name} killed by ${t.name}`),t.addXp(this.character.xp))}onDead(){this.drop(),this.destroy()}ready(){this._state=o.READY}sendAlarm(t){this._state=o.ALARM;for(const e of this.scanMonsters(n.ScanDirection.AROUND,this.max_distance))e.alarm(t)}alarm(t){!this.character.dead.get()&&this.character.type!==s.LEADER&&this._state===o.READY&&this.animation instanceof n.IdleAnimation&&this.moveTo(t)}get state(){return this._state}randomMove(){if(Math.random()<.1){const t=Math.floor(3*Math.random())-1,e=Math.floor(3*Math.random())-1;if(this.move(t,e))return!0}return!1}moveToHero(){const[t]=this.scanHero(n.ScanDirection.AROUND,this.max_distance);if(t){this.sendAlarm(t);const e=Math.abs(this.x-t.x),i=Math.abs(this.y-t.y);return e>this.width||i>this.height?this.moveTo(t):(this.hit(),!0)}return!1}moveTo(t){return this.last_path=this.findPath(t),this.moveByPath()}moveByPath(){if(this.last_path.length>0){const t=this.last_path[0],e=t.x-this.x,i=t.y-this.y;return this.move(e,i)?(this.last_path.splice(0,1),!0):(this.last_path=[],!1)}return!1}hit(){this.animation=new n.HitAnimation(this,this.dungeon.ticker,{sprite:this.character.name+"_idle",speed:this.character.speed,finish:()=>{const[t]=this.scanHero(n.ScanDirection.AROUND,1);t&&Math.random()<this.character.luck&&t.character.hitDamage(this.character,this.character.damage),this.action(!0)||this.idle()}})}spawnMinions(){for(let t=this.spawned.length-1;t>=0;t--)this.spawned[t].character.dead.get()&&this.spawned.splice(t,1);if(this.spawned.length<this.character.spawn){if(Math.random()>.1)return!1;const t=this.findSpawnCell();if(!t)return console.warn(`spawn cell not found at ${this.x}:${this.y}`,this.character.category,this.character.type),!1;const e=this.spawnMinion(t.x,t.y);return e?(t.object=e,this.spawned.push(e),!0):(console.warn("minion not spawned",this.character.category,this.character.type),!1)}return!1}scanHero(t,e){return this.scanObjects(t,e,t=>t instanceof r.HeroAI)}scanMonsters(t,e){return this.scanObjects(t,e,t=>t instanceof h)}}i.MonsterAI=h},{"./character":59,"./hero":72}],79:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const r=t("./character"),n=t("./dungeon.map"),s=t("pixi.js");class o{constructor(t,e){this.npc=t,this.controller=e}}i.NpcSkill=o;class a extends o{constructor(t,e){super(t,e)}use(t){this.controller.showInventory(t,this.npc)}}i.SellingSkill=a,a.id="selling";class h extends o{constructor(t,e){super(t,e)}use(t){s.sound.play("big_egg_collect"),t.heal(t.healthMax.get())}}i.HealSkill=h,h.id="heal",i.npcCharacters=[{name:"alchemist",width:1,height:1,skills:[a.id]},{name:"archer",width:1,height:1,skills:[a.id]},{name:"bishop",width:1,height:2,skills:[]},{name:"blacksmith",width:1,height:1,skills:[a.id]},{name:"butcher",width:1,height:1,skills:[a.id]},{name:"elite_knight",width:1,height:1,skills:[]},{name:"executioner",width:2,height:2,skills:[]},{name:"fat_nun",width:1,height:1,skills:[h.id]},{name:"heavy_knight",width:1,height:1,skills:[]},{name:"herald",width:1,height:1,skills:[]},{name:"king",width:1,height:1,skills:[]},{name:"knight",width:1,height:1,skills:[]},{name:"large_elite_knight",width:2,height:2,skills:[]},{name:"large_knight",width:2,height:2,skills:[]},{name:"mage",width:1,height:1,skills:[a.id]},{name:"magic_shop_keeper",width:1,height:1,skills:[a.id]},{name:"merchant",width:1,height:1,skills:[a.id]},{name:"mountain_king",width:1,height:1,skills:[]},{name:"normal_nun",width:1,height:1,skills:[h.id]},{name:"princess",width:1,height:1,skills:[]},{name:"queen",width:1,height:1,skills:[]},{name:"skinny_nun",width:1,height:1,skills:[h.id]},{name:"thief",width:1,height:1,skills:[a.id]},{name:"townsfolk_f",width:1,height:1,skills:[]}];class l extends r.Character{constructor(t){super({name:t,speed:1,healthMax:100}),this._context={},this._skill={}}setContext(t,e){this._context[t]=e}getContext(t){return this._context[t]}hasSkill(t){return this._skill.hasOwnProperty(t)}getSkill(t){return this._skill[t]||null}addSkill(t,e){this._skill[t]=e}}i.NpcCharacter=l;class u extends r.BaseCharacterAI{constructor(t,e,i,r,s){super(e,{width:t.width,height:t.height,x:r,y:s,zIndex:n.DungeonZIndexes.character}),this.interacting=!0,this.character=new l(t.name),this.initSkills(i,t.skills),this.init()}initSkills(t,e){for(const i of e)switch(i){case a.id:this.character.addSkill(i,new a(this.character,t));break;case h.id:this.character.addSkill(i,new h(this.character,t))}}onDead(){}onKilledBy(t){}action(){return!1}hit(){this.idle()}interact(t){this.lookAt(t),this.dungeon.controller.showDialog(t.character,this.character)}}i.NpcAI=u},{"./character":59,"./dungeon.map":67,"pixi.js":45}],80:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});i.ObservableVar=class{constructor(t){this.listeners=[],this.value=t}set(t){this.value=t;for(let t of this.listeners)t.send(this.value)}update(t){this.set(t(this.value))}get(){return this.value}subscribe(t,e){const i=new r(t,e);this.listeners.push(i),i.send(this.value)}unsubscribe(t,e){const i=this.listeners.findIndex(i=>i.matches(t,e));i>=0&&this.listeners.splice(i,1)}};i.EventPublisher=class{constructor(){this.listeners=[]}send(t){for(let e of this.listeners)e.send(t)}subscribe(t,e){const i=new r(t,e);this.listeners.push(i)}unsubscribe(t,e){const i=this.listeners.findIndex(i=>i.matches(t,e));i>=0&&this.listeners.splice(i,1)}};class r{constructor(t,e){this.callback=t,this.context=e||null}matches(t,e){return this.callback===t&&this.context===e}send(t){this.context?this.callback.call(this.context,t):this.callback(t)}}},{}],81:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const r=t("pixi.js");var n;!function(t){t[t.Manhattan=0]="Manhattan",t[t.Euclidean=1]="Euclidean",t[t.Chebyshev=2]="Chebyshev",t[t.Octile=3]="Octile"}(n=i.Heuristic||(i.Heuristic={}));class s{constructor(t,e){this.g=0,this.h=0,this.f=0,this.parent=t,this.position=e}equal(t){return this.position.equals(t.position)}}class o{constructor(t,e,i=!0,r=!1,s=!1,o=n.Chebyshev,a=1){this.map=[],this.weight=1,this.width=t,this.height=e,this.diagonalAllowed=i,this.includeStart=r,this.includeEnd=s,this.heuristic=o,this.weight=a;for(let i=0;i<t;i++){const t=[];this.map.push(t);for(let i=0;i<e;i++)t.push(1)}}clear(t,e){this.map[t][e]=0}mark(t,e){this.map[t][e]=1}find(t,e){let i=new s(null,t),n=new s(null,e),a=[],h=[];for(a.push(i);a.length>0;){let t=a[0],e=0;for(let i=1;i<a.length;i++){let r=a[i];r.f<t.f&&(t=r,e=i)}if(a.splice(e,1),h.push(t),t.equal(n)){const e=[];let i;for(i=this.includeEnd?t:t.parent;null!==i.parent;)e.push(i.position),i=i.parent;return this.includeStart&&e.push(i.position),e.reverse()}const i=[],l=this.diagonalAllowed?o.adjacentSquaresDiagonal:o.adjacentSquares;for(let e=0;e<l.length;e++){let n=l[e],o=new r.Point(t.position.x+n.x,t.position.y+n.y);if(o.x>=this.width||o.x<0||o.y>=this.height||o.y<0)continue;if(0!=this.map[o.x][o.y])continue;let a=new s(t,o);i.push(a)}for(let e=0;e<i.length;e++){let r=i[e];null==h.find(t=>t.equal(r))&&(r.g=t.g+1,r.h=this.heuristicFunction(r.position,n.position),r.f=r.g+r.h,null==a.find(t=>t.equal(r))&&a.push(r))}}return[]}heuristicFunction(t,e){let i=Math.abs(e.x-t.x),r=Math.abs(e.y-t.y);switch(this.heuristic){case n.Manhattan:return(i+r)*this.weight;case n.Euclidean:return Math.sqrt(i*i+r*r)*this.weight;case n.Chebyshev:return Math.max(i,r)*this.weight;case n.Octile:return(i+r-.58*Math.min(i,r))*this.weight}}}i.PathFinding=o,o.adjacentSquares=[new r.Point(0,-1),new r.Point(0,1),new r.Point(-1,0),new r.Point(1,0)],o.adjacentSquaresDiagonal=[new r.Point(0,-1),new r.Point(0,1),new r.Point(-1,0),new r.Point(1,0),new r.Point(-1,-1),new r.Point(-1,1),new r.Point(1,-1),new r.Point(1,1)]},{"pixi.js":45}],82:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});class r{constructor(t,e){this.transaction=new Map,this.storage=t,this.prefix=e}clear(){for(let t of Object.keys(this.storage))t.startsWith(this.prefix)&&this.storage.removeItem(t);this.transaction.clear()}load(t){const e=this.storage.getItem(this.key(t));return null!==e?JSON.parse(e):null}save(t,e){this.transaction.set(t,e),this.storage.setItem(this.key(t),JSON.stringify(e))}commit(){for(let[t,e]of this.transaction)this.storage.setItem(this.key(t),JSON.stringify(e));this.transaction.clear()}key(t){return[this.prefix,t].join()}}i.StoragePersistentStore=r;i.SessionPersistentState=class{constructor(){const t="localhost"===location.hostname||"0.0.0.0"===location.hostname||"127.0.0.1"===location.hostname?sessionStorage:localStorage;this.global=new r(t,"global."),this.session=new r(t,"session.")}}},{}],83:[function(t,e,i){"use strict";var r=this&&this.__awaiter||function(t,e,i,r){return new(i||(i=Promise))((function(n,s){function o(t){try{h(r.next(t))}catch(t){s(t)}}function a(t){try{h(r.throw(t))}catch(t){s(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((r=r.apply(t,e||[])).next())}))};Object.defineProperty(i,"__esModule",{value:!0});const n=t("pixi.js");i.Resources=class{constructor(t){this._textures={},this._animations={},this.loader=t}load(){return r(this,void 0,void 0,(function*(){return yield new Promise(t=>{this.loader.add("npc.json").add("dungeon.json").add("bonfire.json").add("dungeon.rules.json").add("dungeon.rules.4.json").add("dungeon.design.json").add("dialogs.json").add("alagard","fonts/alagard.fnt").add("big_egg_collect","sounds/big_egg_collect.{ogg,mp3}").add("fruit_collect","sounds/fruit_collect.{ogg,mp3}").add("select","sounds/select.{ogg,mp3}").add("confirm","sounds/confirm.{ogg,mp3}").add("cancel","sounds/cancel.{ogg,mp3}").add("text","sounds/text.{ogg,mp3}").add("boss_hit","sounds/boss_hit.{ogg,mp3}").add("hit_damage","sounds/hit_damage.{ogg,mp3}").load((e,i)=>{i["fonts/alagard.png"].texture.baseTexture.scaleMode=n.SCALE_MODES.NEAREST,this.add(i["npc.json"].spritesheet),this.add(i["dungeon.json"].spritesheet),this.add(i["bonfire.json"].spritesheet),t()})})}))}add(t){t.baseTexture.scaleMode=n.SCALE_MODES.NEAREST;for(let e of Object.keys(t.textures))this._textures[e]=t.textures[e];for(let e of Object.keys(t.animations))this._animations[e]=t.animations[e]}get textures(){return Object.keys(this._textures)}get animations(){return Object.keys(this._animations)}sprite(t){if(!this._textures[t])throw"sprite not found: "+t;const e=new n.Sprite(this._textures[t]);return e.name=t,e}animated(t,e=!0){if(!this._animations[t])throw"animation not found: "+t;const i=new n.AnimatedSprite(this._animations[t],e);return i.name=t,i}}},{"pixi.js":45}],84:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const r=2147483648;i.RNG=class{constructor(t=null){this.state=t||Math.floor(Math.random()*(r-1)),console.log("seed",this.state)}get boolean(){return this.nextInt()%1!=0}get int(){return this.state=(1103515245*this.state+12345)%r,this.state}get float(){return this.int/(r-1)}nextInt(){return this.int}nextFloat(){return this.float}nextRange(t,e){const i=e-t,n=this.nextInt()/r;return t+Math.floor(n*i)}choice(t){return t[this.nextRange(0,t.length)]}nextNormal(t,e,i){let r=0,n=0;for(;0===r;)r=Math.random();for(;0===n;)n=Math.random();let s=Math.sqrt(-2*Math.log(r))*Math.cos(2*Math.PI*n);return s=s/10+.5,(s>1||s<0)&&(s=this.nextNormal(t,e,i)),s=Math.pow(s,i),s*=e-t,s+=t,s}}},{}],85:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const r=t("./rng"),n=t("./input"),s=t("./dead.scene"),o=t("./generate.scene"),a=t("./dungeon.scene"),h=t("./keybind.scene"),l=t("./select.hero.scene"),u=t("./update.hero.scene"),c=t("./inventory.modal"),d=t("./persistent.state"),p=t("./dialog"),f=t("pixi.js"),g=t("./bonfire");i.SceneController=class{constructor(t,e,i){this.mainScene=null,this.modalScene=null,this.persistent=new d.SessionPersistentState,this.rng=new r.RNG,this.joystick=new n.Joystick,this.resources=t,this.app=e,this.stage=i,this.dialogs=new p.DialogManager(this),this.app.ticker.add(this.persistent.global.commit,this.persistent.global,f.UPDATE_PRIORITY.LOW),this.app.ticker.add(this.persistent.session.commit,this.persistent.session,f.UPDATE_PRIORITY.LOW)}set scene(t){var e;null===(e=this.mainScene)||void 0===e||e.destroy(),this.joystick.reset(),this.mainScene=t,this.mainScene.init()}keyBind(){this.scene=new h.KeyBindScene(this)}selectHero(){this.scene=new l.SelectHeroScene(this)}updateHero(t,e){this.scene=new u.UpdateHeroScene(this,{level:e,hero:t})}dead(){this.scene=new s.YouDeadScene(this)}generateDungeon(t){this.scene=new o.GenerateDungeonScene(this,t)}dungeon(t,e){this.scene=new a.DungeonScene(this,t,e)}modal(t){var e;f.sound.play("text"),null===(e=this.mainScene)||void 0===e||e.pause(),this.joystick.reset(),this.modalScene=t,this.modalScene.init()}closeModal(){var t,e;null===(t=this.modalScene)||void 0===t||t.destroy(),this.joystick.reset(),null===(e=this.mainScene)||void 0===e||e.resume()}showInventory(t,e){this.modal(new c.InventoryModalScene(this,t,e||null))}showDialog(t,e){const i=this.dialogs.dialog(t,e);this.modal(new p.DialogModalScene(this,i))}showBonfire(t){this.modal(new g.BonfireDialogModal(this,t))}}},{"./bonfire":57,"./dead.scene":62,"./dialog":63,"./dungeon.scene":68,"./generate.scene":70,"./input":74,"./inventory.modal":75,"./keybind.scene":77,"./persistent.state":82,"./rng":84,"./select.hero.scene":86,"./update.hero.scene":98,"pixi.js":45}],86:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const r=t("./hero"),n=t("./drop"),s=t("./ui"),o=t("pixi.js");i.SelectHeroScene=class{constructor(t){this.heroes=[],this.controller=t,this.selectable=new s.SelectableGrid(t.joystick)}init(){this.renderTitle(),this.renderHeroes(),this.controller.app.ticker.add(this.selectable.handleInput,this.selectable)}destroy(){this.controller.app.ticker.remove(this.selectable.handleInput,this.selectable),this.heroes.forEach(t=>t.destroy()),this.controller.stage.removeChildren()}pause(){}resume(){}renderTitle(){let t=new o.BitmapText("ROGUELIKE DUNGEON",{font:{name:"alagard",size:64}});t.anchor=new o.Point(.5,0),t.position.set(this.controller.app.screen.width>>1,64),this.controller.stage.addChild(t)}renderHeroes(){const t=this.controller.app.screen.width,e=this.controller.app.screen.height,i=r.heroCharacterNames.length,n=Math.floor((t-40*(i+1))/i),s=(n-80)/16,o=Math.floor(28*s)+32+120;for(let t=0;t<i;t++){const i=r.heroCharacterNames[t],s=40*(t+1)+n*t,h=(e>>1)-(o>>1),l=new a(n,o,i,this.controller.resources);l.position.set(s,h),this.heroes.push(l),this.controller.stage.addChild(l),this.selectable.set(t,0,l,()=>this.select(i))}this.selectable.reset()}select(t){const e=r.Hero.load(t,this.controller.persistent),i=n.WeaponConfig.configs[0].create(this.controller.resources);e.inventory.equipment.weapon.set(i),this.controller.generateDungeon({level:1,hero:e})}};class a extends o.Container{constructor(t,e,i,r){super(),this.isSelected=!1,this.selectedBg=(new o.Graphics).beginFill(s.Colors.uiSelected).drawRect(0,0,t,e).endFill(),this.notSelectedBg=(new o.Graphics).beginFill(s.Colors.uiNotSelected).drawRect(0,0,t,e).endFill(),this.title=new o.BitmapText(i,{font:{name:"alagard",size:32}}),this.title.anchor=.5,this.title.position.set(t>>1,40);const n=t-80,a=n/16,h=Math.floor(28*a);this.sprite=r.animated(i+"_idle"),this.sprite.animationSpeed=.2,this.sprite.width=n,this.sprite.height=h,this.sprite.position.set(40,112),this.addChild(this.selectedBg,this.notSelectedBg,this.title,this.sprite),this.selected=!1}get selected(){return this.isSelected}set selected(t){this.isSelected=t,t?(this.selectedBg.visible=!0,this.notSelectedBg.visible=!1,this.title.visible=!0,this.sprite.gotoAndPlay(0)):(this.selectedBg.visible=!1,this.notSelectedBg.visible=!0,this.title.visible=!1,this.sprite.gotoAndStop(0))}destroy(){super.destroy(),this.selectedBg.destroy(),this.notSelectedBg.destroy(),this.title.destroy(),this.sprite.destroy()}}},{"./drop":64,"./hero":72,"./ui":97,"pixi.js":45}],87:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const r=t("pixi.js");class n{constructor(t,e){this.begin=!1,this.angle=0,this.point=t,this.segment=e}}var s;i.EndPoint=n,function(t){t[t.NORMAL=0]="NORMAL",t[t.TOP=1]="TOP"}(s=i.SegmentType||(i.SegmentType={}));class o{constructor(t,e,i){this.distance=0,this.p1=new n(t,this),this.p2=new n(e,this),this.type=i}toString(){const t=this.p1.point,e=this.p2.point;return`[${t.x}:${t.y} - ${e.x}:${e.y}]`}}i.Segment=o;class a{constructor(){this.segments=[],this.endpoints=[],this.light=new r.Point(0,0),this.maxDistance=500}init(){this.segments=[],this.endpoints=[],this.light=new r.Point(0,0)}addSegment(t,e,i,n,s){const a=new r.Point(t,e),h=new r.Point(i,n),l=new o(a,h,s);this.segments.push(l),this.endpoints.push(l.p1),this.endpoints.push(l.p2)}static deduplicated(t){const e=[];for(;t.length>0;){const i=t.pop(),r=[];for(let e=0;e<t.length;e++){let n=t[e],s=i.type===n.type,o=i.p1.point.equals(n.p1.point)&&i.p2.point.equals(n.p2.point);s&&o&&r.push(e)}for(let e of r)t.splice(e,1);e.push(i)}return e}static connected(t){const e=[];for(let i=0;i<t.length;i++){let r=t[i],n=!1,s=!1;for(let o=0;o<t.length;o++){if(o==i)continue;let a=t[o];if((!r.p1.point.equals(a.p1.point)||!r.p2.point.equals(a.p2.point))&&(n||!r.p1.point.equals(a.p1.point)&&!r.p1.point.equals(a.p2.point)||(n=!0),s||!r.p2.point.equals(a.p1.point)&&!r.p2.point.equals(a.p2.point)||(s=!0),n&&s)){e.push(r);break}}}return e}static filtered(t){const e=[],i=[],r=[[0,12,0,16],[5,12,5,16],[0,12,5,12],[0,0,5,0],[11,12,11,16],[11,12,16,12],[11,0,16,0]],n=t=>{const e=t.p1.point.x%16,i=t.p1.point.y%16,n=t.p2.point.x-t.p1.point.x+e,s=t.p2.point.y-t.p1.point.y+i;for(let[t,o,a,h]of r)if(t===e&&o===i&&a===n&&h===s)return!0;return!1};for(const r of t)n(r)?i.push(r):e.push(r);for(;i.length>0;){const t=i.pop(),r=[t],n=[t.p1.point,t.p2.point],s=[1,1],o=[];for(let t=0;t<2;t++)for(let t=0;t<i.length;t++){if(o.indexOf(t)>=0)continue;let e=i[t];const a=e.p1.point,h=e.p2.point;let l=!1,u=!1;for(let t=0;t<n.length;t++){let e=n[t];e.equals(a)?(l=!0,s[t]++):e.equals(h)&&(u=!0,s[t]++)}(l||u)&&(o.push(t),r.push(e),l||(n.push(a),s.push(1)),u||(n.push(h),s.push(1)))}if(4===s.length&&s.every(t=>2===t)){let t=0,n=0;for(let e=0;e<4;e++){let i=r[e];i.p1.point.y===i.p2.point.y&&i.p1.point.y>n&&(t=e,n=i.p1.point.y)}for(let t of o.reverse())i.splice(t,1);r.splice(t,1),e.push(...r)}else e.push(t)}return e}static merge(t){const e=[];for(;t.length>0;){const i=t.pop();let r=null;for(let e=0;e<t.length;e++){let n=t[e];if(i.type===n.type){if(i.p2.point.equals(n.p1.point)){t.splice(e,1),r=[i,n];break}if(n.p2.point.equals(i.p1.point)){t.splice(e,1),r=[n,i];break}}}if(r){const[e,i]=r;t.push(new o(e.p1.point,i.p2.point,e.type))}else e.push(i)}return e}optimize(){console.log("optimize: segments="+this.segments.length);const t=a.deduplicated([...this.segments]);console.log("optimize: deduplicated="+t.length);const e=a.connected(t);console.log("optimize: connected="+e.length);const i=a.filtered(e);console.log("optimize: filtered="+i.length);const r=a.connected(i);console.log("optimize: connected = "+r.length);const n=[...a.merge(r.filter(t=>t.p1.point.x===t.p2.point.x)),...a.merge(r.filter(t=>t.p1.point.y===t.p2.point.y))];console.log("optimize: merged="+n.length),this.segments=[],this.endpoints=[];for(const t of n)this.segments.push(t),this.endpoints.push(t.p1),this.endpoints.push(t.p2)}setLightLocation(t,e,i){this.light.x=t,this.light.y=e,this.maxDistance=i,this.endpoints=[];for(const r of this.segments){let n=.5*(r.p1.point.x+r.p2.point.x)-t,s=.5*(r.p1.point.y+r.p2.point.y)-e;if(r.distance=Math.sqrt(n*n+s*s),r.distance<i){r.p1.angle=Math.atan2(r.p1.point.y-e,r.p1.point.x-t),r.p2.angle=Math.atan2(r.p2.point.y-e,r.p2.point.x-t);let i=r.p2.angle-r.p1.angle;i<=-Math.PI&&(i+=2*Math.PI),i>Math.PI&&(i-=2*Math.PI),r.p1.begin=i>0,r.p2.begin=!r.p1.begin,this.endpoints.push(r.p1,r.p2)}}this.endpoints.sort(a.compare)}static compare(t,e){return t.angle>e.angle?1:t.angle<e.angle?-1:!t.begin&&e.begin?1:t.begin&&!e.begin?-1:0}static leftOf(t,e){return(t.p2.point.x-t.p1.point.x)*(e.y-t.p1.point.y)-(t.p2.point.y-t.p1.point.y)*(e.x-t.p1.point.x)<0}static interpolate(t,e,i){return new r.Point(t.x*(1-i)+e.x*i,t.y*(1-i)+e.y*i)}static segmentInFrontOf(t,e,i){const r=a.leftOf(t,a.interpolate(e.p1.point,e.p2.point,.01)),n=a.leftOf(t,a.interpolate(e.p2.point,e.p1.point,.01)),s=a.leftOf(t,i),o=a.leftOf(e,a.interpolate(t.p1.point,t.p2.point,.01)),h=a.leftOf(e,a.interpolate(t.p2.point,t.p1.point,.01)),l=a.leftOf(e,i);return o==h&&h!=l||r==n&&n==s}sweep(){const t=[],e=[];let i=0;for(let r=0;r<=2;r++)for(const n of this.endpoints){let s=0===e.length?null:e[0];if(n.begin){let t=0,i=e[t];for(;null!=i&&a.segmentInFrontOf(n.segment,i,this.light);)t++,i=e[t];null==i?e.push(n.segment):e.splice(t,0,n.segment)}else for(let t=0;t<e.length;t++)e[t]===n.segment&&e.splice(t,1);s!==(0===e.length?null:e[0])&&(1==r&&this.addTriangle(i,n.angle,s,t),i=n.angle)}return t}static lineIntersection(t,e,i,n){const s=((n.x-i.x)*(t.y-i.y)-(n.y-i.y)*(t.x-i.x))/((n.y-i.y)*(e.x-t.x)-(n.x-i.x)*(e.y-t.y));return new r.Point(t.x+s*(e.x-t.x),t.y+s*(e.y-t.y))}addTriangle(t,e,i,n){const o=Math.cos(t),h=Math.sin(t),l=Math.cos(e),u=Math.sin(e);let c=this.light,d=new r.Point(this.light.x+o,this.light.y+h),p=new r.Point(0,0),f=new r.Point(0,0);null!=i?(p.x=i.p1.point.x,p.y=i.p1.point.y,f.x=i.p2.point.x,f.y=i.p2.point.y):(p.x=this.light.x+o*this.maxDistance,p.y=this.light.y+h*this.maxDistance,f.x=this.light.x+l*this.maxDistance,f.y=this.light.y+u*this.maxDistance);let g=a.lineIntersection(p,f,c,d);g.x=Math.round(g.x),g.y=Math.round(g.y),d.x=this.light.x+l,d.y=this.light.y+u;let m=a.lineIntersection(p,f,c,d);if(m.x=Math.round(m.x),m.y=Math.round(m.y),null!=i)switch(i.type){case s.TOP:n.push(g),n.push(new r.Point(g.x,g.y-16)),n.push(new r.Point(m.x,m.y-16)),n.push(m);break;case s.NORMAL:n.push(g),n.push(m)}else n.push(g),n.push(m)}debug(){const t=document.createElement("canvas");t.width=1280,t.height=1280;const e=t.getContext("2d");e.fillRect(0,0,1280,1280),e.scale(1,1);const i=new Path2D;for(let t of this.segments){const e=t.p1.point,r=t.p2.point;i.moveTo(e.x,e.y),i.lineTo(r.x,r.y)}e.strokeStyle="rgba(255,0,0,0.5)",e.stroke(i),console.log("%c ",`\n      font-size: 1px;\n      padding: ${t.height/2}px ${t.width/2}px;\n      background: no-repeat url(${t.toDataURL("image/png")});\n      background-size: ${t.width}px ${t.height}px;\n    `)}}i.ShadowCaster=a},{"pixi.js":45}],88:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});i.Template=class{constructor(){this.context={}}add(t,e){this.context[t]=e}render(t){return t.replace(/{{([^}]+)}}/g,(t,e)=>{let i=e.split(".");if(i.length>=1){let t=this.context;for(;i.length>0;){const[e]=i.splice(0,1);t=t[e]}return t||null}return e})}}},{}],89:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const r=t("./dungeon.map"),n=t("./monster"),s=t("./character");i.tinyMonsters=[{name:"chort",category:n.MonsterCategory.DEMON,type:n.MonsterType.NORMAL,luck:.3},{name:"wogol",category:n.MonsterCategory.DEMON,type:n.MonsterType.NORMAL,luck:.3},{name:"imp",category:n.MonsterCategory.DEMON,type:n.MonsterType.NORMAL,luck:.3},{name:"ice_zombie",category:n.MonsterCategory.ZOMBIE,type:n.MonsterType.NORMAL,luck:.3},{name:"tiny_zombie",category:n.MonsterCategory.ZOMBIE,type:n.MonsterType.NORMAL,luck:.3},{name:"zombie",category:n.MonsterCategory.ZOMBIE,type:n.MonsterType.NORMAL,luck:.3},{name:"orc_shaman",category:n.MonsterCategory.ORC,type:n.MonsterType.LEADER,luck:.4},{name:"masked_orc",category:n.MonsterCategory.ORC,type:n.MonsterType.NORMAL,luck:.3},{name:"orc_warrior",category:n.MonsterCategory.ORC,type:n.MonsterType.MINION,luck:.3},{name:"goblin",category:n.MonsterCategory.ORC,type:n.MonsterType.MINION,luck:.3},{name:"swampy",category:n.MonsterCategory.SLIME,type:n.MonsterType.NORMAL,luck:.3},{name:"muddy",category:n.MonsterCategory.SLIME,type:n.MonsterType.NORMAL,luck:.3},{name:"necromancer",category:n.MonsterCategory.UNDEAD,type:n.MonsterType.LEADER,luck:.4},{name:"skeleton",category:n.MonsterCategory.UNDEAD,type:n.MonsterType.MINION,luck:.3}];class o extends n.MonsterCharacter{constructor(t,e){super({name:t.name,category:t.category,type:t.type,speed:.8,healthMax:10+Math.floor(2*e),level:e,luck:t.luck,damage:3+.5*e,xp:35+5*e,spawn:3})}}i.TinyMonster=o;class a extends n.MonsterAI{constructor(t,e,i,n){super(e,{x:i,y:n,width:1,height:1,zIndex:r.DungeonZIndexes.character}),this.max_distance=5,this.character=t,this.init()}action(t){if(!this.character.dead.get()){const e=this.animation instanceof s.IdleAnimation;if(this.character.type===n.MonsterType.LEADER){if(t&&this.spawnMinions())return!1;if(e||t)return this.moveFromHeroOrAttack();this.ready()}else{if((e||t)&&this.moveToHero())return!0;if((e||t)&&this.moveByPath())return!0;if(this.ready(),t&&this.randomMove())return!0}}return!1}moveFromHeroOrAttack(){const[t]=this.scanHero(s.ScanDirection.AROUND,this.max_distance);if(t){this.sendAlarm(t);const e=Math.abs(this.x-t.x),i=Math.abs(this.y-t.y);if(e>this.width||i>this.height){const e=Math.min(1,Math.max(-1,this.x-t.x)),i=Math.min(1,Math.max(-1,this.y-t.y));return console.log("move from hero"),this.move(e,i)||this.move(e,0)||this.move(0,i)}return console.log("attack hero"),this.lookAt(t),this.hit(),!0}return!1}drop(){var t;Math.random()<this.character.luck&&(null===(t=this.findDropCell())||void 0===t||t.randomDrop())}spawnMinion(t,e){const r=i.tinyMonsters.filter(t=>t.category===this.character.category&&t.type===n.MonsterType.MINION);if(0===r.length)return console.warn("no minion config found",this.character.category),null;const s=this.dungeon.rng.choice(r),h=new o(s,this.dungeon.level);return new a(h,this.dungeon,t,e)}}i.TinyMonsterAI=a},{"./character":59,"./dungeon.map":67,"./monster":78}],90:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const r=t("./model");i.Crawler=class{constructor(t,e,i,r,n,s,o){this.rng=t,this.dungeonCrawler=e,this.config=e.config,this.location=i,this.direction=r,this.age=n,this.maxAge=s,this.generation=o,console.assert(this.valid(i)),console.assert(this.validDirection(r))}rightDirection(){if(0===this.direction.x)return new r.Point(this.direction.y,0);if(0===this.direction.y)return new r.Point(0,-this.direction.x);throw"illegal direction"}valid(t){return t.x>=0&&t.y>=0&&t.x<this.config.width&&t.y<this.config.height}validDirection(t){return 0===t.x&&(-1===t.y||1===t.y)||0===t.y&&(-1===t.x||1===t.x)}frontFree(t,e,i,n){let s;if(console.assert(i>=1&&n>=1),console.assert(this.valid(t)),console.assert(0===e.x&&(1===e.y||-1===e.y)||0===e.y&&(1===e.x||-1===e.x)),0===e.x)s=new r.Point(e.y,0);else{if(0!==e.y)throw"invalid heading";s=new r.Point(0,-e.x)}const o=this.findFrontFree(i,n,t,s,e);return console.assert(o>=0),o>0&&(i=this.findLeftFree(i,o,t,s,e),n=this.findRightFree(n,o,t,s,e)),[o,i,n]}findFrontFree(t,e,i,r,n){let s=0;for(;;){s++;for(let o=-t;o<=e;o++){const t=i.plus(r.multiply(o)).plus(n.multiply(s));if(!this.valid(t))return Math.max(0,s-1);if(this.freePredicate(this.dungeonCrawler.getMap(t)))return Math.max(0,s-1)}}}findLeftFree(t,e,i,r,n){for(;;){t++;for(let s=1;s<=e;s++){const e=i.minus(r.multiply(t)).plus(n.multiply(s));if(!this.valid(e))return t-1;if(this.freePredicate(this.dungeonCrawler.getMap(e)))return t-1}}}findRightFree(t,e,i,r,n){for(;;){t++;for(let s=1;s<=e;s++){const e=i.plus(r.multiply(t)).plus(n.multiply(s));if(!this.valid(e))return t-1;if(this.freePredicate(this.dungeonCrawler.getMap(e)))return t-1}}}freePredicate(t){return t!==r.TunnelerCellType.CLOSED&&t!==r.TunnelerCellType.NON_JOIN_CLOSED}contains(t,...e){for(const i of e)if(t===i)return!0;return!1}}},{"./model":92}],91:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const r=t("./model"),n=t("./wall.crawler"),s=t("./tunnel.crawler"),o=t("./room.crawler");class a{constructor(t,e){this.rooms=[],this.mapFlagsDirections=[],this.crawlers=[],this.activeGeneration=0,this.currSmallRoomsLabyrinth=0,this.currMediumRoomsLabyrinth=0,this.currLargeRoomsLabyrinth=0,this.currSmallRoomsDungeon=0,this.currMediumRoomsDungeon=0,this.currLargeRoomsDungeon=0,this.rng=e,this.config=t,console.assert(11===t.childDelayProbabilityForGenerationCrawlers.length),console.assert(11===t.childDelayProbabilityForGenerationRoomCrawlers.length),console.assert(t.roomAspectRatio>=0&&t.roomAspectRatio<=1,"roomAspectRatio must be a double between 0 and 1"),console.assert(t.genSpeedUpOnAnteroom>=1,"Please use genSpeedUpOnAnteroom >= 1; parameter reset to 1"),console.assert(!t.crawlersInAnterooms||t.crawlersInAnterooms&&t.crawlersInTunnels,"when you allow Crawlers in Anterooms, you must also allow them in Tunnels"),this.map=[];for(let t=0;t<this.config.width*this.config.height;t++)this.map[t]=this.config.background,this.mapFlagsDirections[t]=!1;for(let t=0;t<4;t++)this.crawlers[t]=null;this.setRect(0,0,this.config.width-1,0,r.TunnelerCellType.GUARANTEED_CLOSED),this.setRect(0,0,0,this.config.height-1,r.TunnelerCellType.GUARANTEED_CLOSED),this.setRect(this.config.width-1,0,this.config.width-1,this.config.height-1,r.TunnelerCellType.GUARANTEED_CLOSED),this.setRect(0,this.config.height-1,this.config.width-1,this.config.height-1,r.TunnelerCellType.GUARANTEED_CLOSED);for(const t of this.config.design)this.setRectFill(t);for(const t of this.config.openings)switch(t){case r.Direction.NORTH:this.setRect(0,Math.floor(this.config.height/2)-1,2,Math.floor(this.config.height/2)+1,r.TunnelerCellType.GUARANTEED_OPEN);break;case r.Direction.WEST:this.setRect(Math.floor(this.config.width/2)-1,0,Math.floor(this.config.width/2)+1,2,r.TunnelerCellType.GUARANTEED_OPEN);break;case r.Direction.EAST:this.setRect(Math.floor(this.config.width/2)-1,this.config.height-3,Math.floor(this.config.width/2)+1,this.config.height-1,r.TunnelerCellType.GUARANTEED_OPEN);break;case r.Direction.SOUTH:this.setRect(this.config.width-3,Math.floor(this.config.height/2)-1,this.config.width-1,Math.floor(this.config.height/2)+1,r.TunnelerCellType.GUARANTEED_OPEN);break;case r.Direction.NORTH_WEST:this.setRect(0,0,2,2,r.TunnelerCellType.GUARANTEED_OPEN);break;case r.Direction.NORTH_EAST:this.setRect(0,this.config.height-3,2,this.config.height-1,r.TunnelerCellType.GUARANTEED_OPEN);break;case r.Direction.SOUTH_WEST:this.setRect(this.config.width-3,0,this.config.width-1,2,r.TunnelerCellType.GUARANTEED_OPEN);break;case r.Direction.SOUTH_EAST:this.setRect(this.config.width-3,this.config.height-3,this.config.width-1,this.config.height-1,r.TunnelerCellType.GUARANTEED_OPEN);break;default:console.assert(!1)}const i=(e,i,r)=>{this.createWallCrawler(e,i,0,this.getMaxAgeCrawlers(r),r,i,this.getStepLength(r),1,this.getCorridorWidth(r),this.mutate2(t.randCrawler.straightSingleSpawnProbability),this.mutate2(t.randCrawler.straightDoubleSpawnProbability),this.mutate2(t.randCrawler.turnSingleSpawnProbability),this.mutate2(t.randCrawler.turnDoubleSpawnProbability),this.mutate2(t.randCrawler.changeDirectionProbability))};for(let e=0;e<t.randCrawler.perGeneration.length;e++){let n=t.randCrawler.perGeneration[e];if(n>0){let t=Math.floor(this.config.height*n/1e3);0===t&&this.rng.int%1e3<this.config.height*n&&(t=1);let s=0;for(let n=0;n<t;n++)s=2+this.rng.int%(this.config.height-4),i(new r.Point(0,s),r.Point.SOUTH,e),s=2+this.rng.int%(this.config.height-4),i(new r.Point(this.config.width-1,s),r.Point.NORTH,e);let o=Math.floor(this.config.width*n/1e3);0===o&&this.rng.int%1e3<this.config.width*n&&(o=1);let a=0;for(let t=0;t<o;t++)a=2+this.rng.int%(this.config.width-4),i(new r.Point(a,0),r.Point.EAST,e),a=2+this.rng.int%(this.config.width-4),i(new r.Point(a,this.config.height-1),r.Point.EAST,e)}}for(const e of t.crawlers)this.createWallCrawler(e.location,e.direction,-e.age,e.maxAge,e.generation,e.intendedDirection,e.stepLength,e.opening,e.corridorWidth,e.straightSingleSpawnProbability,e.straightDoubleSpawnProbability,e.turnSingleSpawnProbability,e.turnDoubleSpawnProbability,e.changeDirectionProbability);for(let[e,i]of t.crawlerPairs){let t=!0;this.rng.boolean&&(t=!1),this.createWallCrawler(e.location,e.direction,-e.age,e.maxAge,e.generation,e.intendedDirection,e.stepLength,t?1:0,e.corridorWidth,e.straightSingleSpawnProbability,e.straightDoubleSpawnProbability,e.turnSingleSpawnProbability,e.turnDoubleSpawnProbability,e.changeDirectionProbability),this.setMap(e.location,r.TunnelerCellType.CLOSED),this.createWallCrawler(i.location,i.direction,-i.age,i.maxAge,i.generation,i.intendedDirection,i.stepLength,t?1:0,i.corridorWidth,i.straightSingleSpawnProbability,i.straightDoubleSpawnProbability,i.turnSingleSpawnProbability,i.turnDoubleSpawnProbability,i.changeDirectionProbability),this.setMap(i.location,r.TunnelerCellType.CLOSED)}for(let e of t.tunnelCrawlers)this.createTunnelCrawler(e.location,e.direction,-e.age,e.maxAge,e.generation,e.intendedDirection,e.stepLength,e.tunnelWidth,e.straightDoubleSpawnProbability,e.turnDoubleSpawnProbability,e.changeDirectionProbability,e.makeRoomsRightProbability,e.makeRoomsLeftProbability,e.joinPreference)}isOpen(t){let e=this.getMap(t);return e===r.TunnelerCellType.OPEN||e===r.TunnelerCellType.NON_JOIN_OPEN||e===r.TunnelerCellType.INSIDE_TUNNEL_OPEN||e===r.TunnelerCellType.INSIDE_ANTEROOM_OPEN||e===r.TunnelerCellType.GUARANTEED_OPEN||e===r.TunnelerCellType.NON_JOIN_GUARANTEED_OPEN}static isActive(t,e){for(let i of e)if(t.x===i.x&&t.y===i.y)return!0;return!1}setMap(t,e){const i=t.x,r=t.y;console.assert(void 0!==e),console.assert(i<this.config.width&&r<this.config.height&&i>=0&&r>=0),this.map[i*this.config.height+r]=e}getMap(t){const e=t.x,i=t.y;return console.assert(e<this.config.width&&i<this.config.height&&e>=0&&i>=0),this.map[e*this.config.height+i]}isMapOpen(t){switch(this.getMap(t)){case r.TunnelerCellType.OPEN:case r.TunnelerCellType.GUARANTEED_OPEN:case r.TunnelerCellType.NON_JOIN_OPEN:case r.TunnelerCellType.NON_JOIN_GUARANTEED_OPEN:case r.TunnelerCellType.INSIDE_ROOM_OPEN:case r.TunnelerCellType.INSIDE_TUNNEL_OPEN:case r.TunnelerCellType.INSIDE_ANTEROOM_OPEN:case r.TunnelerCellType.H_DOOR:case r.TunnelerCellType.V_DOOR:return!0;default:return!1}}isMoreRoomsLabyrinth(t=null){if(null===t)return this.isMoreRoomsLabyrinth(r.RoomSize.SMALL)||this.isMoreRoomsLabyrinth(r.RoomSize.MEDIUM)||this.isMoreRoomsLabyrinth(r.RoomSize.LARGE);switch(t){case r.RoomSize.SMALL:return this.config.numSmallRoomsInLabyrinth>this.currSmallRoomsLabyrinth;case r.RoomSize.MEDIUM:return this.config.numMediumRoomsInLabyrinth>this.currMediumRoomsLabyrinth;case r.RoomSize.LARGE:return this.config.numLargeRoomsInLabyrinth>this.currLargeRoomsLabyrinth}}isMoreRoomsDungeon(t){if(null===t)return this.isMoreRoomsDungeon(r.RoomSize.SMALL)||this.isMoreRoomsDungeon(r.RoomSize.MEDIUM)||this.isMoreRoomsDungeon(r.RoomSize.LARGE);switch(t){case r.RoomSize.SMALL:return this.config.numSmallRoomsInDungeon>this.currSmallRoomsDungeon;case r.RoomSize.MEDIUM:return this.config.numMediumRoomsInDungeon>this.currMediumRoomsDungeon;case r.RoomSize.LARGE:return this.config.numLargeRoomsInDungeon>this.currLargeRoomsDungeon}}builtRoomDungeon(t){r.RoomSize.SMALL===t?this.currSmallRoomsDungeon++:r.RoomSize.MEDIUM===t?this.currMediumRoomsDungeon++:r.RoomSize.LARGE===t&&this.currLargeRoomsDungeon++}getStepLength(t){return t>=this.config.stepLengths.length?this.config.stepLengths[this.config.stepLengths.length-1]:this.config.stepLengths[t]}getCorridorWidth(t){return t>=this.config.corridorWidths.length?this.config.corridorWidths[this.config.corridorWidths.length-1]:this.config.corridorWidths[t]}getMaxAgeCrawlers(t){return t>=this.config.maxAgesCrawlers.length?this.config.maxAgesCrawlers[this.config.maxAgesCrawlers.length-1]:this.config.maxAgesCrawlers[t]}addRoom(t){this.rooms.push(t)}isChecked(t){return console.assert(t.x<this.config.width&&t.y<this.config.height&&t.x>=0&&t.y>=0),this.mapFlagsDirections[t.x*this.config.height+t.y]}static isCheckedList(t,e){for(let i=0;i<e.length;i++)if(t.x===e[i].x&&t.y===e[i].y)return!0;return!1}setChecked(t){console.assert(t.x<this.config.width&&t.y<this.config.height&&t.x>=0&&t.y>=0),this.mapFlagsDirections[t.x*this.config.height+t.y]=!0}setRectFill(t){this.setRect(t.startX,t.startY,t.endX,t.endY,t.type)}setRect(t,e,i,r,n){if(i<t||r<e)console.error(`Refuse to set incorrectly specified rectangle; sX = ${t} sY=${e} eX=${i} endY=${r}`);else for(let s=t;s<=i;s++)for(let t=e;t<=r;t++)this.setMap({x:s,y:t},n)}createWallCrawler(t,e,i,s,o,a,h,l,u,c,d,p,f,g){let m=new n.WallCrawler(this.rng,this,r.Point.from(t),r.Point.from(e),i,s,o,r.Point.from(a),h,l,u,c,d,p,f,g);for(let t=0;t<this.crawlers.length;t++)if(null===this.crawlers[t])return void(this.crawlers[t]=m);this.crawlers.push(m)}createTunnelCrawler(t,e,i,n,o,a,h,l,u,c,d,p,f,g){let m=new s.TunnelCrawler(this.rng,this,r.Point.from(t),r.Point.from(e),i,n,o,r.Point.from(a),h,l,u,c,d,p,f,g);for(let t=0;t<this.crawlers.length;t++)if(null===this.crawlers[t])return void(this.crawlers[t]=m);this.crawlers.push(m)}createRoomCrawler(t,e,i,n,s,a,h){const l=new o.RoomCrawler(this.rng,this,r.Point.from(t),r.Point.from(e),i,n,s,a,h);for(let t=0;t<this.crawlers.length;t++)if(null===this.crawlers[t])return void(this.crawlers[t]=l);this.crawlers.push(l)}mutate(t){let e=t-this.config.mutator+this.rng.int%(2*this.config.mutator+1);return e<0?0:e}mutate2(t){return t<=50?t<0?0:this.rng.int%(2*t+1):t>100?100:2*t-100+this.rng.int%(200-2*t+1)}createSeedCrawlersInTunnels(){let t=0,e=0;for(new n.WallCrawler(this.rng,this,new r.Point(2,2),r.Point.SOUTH,0,1,0,r.Point.SOUTH,1,0,1,0,0,0,0,0);t<this.config.seedCrawlersInTunnels&&e<this.config.width*this.config.height;){e++;let i=1+this.rng.int%(this.config.width-4),n=1+this.rng.int%(this.config.height-4),s=new r.Point(i,n);this.rng.int%100<50?i=0:n=0,0===i?n=this.rng.int%100<50?-1:1:(console.assert(0===n),i=this.rng.int%100<50?-1:1);let o,a=new r.Point(i,n);if(0===a.x)o=new r.Point(a.y,0);else{if(0!==a.y)throw"illegal direction";o=new r.Point(0,-a.x)}let h=!0;for(;h&&(s=s.plus(a),!(s.x<2||s.y<2||s.x>this.config.width-3||s.y>this.config.height-3));)this.getMap(s)===r.TunnelerCellType.INSIDE_TUNNEL_OPEN&&this.getMap(s.plus(a))===r.TunnelerCellType.INSIDE_TUNNEL_OPEN&&this.getMap(s.minus(a))===r.TunnelerCellType.INSIDE_TUNNEL_OPEN&&this.getMap(s.plus(o))===r.TunnelerCellType.INSIDE_TUNNEL_OPEN&&this.getMap(s.minus(o))===r.TunnelerCellType.INSIDE_TUNNEL_OPEN&&this.getMap(s.plus(a).plus(o))===r.TunnelerCellType.INSIDE_TUNNEL_OPEN&&this.getMap(s.minus(a).plus(o))===r.TunnelerCellType.INSIDE_TUNNEL_OPEN&&this.getMap(s.plus(a).minus(o))===r.TunnelerCellType.INSIDE_TUNNEL_OPEN&&this.getMap(s.minus(a).minus(o))===r.TunnelerCellType.INSIDE_TUNNEL_OPEN&&(this.setMap(s,r.TunnelerCellType.CLOSED),this.createWallCrawler(s,a,0,this.config.tunnelCrawlerStats.maxAge,this.activeGeneration+1,a,this.config.tunnelCrawlerStats.stepLength,1,1,this.config.tunnelCrawlerStats.straightSingleSpawnProbability,this.config.tunnelCrawlerStats.straightDoubleSpawnProbability,this.config.tunnelCrawlerStats.turnSingleSpawnProbability,this.config.tunnelCrawlerStats.turnDoubleSpawnProbability,this.config.tunnelCrawlerStats.changeDirectionProbability),this.createWallCrawler(s,o,0,this.config.tunnelCrawlerStats.maxAge,this.activeGeneration+1,a,this.config.tunnelCrawlerStats.stepLength,1,1,this.config.tunnelCrawlerStats.straightSingleSpawnProbability,this.config.tunnelCrawlerStats.straightDoubleSpawnProbability,this.config.tunnelCrawlerStats.turnSingleSpawnProbability,this.config.tunnelCrawlerStats.turnDoubleSpawnProbability,this.config.tunnelCrawlerStats.changeDirectionProbability),this.createWallCrawler(s,o.negative,0,this.config.tunnelCrawlerStats.maxAge,this.activeGeneration+1,a,this.config.tunnelCrawlerStats.stepLength,1,1,this.config.tunnelCrawlerStats.straightSingleSpawnProbability,this.config.tunnelCrawlerStats.straightDoubleSpawnProbability,this.config.tunnelCrawlerStats.turnSingleSpawnProbability,this.config.tunnelCrawlerStats.turnDoubleSpawnProbability,this.config.tunnelCrawlerStats.changeDirectionProbability),this.rng.int%100<this.config.tunnelCrawlerClosedProbability?this.createWallCrawler(s,a.negative,0,this.config.tunnelCrawlerStats.maxAge,this.activeGeneration+1,a,this.config.tunnelCrawlerStats.stepLength,0,1,this.config.tunnelCrawlerStats.straightSingleSpawnProbability,this.config.tunnelCrawlerStats.straightDoubleSpawnProbability,this.config.tunnelCrawlerStats.turnSingleSpawnProbability,this.config.tunnelCrawlerStats.turnDoubleSpawnProbability,this.config.tunnelCrawlerStats.changeDirectionProbability):this.createWallCrawler(s,a.negative,0,this.config.tunnelCrawlerStats.maxAge,this.activeGeneration+1,a,this.config.tunnelCrawlerStats.stepLength,1,1,this.config.tunnelCrawlerStats.straightSingleSpawnProbability,this.config.tunnelCrawlerStats.straightDoubleSpawnProbability,this.config.tunnelCrawlerStats.turnSingleSpawnProbability,this.config.tunnelCrawlerStats.turnDoubleSpawnProbability,this.config.tunnelCrawlerStats.changeDirectionProbability),h=!1,t++)}}makeIteration(){for(let t=0;t<this.crawlers.length;t++)null!==this.crawlers[t]&&(this.crawlers[t].stepAhead()||(this.crawlers[t]=null));return!1}advanceGeneration(){let t=!1,e=0;for(let i=0;i<this.crawlers.length;i++)if(null!==this.crawlers[i]&&(t=!0,this.crawlers[i].generation===this.activeGeneration)){let t=this.crawlers[i].age;if(t>=0)return!0;(0===e||t>e)&&(e=t)}if(0===e)return this.activeGeneration++,t;console.assert(e<0);for(let t=0;t<this.crawlers.length;t++)null!==this.crawlers[t]&&this.crawlers[t].generation===this.activeGeneration&&(this.crawlers[t].age-=e);return t}createRoom(t){if(this.config.width<10||this.config.height<10)return!1;if(t.endX-t.startX<=5)return!1;if(t.endY-t.startY<=5)return!1;let e=t.startX+1+this.rng.int%(t.endX-t.startX-3),i=t.startY+1+this.rng.int%(t.endY-t.startY-3),n=new r.Point(e,i);if(!this.isOpen(n))return!1;if(this.isChecked(n))return!1;let s=this.config.maxRoomSize;if(this.isMoreRoomsLabyrinth(r.RoomSize.LARGE)||(s=this.config.largeRoomSize),this.isMoreRoomsLabyrinth(r.RoomSize.LARGE)||this.isMoreRoomsLabyrinth(r.RoomSize.MEDIUM)||(s=this.config.mediumRoomSize),!this.isMoreRoomsLabyrinth())return!1;let o,h=!0,l=[],u=[],c=[];for(u.push(n);h;){h=!1;for(let t=0;t<u.length;){let e=u[t];if(o=0,!this.isOpen(e.plus(r.Point.NORTH))||a.isCheckedList(e.plus(r.Point.NORTH),l)||a.isActive(e.plus(r.Point.NORTH),u)||a.isActive(e.plus(r.Point.NORTH),c)||o++,!this.isOpen(e.plus(r.Point.SOUTH))||a.isCheckedList(e.plus(r.Point.SOUTH),l)||a.isActive(e.plus(r.Point.SOUTH),u)||a.isActive(e.plus(r.Point.SOUTH),c)||o++,!this.isOpen(e.plus(r.Point.EAST))||a.isCheckedList(e.plus(r.Point.EAST),l)||a.isActive(e.plus(r.Point.EAST),u)||a.isActive(e.plus(r.Point.EAST),c)||o++,!this.isOpen(e.plus(r.Point.WEST))||a.isCheckedList(e.plus(r.Point.WEST),l)||a.isActive(e.plus(r.Point.WEST),u)||a.isActive(e.plus(r.Point.WEST),c)||o++,!this.isOpen(e.plus(r.Point.NORTH_EAST))||a.isCheckedList(e.plus(r.Point.NORTH_EAST),l)||a.isActive(e.plus(r.Point.NORTH_EAST),u)||a.isActive(e.plus(r.Point.NORTH_EAST),c)||o++,!this.isOpen(e.plus(r.Point.NORTH_WEST))||a.isCheckedList(e.plus(r.Point.NORTH_WEST),l)||a.isActive(e.plus(r.Point.NORTH_WEST),u)||a.isActive(e.plus(r.Point.NORTH_WEST),c)||o++,!this.isOpen(e.plus(r.Point.SOUTH_EAST))||a.isCheckedList(e.plus(r.Point.SOUTH_EAST),l)||a.isActive(e.plus(r.Point.SOUTH_EAST),u)||a.isActive(e.plus(r.Point.SOUTH_EAST),c)||o++,!this.isOpen(e.plus(r.Point.SOUTH_WEST))||a.isCheckedList(e.plus(r.Point.SOUTH_WEST),l)||a.isActive(e.plus(r.Point.SOUTH_WEST),u)||a.isActive(e.plus(r.Point.SOUTH_WEST),c)||o++,o>2)h=!0,!this.isOpen(e.plus(r.Point.NORTH))||a.isCheckedList(e.plus(r.Point.NORTH),l)||a.isActive(e.plus(r.Point.NORTH),u)||a.isActive(e.plus(r.Point.NORTH),c)||c.push(e.plus(r.Point.NORTH)),!this.isOpen(e.plus(r.Point.SOUTH))||a.isCheckedList(e.plus(r.Point.SOUTH),l)||a.isActive(e.plus(r.Point.SOUTH),u)||a.isActive(e.plus(r.Point.SOUTH),c)||c.push(e.plus(r.Point.SOUTH)),!this.isOpen(e.plus(r.Point.EAST))||a.isCheckedList(e.plus(r.Point.EAST),l)||a.isActive(e.plus(r.Point.EAST),u)||a.isActive(e.plus(r.Point.EAST),c)||c.push(e.plus(r.Point.EAST)),!this.isOpen(e.plus(r.Point.WEST))||a.isCheckedList(e.plus(r.Point.WEST),l)||a.isActive(e.plus(r.Point.WEST),u)||a.isActive(e.plus(r.Point.WEST),c)||c.push(e.plus(r.Point.WEST)),!this.isOpen(e.plus(r.Point.NORTH_EAST))||a.isCheckedList(e.plus(r.Point.NORTH_EAST),l)||a.isActive(e.plus(r.Point.NORTH_EAST),u)||a.isActive(e.plus(r.Point.NORTH_EAST),c)||c.push(e.plus(r.Point.NORTH_EAST)),!this.isOpen(e.plus(r.Point.NORTH_WEST))||a.isCheckedList(e.plus(r.Point.NORTH_WEST),l)||a.isActive(e.plus(r.Point.NORTH_WEST),u)||a.isActive(e.plus(r.Point.NORTH_WEST),c)||c.push(e.plus(r.Point.NORTH_WEST)),!this.isOpen(e.plus(r.Point.SOUTH_EAST))||a.isCheckedList(e.plus(r.Point.SOUTH_EAST),l)||a.isActive(e.plus(r.Point.SOUTH_EAST),u)||a.isActive(e.plus(r.Point.SOUTH_EAST),c)||c.push(e.plus(r.Point.SOUTH_EAST)),!this.isOpen(e.plus(r.Point.SOUTH_WEST))||a.isCheckedList(e.plus(r.Point.SOUTH_WEST),l)||a.isActive(e.plus(r.Point.SOUTH_WEST),u)||a.isActive(e.plus(r.Point.SOUTH_WEST),c)||c.push(e.plus(r.Point.SOUTH_WEST)),a.isCheckedList(e,l)||(l.push(e),this.setChecked(e)),u.splice(t,1),t++;else if(2===o){let i=0;if(!this.isOpen(e.plus(r.Point.NORTH))||a.isCheckedList(e.plus(r.Point.NORTH),l)||a.isActive(e.plus(r.Point.NORTH),u)||a.isActive(e.plus(r.Point.NORTH),c)||(c.push(e.plus(r.Point.NORTH)),i++),!this.isOpen(e.plus(r.Point.SOUTH))||a.isCheckedList(e.plus(r.Point.SOUTH),l)||a.isActive(e.plus(r.Point.SOUTH),u)||a.isActive(e.plus(r.Point.SOUTH),c)||(c.push(e.plus(r.Point.SOUTH)),i++),!this.isOpen(e.plus(r.Point.EAST))||a.isCheckedList(e.plus(r.Point.EAST),l)||a.isActive(e.plus(r.Point.EAST),u)||a.isActive(e.plus(r.Point.EAST),c)||(c.push(e.plus(r.Point.EAST)),i++),!this.isOpen(e.plus(r.Point.WEST))||a.isCheckedList(e.plus(r.Point.WEST),l)||a.isActive(e.plus(r.Point.WEST),u)||a.isActive(e.plus(r.Point.WEST),c)||(c.push(e.plus(r.Point.WEST)),i++),1===i){t++;continue}!this.isOpen(e.plus(r.Point.NORTH_EAST))||a.isCheckedList(e.plus(r.Point.NORTH_EAST),l)||a.isActive(e.plus(r.Point.NORTH_EAST),u)||a.isActive(e.plus(r.Point.NORTH_EAST),c)||c.push(e.plus(r.Point.NORTH_EAST)),!this.isOpen(e.plus(r.Point.NORTH_WEST))||a.isCheckedList(e.plus(r.Point.NORTH_WEST),l)||a.isActive(e.plus(r.Point.NORTH_WEST),u)||a.isActive(e.plus(r.Point.NORTH_WEST),c)||c.push(e.plus(r.Point.NORTH_WEST)),!this.isOpen(e.plus(r.Point.SOUTH_EAST))||a.isCheckedList(e.plus(r.Point.SOUTH_EAST),l)||a.isActive(e.plus(r.Point.SOUTH_EAST),u)||a.isActive(e.plus(r.Point.SOUTH_EAST),c)||c.push(e.plus(r.Point.SOUTH_EAST)),!this.isOpen(e.plus(r.Point.SOUTH_WEST))||a.isCheckedList(e.plus(r.Point.SOUTH_WEST),l)||a.isActive(e.plus(r.Point.SOUTH_WEST),u)||a.isActive(e.plus(r.Point.SOUTH_WEST),c)||c.push(e.plus(r.Point.SOUTH_WEST)),a.isCheckedList(e,l)||(l.push(e),this.setChecked(e)),u.splice(t,1),t++}else 1==o||(console.assert(0===o),a.isCheckedList(e,l)||(l.push(e),this.setChecked(e)),u.splice(t,1)),t++;if(l.length>s)return!1}for(let t of c){if(this.getMap(t)===r.TunnelerCellType.GUARANTEED_OPEN||this.getMap(t)===r.TunnelerCellType.NON_JOIN_GUARANTEED_OPEN)return!1;a.isCheckedList(t,l)||a.isActive(t,u)||u.push(t)}c.splice(0,c.length)}let d=!0,p=0,f=r.Point.ZERO;for(;d;){p=0,d=!1;for(let t=0;t<u.length;)f=u[t],o=0,!this.isOpen(f.plus(r.Point.NORTH))||a.isCheckedList(f.plus(r.Point.NORTH),l)||a.isActive(f.plus(r.Point.NORTH),u)||a.isActive(f.plus(r.Point.NORTH),c)||o++,!this.isOpen(f.plus(r.Point.SOUTH))||a.isCheckedList(f.plus(r.Point.SOUTH),l)||a.isActive(f.plus(r.Point.SOUTH),u)||a.isActive(f.plus(r.Point.SOUTH),c)||o++,!this.isOpen(f.plus(r.Point.EAST))||a.isCheckedList(f.plus(r.Point.EAST),l)||a.isActive(f.plus(r.Point.EAST),u)||a.isActive(f.plus(r.Point.EAST),c)||o++,!this.isOpen(f.plus(r.Point.WEST))||a.isCheckedList(f.plus(r.Point.WEST),l)||a.isActive(f.plus(r.Point.WEST),u)||a.isActive(f.plus(r.Point.WEST),c)||o++,!this.isOpen(f.plus(r.Point.NORTH_EAST))||a.isCheckedList(f.plus(r.Point.NORTH_EAST),l)||a.isActive(f.plus(r.Point.NORTH_EAST),u)||a.isActive(f.plus(r.Point.NORTH_EAST),c)||o++,!this.isOpen(f.plus(r.Point.NORTH_WEST))||a.isCheckedList(f.plus(r.Point.NORTH_WEST),l)||a.isActive(f.plus(r.Point.NORTH_WEST),u)||a.isActive(f.plus(r.Point.NORTH_WEST),c)||o++,!this.isOpen(f.plus(r.Point.SOUTH_EAST))||a.isCheckedList(f.plus(r.Point.SOUTH_EAST),l)||a.isActive(f.plus(r.Point.SOUTH_EAST),u)||a.isActive(f.plus(r.Point.SOUTH_EAST),c)||o++,!this.isOpen(f.plus(r.Point.SOUTH_WEST))||a.isCheckedList(f.plus(r.Point.SOUTH_WEST),l)||a.isActive(f.plus(r.Point.SOUTH_WEST),u)||a.isActive(f.plus(r.Point.SOUTH_WEST),c)||o++,o>1?(p++,t++):1===o?(d=!0,!this.isOpen(f.plus(r.Point.NORTH))||a.isCheckedList(f.plus(r.Point.NORTH),l)||a.isActive(f.plus(r.Point.NORTH),u)||a.isActive(f.plus(r.Point.NORTH),c)||c.push(f.plus(r.Point.NORTH)),!this.isOpen(f.plus(r.Point.SOUTH))||a.isCheckedList(f.plus(r.Point.SOUTH),l)||a.isActive(f.plus(r.Point.SOUTH),u)||a.isActive(f.plus(r.Point.SOUTH),c)||c.push(f.plus(r.Point.SOUTH)),!this.isOpen(f.plus(r.Point.EAST))||a.isCheckedList(f.plus(r.Point.EAST),l)||a.isActive(f.plus(r.Point.EAST),u)||a.isActive(f.plus(r.Point.EAST),c)||c.push(f.plus(r.Point.EAST)),!this.isOpen(f.plus(r.Point.WEST))||a.isCheckedList(f.plus(r.Point.WEST),l)||a.isActive(f.plus(r.Point.WEST),u)||a.isActive(f.plus(r.Point.WEST),c)||c.push(f.plus(r.Point.WEST)),!this.isOpen(f.plus(r.Point.NORTH_EAST))||a.isCheckedList(f.plus(r.Point.NORTH_EAST),l)||a.isActive(f.plus(r.Point.NORTH_EAST),u)||a.isActive(f.plus(r.Point.NORTH_EAST),c)||c.push(f.plus(r.Point.NORTH_EAST)),!this.isOpen(f.plus(r.Point.NORTH_WEST))||a.isCheckedList(f.plus(r.Point.NORTH_WEST),l)||a.isActive(f.plus(r.Point.NORTH_WEST),u)||a.isActive(f.plus(r.Point.NORTH_WEST),c)||c.push(f.plus(r.Point.NORTH_WEST)),!this.isOpen(f.plus(r.Point.SOUTH_EAST))||a.isCheckedList(f.plus(r.Point.SOUTH_EAST),l)||a.isActive(f.plus(r.Point.SOUTH_EAST),u)||a.isActive(f.plus(r.Point.SOUTH_EAST),c)||c.push(f.plus(r.Point.SOUTH_EAST)),!this.isOpen(f.plus(r.Point.SOUTH_WEST))||a.isCheckedList(f.plus(r.Point.SOUTH_WEST),l)||a.isActive(f.plus(r.Point.SOUTH_WEST),u)||a.isActive(f.plus(r.Point.SOUTH_WEST),c)||c.push(f.plus(r.Point.SOUTH_WEST)),a.isCheckedList(f,l)||(l.push(f),this.setChecked(f)),u.splice(t,1)):(console.assert(0===o),a.isCheckedList(f,l)||(l.push(f),this.setChecked(f)),u.splice(t,1));for(f of c){if(this.getMap(f)===r.TunnelerCellType.GUARANTEED_OPEN||this.getMap(f)===r.TunnelerCellType.NON_JOIN_GUARANTEED_OPEN)return!1;a.isCheckedList(f,l)||a.isActive(f,u)||u.push(f)}c.splice(0,c.length)}if(p>1)return!1;if(0===p){console.assert(l.length>0),console.log("FILLING CLOSED ROOM");for(let t=0;t!==l.length;t++)console.assert(this.getMap(l[t])===r.TunnelerCellType.OPEN||this.getMap(l[t])===r.TunnelerCellType.NON_JOIN_OPEN||this.getMap(l[t])===r.TunnelerCellType.INSIDE_TUNNEL_OPEN||this.getMap(l[t])===r.TunnelerCellType.INSIDE_ANTEROOM_OPEN),this.setMap(l[t],r.TunnelerCellType.CLOSED)}else{if(console.assert(1===p),l.length<this.config.minRoomSize)return!1;let t=!1,e=!1;for(let i=0;i!==l.length;i++)l[i].x!==l[0].x&&(t=!0),l[i].y!==l[0].y&&(e=!0);if(!t||!e)return!1;if(this.getMap(f.plus(r.Point.WEST))===r.TunnelerCellType.V_DOOR||this.getMap(f.plus(r.Point.EAST))===r.TunnelerCellType.V_DOOR||this.getMap(f.plus(r.Point.WEST))===r.TunnelerCellType.H_DOOR||this.getMap(f.plus(r.Point.EAST))===r.TunnelerCellType.H_DOOR||this.getMap(f.plus(r.Point.NORTH))===r.TunnelerCellType.V_DOOR||this.getMap(f.plus(r.Point.SOUTH))===r.TunnelerCellType.V_DOOR||this.getMap(f.plus(r.Point.NORTH))===r.TunnelerCellType.H_DOOR||this.getMap(f.plus(r.Point.SOUTH))===r.TunnelerCellType.H_DOOR)return!1;if(l.length<this.config.mediumRoomSize){if(!this.isMoreRoomsLabyrinth(r.RoomSize.SMALL))return!1;this.currSmallRoomsLabyrinth++}else if(l.length<this.config.largeRoomSize){if(!this.isMoreRoomsLabyrinth(r.RoomSize.MEDIUM))return!1;this.currMediumRoomsLabyrinth++}else{if(!(l.length<this.config.maxRoomSize))return!1;if(!this.isMoreRoomsLabyrinth(r.RoomSize.LARGE))return!1;this.currLargeRoomsLabyrinth++}console.assert(1===u.length),f=u[0],this.isOpen(f.plus(r.Point.NORTH))?(console.assert(this.isOpen(f.plus(r.Point.SOUTH))),this.setMap(f,r.TunnelerCellType.H_DOOR)):this.isOpen(f.plus(r.Point.WEST))&&(console.assert(this.isOpen(f.plus(r.Point.EAST))),this.setMap(f,r.TunnelerCellType.V_DOOR));let i=new r.Room;for(let t=0;t!==l.length;t++)console.assert(this.getMap(l[t])===r.TunnelerCellType.OPEN||this.getMap(l[t])===r.TunnelerCellType.NON_JOIN_OPEN||this.getMap(l[t])===r.TunnelerCellType.INSIDE_TUNNEL_OPEN||this.getMap(l[t])===r.TunnelerCellType.INSIDE_ANTEROOM_OPEN),this.setMap(l[t],r.TunnelerCellType.INSIDE_ROOM_OPEN),i.inside.push(l[t]);i.inDungeon=!1,this.rooms.push(i)}return!0}generate(){for(;;){for(this.activeGeneration===this.config.tunnelCrawlerGeneration&&this.createSeedCrawlersInTunnels();this.makeIteration(););if(!this.advanceGeneration())break}if(this.config.tunnelCrawlerGeneration<0||this.activeGeneration<this.config.tunnelCrawlerGeneration)for(this.createSeedCrawlersInTunnels();;){for(;this.makeIteration(););if(!this.advanceGeneration())break}let t=0,e=0;if(this.config.background===r.TunnelerCellType.OPEN){let i=new r.FillRect(0,0,this.config.width,this.config.height,this.config.background);for(t=0,e=this.config.width*this.config.height;this.isMoreRoomsLabyrinth()&&(this.createRoom(i)||t++,!(t>e)););}for(let i of this.config.design)if(i.type===r.TunnelerCellType.OPEN)for(t=0,e=(i.endX-i.startX)*(i.endY-i.startY);this.isMoreRoomsLabyrinth()&&(this.createRoom(i)||t++,!(t>e)););}}i.DungeonCrawler=a},{"./model":92,"./room.crawler":93,"./tunnel.crawler":94,"./wall.crawler":95}],92:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});class r{constructor(t=0,e=0){this.x=t,this.y=e}plus(t){return new r(this.x+t.x,this.y+t.y)}minus(t){return new r(this.x-t.x,this.y-t.y)}multiply(t){return new r(this.x*t,this.y*t)}get negative(){return new r(-this.x,-this.y)}equal(t,e){return this.x===t&&this.y===e}equals(t){return this.x===t.x&&this.y===t.y}toString(){return`{x: ${this.x}, y: ${this.y}}`}static from(t){return new r(t.x,t.y)}}i.Point=r,r.NORTH=new r(-1,0),r.SOUTH=new r(1,0),r.EAST=new r(0,1),r.WEST=new r(0,-1),r.NORTH_EAST=new r(-1,1),r.SOUTH_EAST=new r(1,1),r.SOUTH_WEST=new r(1,-1),r.NORTH_WEST=new r(-1,-1),r.ZERO=new r(0,0),function(t){t[t.NORTH=0]="NORTH",t[t.EAST=1]="EAST",t[t.SOUTH=2]="SOUTH",t[t.WEST=3]="WEST",t[t.NORTH_EAST=4]="NORTH_EAST",t[t.SOUTH_EAST=5]="SOUTH_EAST",t[t.SOUTH_WEST=6]="SOUTH_WEST",t[t.NORTH_WEST=7]="NORTH_WEST"}(i.Direction||(i.Direction={})),function(t){t[t.OPEN=0]="OPEN",t[t.CLOSED=1]="CLOSED",t[t.GUARANTEED_OPEN=2]="GUARANTEED_OPEN",t[t.GUARANTEED_CLOSED=3]="GUARANTEED_CLOSED",t[t.NON_JOIN_OPEN=4]="NON_JOIN_OPEN",t[t.NON_JOIN_CLOSED=5]="NON_JOIN_CLOSED",t[t.NON_JOIN_GUARANTEED_OPEN=6]="NON_JOIN_GUARANTEED_OPEN",t[t.NON_JOIN_GUARANTEED_CLOSED=7]="NON_JOIN_GUARANTEED_CLOSED",t[t.INSIDE_ROOM_OPEN=8]="INSIDE_ROOM_OPEN",t[t.INSIDE_TUNNEL_OPEN=9]="INSIDE_TUNNEL_OPEN",t[t.INSIDE_ANTEROOM_OPEN=10]="INSIDE_ANTEROOM_OPEN",t[t.H_DOOR=11]="H_DOOR",t[t.V_DOOR=12]="V_DOOR",t[t.COLUMN=13]="COLUMN"}(i.TunnelerCellType||(i.TunnelerCellType={})),function(t){t[t.SMALL=0]="SMALL",t[t.MEDIUM=1]="MEDIUM",t[t.LARGE=2]="LARGE"}(i.RoomSize||(i.RoomSize={}));i.Room=class{constructor(t=[]){this.inside=t,this.inDungeon=!1}randomSquare(){return this.inside[Math.floor(Math.random()*this.inside.length)]}static compare(t,e){return t.inside.length-e.inside.length}};i.FillRect=class{constructor(t,e,i,r,n){this.startX=t,this.startY=e,this.endX=i,this.endY=r,this.type=n}}},{}],93:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const r=t("./model"),n=t("./crawler");class s extends n.Crawler{constructor(t,e,i,r,n,s,o,a,h){super(t,e,i,r,n,s,o),this.defaultWidth=a,this.size=h}stepAhead(){if(!this.dungeonCrawler.isMoreRoomsDungeon(this.size))return!1;if(this.generation!==this.dungeonCrawler.activeGeneration)return console.assert(this.generation>this.dungeonCrawler.activeGeneration),!0;if(this.age++,this.age>=this.maxAge)return!1;if(this.age<0)return!0;const t=this.rightDirection();let e=this.defaultWidth;const i=this.getMinRoomSize(this.size),n=this.getMaxRoomSize(this.size);let s,o,a;do{[a,s,o]=this.frontFree(this.location,this.direction,e+1,e+1);let h=a-2,l=s+o-1;if(h<2)break;if(l/h<this.config.roomAspectRatio&&(h=Math.floor(l/this.config.roomAspectRatio),l/h<this.config.roomAspectRatio&&console.error("length = "+h+", width = "+l+", but width/length should be >= "+this.config.roomAspectRatio)),h/l<this.config.roomAspectRatio&&(l=Math.floor(h/this.config.roomAspectRatio),h/l<this.config.roomAspectRatio&&console.error("length = "+h+", width = "+l+", but length/width should be >= "+this.config.roomAspectRatio)),l/h<this.config.roomAspectRatio)return console.error("The Emperor suggests you make your roomAspectRatio in the design file smaller..."),!1;for(;h*l>n;)h>l?h--:l>h?l--:this.rng.int%100<50?h--:l--;if(console.assert(h*l<=n),h*l>=i){const e=new r.Room;return s<=o?(2*s-1>l?this.attachRoom(e,t,h,(l>>1)-l+1,l>>2):this.attachRoom(e,t,h,1-s,-s+l),0===this.direction.x?this.dungeonCrawler.setMap(this.location.plus(this.direction),r.TunnelerCellType.V_DOOR):(console.assert(0===this.direction.y),this.dungeonCrawler.setMap(this.location.plus(this.direction),r.TunnelerCellType.H_DOOR))):(2*o-1>l?this.attachRoom(e,t,h,-(l>>1),-(l>>1)+l-1):this.attachRoom(e,t,h,o-l,o-1),0===this.direction.x?this.dungeonCrawler.setMap(this.location.plus(this.direction),r.TunnelerCellType.V_DOOR):(console.assert(0===this.direction.y),this.dungeonCrawler.setMap(this.location.plus(this.direction),r.TunnelerCellType.H_DOOR))),this.dungeonCrawler.builtRoomDungeon(this.size),e.inDungeon=!0,this.dungeonCrawler.addRoom(e),!1}e++}while(a-2>=(2*e+1)*this.config.roomAspectRatio);return!1}attachRoom(t,e,i,n,s){for(let o=1;o<=i;o++)for(let i=n;i<=s;i++){const n=this.location.plus(this.direction.multiply(o+1)).plus(e.multiply(i));this.dungeonCrawler.setMap(n,r.TunnelerCellType.INSIDE_ROOM_OPEN),t.inside.push(n)}}getMinRoomSize(t){switch(t){case r.RoomSize.SMALL:return this.config.minRoomSize;case r.RoomSize.MEDIUM:return this.config.mediumRoomSize;case r.RoomSize.LARGE:return this.config.largeRoomSize}}getMaxRoomSize(t){switch(t){case r.RoomSize.SMALL:return this.config.mediumRoomSize-1;case r.RoomSize.MEDIUM:return this.config.largeRoomSize-1;case r.RoomSize.LARGE:return this.config.maxRoomSize-1}}}i.RoomCrawler=s},{"./crawler":90,"./model":92}],94:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const r=t("./model"),n=t("./crawler");class s extends n.Crawler{constructor(t,e,i,r,n,s,o,a,h,l,u,c,d,p,f,g){super(t,e,i,r,n,s,o),this.intendedDirection=a,this.stepLength=h,this.tunnelWidth=l,this.straightDoubleSpawnProbability=u,this.turnDoubleSpawnProbability=c,this.changeDirectionProbability=d,this.makeRoomsRightProbability=p,this.makeRoomsLeftProbability=f,this.joinPreference=g}stepAhead(){const t=this.dungeonCrawler;if(this.generation!==t.activeGeneration)return console.assert(this.generation>t.activeGeneration),!0;if(this.age++,this.age>=this.maxAge)return!1;if(this.age<0)return!0;console.assert(this.tunnelWidth>=0);let[e,i,n]=this.frontFree(this.location,this.direction,this.tunnelWidth+1,this.tunnelWidth+1);if(0===e)return!1;let[s,o]=this.sidewaysBranchingRoomSizes(),a=this.rightDirection(),h=a.negative;const l=this.roomGeneration();if(e<2*this.stepLength||this.maxAge-1===this.age)return this.joinOrBuildTerminatingRoom(o,e,i,n,a,h);if(console.assert(e>=2*this.stepLength),console.assert(this.stepLength>0),this.buildTunnel(this.stepLength,this.tunnelWidth),this.rng.int%100<this.makeRoomsRightProbability){let t=this.location.plus(this.direction.multiply(this.stepLength>>2)).plus(a.multiply(this.tunnelWidth));this.spawnRoomCrawler(t,a,-1,2,l,s,!1)}if(this.rng.int%100<this.makeRoomsLeftProbability){let t=this.location.plus(this.direction.multiply(this.stepLength>>2)).plus(h.multiply(this.tunnelWidth));this.spawnRoomCrawler(t,h,-1,2,l,s,!1)}this.location=this.location.plus(this.direction.multiply(this.stepLength));const u=this.isAnteroomPossible(a,this.tunnelWidth+2,this.tunnelWidth+2,2*this.tunnelWidth+5),c=this.isAnteroomPossible(a,this.tunnelWidth+3,this.tunnelWidth+3,2*this.tunnelWidth+7);let d=!1,p=!1,f=this.rng.int%100;const g=this.getSizeUpProbability(this.generation);let m=g+this.getSizeDownProbability(this.generation);if(f<g?d=!0:f<m&&(p=!0),d&&!c)return!0;const y=this.isChangeDirection(),_=this.isSpawn(y);if(!y&&!_)return!0;const v=this.isSpawnRoom(_),x=this.rng.int%100;let b=this.generation+1;if(_)if(d)b=this.generation+this.config.sizeUpGenDelay;else{let t=0;for(let e=0;e<=10;e++)if(t+=this.getChildDelayProbabilityForGenerationTunnelCrawlers(e),x<t){b=this.generation+e;break}}const w=this.mutateOptions();let T=this.determineSpawnPoints(d,_,u,a,h);if(!0===T)return!0;const[E,S,P,O]=T;let C=!1,I=!1,M=this.direction,A=!1;if(y){let[t]=this.frontFree(S,a,this.tunnelWidth+1,this.tunnelWidth+1),[e]=this.frontFree(P,h,this.tunnelWidth+1,this.tunnelWidth+1);if(this.intendedDirection.equal(0,0)||this.intendedDirection.equals(this.direction)?d&&_?(console.assert(_),t<e||t===e&&this.rng.boolean?t>0&&(this.location=S,this.direction=a,C=!0):e>0&&(this.location=P,this.direction=h,I=!0)):t>e||t===e&&this.rng.boolean?t>0&&(this.location=S,this.direction=a,C=!0):e>0&&(this.location=P,this.direction=h,I=!0):0===this.intendedDirection.x||0===this.intendedDirection.y?(this.direction=this.intendedDirection,this.direction.equals(a)?t>0&&(C=!0,this.location=S):e>0&&(console.assert(this.direction.equals(h)),this.location=P,I=!0)):(console.assert(!this.intendedDirection.equal(0,0)),this.direction=this.intendedDirection.minus(this.direction),this.direction.equals(a)?t>0&&(C=!0,this.location=S):e>0&&(console.assert(this.direction.equals(h)),this.location=P,I=!0)),_){let t=r.Point.ZERO,e=r.Point.ZERO;if(I?(t=S,e=a):C?(t=P,e=h):A=!0,!A){let i=this.rng.int%100;v&&i<50?this.spawnRoomCrawler(t,e,0,2,l,o,O):this.spawnTunnelCrawler(d,p,t,e,b,e,w),v&&i>=50?this.spawnRoomCrawler(E,M,0,2,l,o,O):this.spawnTunnelCrawler(d,p,E,M,b,M,w)}}}else A=!0;if(A){this.location=E;const t=this.rng.int%100;v&&t<50?this.spawnRoomCrawler(S,a,0,2,l,o,O):this.spawnTunnelCrawler(d,p,S,a,b,a,w),v&&t>=50?this.spawnRoomCrawler(S,h,0,2,l,o,O):this.spawnTunnelCrawler(d,p,P,h,b,h,w)}return!0}isAnteroomPossible(t,e,i,n){const s=this.dungeonCrawler;let o=!1;console.assert(this.tunnelWidth>=0),console.assert(s.getMap(this.location)===r.TunnelerCellType.INSIDE_TUNNEL_OPEN),s.setMap(this.location,r.TunnelerCellType.CLOSED);for(let e=1;e<=this.tunnelWidth;e++)console.assert(s.getMap(this.location.plus(t.multiply(e)))===r.TunnelerCellType.INSIDE_TUNNEL_OPEN),console.assert(s.getMap(this.location.minus(t.multiply(e)))===r.TunnelerCellType.INSIDE_TUNNEL_OPEN),s.setMap(this.location.plus(t.multiply(e)),r.TunnelerCellType.CLOSED),s.setMap(this.location.minus(t.multiply(e)),r.TunnelerCellType.CLOSED);let[a]=this.frontFree(this.location.minus(this.direction),this.direction,e,i);a>=n&&(o=!0),s.setMap(this.location,r.TunnelerCellType.INSIDE_TUNNEL_OPEN);for(let e=1;e<=this.tunnelWidth;e++)s.setMap(this.location.plus(t.multiply(e)),r.TunnelerCellType.INSIDE_TUNNEL_OPEN),s.setMap(this.location.minus(t.multiply(e)),r.TunnelerCellType.INSIDE_TUNNEL_OPEN);return o}determineSpawnPoints(t,e,i,n,s){const o=this.dungeonCrawler;if(t){if(this.rng.int%100<this.getAnteroomProbability(this.tunnelWidth)||e){const t=this.buildAnteroom(2*this.tunnelWidth+5,this.tunnelWidth+2);return console.assert(t),[this.location.plus(this.direction.multiply(2*this.tunnelWidth+5)),this.location.plus(this.direction.multiply(this.tunnelWidth+3)).plus(n.multiply(this.tunnelWidth+2)),this.location.plus(this.direction.multiply(this.tunnelWidth+3)).plus(s.multiply(this.tunnelWidth+2)),!0]}}else if(this.rng.int%100<this.getAnteroomProbability(this.tunnelWidth)&&i){const t=this.buildAnteroom(2*this.tunnelWidth+3,this.tunnelWidth+1);return console.assert(t),[this.location.plus(this.direction.multiply(2*this.tunnelWidth+3)),this.location.plus(this.direction.multiply(this.tunnelWidth+2)).plus(n.multiply(this.tunnelWidth+1)),this.location.plus(this.direction.multiply(this.tunnelWidth+2)).plus(s.multiply(this.tunnelWidth+1)),!0]}const a=this.location,h=this.location.minus(this.direction.multiply(this.tunnelWidth)).plus(n.multiply(this.tunnelWidth)),l=this.location.minus(this.direction.multiply(this.tunnelWidth)).plus(s.multiply(this.tunnelWidth));return this.dungeonCrawler.getMap(h)!==r.TunnelerCellType.INSIDE_TUNNEL_OPEN||o.getMap(l)!==r.TunnelerCellType.INSIDE_TUNNEL_OPEN||[a,h,l,!1]}joinOrBuildTerminatingRoom(t,e,i,n,s,o){const a=this.dungeonCrawler;let h=!1,l=!1,u=!1,c=0;for(let t=-this.tunnelWidth;t<=this.tunnelWidth;t++){const i=this.location.plus(this.direction.multiply(e+1)).plus(s.multiply(t)),n=a.getMap(i);this.contains(n,r.TunnelerCellType.OPEN,r.TunnelerCellType.GUARANTEED_OPEN,r.TunnelerCellType.INSIDE_TUNNEL_OPEN,r.TunnelerCellType.INSIDE_ANTEROOM_OPEN)?(l=!0,c++):this.contains(n,r.TunnelerCellType.GUARANTEED_CLOSED,r.TunnelerCellType.NON_JOIN_GUARANTEED_CLOSED)?(h=!0,c=0):n===r.TunnelerCellType.INSIDE_ROOM_OPEN?(u=!0,c=0):c=0}if(this.rng.int%100<=this.joinPreference&&(this.age<this.maxAge-1||e<=this.config.tunnelJoinDist)||e<5){const t=this.joinOtherTunnel(c,e,i,n,l,u,h,s);if(null!=t)return t}a.isMoreRoomsDungeon(t)&&this.spawnRoomCrawler(this.location,this.direction,0,2,this.generation,t,!1);let d=this.rng.int%11*10;if(100!==this.joinPreference||this.makeRoomsLeftProbability!==this.config.lastChanceTunnelCrawler.makeRoomsLeftProbability||this.makeRoomsRightProbability!==this.config.lastChanceTunnelCrawler.makeRoomsRightProbability||this.changeDirectionProbability!==this.config.lastChanceTunnelCrawler.changeDirectionProbability||this.straightDoubleSpawnProbability!==this.config.lastChanceTunnelCrawler.straightDoubleSpawnProbability||this.turnDoubleSpawnProbability!==this.config.lastChanceTunnelCrawler.turnDoubleSpawnProbability||0!==this.tunnelWidth){let[t]=this.frontFree(this.location.plus(s.multiply(this.tunnelWidth)),s,this.tunnelWidth+1,this.tunnelWidth+1),[i]=this.frontFree(this.location.minus(s.multiply(this.tunnelWidth)),o,this.tunnelWidth+1,this.tunnelWidth+1),[r]=this.frontFree(this.location,this.direction.negative,this.tunnelWidth+1,this.tunnelWidth+1);const n=(t,e,i,r)=>{this.dungeonCrawler.createTunnelCrawler(t,e,0,this.maxAge,i,r,3,0,this.config.lastChanceTunnelCrawler.straightDoubleSpawnProbability,this.config.lastChanceTunnelCrawler.turnDoubleSpawnProbability,this.config.lastChanceTunnelCrawler.changeDirectionProbability,this.config.lastChanceTunnelCrawler.makeRoomsRightProbability,this.config.lastChanceTunnelCrawler.makeRoomsLeftProbability,d)};0===this.tunnelWidth?this.makeRoomsLeftProbability===this.config.lastChanceTunnelCrawler.makeRoomsLeftProbability&&this.makeRoomsRightProbability===this.config.lastChanceTunnelCrawler.makeRoomsRightProbability&&this.changeDirectionProbability===this.config.lastChanceTunnelCrawler.changeDirectionProbability&&this.straightDoubleSpawnProbability===this.config.lastChanceTunnelCrawler.straightDoubleSpawnProbability&&this.turnDoubleSpawnProbability===this.config.lastChanceTunnelCrawler.turnDoubleSpawnProbability?e>=t&&e>=i&&e>=r?n(this.location,this.direction,this.generation+1,this.direction):r>=t&&r>=i?n(this.location,this.direction.negative,this.generation+this.config.genDelayLastChance,this.direction.negative):t>=i||t===i&&this.rng.int%100<50?n(this.location,s,this.generation+this.config.genDelayLastChance,s):n(this.location,o,this.generation+this.config.genDelayLastChance,o):n(this.location,this.direction,this.generation+this.config.genDelayLastChance,this.direction):h?(n(this.location.plus(s.multiply(this.tunnelWidth)),s,this.generation+this.config.genDelayLastChance,s),n(this.location.minus(s.multiply(this.tunnelWidth)),o,this.generation+this.config.genDelayLastChance,o)):t>=i||t===i&&this.rng.int%100<50?(n(this.location.plus(s.multiply(this.tunnelWidth)),s,this.generation+this.config.genDelayLastChance,s),n(this.location.minus(s.multiply(this.tunnelWidth)),this.direction,this.generation+this.config.genDelayLastChance,this.direction)):(n(this.location.plus(s.multiply(this.tunnelWidth)),this.direction,this.generation+this.config.genDelayLastChance,this.direction),n(this.location.minus(s.multiply(this.tunnelWidth)),this.direction,this.generation+this.config.genDelayLastChance,this.direction))}return!1}joinOtherTunnel(t,e,i,n,s,o,a,h){const l=this.dungeonCrawler;if(2*this.tunnelWidth+1===t)return this.buildTunnel(e,this.tunnelWidth),!1;if(s)return this.buildSmallerTunnel(e,l,h);if(o&&0===this.tunnelWidth&&e>1){const t=this.location.plus(this.direction.multiply(e+1)),i=l.getMap(t);return console.assert(i===r.TunnelerCellType.INSIDE_ROOM_OPEN),this.buildTunnel(e-1,0),0===this.direction.x?l.setMap(this.location.plus(this.direction.multiply(e)),r.TunnelerCellType.V_DOOR):(console.assert(0===this.direction.y),l.setMap(this.location.plus(this.direction.multiply(e)),r.TunnelerCellType.H_DOOR)),!1}if(a&&0===this.tunnelWidth){if(100!==this.joinPreference||20!==this.makeRoomsLeftProbability||20!==this.makeRoomsRightProbability||30!==this.changeDirectionProbability||0!==this.straightDoubleSpawnProbability||0!==this.turnDoubleSpawnProbability||0!==this.tunnelWidth){const t=this.rng.int%11*10,e=i>=n?h.negative:h;l.createTunnelCrawler(this.location,e,0,this.maxAge,this.generation+1,e,3,0,0,0,30,20,20,t)}return!1}if(!s&&!a){if(this.isSpecialCase(e,h)){const t=this.buildTunnel(e,this.tunnelWidth);console.assert(t);for(let t=-this.tunnelWidth;t<=this.tunnelWidth;t++)l.setMap(this.location.plus(this.direction.multiply(e+1)).plus(h.multiply(t)),r.TunnelerCellType.INSIDE_TUNNEL_OPEN);let i=e+2,n=!0,s=!0;for(;n&&s;){for(let t=-this.tunnelWidth;t<=this.tunnelWidth;t++){const e=this.location.plus(this.direction.multiply(i)).plus(h.multiply(t));if(l.getMap(e)!==r.TunnelerCellType.CLOSED){n=!1;break}}let t=this.location.plus(this.direction.multiply(i)).plus(h.multiply(this.tunnelWidth+1)),e=this.location.plus(this.direction.multiply(i)).minus(h.multiply(this.tunnelWidth+1)),o=l.getMap(t),a=l.getMap(e);if(!this.contains(o,r.TunnelerCellType.OPEN,r.TunnelerCellType.GUARANTEED_OPEN,r.TunnelerCellType.INSIDE_TUNNEL_OPEN,r.TunnelerCellType.INSIDE_ANTEROOM_OPEN)&&!this.contains(a,r.TunnelerCellType.OPEN,r.TunnelerCellType.GUARANTEED_OPEN,r.TunnelerCellType.INSIDE_TUNNEL_OPEN,r.TunnelerCellType.INSIDE_ANTEROOM_OPEN)){n=!1;break}if(o===r.TunnelerCellType.INSIDE_ROOM_OPEN||a===r.TunnelerCellType.INSIDE_ROOM_OPEN){n=!1;break}for(let t=-this.tunnelWidth;t<=this.tunnelWidth;t++){const e=this.location.plus(this.direction.multiply(i+1)).plus(h.multiply(t));l.getMap(e)!==r.TunnelerCellType.CLOSED&&(s=!1)}t=this.location.plus(this.direction.multiply(i+1)).plus(h.multiply(this.tunnelWidth+1)),e=this.location.plus(this.direction.multiply(i+1)).minus(h.multiply(this.tunnelWidth+1)),o=l.getMap(t),a=l.getMap(e),this.contains(o,r.TunnelerCellType.OPEN,r.TunnelerCellType.GUARANTEED_OPEN,r.TunnelerCellType.INSIDE_TUNNEL_OPEN,r.TunnelerCellType.INSIDE_ANTEROOM_OPEN,r.TunnelerCellType.CLOSED)||this.contains(a,r.TunnelerCellType.OPEN,r.TunnelerCellType.GUARANTEED_OPEN,r.TunnelerCellType.INSIDE_TUNNEL_OPEN,r.TunnelerCellType.INSIDE_ANTEROOM_OPEN,r.TunnelerCellType.CLOSED)||(s=!1),o!==r.TunnelerCellType.INSIDE_ROOM_OPEN&&a!==r.TunnelerCellType.INSIDE_ROOM_OPEN||(s=!1);let u=!0;for(let t=-this.tunnelWidth-1;t<=this.tunnelWidth+1;t++){const e=this.location.plus(this.direction.multiply(i+1)).plus(h.multiply(t)),n=l.getMap(e);n!==r.TunnelerCellType.INSIDE_TUNNEL_OPEN&&n!==r.TunnelerCellType.INSIDE_ANTEROOM_OPEN&&(u=!1)}if(u&&(s=!0),n&&s)for(let t=-this.tunnelWidth;t<=this.tunnelWidth;t++)l.setMap(this.location.plus(this.direction.multiply(i)).plus(h.multiply(t)),r.TunnelerCellType.INSIDE_TUNNEL_OPEN);i++}return!1}if(0===this.tunnelWidth&&l.getMap(this.location.plus(this.direction.multiply(e+1)))===r.TunnelerCellType.CLOSED){if(l.getMap(this.location.plus(this.direction.multiply(e+1)).plus(h))===r.TunnelerCellType.INSIDE_ROOM_OPEN)return this.direction=h.negative,this.direction.equals(this.intendedDirection.negative)&&(this.direction=this.intendedDirection),!0;if(l.getMap(this.location.plus(this.direction.multiply(e+1)).minus(h))===r.TunnelerCellType.INSIDE_ROOM_OPEN)return this.direction=h,this.direction.equals(this.intendedDirection.negative)&&(this.direction=this.intendedDirection),!0}}return null}isSpecialCase(t,e){const i=this.dungeonCrawler;let n=!0;for(let s=-this.tunnelWidth;s<=this.tunnelWidth;s++){const o=this.location.plus(this.direction.multiply(t+1)).plus(e.multiply(s));if(i.getMap(o)!==r.TunnelerCellType.CLOSED){n=!1;break}}let s=this.location.plus(this.direction.multiply(t+1)).plus(e.multiply(this.tunnelWidth+1)),o=this.location.plus(this.direction.multiply(t+1)).minus(e.multiply(this.tunnelWidth+1)),a=i.getMap(s),h=i.getMap(o);this.contains(a,r.TunnelerCellType.OPEN,r.TunnelerCellType.GUARANTEED_OPEN,r.TunnelerCellType.INSIDE_TUNNEL_OPEN,r.TunnelerCellType.INSIDE_ANTEROOM_OPEN)||this.contains(h,r.TunnelerCellType.OPEN,r.TunnelerCellType.GUARANTEED_OPEN,r.TunnelerCellType.INSIDE_TUNNEL_OPEN,r.TunnelerCellType.INSIDE_ANTEROOM_OPEN)||(n=!1),a!==r.TunnelerCellType.INSIDE_ROOM_OPEN&&h!==r.TunnelerCellType.INSIDE_ROOM_OPEN||(n=!1);for(let s=-this.tunnelWidth-1;s<=this.tunnelWidth+1;s++){const o=this.location.plus(this.direction.multiply(t+2)).plus(e.multiply(s));if(i.getMap(o)===r.TunnelerCellType.INSIDE_ROOM_OPEN){n=!1;break}}return n}spawnTunnelCrawler(t,e,i,r,n,s,o){let a=this.tunnelWidth,h=this.stepLength;t?(a++,h+=2):e&&(a--,a<0&&(a=0),h-=2,h<3&&(h=3)),this.dungeonCrawler.createTunnelCrawler(i,r,0,this.getMaxAgeTunnelCrawlers(n),n,s,h,a,o.straightDoubleSpawnProbability,o.turnDoubleSpawnProbability,o.changeDirectionProbability,o.makeRoomsRightProbability,o.makeRoomsLeftProbability,o.joinPreference)}spawnRoomCrawler(t,e,i,r,n,s,o){const a=Math.max(1,2*this.tunnelWidth);o&&(n=this.generation+Math.floor((n-this.generation)/this.config.genSpeedUpOnAnteroom)),this.dungeonCrawler.createRoomCrawler(t,e,i,r,n,a,s)}buildSmallerTunnel(t,e,i){const n=this.location.plus(this.direction.multiply(t+1)),s=e.getMap(n);if(this.contains(s,r.TunnelerCellType.OPEN,r.TunnelerCellType.GUARANTEED_OPEN,r.TunnelerCellType.INSIDE_TUNNEL_OPEN,r.TunnelerCellType.INSIDE_ANTEROOM_OPEN))return this.buildTunnel(t,0)||console.error("openAhead, failed to join, frontFree = "+t),!1;let o=0;for(let n=1;n<=this.tunnelWidth;n++){const s=this.location.plus(this.direction.multiply(t+1)).plus(i.multiply(n)),a=e.getMap(s);if(this.contains(a,r.TunnelerCellType.OPEN,r.TunnelerCellType.GUARANTEED_OPEN,r.TunnelerCellType.INSIDE_TUNNEL_OPEN,r.TunnelerCellType.INSIDE_ANTEROOM_OPEN)){o=n;break}const h=this.location.plus(this.direction.multiply(t+1)).minus(i.multiply(n)),l=e.getMap(h);if(this.contains(l,r.TunnelerCellType.OPEN,r.TunnelerCellType.GUARANTEED_OPEN,r.TunnelerCellType.INSIDE_TUNNEL_OPEN,r.TunnelerCellType.INSIDE_ANTEROOM_OPEN)){o=-n;break}}console.assert(0!==o);for(let n=1;n<=t;n++){const t=this.location.plus(this.direction.multiply(n)).plus(i.multiply(o));e.setMap(t,r.TunnelerCellType.INSIDE_TUNNEL_OPEN)}return!1}roomGeneration(){let t=this.rng.int%100,e=this.generation,i=0;for(let r=0;r<=10;r++)if(i+=this.getChildDelayProbabilityForGenerationRoomCrawlers(r),t<i){e=this.generation+r;break}return e}sidewaysBranchingRoomSizes(){let t,e;const i=this.getRoomSizeProbabilitySideways(this.tunnelWidth,r.RoomSize.MEDIUM),n=this.getRoomSizeProbabilitySideways(this.tunnelWidth,r.RoomSize.SMALL),s=this.getRoomSizeProbabilityBranching(this.tunnelWidth,r.RoomSize.MEDIUM),o=this.getRoomSizeProbabilityBranching(this.tunnelWidth,r.RoomSize.SMALL);let a=this.rng.int%100;return t=a<n?r.RoomSize.SMALL:a<n+i?r.RoomSize.MEDIUM:r.RoomSize.LARGE,e=a<o?r.RoomSize.SMALL:a<o+s?r.RoomSize.MEDIUM:r.RoomSize.LARGE,[t,e]}isChangeDirection(){return this.rng.int%100<this.changeDirectionProbability}isSpawn(t){return!!(t&&this.rng.int%100<this.turnDoubleSpawnProbability)||!t&&this.rng.int%100<this.straightDoubleSpawnProbability}isSpawnRoom(t){return t&&this.rng.int%100>this.config.patience}buildAnteroom(t,e){if(t<3||e<1)return console.error("Anteroom must be at least 3x3"),!1;let[i]=this.frontFree(this.location,this.direction,e+1,e+1);if(i<=t)return!1;const n=this.rightDirection();for(let i=1;i<=t;i++)for(let t=-e;t<=e;t++){const e=this.location.plus(this.direction.multiply(i)).plus(n.multiply(t));this.dungeonCrawler.setMap(e,r.TunnelerCellType.INSIDE_ANTEROOM_OPEN)}if(e>=3&&t>=7&&this.config.columnsInTunnels){let t=2;this.placeColumns(e,t,n)}return!0}buildTunnel(t,e){if(t<1||e<0)return console.error("Trying to build zero size tunnel with length = "+t+"; width =  "+e),!1;let[i]=this.frontFree(this.location,this.direction,e+1,e+1);if(i<t)return!1;const n=this.rightDirection();for(let i=1;i<=t;i++)for(let t=-e;t<=e;t++){const e=this.location.plus(this.direction.multiply(i)).plus(n.multiply(t));this.dungeonCrawler.setMap(e,r.TunnelerCellType.INSIDE_TUNNEL_OPEN)}if(e>=3&&t>=7&&this.config.columnsInTunnels){const i=Math.floor((t-1)/6);console.assert(i>0);for(let t=0;t<i;t++){let i=2+3*t;this.placeColumns(e,i,n)}}return!0}placeColumns(t,e,i){let n=1-t,s=this.location.plus(this.direction.multiply(e)).plus(i.multiply(n));this.dungeonCrawler.setMap(s,r.TunnelerCellType.COLUMN),n=t-1,s=this.location.plus(this.direction.multiply(e)).plus(i.multiply(n)),this.dungeonCrawler.setMap(s,r.TunnelerCellType.COLUMN),e-=1,n=1-t,s=this.location.plus(this.direction.multiply(e)).plus(i.multiply(n)),this.dungeonCrawler.setMap(s,r.TunnelerCellType.COLUMN),n=t-1,s=this.location.plus(this.direction.multiply(e)).plus(i.multiply(n)),this.dungeonCrawler.setMap(s,r.TunnelerCellType.COLUMN)}getChildDelayProbabilityForGenerationRoomCrawlers(t){return 0<=t&&t<=10?this.config.childDelayProbabilityForGenerationRoomCrawlers[t]:0}getChildDelayProbabilityForGenerationTunnelCrawlers(t){return 0<=t&&t<=10?this.config.childDelayProbabilityForGenerationTunnelCrawlers[t]:0}getAnteroomProbability(t){return t>=this.config.anteroomProbability.length?100:this.config.anteroomProbability[t]}getSizeUpProbability(t){return t>=this.config.sizeUpProbability.length?this.config.sizeUpProbability[this.config.sizeUpProbability.length-1]:this.config.sizeUpProbability[t]}getSizeDownProbability(t){return t>=this.config.sizeDownProbability.length?this.config.sizeDownProbability[this.config.sizeDownProbability.length-1]:this.config.sizeDownProbability[t]}getMaxAgeTunnelCrawlers(t){return t>=this.config.maxAgesTunnelCrawlers.length?this.config.maxAgesTunnelCrawlers[this.config.maxAgesTunnelCrawlers.length-1]:this.config.maxAgesTunnelCrawlers[t]}getRoomSizeProbabilitySideways(t,e){if(t>=this.config.roomSizeProbabilitySidewaysRooms.length)return r.RoomSize.LARGE===e?100:0;switch(e){case r.RoomSize.LARGE:return this.config.roomSizeProbabilitySidewaysRooms[t][2];case r.RoomSize.MEDIUM:return this.config.roomSizeProbabilitySidewaysRooms[t][1];case r.RoomSize.SMALL:return this.config.roomSizeProbabilitySidewaysRooms[t][0]}}getRoomSizeProbabilityBranching(t,e){if(t>=this.config.roomSizeProbabilityBranching.length)return r.RoomSize.LARGE===e?100:0;switch(e){case r.RoomSize.LARGE:return this.config.roomSizeProbabilityBranching[t][2];case r.RoomSize.MEDIUM:return this.config.roomSizeProbabilityBranching[t][1];case r.RoomSize.SMALL:return this.config.roomSizeProbabilityBranching[t][0]}}mutateOptions(){return{straightDoubleSpawnProbability:this.dungeonCrawler.mutate(this.straightDoubleSpawnProbability),turnDoubleSpawnProbability:this.dungeonCrawler.mutate(this.turnDoubleSpawnProbability),changeDirectionProbability:this.dungeonCrawler.mutate(this.changeDirectionProbability),makeRoomsRightProbability:this.dungeonCrawler.mutate(this.makeRoomsRightProbability),makeRoomsLeftProbability:this.dungeonCrawler.mutate(this.makeRoomsLeftProbability),joinPreference:this.dungeonCrawler.mutate(this.joinPreference)}}}i.TunnelCrawler=s},{"./crawler":90,"./model":92}],95:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const r=t("./model"),n=t("./crawler");class s extends n.Crawler{constructor(t,e,i,r,n,s,o,a,h,l,u,c,d,p,f,g){super(t,e,i,r,n,s,o),this.intendedDirection=a,this.stepLength=h,this.opening=l,this.corridorWidth=u,this.straightSingleSpawnProbability=c,this.straightDoubleSpawnProbability=d,this.turnSingleSpawnProbability=p,this.turnDoubleSpawnProbability=f,this.changeDirectionProbability=g,console.assert(u>=0)}freePredicate(t){if(this.config.crawlersInTunnels&&this.config.crawlersInAnterooms){if(!this.contains(t,r.TunnelerCellType.OPEN,r.TunnelerCellType.NON_JOIN_OPEN,r.TunnelerCellType.GUARANTEED_OPEN,r.TunnelerCellType.INSIDE_TUNNEL_OPEN,r.TunnelerCellType.INSIDE_ANTEROOM_OPEN,r.TunnelerCellType.NON_JOIN_GUARANTEED_OPEN))return!0}else if(this.config.crawlersInTunnels){if(!this.contains(t,r.TunnelerCellType.OPEN,r.TunnelerCellType.NON_JOIN_OPEN,r.TunnelerCellType.GUARANTEED_OPEN,r.TunnelerCellType.INSIDE_TUNNEL_OPEN,r.TunnelerCellType.NON_JOIN_GUARANTEED_OPEN))return!0}else if(!this.contains(t,r.TunnelerCellType.OPEN,r.TunnelerCellType.NON_JOIN_OPEN,r.TunnelerCellType.GUARANTEED_OPEN,r.TunnelerCellType.NON_JOIN_GUARANTEED_OPEN))return!0;return!1}stepAhead(){if(this.generation!==this.dungeonCrawler.activeGeneration)return console.assert(this.generation>this.dungeonCrawler.activeGeneration),!0;if(this.age++,this.age>=this.maxAge)return!1;if(this.age<0)return!0;let[t,e,i]=this.frontFree(this.location,this.direction,this.corridorWidth,this.corridorWidth);const n=this.rightDirection(),s=n.negative;let o=n;if(0===this.opening&&t<this.config.joinDistance&&this.join(t))return!1;let a=this.stepLength;if(t>this.corridorWidth){t-this.corridorWidth<this.stepLength&&(a=t-this.corridorWidth);for(let t=1;t<=a;t++)o=this.location.plus(this.direction.multiply(t)),1===this.opening?this.dungeonCrawler.setMap(o,r.TunnelerCellType.CLOSED):(console.assert(0===this.opening),this.dungeonCrawler.setMap(o,r.TunnelerCellType.NON_JOIN_CLOSED));this.location=o;let h=this.rng.int%100,l=this.generation+1,u=0;for(let t=0;t<=10;t++)if(u+=this.getChildDelayProbabilityForGenerationCrawlers(t),h<u){l=this.generation+t;break}const c={straightSingleSpawnProbability:this.dungeonCrawler.mutate(this.straightSingleSpawnProbability),straightDoubleSpawnProbability:this.dungeonCrawler.mutate(this.straightDoubleSpawnProbability),turnSingleSpawnProbability:this.dungeonCrawler.mutate(this.turnSingleSpawnProbability),turnDoubleSpawnProbability:this.dungeonCrawler.mutate(this.turnDoubleSpawnProbability),changeDirectionProbability:this.dungeonCrawler.mutate(this.changeDirectionProbability)};if(this.rng.int%100<this.changeDirectionProbability){let t=this.direction;if(0===this.intendedDirection.x&&0===this.intendedDirection.y||this.intendedDirection.x===this.direction.x&&this.intendedDirection.y===this.direction.y){let t=this.rng.int%4;0===t?this.direction=n:1===t?this.direction=s:i>e||i===e&&this.rng.boolean?this.direction=n:this.direction=s}else 0===this.intendedDirection.x||0===this.intendedDirection.y?this.direction=this.intendedDirection:(console.assert(!this.intendedDirection.equal(0,0)),this.direction=this.intendedDirection.minus(this.direction));this.rng.int%100<this.turnDoubleSpawnProbability?(this.spawnWallCrawler(this.direction.negative,this.direction.negative,l,c),this.spawnWallCrawler(t,t,l,c)):this.rng.int%100<this.turnSingleSpawnProbability&&this.spawnWallCrawler(this.direction.negative,this.direction.negative,l,c)}else this.rng.int%100<this.straightDoubleSpawnProbability?(this.spawnWallCrawler(n,n,l,c),this.spawnWallCrawler(s,s,l,c)):this.rng.int%100<this.straightSingleSpawnProbability&&(o=e>i||e===i&&this.rng.boolean?s:n,this.rng.int%3==0&&(o=o.negative),this.spawnWallCrawler(o,o,l,c))}else if(this.direction.equals(this.intendedDirection)||this.intendedDirection.equal(0,0)){let[t]=this.frontFree(this.location,n,this.corridorWidth,this.corridorWidth),[e]=this.frontFree(this.location,s,this.corridorWidth,this.corridorWidth);if(t<=this.corridorWidth&&e<=this.corridorWidth)return!1;t>2*this.corridorWidth+1&&e>2*this.corridorWidth+1?this.rng.boolean?this.direction=n:this.direction=s:t>e?this.direction=n:e>t?this.direction=s:this.rng.boolean?this.direction=n:this.direction=s}else if(0===this.intendedDirection.x||0===this.intendedDirection.y){let[t]=this.frontFree(this.location,this.intendedDirection,this.corridorWidth,this.corridorWidth);if(!(t>this.corridorWidth))return!1;this.direction=this.intendedDirection}else{console.assert(!this.intendedDirection.equal(0,0)),o=this.intendedDirection.minus(this.direction);let[t]=this.frontFree(this.location,o,this.corridorWidth,this.corridorWidth);if(!(t>this.corridorWidth))return!1;this.direction=o}return!0}spawnWallCrawler(t,e,i,n){this.rng.int%100<this.config.noHeadingProbability&&(e=r.Point.ZERO),this.dungeonCrawler.createWallCrawler(this.location,t,0,this.dungeonCrawler.getMaxAgeCrawlers(i),i,e,this.dungeonCrawler.getStepLength(i),1,this.dungeonCrawler.getCorridorWidth(i),n.straightSingleSpawnProbability,n.straightDoubleSpawnProbability,n.turnSingleSpawnProbability,n.turnDoubleSpawnProbability,n.changeDirectionProbability)}join(t){let e=this.rightDirection(),i=this.location.plus(this.direction.multiply(t+1));if(!this.valid(i))return!1;let n=this.dungeonCrawler.getMap(i);if(this.contains(n,r.TunnelerCellType.CLOSED,r.TunnelerCellType.GUARANTEED_CLOSED)){for(let e=1;e<=t;e++){const t=this.location.plus(this.direction.multiply(e));if(!this.valid(t))return!1;this.dungeonCrawler.setMap(t,r.TunnelerCellType.NON_JOIN_CLOSED)}return!0}if(this.contains(n,r.TunnelerCellType.NON_JOIN_CLOSED,r.TunnelerCellType.NON_JOIN_GUARANTEED_CLOSED))return!1;let s=new r.Point,o=0;for(let i=1;i<=this.corridorWidth;i++){let a=this.location.plus(e.multiply(i)).plus(this.direction.multiply(t+1));if(!this.valid(a))return!1;if(n=this.dungeonCrawler.getMap(a),this.contains(n,r.TunnelerCellType.CLOSED,r.TunnelerCellType.GUARANTEED_CLOSED,r.TunnelerCellType.NON_JOIN_CLOSED,r.TunnelerCellType.NON_JOIN_GUARANTEED_CLOSED)){s=a,o=i;break}if(a=this.location.minus(e.multiply(i).plus(this.direction.multiply(t+1))),!this.valid(a))return!1;if(n=this.dungeonCrawler.getMap(a),this.contains(n,r.TunnelerCellType.CLOSED,r.TunnelerCellType.GUARANTEED_CLOSED,r.TunnelerCellType.NON_JOIN_CLOSED,r.TunnelerCellType.NON_JOIN_GUARANTEED_CLOSED)){s=a,o=-i;break}}if(0!==s.x||0!==s.y)return!1;if(0!==o)return!1;if(this.contains(n,r.TunnelerCellType.NON_JOIN_CLOSED,r.TunnelerCellType.NON_JOIN_GUARANTEED_CLOSED))return!1;i=o<0?e:e.negative;let a,h,[l]=this.frontFree(s,i,1,1);if(o>0?(a=o,h=1):(a=-o,h=-1),l<a+1)return!1;for(let e=1;e<=t+1;e++){const t=this.location.plus(this.direction.multiply(e));if(!this.valid(t))return!1;this.dungeonCrawler.setMap(t,r.TunnelerCellType.NON_JOIN_CLOSED)}for(let i=1;i<a;i++){const n=this.location.plus(e.multiply(i*h)).plus(this.direction.multiply(t+1));if(!this.valid(n))return!1;this.dungeonCrawler.setMap(n,r.TunnelerCellType.NON_JOIN_CLOSED)}return!0}getChildDelayProbabilityForGenerationCrawlers(t){return 0<=t&&t<=10?this.config.childDelayProbabilityForGenerationCrawlers[t]:0}}i.WallCrawler=s},{"./crawler":90,"./model":92}],96:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const r=t("./geometry");var n;i.TunnelingAlgorithm=class{constructor(t,e,i,r){this.possible=[],this.rooms=[],this.corridorsV=[],this.corridorsH=[],this.rng=t,this.width=e,this.height=i,this.room_min_w=r.room_min_w||5,this.room_min_h=r.room_min_h||5,this.room_max_w=r.room_max_w||20,this.room_max_h=r.room_max_h||20,this.room_min_x=r.room_min_x||2,this.room_min_y=r.room_min_y||2,this.max_corr_dist=r.max_corr_dist||20,this.max_corr_width=r.max_corr_width||5,this.skew=r.skew||3,this.x_dist=r.x_dist||2,this.y_dist=r.y_dist||2,this.min_corr_dist_x=r.min_corr_dist_x||1+(this.x_dist<<1),this.min_corr_dist_y=r.min_corr_dist_y||1+(this.y_dist<<1),this.max_rooms=r.max_rooms||0,this.debug=r.debug||!1}isOverlap(t){const e=t.isOverlap.bind(t);return this.rooms.some(e)||this.corridorsV.some(e)||this.corridorsH.some(e)}valid(t){return t.x>=0&&t.y>=0&&t.w>0&&t.h>0&&t.x+t.w<this.width&&t.y+t.h<this.height&&!this.isOverlap(t)}generate(){if(this.rooms.splice(0,this.rooms.length),this.corridorsH.splice(0,this.corridorsH.length),this.corridorsV.splice(0,this.corridorsV.length),this.generateFirstRoom()){if(this.max_rooms>0){for(;this.rooms.length<this.max_rooms;)if(!this.generateNextRoom())return!1;return!0}for(;this.generateNextRoom(););return!0}return!1}generateFirstRoom(){const t=this.rng.nextRange(this.room_min_w,this.room_max_w),e=this.rng.nextRange(this.room_min_h,this.room_max_h),i=Math.max(this.room_min_x,(this.width>>1)-t),n=Math.max(this.room_min_y,(this.height>>1)-e),s=Math.min(this.width-this.room_min_x-t,(this.width>>1)+t),o=Math.min(this.height-this.room_min_y-e,(this.height>>1)+e),a=new r.ImmutableRect(this.nextRange(i,s),this.nextRange(n,o),t,e);return!this.isOverlap(a.expand())&&(this.rooms.push(a),!0)}generateNextRoom(){for(this.debug&&console.log("generate next room"),this.possible.splice(0,this.possible.length),this.rooms.forEach(t=>{const e=this.findTopCorridorArea(t),i=this.findBottomCorridorArea(t),r=this.findRightCorridorArea(t),o=this.findLeftCorridorArea(t);if(e){this.debug&&console.log("possible top corridor area",t,e);const i=this.findTopRoomArea(e);i&&(this.debug&&console.log("add possible top room area",t,e,i),this.possible.push(new s(i,e,n.TOP)))}if(i){this.debug&&console.log("possible bottom corridor area",t,i);const e=this.findBottomRoomArea(i);e&&(this.debug&&console.log("add possible bottom room area",t,i,e),this.possible.push(new s(e,i,n.BOTTOM)))}if(r){this.debug&&console.log("possible right corridor area",t,r);const e=this.findRightRoomArea(r);e&&(this.debug&&console.log("add possible right room area",t,r,e),this.possible.push(new s(e,r,n.RIGHT)))}if(o){this.debug&&console.log("possible left corridor area",t,o);const e=this.findLeftRoomArea(o);e&&(this.debug&&console.log("add possible left room area",t,o,e),this.possible.push(new s(e,o,n.LEFT)))}}),this.debug&&console.log("possible",[...this.possible]),this.debug&&console.log("rooms",[...this.rooms]),this.debug&&console.log("corridorsV",[...this.corridorsV]),this.debug&&console.log("corridorsH",[...this.corridorsH]);this.possible.length>0;){const t=this.rng.nextRange(0,this.possible.length),e=this.possible[t];switch(this.possible.splice(t,1),e.direction){case n.TOP:if(this.generateTopRoom(e))return!0;break;case n.BOTTOM:if(this.generateBottomRoom(e))return!0;break;case n.RIGHT:if(this.generateRightRoom(e))return!0;break;case n.LEFT:if(this.generateLeftRoom(e))return!0}}return!1}findTopCorridorArea(t){const e=r.MutableRect.from(t);e.h=this.min_corr_dist_y,e.y-=this.min_corr_dist_y,e.x+=this.x_dist,e.w-=this.x_dist<<1;let i=-1,n=-1;for(;e.h<=this.max_corr_dist&&this.valid(e);e.h++,e.y--)i=e.h,n=e.y;return i>=0&&n>=0?(e.h=i,e.y=n,e.immutable()):null}findBottomCorridorArea(t){const e=r.MutableRect.from(t);e.y+=t.h,e.h=this.min_corr_dist_y,e.x+=this.x_dist,e.w-=this.x_dist<<1;let i=-1;for(;e.h<this.max_corr_dist&&this.valid(e);e.h++)i=e.h;return i>=0?(e.h=i,e.immutable()):null}findRightCorridorArea(t){const e=r.MutableRect.from(t);e.x+=e.w,e.y+=this.y_dist,e.h-=this.y_dist<<1;let i=-1;for(;e.w<this.max_corr_dist&&this.valid(e);e.w++)i=e.w;return i>=0?(e.w=i,e.immutable()):null}findLeftCorridorArea(t){const e=r.MutableRect.from(t);e.w=this.min_corr_dist_x,e.x-=this.min_corr_dist_x,e.y+=this.y_dist,e.h-=this.y_dist<<1;let i=-1,n=-1;for(;e.w<=this.max_corr_dist&&this.valid(e);e.w++,e.x--)i=e.w,n=e.x;return i>=0&&n>=0?(e.w=i,e.x=n,e.immutable()):null}findTopRoomArea(t){const e=r.MutableRect.from(t);if(e.h-=this.min_corr_dist_y,e.x-=this.x_dist,e.w+=this.x_dist<<1,e.h<this.room_min_h){const t=this.room_min_h-e.h;e.h+=t,e.y-=t}let i=e.y,n=e.h;for(;e.h<=this.room_max_h;e.h++,e.y--){if(!this.valid(e)){e.h=n,e.y=i;break}n=e.h,i=e.y}if(i>=0&&n>=0){let i=e.x,r=e.w;for(const n=t.x+this.x_dist+1-this.room_max_w;e.x>n&&this.valid(e);e.x--,e.w++)i=e.x,r=e.w;e.x=i,e.w=r;for(const i=t.x+t.w-this.x_dist-1+this.room_max_w;e.x+e.w<i&&this.valid(e);e.w++)r=e.w;return e.w=r,e.immutable()}return null}findBottomRoomArea(t){const e=r.MutableRect.from(t);e.y+=this.min_corr_dist_y,e.h-=this.min_corr_dist_y,e.x-=this.x_dist,e.w+=this.x_dist<<1,e.h<this.room_min_h&&(e.h=this.room_min_h);let i=e.h;for(;e.h<=this.room_max_h;e.h++){if(!this.valid(e)){e.h=i;break}i=e.h}if(i>=0){let i=e.x,r=e.w;for(const n=t.x+this.x_dist+1-this.room_max_w;e.x>n&&this.valid(e);e.x--,e.w++)i=e.x,r=e.w;e.x=i,e.w=r;for(const i=t.x+t.w-this.x_dist-1+this.room_max_w;e.x+e.w<i&&this.valid(e);e.w++)r=e.w;return e.w=r,e.immutable()}return null}findRightRoomArea(t){const e=r.MutableRect.from(t);e.x+=this.min_corr_dist_x,e.w-=this.min_corr_dist_x,e.y-=this.y_dist,e.h+=this.y_dist<<1,e.w<this.room_min_w&&(e.w=this.room_min_w);let i=e.w;for(;e.w<=this.room_max_w;e.w++){if(!this.valid(e)){e.w=i;break}i=e.w}if(i>=0){let i=e.y,r=e.h;for(const n=t.y+this.y_dist+1-this.room_max_h;e.y>n;e.y--,e.h++){if(!this.valid(e)){e.y=i,e.h=r;break}i=e.y,r=e.h}for(const i=t.y+t.h-this.y_dist-1+this.room_max_h;e.y+e.h<i;e.h++){if(!this.valid(e)){e.h=r;break}r=e.h}return e.immutable()}return null}findLeftRoomArea(t){const e=r.MutableRect.from(t);if(e.w-=this.min_corr_dist_x,e.y-=this.y_dist,e.h+=this.y_dist<<1,e.w<this.room_min_w){const t=this.room_min_w-e.w;e.w+=t,e.x-=t}let i=e.x,n=e.w;for(;e.w<=this.room_max_w;e.w++,e.x--){if(!this.valid(e)){e.x=i,e.w=n;break}n=e.w,i=e.x}if(i>=0&&n>=0){let i=e.y,r=e.h;for(const n=t.y+this.y_dist+1-this.room_max_h;e.y>n&&this.valid(e);e.y--,e.h++)i=e.y,r=e.h;e.y=i,e.h=r;for(const i=t.y-this.y_dist-1+this.room_max_h;e.y+e.h<i&&this.valid(e);e.h++)r=e.h;return e.h=r,e.immutable()}return this.debug&&console.warn("left room area not valid",t,e),null}generateTopRoom(t){const e=this.nextRange(1,Math.min(this.max_corr_width,t.corridor.w)),i=this.nextRange(this.min_corr_dist_y,t.corridor.h),n=t.corridor.y+(t.corridor.h-i),s=this.nextRange(t.corridor.x,t.corridor.x+t.corridor.w-e),o=new r.ImmutableRect(s,n,e,i);if(this.valid(o.expandV())){const e=Math.max(3,t.room.y,o.y-this.room_max_h),i=this.nextRange(e,o.y-this.room_min_h),n=o.y-i,s=o.x-this.x_dist,a=Math.max(2,t.room.x,o.x+o.w+this.x_dist-this.room_max_w),h=this.nextRange(a,s),l=o.x+o.w+this.x_dist,u=Math.min(t.room.x+t.room.w,h+this.room_max_w),c=this.nextRange(l,u)-h,d=new r.ImmutableRect(h,i,c,n);if(this.valid(d.expand()))return this.debug&&console.log("add top room",o,d),this.corridorsV.push(o),this.rooms.push(d),this.connectWithOthers(d),!0;this.debug&&console.warn("top room not valid")}else this.debug&&console.warn("top corridor not valid");return!1}generateBottomRoom(t){const e=t.corridor.y,i=this.nextRange(1,Math.min(this.max_corr_width,t.corridor.w)),n=this.nextRange(this.min_corr_dist_y,t.corridor.h),s=this.nextRange(t.corridor.x,t.corridor.x+t.corridor.w-i),o=new r.ImmutableRect(s,e,i,n);if(this.valid(o.expandV())){const e=o.y+o.h,i=e+this.room_min_h,n=Math.min(t.room.y+t.room.h,i+this.room_max_h),s=this.nextRange(i,n)-e,a=o.x-this.x_dist,h=Math.max(2,t.room.x,o.x+o.w+this.x_dist-this.room_max_w),l=this.nextRange(h,a),u=o.x+o.w+this.x_dist,c=Math.min(t.room.x+t.room.w,l+this.room_max_w),d=this.nextRange(u,c)-l,p=new r.ImmutableRect(l,e,d,s);if(this.valid(p.expand()))return this.debug&&console.log("add bottom room",o,p),this.corridorsV.push(o),this.rooms.push(p),this.connectWithOthers(p),!0;this.debug&&console.warn("bottom room not valid",o,p)}else this.debug&&console.warn("bottom corridor not valid",o);return!1}generateRightRoom(t){const e=t.corridor.x,i=this.nextRange(1,Math.min(this.max_corr_width,t.corridor.h)),n=this.nextRange(this.min_corr_dist_x,t.corridor.w),s=this.nextRange(t.corridor.y,t.corridor.y+t.corridor.h-i),o=new r.ImmutableRect(e,s,n,i);if(this.valid(o.expandH())){const e=o.x+o.w,i=e+this.room_min_w,n=Math.min(t.room.x+t.room.w,i+this.room_max_w),s=this.nextRange(i,n)-e,a=o.y-this.y_dist,h=Math.max(2,t.room.y,o.y+o.h+this.y_dist-this.room_max_h),l=this.nextRange(h,a),u=o.y+o.h+this.y_dist,c=Math.min(t.room.y+t.room.h,l+this.room_max_h),d=this.nextRange(u,c)-l,p=new r.ImmutableRect(e,l,s,d);if(this.valid(p.expand()))return this.debug&&console.log("add right room",o,p),this.corridorsH.push(o),this.rooms.push(p),this.connectWithOthers(p),!0;this.debug&&console.warn("right room not valid",o,p)}else this.debug&&console.warn("right corridor not valid",o);return!1}generateLeftRoom(t){const e=this.nextRange(1,Math.min(this.max_corr_width,t.corridor.h)),i=this.nextRange(this.min_corr_dist_x,t.corridor.w),n=t.corridor.x+(t.corridor.w-i),s=this.nextRange(t.corridor.y,t.corridor.y+t.corridor.h-e),o=new r.ImmutableRect(n,s,i,e);if(this.valid(o.expandH())){const e=Math.max(2,t.room.x,o.x-this.room_max_w),i=this.nextRange(e,o.x-this.room_min_w),n=o.x-i,s=o.y-this.y_dist,a=Math.max(3,t.room.y,o.y+o.h+this.y_dist-this.room_max_h),h=this.nextRange(a,s),l=o.y+o.h+this.y_dist,u=Math.min(t.room.y+t.room.h,h+this.room_max_h),c=this.nextRange(l,u)-h,d=new r.ImmutableRect(i,h,n,c);if(this.valid(d.expand()))return this.debug&&console.log("add left room",o,d),this.corridorsH.push(o),this.rooms.push(d),this.connectWithOthers(d),!0;this.debug&&console.warn("left room not valid")}else this.debug&&console.warn("left corridor not valid");return!1}connectWithOthers(t){const e=t;for(let t=0;t<this.rooms.length-1;t++){let i=this.rooms[t];const n=Math.max(e.x,i.x),s=Math.min(e.x+e.w,i.x+i.w);if(n+5<=s){let t;t=e.y+e.h<i.y?new r.ImmutableRect(n+2,e.y+e.h,s-n-4,i.y-e.y-e.h):new r.ImmutableRect(n+2,i.y+i.h,s-n-4,e.y-i.y-i.h),this.debug&&console.log("test v corr",t),t.w<this.max_corr_dist&&this.valid(t.expandV())&&(this.debug&&console.log("add v corr",t),this.corridorsV.push(t))}const o=Math.max(e.y,i.y),a=Math.min(e.y+e.h,i.y+i.h);if(o+3<=a){let t;t=e.x+e.w<i.x?new r.ImmutableRect(e.x+e.w,o+1,i.x-e.x-e.w,a-o-2):new r.ImmutableRect(i.x+i.w,o+1,e.x-i.x-i.w,a-o-2),this.debug&&console.log("test h corr",t),t.h<this.max_corr_dist&&this.valid(t.expandH())&&(this.debug&&console.log("add h corr",t),this.corridorsH.push(t))}}}nextRange(t,e){return Math.round(this.rng.nextNormal(t,e,this.skew))}},function(t){t[t.TOP=0]="TOP",t[t.RIGHT=1]="RIGHT",t[t.BOTTOM=2]="BOTTOM",t[t.LEFT=3]="LEFT"}(n||(n={}));class s{constructor(t,e,i){this.room=t,this.corridor=e,this.direction=i}}},{"./geometry":71}],97:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const r=t("pixi.js");i.Colors={background:2105376,uiBackground:5263440,uiSelected:9474192,uiNotSelected:5263440,uiRed:16711680,uiYellow:16765696},i.Sizes={uiBorder:4,uiMargin:16};class n extends r.Container{constructor(t){super(),this._selected=!1,this._width=t.width||200,this._height=t.height||24,this._textSize=t.textSize||16,this._bg=new r.Graphics,this._text=new r.BitmapText(t.label,{font:{name:"alagard",size:this._textSize}}),this._text.anchor=new r.Point(.5,.5),this._text.position.set(this._width>>1,this._height>>1),this.selected=t.selected||!1,super.addChild(this._bg,this._text)}get selected(){return this._selected}set selected(t){this._selected=t,this._bg.clear().beginFill(t?i.Colors.uiSelected:i.Colors.uiNotSelected).drawRect(0,0,this._width,this._height).endFill()}}i.Button=n;function s(t,e){const i=e||0;if(t[i]>0)return i;const r=function(t,e){for(let i=e-1;i>=0;i--)if(t[i]>0)return i;return null}(t,i);if(null!==r)return r;const n=function(t,e){for(let i=e+1;i<t.length;i++)if(t[i]>0)return i;return null}(t,i);return null!==n?n:null}i.Layout=class{constructor(){this.commitX=0,this.commitY=0,this.offsetX=0,this.offsetY=0}commit(){this.commitX=this.offsetX,this.commitY=this.offsetY}reset(){this.offsetX=this.commitX,this.offsetY=this.commitY}offset(t,e){this.offsetX+=t,this.offsetY+=e}get x(){return this.offsetX}get y(){return this.offsetY}};i.SelectableGrid=class{constructor(t){this.cells=[],this.counts_x=[],this.counts_y=[],this.limit_x=-1,this.limit_y=-1,this.selected_x=null,this.selected_y=null,this.joystick=t}reset(){if(this.unmark(),this.selected_x=s(this.counts_x,this.selected_x),this.selected_y=s(this.counts_y,this.selected_y),null===this.selected_x||null===this.selected_y)this.selected_x=null,this.selected_y=null;else if(!this.cell(this.selected_x,this.selected_y).isSelectable){const t=this.selected_y,e=(e=>{for(let i=e-1;i>=0;i--)if(this.cell(i,t).isSelectable)return i;return null})(this.selected_x);if(null!==e)this.selected_x=e;else{const e=(e=>{for(let i=e+1;i<=this.limit_x;i++)if(this.cell(i,t).isSelectable)return i;return null})(this.selected_x);if(null===e)throw"illegal state";this.selected_x=e}}this.mark()}moveLeft(){var t;if(this.unmark(),null!==this.selected_x&&null!==this.selected_y){const e=this.selected_y;if(0===this.counts_y[e])throw"illegal state: empty column "+e;const i=null===(t=this.selectedCell)||void 0===t?void 0:t.merged,r=this.selected_x,n=t=>t>0?t-1:this.limit_x;for(let t=n(r);t!=r;t=n(t))if(!(null==i?void 0:i.contains(t,e))&&this.cell(t,e).isSelectable){this.selected_x=t;break}}this.mark()}moveRight(){var t;if(this.unmark(),null!==this.selected_x&&null!==this.selected_y){const e=this.selected_y;if(0===this.counts_y[e])throw"illegal state: empty column "+e;const i=null===(t=this.selectedCell)||void 0===t?void 0:t.merged,r=this.selected_x,n=t=>(t+1)%(this.limit_x+1);for(let t=n(r);t!=r;t=n(t))if(!(null==i?void 0:i.contains(t,e))&&this.cell(t,e).isSelectable){this.selected_x=t;break}}this.mark()}moveUp(){var t;if(this.unmark(),null!==this.selected_x&&null!==this.selected_y){const e=this.selected_x;if(0===this.counts_x[e])throw"illegal state: empty row "+e;const i=null===(t=this.selectedCell)||void 0===t?void 0:t.merged,r=this.selected_y,n=t=>t>0?t-1:this.limit_y;for(let t=n(r);t!=r;t=n(t))if(!(null==i?void 0:i.contains(e,t))&&this.cell(e,t).isSelectable){this.selected_y=t;break}}this.mark()}moveDown(){var t;if(this.unmark(),null!==this.selected_x&&null!==this.selected_y){const e=this.selected_x;if(0===this.counts_x[e])throw"illegal state: empty row "+e;const i=null===(t=this.selectedCell)||void 0===t?void 0:t.merged,r=this.selected_y,n=t=>(t+1)%(this.limit_y+1);for(let t=n(r);t!=r;t=n(t))if(!(null==i?void 0:i.contains(e,t))&&this.cell(e,t).isSelectable){this.selected_y=t;break}}this.mark()}unmark(){var t;null===(t=this.selectedCell)||void 0===t||t.unmark()}mark(){var t;null===(t=this.selectedCell)||void 0===t||t.mark()}get selected(){var t;return(null===(t=this.selectedCell)||void 0===t?void 0:t.value)||null}get selectedCell(){if(null!==this.selected_x&&null!==this.selected_y){const t=this.cell(this.selected_x,this.selected_y);return t.merged&&t.isRef?this.cell(t.merged.from_x,t.merged.from_y):t}return null}set(t,e,i,r){if(t<0||e<0)throw`illegal coordinate: ${t}:${e}`;const n=this.cell(t,e);if(n.isRef)throw`cell is ref: ${t}:${e}`;const s=null!==n.value;if(n.value=[i,r],!s)if(n.merged){const t=n.merged;for(let e=t.from_x;e<=t.to_x;e++)for(let i=t.from_y;i<=t.to_y;i++)this.counts_x[e]++,this.counts_y[i]++}else this.counts_x[t]++,this.counts_y[e]++;this.reset()}merge(t,e,i,r){if(t<0||e<0)throw`illegal coordinate: ${t}:${e}`;if(i<1||r<1)throw`illegal size: ${i}:${r}`;const n=new a(t,e,t+i-1,e+r-1),s=this.cell(t,e);if(s.isRef)throw`cell is ref: ${t}:${e}`;if(s.merged)throw"cell is merged: "+JSON.stringify(s.merged);s.merged=n;const o=null!==s.value;for(let i=n.from_x;i<=n.to_x;i++)for(let r=n.from_y;r<=n.to_y;r++)if(i!==t||r!==e){const t=this.cell(i,r);if(t.value)throw`merging cell already has value: ${i}:${r}`;if(t.isRef)throw`merging cell is ref: ${i}:${r}`;t.merged=n,o&&(this.counts_x[i]++,this.counts_y[r]++)}}remove(t,e){if(t<0||e<0)throw`illegal coordinate: ${t}:${e}`;const i=this.cell(t,e);if(i.isRef)throw`cell is ref: ${t}:${e}`;if(i.value)if(i.value=null,i.merged){const t=i.merged;for(let e=t.from_x;e<=t.to_x;e++)for(let i=t.from_y;i<=t.to_y;i++)this.counts_x[e]--,this.counts_y[i]--}else this.counts_x[t]--,this.counts_y[e]--}unmerge(t,e){if(t<0||e<0)throw`illegal coordinate: ${t}:${e}`;const i=this.cell(t,e);if(i.isRef)throw`cell is ref: ${t}:${e}`;if(i.merged){const r=null!==i.value,n=i.merged;i.merged=null;for(let i=n.from_x;i<=n.to_x;i++)for(let s=n.from_y;s<=n.to_y;s++)i===t&&s===e||(this.cell(i,s).merged=null,r&&(this.counts_x[i]--,this.counts_y[s]--))}}cell(t,e){if(t<0||e<0)throw"illegal coordinate";return this.expand(t,e),this.cells[e][t]}expand(t,e){for(;this.limit_y<e;){this.limit_y++,this.counts_y[this.limit_y]=0,this.cells[this.limit_y]=[];for(let t=0;t<=this.limit_x;t++)this.cells[this.limit_y][t]=new o(t,this.limit_y)}for(;this.limit_x<t;){this.limit_x++,this.counts_x[this.limit_x]=0;for(let t=0;t<=this.limit_y;t++)this.cells[t][this.limit_x]=new o(this.limit_x,t)}}handleInput(){const t=this.joystick;if(t.moveUp.once()&&this.moveUp(),t.moveDown.once()&&this.moveDown(),t.moveLeft.once()&&this.moveLeft(),t.moveRight.once()&&this.moveRight(),t.hit.once()){const t=this.selected;if(t){let[,e]=t;r.sound.play("confirm"),e()}else r.sound.play("cancel"),console.warn("selected not found")}}};class o{constructor(t,e){this.x=t,this.y=e,this.merged=null,this.value=null}unmark(){this.value&&(this.value[0].selected=!1)}mark(){this.value&&(this.value[0].selected=!0)}get isRef(){return null!==this.merged&&!(this.merged.from_x===this.x&&this.merged.from_y===this.y)}get isSelectable(){return null!==this.value||this.isRef}}class a{constructor(t,e,i,r){this.from_x=t,this.from_y=e,this.to_x=i,this.to_y=r}contains(t,e){return t>=this.from_x&&t<=this.to_x&&e>=this.from_y&&e<=this.to_y}}},{"pixi.js":45}],98:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const r=t("./hero"),n=t("./inventory"),s=t("./ui"),o=t("pixi.js");i.UpdateHeroScene=class{constructor(t,e){this.title=null,this.sprite=null,this.spriteBg=null,this.state=null,this.inventory=null,this.buttons=[],this.controller=t,this.hero=e.hero,this.options=e,this.selectable=new s.SelectableGrid(t.joystick)}init(){const t=new s.Layout;this.renderTitle(t),this.renderState(t),this.renderIcon(t),this.renderContinue(t),t.reset(),t.offset(256+s.Sizes.uiMargin,0),t.commit(),this.renderIncreaseHealth(t),t.reset(),t.offset(24+2*s.Sizes.uiMargin,0),t.commit(),this.renderInventory(t),this.selectable.reset(),this.controller.app.ticker.add(this.handleInput,this)}destroy(){var t,e,i,r,n;this.controller.app.ticker.remove(this.handleInput,this),null===(t=this.title)||void 0===t||t.destroy(),null===(e=this.sprite)||void 0===e||e.destroy(),null===(i=this.spriteBg)||void 0===i||i.destroy(),null===(r=this.state)||void 0===r||r.destroy(),null===(n=this.inventory)||void 0===n||n.destroy();for(let t of this.buttons)t.destroy();this.sprite=null,this.spriteBg=null,this.title=null,this.state=null,this.inventory=null,this.buttons.splice(0,1e3)}pause(){}resume(){}renderTitle(t){this.title=new o.BitmapText("ROGUELIKE DUNGEON",{font:{name:"alagard",size:64}}),this.title.anchor=new o.Point(.5,0),this.title.position.set(this.controller.app.screen.width>>1,64),this.controller.stage.addChild(this.title),t.offset(0,128+s.Sizes.uiMargin),t.commit()}renderState(t){t.offset(s.Sizes.uiMargin,0),t.commit(),this.state=new r.HeroStateView(this.hero,{fixedHPSize:!0}),this.state.position.set(t.x,t.y),this.controller.stage.addChild(this.state),t.offset(0,this.state.getBounds().height)}renderIcon(t){this.sprite=this.controller.resources.animated(this.hero.name+"_idle"),this.sprite.play(),this.sprite.animationSpeed=.2;const e=this.sprite.width,i=this.sprite.height;this.sprite.width=256-(s.Sizes.uiMargin<<1);const r=this.sprite.width/e;this.sprite.height=Math.floor(r*i);const n=Math.floor(r*this.sprite.texture.trim.height),a=this.sprite.height-n;t.offset(0,s.Sizes.uiMargin),this.sprite.position.set(t.x+s.Sizes.uiMargin,t.y+s.Sizes.uiMargin-a),this.spriteBg=(new o.Graphics).beginFill(s.Colors.uiBackground).drawRect(0,0,256,n+(s.Sizes.uiMargin<<1)).endFill(),this.spriteBg.position.set(t.x,t.y),this.controller.stage.addChild(this.spriteBg,this.sprite),t.offset(0,n+(s.Sizes.uiMargin<<1))}renderIncreaseHealth(t){const e=new s.Button({label:"+",width:24,height:24});e.position.set(t.x,t.y),this.selectable.set(1,0,e,()=>this.hero.increaseHealth()),this.selectable.merge(1,0,1,12),this.buttons.push(e),this.controller.stage.addChild(e),t.offset(0,24)}renderContinue(t){t.offset(0,s.Sizes.uiMargin);const e=new s.Button({label:"Continue ...",width:256,height:32});e.position.set(t.x,t.y),this.selectable.set(0,0,e,()=>this.controller.generateDungeon(this.options)),this.selectable.merge(0,0,1,12),this.buttons.push(e),this.controller.stage.addChild(e),t.offset(0,32)}renderInventory(t){const e=new n.DefaultInventoryActionsController(this.hero.inventory);this.inventory=new n.InventoryView(this.hero.inventory,e,this.selectable,2),this.inventory.position.set(t.x,t.y),this.controller.stage.addChild(this.inventory)}handleInput(){this.selectable.handleInput()}}},{"./hero":72,"./inventory":76,"./ui":97,"pixi.js":45}],99:[function(t,e,i){"use strict";var r=this&&this.__awaiter||function(t,e,i,r){return new(i||(i=Promise))((function(n,s){function o(t){try{h(r.next(t))}catch(t){s(t)}}function a(t){try{h(r.throw(t))}catch(t){s(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((r=r.apply(t,e||[])).next())}))};Object.defineProperty(i,"__esModule",{value:!0});const n=t("../dungeon.generator"),s=t("./even.simple.tiled"),o=t("./model"),a=t("../concurency"),h=t("../rng");class l extends n.BaseDungeonGenerator{constructor(t){super(t),this.model=null}get percent(){var t;return(null===(t=this.model)||void 0===t?void 0:t.percent)||0}generate(t){return r(this,void 0,void 0,(function*(){const e=this.controller.app.loader.resources["dungeon.rules.4.json"].data,i=this.controller.app.loader.resources["dungeon.design.json"].data,r=t.hero;let n;r.dungeonSeeds.has(t.level)?(n=r.dungeonSeeds.get(t.level),console.log(`dungeon level ${t.level} exists seed: ${n}`)):(n=this.controller.rng.nextInt(),console.log(`dungeon level ${t.level} new seed: ${n}`),r.dungeonSeeds.set(t.level,n));const l=new h.RNG(n);yield a.yields(10);const u=new s.DungeonCrawlerConstraint(i);let c;for(this.model=new s.EvenSimpleTiledModel(this.resources,e,l,i.width,i.height,[u]),console.time("model loop run");;){if(console.time("model run"),c=yield this.model.run(1e4),console.timeEnd("model run"),c===o.Resolution.Decided){console.log("success run model");break}console.error("failed run model"),yield a.yields()}console.timeEnd("model loop run");const d=this.createDungeon(l,n,t.level,this.model.FMX,this.model.FMY),p=this.model.observed;for(let t=0;t<this.model.FMY;t++)for(let i=0;i<this.model.FMX;i++){const r=i+t*this.model.FMX,[n,s]=e.cells[p[r]];n>=0&&(d.cell(i,t).floorName=e.tiles[n]),s>=0&&(d.cell(i,t).wallName=e.tiles[s])}yield a.yields(),this.replaceFloorRandomly(l,d),yield a.yields(),this.replaceWallRandomly(l,d);const f=this.placeHero(l,d,t.hero);return yield a.yields(),this.placeLadder(l,d,f),yield a.yields(),t.level%5==1&&(this.placeBonfire(l,d,f),yield a.yields()),this.placeNpc(l,d,f),yield a.yields(),this.placeMonsters(l,d,f),yield a.yields(),t.level%5==0&&(this.placeBoss(l,d,f),yield a.yields()),this.placeDrop(l,d),yield a.yields(),d.light.loadMap(),yield a.yields(),d}))}}i.HybridDungeonGenerator=l},{"../concurency":60,"../dungeon.generator":65,"../rng":84,"./even.simple.tiled":100,"./model":101}],100:[function(t,e,i){"use strict";var r=this&&this.__awaiter||function(t,e,i,r){return new(i||(i=Promise))((function(n,s){function o(t){try{h(r.next(t))}catch(t){s(t)}}function a(t){try{h(r.throw(t))}catch(t){s(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((r=r.apply(t,e||[])).next())}))};Object.defineProperty(i,"__esModule",{value:!0});const n=t("./model"),s=t("../rng"),o=t("../tunneling"),a=t("../indexer"),h=t("../tunneler/dungeon.crawler"),l=t("pixi.js");var u,c;!function(t){t[t.RIGHT=2]="RIGHT",t[t.DOWN=1]="DOWN"}(u=i.Direction||(i.Direction={})),function(t){t[t.EMPTY=0]="EMPTY",t[t.FLOOR=1]="FLOOR",t[t.FLOOR_WALL_TOP=2]="FLOOR_WALL_TOP",t[t.WALL_MID=3]="WALL_MID",t[t.WALL_TOP=4]="WALL_TOP",t[t.WALL_SIDE=5]="WALL_SIDE"}(c=i.CellType||(i.CellType={}));i.TilesetRulesBuilder=class{constructor(){this.tilesIndex=a.Indexer.identity(),this.cellsIndex=a.Indexer.array(),this.rightIndex=a.Indexer.array(),this.downIndex=a.Indexer.array()}addCell(t,e,i){const r=t?this.tilesIndex.index(t):-1,n=e?this.tilesIndex.index(e):-1;return this.cellsIndex.index([r,n,i])}addRuleRight(t,e){this.rightIndex.index([t,e])}addRuleDown(t,e){this.downIndex.index([t,e])}build(){return{size:16,tiles:this.tilesIndex.values,cells:this.cellsIndex.values,right:this.rightIndex.values,down:this.downIndex.values}}};class d extends n.Model{constructor(t,e,i,r,s,o){super(i,r,s),this.app=null,this.resources=t,this.weights=[],this.tileset=e,this.constraints=o,this.T=e.cells.length;for(let t=0;t<this.T;t++)this.weights[t]=1;const a=[];for(let t=0;t<4;t++){a[t]=[];for(let e=0;e<this.T;e++){a[t][e]=[];for(let i=0;i<this.T;i++)a[t][e][i]=!1}}for(let[t,i]of e.right){const e=n.Model.opposite[u.RIGHT];a[u.RIGHT][t][i]=!0,a[e][i][t]=!0}for(let[t,i]of e.down){const e=n.Model.opposite[u.DOWN];a[u.DOWN][t][i]=!0,a[e][i][t]=!0}this.propagator=[];for(let t=0;t<4;t++){this.propagator[t]=[];for(let e=0;e<this.T;e++){this.propagator[t][e]=[];for(let i=0;i<this.T;i++)a[t][e][i]&&this.propagator[t][e].push(i)}}}onBoundary(t,e){return!this.periodic&&(t<0||e<0||t>=this.FMX||e>=this.FMY)}clear(){super.clear();for(let t of this.constraints)t.onClear(),this.propagate()}backtrackConstraint(t,e){for(let i of this.constraints)i.onBacktrack(t,e)}banConstraint(t,e){for(let i of this.constraints)i.onBan(t,e)}initConstraint(){for(let t of this.constraints)if(t.init(this),this.status!=n.Resolution.Undecided)return void(this.debug&&console.warn("failed init constraint",this.status))}stepConstraint(){for(let t of this.constraints){if(t.check(),this.status!=n.Resolution.Undecided)return void(this.debug&&console.warn("failed step constraint check"));if(this.propagate(),this.status!=n.Resolution.Undecided)return void(this.debug&&console.warn("failed step constraint propagate"))}this.deferredConstraintsStep=!1}testObserved(t){let e=t%this.FMX,i=Math.floor(t/this.FMX);if(!this.onBoundary(e,i)){const e=this.wave[t].filter(t=>t).length;console.assert(1===e,`wave ${t} pattern count ${e}`)}}graphics(t){const e=this.tileset.size;console.log("tilesize",e,this.tileset,this.tileset.size),null==this.app&&(this.app=new l.Application({width:this.FMX*e*1,height:this.FMY*e*1,resolution:1,antialias:!1,autoStart:!1,sharedTicker:!1,sharedLoader:!1}),document.body.appendChild(this.app.view));const i=this.app;this.app.stage.removeChildren();const r=new l.Container;if(r.scale.set(1,1),i.stage.addChild(r),null!=this.observed)for(let t=0;t<this.FMX;t++)for(let i=0;i<this.FMY;i++){let[n,s]=this.tileset.cells[this.observed[t+i*this.FMX]];if(n>=0){const s=this.resources.sprite(this.tileset.tiles[n]);s.position.set(t*e,i*e),s.zIndex=1,r.addChild(s)}if(s>=0){const n=this.resources.sprite(this.tileset.tiles[s]);n.position.set(t*e,i*e),n.zIndex=2,r.addChild(n)}}else for(let t=0;t<this.FMX;t++)for(let i=0;i<this.FMY;i++){let n=this.wave[t+i*this.FMX],s=0;for(let t=0;t<this.T;t++)n[t]&&(s+=this.weights[t]);const o=1/s;for(let s=0;s<this.T;s++)if(n[s]){const[n,a]=this.tileset.cells[s],h=(n>=0?1:0)+(a>=0?1:0);if(n>=0){const a=this.resources.sprite(this.tileset.tiles[n]);a.position.set(t*e,i*e),a.zIndex=1,a.alpha=o*(1/h)*this.weights[s],r.addChild(a)}if(a>=0){const n=this.resources.sprite(this.tileset.tiles[a]);n.position.set(t*e,i*e),n.zIndex=2,n.alpha=o*(1/h)*this.weights[s],r.addChild(n)}}}const n=new l.Graphics;r.addChild(n),n.lineStyle(1,16711680);for(let i of t){let t=i%this.FMX,r=Math.floor(i/this.FMX);n.drawRect(t*e,r*e,e,e)}i.render();const s=i.view;console.log("%c ",`\n      font-size: 1px;\n      padding: ${s.height/2}px ${s.width/2}px;\n      background: no-repeat url(${s.toDataURL("image/png")});\n      background-size: ${s.width}px ${s.height}px;\n    `)}}i.EvenSimpleTiledModel=d;class p{constructor(t){this.model=null,this.isBorderCell=t}init(t){this.model=t}onClear(){console.log("on clear");const t=this.model,e=t.FMX*t.FMY;for(let i=0;i<e;i++){let e=i%t.FMX,r=Math.floor(i/t.FMX);if(0===e||e===t.FMX-1||0===r||r===t.FMY-1)for(let e=0;e<t.T;e++)t.wave[i][e]&&!this.isBorderCell[e]&&t.ban(i,e)}}onBan(t,e){}onBacktrack(t,e){}check(){return!0}}i.BorderConstraint=p;class f{constructor(t){this.model=null,this.graph=null,this.couldBePath=[],this.mustBePath=[],this.refresh=[],this.refreshQueue=[],this.isPathCell=t}init(t){this.model=t;const e=t.FMX*t.FMY;this.couldBePath=n.buffer(e,!1),this.mustBePath=n.buffer(e,!1),this.refresh=n.buffer(e,!0),this.refreshQueue=[]}onClear(){let t=this.model.FMX*this.model.FMY;this.couldBePath=n.buffer(t,!1),this.mustBePath=n.buffer(t,!1),this.refresh=n.buffer(t,!0),this.refreshQueue=[];for(let e=0;e<t;e++)this.refreshQueue.push(e);this.refreshAll(),this.graph=this.createGraph()}onBacktrack(t,e){this.addRefresh(t)}onBan(t,e){this.addRefresh(t)}addRefresh(t){if(!this.refresh[t]){const e=this.model.FMX,i=this.model.FMY;let r=t%e,s=Math.floor(t/e);this.refresh[t]=!0,this.refreshQueue.push(t);for(let t=0;t<4;t++){let o=r+n.Model.DX[t],a=s+n.Model.DY[t];if(this.model.onBoundary(o,a))continue;o<0?o+=e:o>=e&&(o-=e),a<0?a+=i:a>=i&&(a-=i);let h=o+a*e;this.refresh[h]||(this.refresh[h]=!0,this.refreshQueue.push(h))}}}refreshAll(){const t=this.model,e=t.T;for(;this.refreshQueue.length>0;){const i=this.refreshQueue.pop();this.refresh[i]=!1;let r=0,n=0;for(let s=0;s<e;s++)t.wave[i][s]&&(n++,this.isPathCell[s]&&r++);this.couldBePath[i]=r>0,this.mustBePath[i]=r>0&&n===r}}check(){for(;;){this.refreshAll();let t=this.getArticulationPoints();if(null==t)return this.model.debug&&console.error("no articulation"),void(this.model.status=n.Resolution.Contradiction);if(!this.applyArticulationPoints(t))break;if(this.model.debug){console.log("articulation");let e=t.map((t,e)=>[t,e]).filter(t=>t[0]).map(t=>t[1]);this.model.graphics(e),console.log("continue articulation loop")}}}applyArticulationPoints(t){const e=this.model;let i=e.FMX*e.FMY,r=!1;for(let n=0;n<i;n++)if(t[n]&&!this.mustBePath[n]){e.debug&&console.log("articulation",n);let t=n%e.FMX,i=Math.floor(n/e.FMX);e.debug&&console.log("x, y, i",t,i,n);for(let t=0;t<e.T;t++)e.wave[n][t]&&this.isPathCell[t]&&(e.debug&&console.log("ban not path",n,t),e.ban(n,t),r=!0)}return r}getArticulationPoints(){const t=this.couldBePath,e=this.mustBePath,i=this.model,r=this.graph,s=t.length,o=n.buffer(s,0);let a=1;const h=n.buffer(s,0),l=[],u=n.buffer(s,!1);function c(i){const n=[];n.push(new g(i));let s=!1,c=0;for(;;){const i=n.length-1,d=n[i],p=d.u;let f,m=d.state;do{switch(f=!1,m){case 0:{let t=null!=e&&e[p];t&&(u[p]=!0),d.isRelevantSubtree=t,o[p]=h[p]=a++,l.push(p),m=1,f=!0;break}case 1:{let e=r.neighbours[p],s=d.neighbourIndex;if(s>=e.length){m=3,f=!0;break}let a=e[s];if(!t[a]){d.neighbourIndex=s+1,m=1,f=!0;break}if(0===h[a]){n.push(new g(a)),d.state=2,m=2,n[i]=d;break}o[p]=Math.min(o[p],h[a]),d.neighbourIndex=s+1,m=1,f=!0;break}case 2:{let t=r.neighbours[p],n=d.neighbourIndex,a=t[n];0==i&&c++,s&&(d.isRelevantSubtree=!0),o[a]>=h[p]&&(null==e||s)&&(u[p]=!0),o[p]=Math.min(o[p],o[a]),d.neighbourIndex=n+1,m=1,f=!0;break}case 3:if(0==i)return c;s=d.isRelevantSubtree,n.splice(i,1)}}while(f)}}for(let i=0;i<s;i++)if(t[i]&&e[i]&&0==h[i]){c(i);break}for(let n=0;n<s;n++)if(e[n]&&0==h[n]){if(i.debug){console.warn("walkable:");let e=t.map((t,e)=>[t,e]).filter(t=>t[0]).map(t=>t[1]);i.graphics(e),console.warn("visited"),i.graphics(l);const s=i.FMX;let o=n%s,a=Math.floor(n/s);console.error(`not visited relevant point i=${n} x=${o} y=${a}`),console.warn("graph neighbours",r.neighbours[n]),i.graphics([n])}return null}for(let i=0;i<s;i++){if(!t[i])continue;if(e[i])continue;if(0!=h[i])continue;if(u[i])continue;let r=c(i);u[i]=r>1}return u}createGraph(){const t=this.model;let e=t.FMX*t.FMY,i=[];for(let r=0;r<e;r++){i[r]=[];let e=r%t.FMX,s=Math.floor(r/t.FMX);for(let o=0;o<4;o++){let a=e+n.Model.DX[o],h=s+n.Model.DY[o];if(!t.periodic&&(a>=t.FMX||h>=t.FMY||a<0||h<0))continue;a<0?a+=t.FMX:a>=t.FMX&&(a-=t.FMX),h<0?h+=t.FMY:h>=t.FMY&&(h-=t.FMY);let l=a+h*t.FMX;i[r].push(l)}}return{nodeCount:e,neighbours:i}}}i.PathConstraint=f;class g{constructor(t){this.state=0,this.neighbourIndex=0,this.isRelevantSubtree=!1,this.u=t}}class m{constructor(t,e,i){this.isRoomCell=[],this.model=null,this.isRoomCell=t,this.denyOther=e,this.tunnelingOptions=i}init(t){this.model=t}onClear(){const t=this.model,e=new o.TunnelingAlgorithm(t.rng,t.FMX,t.FMY,this.tunnelingOptions);e.generate();const i=n.buffer(t.FMX*t.FMY,!1);for(const r of e.rooms)for(let e=r.y;e<r.y+r.h;e++)for(let n=r.x;n<r.x+r.w;n++)i[n+e*t.FMX]=!0;for(let e=0;e<i.length;e++)for(let r=0;r<t.T;r++)i[e]?this.isRoomCell[r]||t.ban(e,r):this.denyOther&&this.isRoomCell[r]&&t.ban(e,r)}check(){}onBacktrack(t,e){}onBan(t,e){}}i.RoomConstraint=m;i.DungeonCrawlerConstraint=class{constructor(t){this.model=null,this.config=t}init(t){this.model=t}onClear(){const t=this.model;console.time("crawler");const e=new h.DungeonCrawler(this.config,t.rng);e.generate(),console.timeEnd("crawler"),console.time("crawler constraint");const i=n.buffer(t.FMX*t.FMY,!1);for(let r=0;r<e.config.height;r++)for(let n=0;n<e.config.width;n++){const s=n+r*t.FMX;i[s]=e.isMapOpen({x:n,y:r})}function r(e){let r=e%t.FMX,n=Math.floor(e/t.FMX);for(let e=0;e<=1;e++)for(let s=-1;s<=1;s++)if(0!==s||0!==e){let o=r+s,a=n+e;if(t.onBoundary(o,a))continue;if(!i[o+a*t.FMX])return!1}return!0}function s(e,r=2){let n=e%t.FMX,s=Math.floor(e/t.FMX);for(let e=-1;e<=r;e++)for(let r=-1;r<=1;r++)if(0!==r||0!==e){let o=n+r,a=s+e;if(t.onBoundary(o,a))continue;if(i[o+a*t.FMX])return!0}return!1}function o(e,r,n){let s=e%t.FMX+r,o=Math.floor(e/t.FMX)+n;return t.onBoundary(s,o)?null:i[s+o*t.FMX]}for(let e=0;e<i.length;e++){const a=n.buffer(6,!1),h=o(e,0,1);if(i[e])a[c.EMPTY]=!1,a[c.FLOOR]=!0,r(e)||(a[c.FLOOR_WALL_TOP]=!0);else if(s(e)){const t=o(e,0,-1);a[c.EMPTY]=!(!0===t||!0===h),a[c.WALL_MID]=!0===t||!0===h,a[c.WALL_TOP]=!0,a[c.WALL_SIDE]=!0}else a[c.EMPTY]=!0;for(let i=0;i<t.T;i++){a[t.tileset.cells[i][2]]||t.ban(e,i)}}console.timeEnd("crawler constraint")}check(){}onBacktrack(t,e){}onBan(t,e){}};i.EvenSimpleTiledModelTest=class{static test(t){return r(this,void 0,void 0,(function*(){const e=new l.Loader;e.add("village.rules.json"),yield new Promise(t=>e.load(()=>t()));const i=e.resources["village.rules.json"].data;console.log("tileset",i);const r=t=>{const e=i.tiles.map(e=>!!e.match(t));return i.cells.map(t=>{const[i,r]=t;return i>=0&&e[i]&&-1===r})},o=r(/^grass_\d+\.png$/),a=r(/^road_\d+\.png$/),h=r(/^wood_floor_\d+\.png$/);console.log("borderCells",o),console.log("pathCells",a),console.log("roomCells",h);const u=new d(t,i,new s.RNG,50,50,[new p(o),new m(h,!0,{room_max_w:7,room_max_h:5,max_corr_dist:20,min_corr_dist_x:5,min_corr_dist_y:10}),new f(a)]);let c;for(console.time("model loop run");;){if(console.time("model run"),c=yield u.run(1e4),console.timeEnd("model run"),c===n.Resolution.Decided){console.log("success run model");break}console.error("failed run model")}console.timeEnd("model loop run"),console.log("model",u),u.graphics([])}))}}},{"../indexer":73,"../rng":84,"../tunneler/dungeon.crawler":91,"../tunneling":96,"./model":101,"pixi.js":45}],101:[function(t,e,i){"use strict";var r=this&&this.__awaiter||function(t,e,i,r){return new(i||(i=Promise))((function(n,s){function o(t){try{h(r.next(t))}catch(t){s(t)}}function a(t){try{h(r.throw(t))}catch(t){s(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}h((r=r.apply(t,e||[])).next())}))};Object.defineProperty(i,"__esModule",{value:!0});const n=t("../concurency");function s(t,e){const i=[];for(let r=0;r<t;r++)i.push(e);return i}i.buffer=s;class o{constructor(t,e,i,r=255){this.R=t,this.G=e,this.B=i,this.A=r}static fromRgb(t){return new o(t>>16&255,t>>8&255,255&t)}static fromImage(t,e,i){return o.fromBuffer(t.data,t.width,e,i)}static fromBuffer(t,e,i,r){let n=4*(r*e+i),s=t[n],a=t[n+1],h=t[n+2],l=t[n+3];return new o(s,a,h,l)}equals(t){return this.R===t.R&&this.G===t.G&&this.B===t.B&&this.A===t.A}}i.Color=o;var a;i.Tile=class{constructor(t,e,i=((t,e)=>t===e)){this.value=t,this.color=e,this.equal=i}equals(t){return t.equal(this.value,t.value)}},function(t){t[t.Decided=0]="Decided",t[t.Undecided=-1]="Undecided",t[t.Contradiction=-2]="Contradiction"}(a=i.Resolution||(i.Resolution={}));class h{constructor(t,e,i){this.wave=[],this.propagator=[],this.compatible=[],this.observed=null,this.toPropagate=[],this.backtrackItems=[],this.backtrackItemsLengths=[],this.prevChoices=[],this.droppedBacktrackItemsCount=0,this.T=0,this.periodic=!1,this.weights=[],this.weightLogWeights=[],this.sumsOfOnes=[],this.sumOfWeights=0,this.sumOfWeightLogWeights=0,this.startingEntropy=0,this.sumsOfWeights=[],this.sumsOfWeightLogWeights=[],this.entropies=[],this.status=a.Undecided,this.deferredConstraintsStep=!1,this.debug=!1,this.rng=t,this.FMX=e,this.FMY=i}get percent(){let t=0;for(let e=0;e<this.wave.length;e++)1===this.sumsOfOnes[e]&&t++;return 100*t/this.wave.length}init(){this.wave=s(this.FMX*this.FMY,[]),this.compatible=[];for(let t=0;t<this.wave.length;t++){this.wave[t]=s(this.T,!0),this.compatible[t]=[];for(let e=0;e<this.T;e++)this.compatible[t][e]=s(4,0)}this.weightLogWeights=[],this.sumOfWeights=0,this.sumOfWeightLogWeights=0;for(let t=0;t<this.T;t++)this.weightLogWeights[t]=this.weights[t]*Math.log(this.weights[t]),this.sumOfWeights+=this.weights[t],this.sumOfWeightLogWeights+=this.weightLogWeights[t];this.startingEntropy=Math.log(this.sumOfWeights)-this.sumOfWeightLogWeights/this.sumOfWeights,this.status=a.Undecided,this.initConstraint()}clear(){this.sumsOfOnes=[],this.sumsOfWeights=[],this.sumsOfWeightLogWeights=[],this.entropies=[];for(let t=0;t<this.wave.length;t++){for(let e=0;e<this.T;e++){this.wave[t][e]=!0;for(let i=0;i<4;i++)this.compatible[t][e][i]=this.propagator[h.opposite[i]][e].length}this.sumsOfOnes[t]=this.weights.length,this.sumsOfWeights[t]=this.sumOfWeights,this.sumsOfWeightLogWeights[t]=this.sumOfWeightLogWeights,this.entropies[t]=this.startingEntropy}this.toPropagate=[],this.backtrackItems=[],this.backtrackItemsLengths=[0],this.droppedBacktrackItemsCount=0,this.prevChoices=[],this.status=a.Undecided}run(t=0,e=!1){return r(this,void 0,void 0,(function*(){0===this.wave.length&&(console.time("model.init"),this.init(),console.timeEnd("model.init")),console.time("model.clear"),this.clear(),console.timeEnd("model.clear"),console.time("model.run"),this.debug=e;let i=0;for(;(i<t||0===t)&&(i%50==0&&(yield n.yields()),this.debug&&console.log("step",i),this.step(),this.debug&&(console.log("after step",i),this.graphics([])),this.status===a.Undecided);i++);return console.timeEnd("model.run"),console.log("complete, steps: "+i),this.status}))}step(){let t,e=-1,i=!1;this.deferredConstraintsStep&&(this.debug&&console.log("step constraint"),this.stepConstraint()),this.status!=a.Undecided&&(e=0,i=!0,this.debug&&console.log("restart = true")),i||(console.assert(0==this.toPropagate.length),this.backtrackItemsLengths.push(this.droppedBacktrackItemsCount+this.backtrackItems.length),[e,t]=this.observe(),this.debug&&console.log("observed",e,t),-1!==e&&(this.debug&&console.log("push to prev choices"),this.prevChoices.push([e,t])));do{if(this.debug&&console.log("do loop"),i=!1,this.debug&&console.log("status",this.status),this.status===a.Undecided&&this.propagate(),this.status===a.Undecided&&this.stepConstraint(),-1===e&&this.status===a.Undecided)return this.debug&&console.log("decided"),this.status=a.Decided,this.status;if(this.status===a.Contradiction)for(this.debug&&console.log("contradiction"),e=0;;){if(this.debug&&console.log("while backtrack"),1==this.backtrackItemsLengths.length)return this.debug&&console.log("We've backtracked as much as we can, but, it's still not possible. That means it is impossible"),a.Contradiction;this.backtrack();let t=this.prevChoices.pop();if(this.toPropagate=[],this.status=a.Undecided,this.debug&&(console.log("Mark the given choice as impossible",t[0],t[1]),this.graphics([t[0]])),this.internalBan(t[0],t[1])&&(this.status=a.Contradiction),this.status===a.Undecided&&this.propagate(),this.status!==a.Contradiction){this.debug&&console.log("// Include the last ban as part of the previous backtrack"),console.assert(0===this.toPropagate.length),this.backtrackItemsLengths.pop(),this.backtrackItemsLengths.push(this.droppedBacktrackItemsCount+this.backtrackItems.length),this.debug&&console.log("restart = true and break"),i=!0;break}this.debug&&console.log("If still in contradiction, repeat backtracking")}}while(i);return this.status}observe(){this.debug&&console.log("observe");let t=1e3,e=-1;for(let i=0;i<this.wave.length;i++){if(this.onBoundary(i%this.FMX,Math.floor(i/this.FMX)))continue;let r=this.sumsOfOnes[i];if(0===r)return this.debug&&console.error(`[wave=${i}] found zero sum of ones`),this.debug&&this.graphics([i]),this.status=a.Contradiction,[-1,-1];let n=this.entropies[i];if(r>1&&n<=t){let r=1e-6*this.rng.nextFloat();n+r<t&&(t=n+r,e=i)}}if(-1==e){this.debug&&console.log("complete observed"),this.observed=s(this.FMX*this.FMY,0);for(let t=0;t<this.wave.length;t++){let e=t%this.FMX,i=Math.floor(t/this.FMX);if(!this.onBoundary(e,i)){this.testObserved(t);for(let e=0;e<this.T;e++)if(this.wave[t][e]){this.observed[t]=e;break}}}return[-1,-1]}let i=0,r=[];for(let t=0;t<this.T;t++)r[t]=this.wave[e][t]?this.weights[t]:0,i+=r[t];let n=this.rng.nextFloat()*i,o=0;for(let t of r){if(n-=t,n<0)break;o++}let h=this.wave[e];for(let t=0;t<this.T;t++)h[t]!=(t==o)&&(this.debug&&console.log("observe select"),this.internalBan(e,t)&&(this.status=a.Contradiction));return this.debug&&(console.log("observed",[e,o]),this.graphics([e])),[e,o]}propagate(){for(;this.toPropagate.length>0;){let[t,e]=this.toPropagate.pop(),i=t%this.FMX,r=Math.floor(t/this.FMX);for(let t=0;t<4;t++){let n=i+h.DX[t],s=r+h.DY[t];if(this.onBoundary(n,s))continue;n<0?n+=this.FMX:n>=this.FMX&&(n-=this.FMX),s<0?s+=this.FMY:s>=this.FMY&&(s-=this.FMY);let o=n+s*this.FMX,l=this.propagator[t][e],u=this.compatible[o];for(let e of l){let i=u[e];i[t]--,0==i[t]&&this.internalBan(o,e)&&(this.status=a.Contradiction)}}if(this.status==a.Contradiction)break}}ban(t,e){return this.debug&&console.log("ban",t,e),this.wave[t][e]&&(this.deferredConstraintsStep=!0,this.internalBan(t,e))?this.status=a.Contradiction:(this.propagate(),this.status)}internalBan(t,e){this.debug&&console.log("internal ban",t,e),this.wave[t][e]=!1;let i=this.compatible[t][e];for(let t=0;t<4;t++)i[t]-=this.T;this.toPropagate.push([t,e]),this.sumsOfOnes[t]-=1,this.sumsOfWeights[t]-=this.weights[e],this.sumsOfWeightLogWeights[t]-=this.weightLogWeights[e];let r=this.sumsOfWeights[t];return this.entropies[t]=Math.log(r)-this.sumsOfWeightLogWeights[t]/r,this.backtrackItems.push([t,e]),this.banConstraint(t,e),0===this.sumsOfOnes[t]&&(this.debug&&(console.error("sum is zero",t),this.graphics([t])),!0)}backtrack(){const t=this.backtrackItemsLengths.pop()-this.droppedBacktrackItemsCount;this.debug&&console.warn("backtrack",t);const e=[],i=new Set(this.toPropagate.map(t=>t.join(",")));for(;this.backtrackItems.length>t;){let[t,r]=this.backtrackItems.pop();e.push(t);let n=this.compatible[t][r];for(let t=0;t<4;t++)n[t]+=this.T;this.wave[t][r]=!0,this.sumsOfOnes[t]+=1,this.sumsOfWeights[t]+=this.weights[r],this.sumsOfWeightLogWeights[t]+=this.weightLogWeights[r];let s=this.sumsOfWeights[t];if(this.entropies[t]=Math.log(s)-this.sumsOfWeightLogWeights[t]/s,!i.has([t,r].join(","))){let i=t%this.FMX,n=Math.floor(t/this.FMX);for(let t=0;t<4;t++){let s=i+h.DX[t],o=n+h.DY[t];if(this.onBoundary(s,o))continue;s<0?s+=this.FMX:s>=this.FMX&&(s-=this.FMX),o<0?o+=this.FMY:o>=this.FMY&&(o-=this.FMY);let a=s+o*this.FMX;e.push(a);const l=this.propagator[t][r];for(let e of l)this.compatible[a][e][t]++}}this.backtrackConstraint(t,r)}this.debug&&(console.log("backtracked"),this.graphics(e))}}i.Model=h,h.DX=[-1,0,1,0],h.DY=[0,1,0,-1],h.opposite=[2,3,0,1]},{"../concurency":60}]},{},[55]);
//# sourceMappingURL=bundle.js.map
